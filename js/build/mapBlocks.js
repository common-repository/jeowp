!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./src/js/build/",r(r.s=666)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.React},function(e,t){e.exports=window.wp.i18n},function(e,t,r){"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return o}));var n=r(3);function o(e){Object(n.a)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}},function(e,t){e.exports=window.wp.components},function(e,t,r){"use strict";function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}r.d(t,"a",(function(){return n}))},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,"a",(function(){return n}))},function(e,t,r){e.exports=function(){"use strict";var e,t,r;function n(n,o){if(e)if(t){var i="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",a={};e(a),r=o(a),"undefined"!=typeof window&&(r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}else t=o;else e=o}return n(0,(function(e){function t(e,t){return e(t={exports:{}},t.exports),t.exports}var r=n;function n(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=r,this.p2y=n}n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},n.prototype.solveCurveX=function(e,t){var r,n,o,i,a;for(void 0===t&&(t=1e-6),o=e,a=0;a<8;a++){if(i=this.sampleCurveX(o)-e,Math.abs(i)<t)return o;var s=this.sampleCurveDerivativeX(o);if(Math.abs(s)<1e-6)break;o-=i/s}if((o=e)<(r=0))return r;if(o>(n=1))return n;for(;r<n;){if(i=this.sampleCurveX(o),Math.abs(i-e)<t)return o;e>i?r=o:n=o,o=.5*(n-r)+r}return o},n.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var o=i;function i(e,t){this.x=e,this.y=t}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(e){return e instanceof i?e:Array.isArray(e)?new i(e[0],e[1]):e};var a="undefined"!=typeof self?self:{},s=Math.pow(2,53)-1;function l(e,t,n,o){var i=new r(e,t,n,o);return function(e){return i.solve(e)}}var c=l(.25,.1,.25,1);function u(e,t,r){return Math.min(r,Math.max(t,e))}function d(e,t,r){var n=r-t,o=((e-t)%n+n)%n+t;return o===t?r:o}function h(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,o=t;n<o.length;n+=1){var i=o[n];for(var a in i)e[a]=i[a]}return e}var p=1;function f(){return p++}function m(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function g(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function b(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function v(e,t){return-1!==e.indexOf(t,e.length-t.length)}function y(e,t,r){var n={};for(var o in e)n[o]=t.call(r||this,e[o],o,e);return n}function _(e,t,r){var n={};for(var o in e)t.call(r||this,e[o],o,e)&&(n[o]=e[o]);return n}function w(e){return Array.isArray(e)?e.map(w):"object"==typeof e&&e?y(e,w):e}var x={};function k(e){x[e]||("undefined"!=typeof console&&console.warn(e),x[e]=!0)}function C(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function E(e){for(var t=0,r=0,n=e.length,o=n-1,i=void 0,a=void 0;r<n;o=r++)t+=((a=e[o]).x-(i=e[r]).x)*(i.y+a.y);return t}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function T(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,r,n,o){var i=n||o;return t[r]=!i||i.toLowerCase(),""})),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var A=null;function P(e){if(null==A){var t=e.navigator?e.navigator.userAgent:null;A=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return A}function I(e){try{var t=a[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}var O,M,D,z,j=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),R=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,L=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,N={now:j,frame:function(e){var t=R(e);return{cancel:function(){return L(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=a.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return O||(O=a.document.createElement("a")),O.href=e,O.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==M&&(M=a.matchMedia("(prefers-reduced-motion: reduce)")),M.matches)}},B={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(e){!V&&z&&(U?q(e):D=e)}},V=!1,U=!1;function q(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.isContextLost())return;F.supported=!0}catch(e){}e.deleteTexture(t),V=!0}a.document&&((z=a.document.createElement("img")).onload=function(){D&&q(D),D=null,U=!0},z.onerror=function(){V=!0,D=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var H="01",W=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function G(e){return 0===e.indexOf("mapbox:")}W.prototype._createSkuToken=function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",H,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},W.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},W.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},W.prototype.normalizeStyleURL=function(e,t){if(!G(e))return e;var r=K(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},W.prototype.normalizeGlyphsURL=function(e,t){if(!G(e))return e;var r=K(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},W.prototype.normalizeSourceURL=function(e,t){if(!G(e))return e;var r=K(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},W.prototype.normalizeSpriteURL=function(e,t,r,n){var o=K(e);return G(e)?(o.path="/styles/v1"+o.path+"/sprite"+t+r,this._makeAPIURL(o,this._customAccessToken||n)):(o.path+=""+t+r,X(o))},W.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!G(e))return e;var r=K(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(N.devicePixelRatio>=2||512===t?"@2x":"")+(F.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var n=this._customAccessToken||function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t].match(/^access_token=(.*)$/);if(n)return n[1]}return null}(r.params)||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&n&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,n)},W.prototype.canonicalizeTileURL=function(e,t){var r=K(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var n="mapbox://tiles/";n+=r.path.replace("/v4/","");var o=r.params;return t&&(o=o.filter((function(e){return!e.match(/^access_token=/)}))),o.length&&(n+="?"+o.join("&")),n},W.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&G(t),n=[],o=0,i=e.tiles||[];o<i.length;o+=1){var a=i[o];Y(a)?n.push(this.canonicalizeTileURL(a,r)):n.push(a)}return n},W.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=K(B.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){var o=e.params.indexOf("secure");o>=0&&e.params.splice(o,1)}if("/"!==n.path&&(e.path=""+n.path+e.path),!B.REQUIRE_ACCESS_TOKEN)return X(e);if(!(t=t||B.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token="+t),X(e)};var Z=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Y(e){return Z.test(e)}var $=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function K(e){var t=e.match($);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function X(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function J(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(t[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}var Q=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Q.prototype.getStorageKey=function(e){var t,r=J(B.ACCESS_TOKEN);return t=r&&r.u?a.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):B.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Q.prototype.fetchEventData=function(){var e=I("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var n=a.localStorage.getItem(t);n&&(this.eventData=JSON.parse(n));var o=a.localStorage.getItem(r);o&&(this.anonId=o)}catch(e){k("Unable to read from LocalStorage")}},Q.prototype.saveEventData=function(){var e=I("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{a.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){k("Unable to write to LocalStorage")}},Q.prototype.processRequests=function(e){},Q.prototype.postEvent=function(e,t,r,n){var o=this;if(B.EVENTS_URL){var i=K(B.EVENTS_URL);i.params.push("access_token="+(n||B.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.1",skuId:H,userId:this.anonId},s=t?h(a,t):a,l={url:X(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=we(l,(function(e){o.pendingRequest=null,r(e),o.saveEventData(),o.processRequests(n)}))}},Q.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ee,te,re=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(e,t,r,n){this.skuToken=r,(B.EVENTS_URL&&n||B.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return G(e)||Y(e)})))&&this.queueRequest({id:t,timestamp:Date.now()},n)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),n=r.id,o=r.timestamp;n&&this.success[n]||(this.anonId||this.fetchEventData(),g(this.anonId)||(this.anonId=m()),this.postEvent(o,{skuToken:this.skuToken},(function(e){e||n&&(t.success[n]=!0)}),e))}},t}(Q),ne=new(function(e){function t(t){e.call(this,"appUserTurnstile"),this._customAccessToken=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(e,t){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return G(e)||Y(e)}))&&this.queueRequest(Date.now(),t)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=J(B.ACCESS_TOKEN),n=r?r.u:B.ACCESS_TOKEN,o=n!==this.eventData.tokenU;g(this.anonId)||(this.anonId=m(),o=!0);var i=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(i),l=(i-this.eventData.lastSuccess)/864e5;o=o||l>=1||l<-1||a.getDate()!==s.getDate()}else o=!0;if(!o)return this.processRequests();this.postEvent(i,{"enabled.telemetry":!1},(function(e){e||(t.eventData.lastSuccess=i,t.eventData.tokenU=n)}),e)}},t}(Q)),oe=ne.postTurnstileEvent.bind(ne),ie=new re,ae=ie.postMapLoadEvent.bind(ie),se=500,le=50;function ce(){a.caches&&!ee&&(ee=a.caches.open("mapbox-tiles"))}function ue(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var de,he=1/0;function pe(){return null==de&&(de=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),de}var fe={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(fe);var me,ge,be=function(e){function t(t,r,n){401===r&&Y(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,t),this.status=r,this.url=n,this.name=this.constructor.name,this.message=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ve=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href},ye=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(ve())&&!/^\w+:/.test(r))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(e,t){var r,n=new a.AbortController,o=new a.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:ve(),signal:n.signal}),i=!1,s=!1,l=(r=o.url).indexOf("sku=")>0&&Y(r);"json"===e.type&&o.headers.set("Accept","application/json");var c=function(r,n,i){if(!s){if(r&&"SecurityError"!==r.message&&k(r),n&&i)return u(n);var c=Date.now();a.fetch(o).then((function(r){if(r.ok){var n=l?r.clone():null;return u(r,n,c)}return t(new be(r.statusText,r.status,e.url))})).catch((function(e){20!==e.code&&t(new Error(e.message))}))}},u=function(r,n,l){("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((function(e){s||(n&&l&&function(e,t,r){if(ce(),ee){var n={status:t.status,statusText:t.statusText,headers:new a.Headers};t.headers.forEach((function(e,t){return n.headers.set(t,e)}));var o=T(t.headers.get("Cache-Control")||"");o["no-store"]||(o["max-age"]&&n.headers.set("Expires",new Date(r+1e3*o["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===te)try{new Response(new ReadableStream),te=!0}catch(e){te=!1}te?t(e.body):e.blob().then(t)}(t,(function(t){var r=new a.Response(t,n);ce(),ee&&ee.then((function(t){return t.put(ue(e.url),r)})).catch((function(e){return k(e.message)}))})))}}(o,n,l),i=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((function(e){s||t(new Error(e.message))}))};return l?function(e,t){if(ce(),!ee)return t(null);var r=ue(e.url);ee.then((function(e){e.match(r).then((function(n){var o=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),r=T(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}(n);e.delete(r),o&&e.put(r,n.clone()),t(null,n,o)})).catch(t)})).catch(t)}(o,c):c(null,null),{cancel:function(){s=!0,i||n.abort()}}}(e,t);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(e,t){var r=new a.XMLHttpRequest;for(var n in r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)r.setRequestHeader(n,e.headers[n]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){var n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else t(new be(r.statusText,r.status,e.url))},r.send(e.body),{cancel:function(){return r.abort()}}}(e,t)},_e=function(e,t){return ye(h(e,{type:"arrayBuffer"}),t)},we=function(e,t){return ye(h(e,{method:"POST"}),t)},xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";me=[],ge=0;var ke=function(e,t){if(F.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ge>=B.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return me.push(r),r}ge++;var n=!1,o=function(){if(!n)for(n=!0,ge--;me.length&&ge<B.MAX_PARALLEL_IMAGE_REQUESTS;){var e=me.shift();e.cancelled||(e.cancel=ke(e.requestParameters,e.callback).cancel)}},i=_e(e,(function(e,r,n,i){o(),e?t(e):r&&(pe()?function(e,t){var r=new a.Blob([new Uint8Array(e)],{type:"image/png"});a.createImageBitmap(r).then((function(e){t(null,e)})).catch((function(e){t(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(r,t):function(e,t,r,n){var o=new a.Image,i=a.URL;o.onload=function(){t(null,o),i.revokeObjectURL(o.src),o.onload=null,a.requestAnimationFrame((function(){o.src=xe}))},o.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new a.Blob([new Uint8Array(e)],{type:"image/png"});o.cacheControl=r,o.expires=n,o.src=e.byteLength?i.createObjectURL(s):xe}(r,t,n,i))}));return{cancel:function(){i.cancel(),o()}}};function Ce(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function Ee(e,t,r){if(r&&r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}var Se=function(e,t){void 0===t&&(t={}),h(this,t),this.type=e},Te=function(e){function t(t,r){void 0===r&&(r={}),e.call(this,"error",h({error:t},r))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Se),Ae=function(){};Ae.prototype.on=function(e,t){return this._listeners=this._listeners||{},Ce(e,t,this._listeners),this},Ae.prototype.off=function(e,t){return Ee(e,t,this._listeners),Ee(e,t,this._oneTimeListeners),this},Ae.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},Ce(e,t,this._oneTimeListeners),this},Ae.prototype.fire=function(e,t){"string"==typeof e&&(e=new Se(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var n=0,o=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];n<o.length;n+=1)o[n].call(this,e);for(var i=0,a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];i<a.length;i+=1){var s=a[i];Ee(r,s,this._oneTimeListeners),s.call(this,e)}var l=this._eventedParent;l&&(h(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(e))}else e instanceof Te&&console.error(e.error);return this},Ae.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ae.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ie=function(e,t,r,n){this.message=(e?e+": ":"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)};function Oe(e){var t=e.value;return t?[new Ie(e.key,t,"constants have been deprecated as of v8")]:[]}function Me(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,o=t;n<o.length;n+=1){var i=o[n];for(var a in i)e[a]=i[a]}return e}function De(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ze(e){if(Array.isArray(e))return e.map(ze);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=ze(e[r]);return t}return De(e)}var je=function(e){function t(t,r){e.call(this,r),this.message=r,this.key=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Re=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,n=t;r<n.length;r+=1){var o=n[r];this.bindings[o[0]]=o[1]}};Re.prototype.concat=function(e){return new Re(this,e)},Re.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Re.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Le={kind:"null"},Ne={kind:"number"},Be={kind:"string"},Fe={kind:"boolean"},Ve={kind:"color"},Ue={kind:"object"},qe={kind:"value"},He={kind:"collator"},We={kind:"formatted"},Ge={kind:"resolvedImage"};function Ze(e,t){return{kind:"array",itemType:e,N:t}}function Ye(e){if("array"===e.kind){var t=Ye(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var $e=[Le,Ne,Be,Fe,Ve,We,Ue,Ze(qe),Ge];function Ke(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Ke(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,n=$e;r<n.length;r+=1)if(!Ke(n[r],t))return null}return"Expected "+Ye(e)+" but found "+Ye(t)+" instead."}function Xe(e,t){return t.some((function(t){return t.kind===e.kind}))}function Je(e,t){return t.some((function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e}))}var Qe=t((function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(e){return(e=Math.round(e))<0?0:e>255?255:e}function o(e){return n("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function i(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function a(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?(t=parseInt(s.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&(t=parseInt(s.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=s.indexOf("("),c=s.indexOf(")");if(-1!==l&&c+1===s.length){var u=s.substr(0,l),d=s.substr(l+1,c-(l+1)).split(","),h=1;switch(u){case"rgba":if(4!==d.length)return null;h=i(d.pop());case"rgb":return 3!==d.length?null:[o(d[0]),o(d[1]),o(d[2]),h];case"hsla":if(4!==d.length)return null;h=i(d.pop());case"hsl":if(3!==d.length)return null;var p=(parseFloat(d[0])%360+360)%360/360,f=i(d[1]),m=i(d[2]),g=m<=.5?m*(f+1):m+f-m*f,b=2*m-g;return[n(255*a(b,g,p+1/3)),n(255*a(b,g,p)),n(255*a(b,g,p-1/3)),h];default:return null}}return null}}catch(e){}})).parseCSSColor,et=function(e,t,r,n){void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n};et.parse=function(e){if(e){if(e instanceof et)return e;if("string"==typeof e){var t=Qe(e);if(t)return new et(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},et.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],n=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+n+")"},et.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},et.black=new et(0,0,0,1),et.white=new et(1,1,1,1),et.transparent=new et(0,0,0,0),et.red=new et(1,0,0,1);var tt=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};tt.prototype.compare=function(e,t){return this.collator.compare(e,t)},tt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var rt=function(e,t,r,n,o){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=o},nt=function(e){this.sections=e};nt.fromString=function(e){return new nt([new rt(e,null,null,null,null)])},nt.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))},nt.factory=function(e){return e instanceof nt?e:nt.fromString(e)},nt.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")},nt.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];if(n.image)e.push(["image",n.image.name]);else{e.push(n.text);var o={};n.fontStack&&(o["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(o["font-scale"]=n.scale),n.textColor&&(o["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(o)}}return e};var ot=function(e){this.name=e.name,this.available=e.available};function it(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function at(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof et)return!0;if(e instanceof tt)return!0;if(e instanceof nt)return!0;if(e instanceof ot)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!at(r[t]))return!1;return!0}if("object"==typeof e){for(var n in e)if(!at(e[n]))return!1;return!0}return!1}function st(e){if(null===e)return Le;if("string"==typeof e)return Be;if("boolean"==typeof e)return Fe;if("number"==typeof e)return Ne;if(e instanceof et)return Ve;if(e instanceof tt)return He;if(e instanceof nt)return We;if(e instanceof ot)return Ge;if(Array.isArray(e)){for(var t,r=e.length,n=0,o=e;n<o.length;n+=1){var i=st(o[n]);if(t){if(t===i)continue;t=qe;break}t=i}return Ze(t||qe,r)}return Ue}function lt(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof et||e instanceof nt||e instanceof ot?e.toString():JSON.stringify(e)}ot.prototype.toString=function(){return this.name},ot.fromString=function(e){return e?new ot({name:e,available:!1}):null},ot.prototype.serialize=function(){return["image",this.name]};var ct=function(e,t){this.type=e,this.value=t};ct.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!at(e[1]))return t.error("invalid value");var r=e[1],n=st(r),o=t.expectedType;return"array"!==n.kind||0!==n.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(n=o),new ct(n,r)},ct.prototype.evaluate=function(){return this.value},ct.prototype.eachChild=function(){},ct.prototype.outputDefined=function(){return!0},ct.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof et?["rgba"].concat(this.value.toArray()):this.value instanceof nt?this.value.serialize():this.value};var ut=function(e){this.name="ExpressionEvaluationError",this.message=e};ut.prototype.toJSON=function(){return this.message};var dt={string:Be,number:Ne,boolean:Fe,object:Ue},ht=function(e,t){this.type=e,this.args=t};ht.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,n=1,o=e[0];if("array"===o){var i,a;if(e.length>2){var s=e[1];if("string"!=typeof s||!(s in dt)||"object"===s)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=dt[s],n++}else i=qe;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],n++}r=Ze(i,a)}else r=dt[o];for(var l=[];n<e.length;n++){var c=t.parse(e[n],n,qe);if(!c)return null;l.push(c)}return new ht(r,l)},ht.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!Ke(this.type,st(r)))return r;if(t===this.args.length-1)throw new ut("Expected value to be of type "+Ye(this.type)+", but found "+Ye(st(r))+" instead.")}return null},ht.prototype.eachChild=function(e){this.args.forEach(e)},ht.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},ht.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map((function(e){return e.serialize()})))};var pt=function(e){this.type=We,this.sections=e};pt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var n=[],o=!1,i=1;i<=e.length-1;++i){var a=e[i];if(o&&"object"==typeof a&&!Array.isArray(a)){o=!1;var s=null;if(a["font-scale"]&&!(s=t.parse(a["font-scale"],1,Ne)))return null;var l=null;if(a["text-font"]&&!(l=t.parse(a["text-font"],1,Ze(Be))))return null;var c=null;if(a["text-color"]&&!(c=t.parse(a["text-color"],1,Ve)))return null;var u=n[n.length-1];u.scale=s,u.font=l,u.textColor=c}else{var d=t.parse(e[i],1,qe);if(!d)return null;var h=d.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,n.push({content:d,scale:null,font:null,textColor:null})}}return new pt(n)},pt.prototype.evaluate=function(e){return new nt(this.sections.map((function(t){var r=t.content.evaluate(e);return st(r)===Ge?new rt("",r,null,null,null):new rt(lt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))},pt.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}},pt.prototype.outputDefined=function(){return!1},pt.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e.push(n.content.serialize());var o={};n.scale&&(o["font-scale"]=n.scale.serialize()),n.font&&(o["text-font"]=n.font.serialize()),n.textColor&&(o["text-color"]=n.textColor.serialize()),e.push(o)}return e};var ft=function(e){this.type=Ge,this.input=e};ft.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Be);return r?new ft(r):t.error("No image name provided.")},ft.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=ot.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},ft.prototype.eachChild=function(e){e(this.input)},ft.prototype.outputDefined=function(){return!1},ft.prototype.serialize=function(){return["image",this.input.serialize()]};var mt={"to-boolean":Fe,"to-color":Ve,"to-number":Ne,"to-string":Be},gt=function(e,t){this.type=e,this.args=t};gt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var n=mt[r],o=[],i=1;i<e.length;i++){var a=t.parse(e[i],i,qe);if(!a)return null;o.push(a)}return new gt(n,o)},gt.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,n=0,o=this.args;n<o.length;n+=1){if(r=null,(t=o[n].evaluate(e))instanceof et)return t;if("string"==typeof t){var i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":it(t[0],t[1],t[2],t[3])))return new et(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ut(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(e)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new ut("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?nt.fromString(lt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ot.fromString(lt(this.args[0].evaluate(e))):lt(this.args[0].evaluate(e))},gt.prototype.eachChild=function(e){this.args.forEach(e)},gt.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},gt.prototype.serialize=function(){if("formatted"===this.type.kind)return new pt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ft(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild((function(t){e.push(t.serialize())})),e};var bt=["Unknown","Point","LineString","Polygon"],vt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};vt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},vt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?bt[this.feature.type]:this.feature.type:null},vt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},vt.prototype.canonicalID=function(){return this.canonical},vt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},vt.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=et.parse(e)),t};var yt=function(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n};yt.prototype.evaluate=function(e){return this._evaluate(e,this.args)},yt.prototype.eachChild=function(e){this.args.forEach(e)},yt.prototype.outputDefined=function(){return!1},yt.prototype.serialize=function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))},yt.parse=function(e,t){var r,n=e[0],o=yt.definitions[n];if(!o)return t.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(o)?o[0]:o.type,a=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,s=a.filter((function(t){var r=t[0];return!Array.isArray(r)||r.length===e.length-1})),l=null,c=0,u=s;c<u.length;c+=1){var d=u[c],h=d[0],p=d[1];l=new Vt(t.registry,t.path,null,t.scope);for(var f=[],m=!1,g=1;g<e.length;g++){var b=e[g],v=Array.isArray(h)?h[g-1]:h.type,y=l.parse(b,1+f.length,v);if(!y){m=!0;break}f.push(y)}if(!m)if(Array.isArray(h)&&h.length!==f.length)l.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var _=0;_<f.length;_++){var w=Array.isArray(h)?h[_]:h.type,x=f[_];l.concat(_+1).checkSubtype(w,x.type)}if(0===l.errors.length)return new yt(n,i,p,f)}}if(1===s.length)(r=t.errors).push.apply(r,l.errors);else{for(var k=(s.length?s:a).map((function(e){var t;return t=e[0],Array.isArray(t)?"("+t.map(Ye).join(", ")+")":"("+Ye(t.type)+"...)"})).join(" | "),C=[],E=1;E<e.length;E++){var S=t.parse(e[E],1+C.length);if(!S)return null;C.push(Ye(S.type))}t.error("Expected arguments of type "+k+", but found ("+C.join(", ")+") instead.")}return null},yt.register=function(e,t){for(var r in yt.definitions=t,t)e[r]=yt};var _t=function(e,t,r){this.type=He,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function wt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function xt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function kt(e,t){var r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,o=Math.pow(2,t.z);return[Math.round(r*o*8192),Math.round(n*o*8192)]}function Ct(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Et(e,t){for(var r,n,o,i,a,s,l,c=!1,u=0,d=t.length;u<d;u++)for(var h=t[u],p=0,f=h.length;p<f-1;p++){if((i=(r=e)[0]-(n=h[p])[0])*(l=r[1]-(o=h[p+1])[1])-(s=r[0]-o[0])*(a=r[1]-n[1])==0&&i*s<=0&&a*l<=0)return!1;Ct(e,h[p],h[p+1])&&(c=!c)}return c}function St(e,t){for(var r=0;r<t.length;r++)if(Et(e,t[r]))return!0;return!1}function Tt(e,t,r,n){var o=n[0]-r[0],i=n[1]-r[1],a=(e[0]-r[0])*i-o*(e[1]-r[1]),s=(t[0]-r[0])*i-o*(t[1]-r[1]);return a>0&&s<0||a<0&&s>0}function At(e,t,r){for(var n=0,o=r;n<o.length;n+=1)for(var i=o[n],a=0;a<i.length-1;++a)if(0!=(d=[(u=i[a+1])[0]-(c=i[a])[0],u[1]-c[1]])[0]*(h=[(l=t)[0]-(s=e)[0],l[1]-s[1]])[1]-d[1]*h[0]&&Tt(s,l,c,u)&&Tt(c,u,s,l))return!0;var s,l,c,u,d,h;return!1}function Pt(e,t){for(var r=0;r<e.length;++r)if(!Et(e[r],t))return!1;for(var n=0;n<e.length-1;++n)if(At(e[n],e[n+1],t))return!1;return!0}function It(e,t){for(var r=0;r<t.length;r++)if(Pt(e,t[r]))return!0;return!1}function Ot(e,t,r){for(var n=[],o=0;o<e.length;o++){for(var i=[],a=0;a<e[o].length;a++){var s=kt(e[o][a],r);wt(t,s),i.push(s)}n.push(i)}return n}function Mt(e,t,r){for(var n=[],o=0;o<e.length;o++){var i=Ot(e[o],t,r);n.push(i)}return n}function Dt(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){var o=.5*n,i=e[0]-r[0]>o?-n:r[0]-e[0]>o?n:0;0===i&&(i=e[0]-r[2]>o?-n:r[2]-e[0]>o?n:0),e[0]+=i}wt(t,e)}function zt(e,t,r,n){for(var o=8192*Math.pow(2,n.z),i=[8192*n.x,8192*n.y],a=[],s=0,l=e;s<l.length;s+=1)for(var c=0,u=l[s];c<u.length;c+=1){var d=u[c],h=[d.x+i[0],d.y+i[1]];Dt(h,t,r,o),a.push(h)}return a}function jt(e,t,r,n){for(var o,i=8192*Math.pow(2,n.z),a=[8192*n.x,8192*n.y],s=[],l=0,c=e;l<c.length;l+=1){for(var u=[],d=0,h=c[l];d<h.length;d+=1){var p=h[d],f=[p.x+a[0],p.y+a[1]];wt(t,f),u.push(f)}s.push(u)}if(t[2]-t[0]<=i/2){(o=t)[0]=o[1]=1/0,o[2]=o[3]=-1/0;for(var m=0,g=s;m<g.length;m+=1)for(var b=0,v=g[m];b<v.length;b+=1)Dt(v[b],t,r,i)}return s}_t.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Fe);if(!n)return null;var o=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Fe);if(!o)return null;var i=null;return r.locale&&!(i=t.parse(r.locale,1,Be))?null:new _t(n,o,i)},_t.prototype.evaluate=function(e){return new tt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},_t.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},_t.prototype.outputDefined=function(){return!1},_t.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Rt=function(e,t){this.type=Fe,this.geojson=e,this.geometries=t};function Lt(e){if(e instanceof yt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Rt)return!1;var t=!0;return e.eachChild((function(e){t&&!Lt(e)&&(t=!1)})),t}function Nt(e){if(e instanceof yt&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild((function(e){t&&!Nt(e)&&(t=!1)})),t}function Bt(e,t){if(e instanceof yt&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild((function(e){r&&!Bt(e,t)&&(r=!1)})),r}Rt.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(at(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var n=0;n<r.features.length;++n){var o=r.features[n].geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Rt(r,r.features[n].geometry)}else if("Feature"===r.type){var i=r.geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Rt(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Rt(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Rt.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){var i=Ot(t.coordinates,n,o),a=zt(e.geometry(),r,n,o);if(!xt(r,n))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Et(l[s],i))return!1}if("MultiPolygon"===t.type){var c=Mt(t.coordinates,n,o),u=zt(e.geometry(),r,n,o);if(!xt(r,n))return!1;for(var d=0,h=u;d<h.length;d+=1)if(!St(h[d],c))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){var i=Ot(t.coordinates,n,o),a=jt(e.geometry(),r,n,o);if(!xt(r,n))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Pt(l[s],i))return!1}if("MultiPolygon"===t.type){var c=Mt(t.coordinates,n,o),u=jt(e.geometry(),r,n,o);if(!xt(r,n))return!1;for(var d=0,h=u;d<h.length;d+=1)if(!It(h[d],c))return!1}return!0}(e,this.geometries)}return!1},Rt.prototype.eachChild=function(){},Rt.prototype.outputDefined=function(){return!0},Rt.prototype.serialize=function(){return["within",this.geojson]};var Ft=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ft.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ft(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ft.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ft.prototype.eachChild=function(){},Ft.prototype.outputDefined=function(){return!1},Ft.prototype.serialize=function(){return["var",this.name]};var Vt=function(e,t,r,n,o){void 0===t&&(t=[]),void 0===n&&(n=new Re),void 0===o&&(o=[]),this.registry=e,this.path=t,this.key=t.map((function(e){return"["+e+"]"})).join(""),this.scope=n,this.errors=o,this.expectedType=r};function Ut(e,t){for(var r,n=e.length-1,o=0,i=n,a=0;o<=i;)if((r=e[a=Math.floor((o+i)/2)])<=t){if(a===n||t<e[a+1])return a;o=a+1}else{if(!(r>t))throw new ut("Input is not a number.");i=a-1}return 0}Vt.prototype.parse=function(e,t,r,n,o){return void 0===o&&(o={}),t?this.concat(t,r,n)._parse(e,o):this._parse(e,o)},Vt.prototype._parse=function(e,t){function r(e,t,r){return"assert"===r?new ht(t,[e]):"coerce"===r?new gt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var o=this.registry[n];if(o){var i=o.parse(e,this);if(!i)return null;if(this.expectedType){var a=this.expectedType,s=i.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else i=r(i,a,t.typeAnnotation||"coerce");else i=r(i,a,t.typeAnnotation||"assert")}if(!(i instanceof ct)&&"resolvedImage"!==i.type.kind&&function e(t){if(t instanceof Ft)return e(t.boundExpression);if(t instanceof yt&&"error"===t.name)return!1;if(t instanceof _t)return!1;if(t instanceof Rt)return!1;var r=t instanceof gt||t instanceof ht,n=!0;return t.eachChild((function(t){n=r?n&&e(t):n&&t instanceof ct})),!!n&&Lt(t)&&Bt(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(i)){var l=new vt;try{i=new ct(i.type,i.evaluate(l))}catch(e){return this.error(e.message),null}}return i}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Vt.prototype.concat=function(e,t,r){var n="number"==typeof e?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new Vt(this.registry,n,t||null,o,this.errors)},Vt.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var n=""+this.key+t.map((function(e){return"["+e+"]"})).join("");this.errors.push(new je(n,e))},Vt.prototype.checkSubtype=function(e,t){var r=Ke(e,t);return r&&this.error(r),r};var qt=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,o=r;n<o.length;n+=1){var i=o[n],a=i[1];this.labels.push(i[0]),this.outputs.push(a)}};function Ht(e,t,r){return e*(1-r)+t*r}qt.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Ne);if(!r)return null;var n=[],o=null;t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(var i=1;i<e.length;i+=2){var a=1===i?-1/0:e[i],s=e[i+1],l=i,c=i+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var u=t.parse(s,c,o);if(!u)return null;o=o||u.type,n.push([a,u])}return new qt(o,r,n)},qt.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var o=t.length;return n>=t[o-1]?r[o-1].evaluate(e):r[Ut(t,n)].evaluate(e)},qt.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},qt.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},qt.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Wt=Object.freeze({__proto__:null,number:Ht,color:function(e,t,r){return new et(Ht(e.r,t.r,r),Ht(e.g,t.g,r),Ht(e.b,t.b,r),Ht(e.a,t.a,r))},array:function(e,t,r){return e.map((function(e,n){return Ht(e,t[n],r)}))}}),Gt=6/29*3*(6/29),Zt=Math.PI/180,Yt=180/Math.PI;function $t(e){return e>.008856451679035631?Math.pow(e,1/3):e/Gt+4/29}function Kt(e){return e>6/29?e*e*e:Gt*(e-4/29)}function Xt(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Jt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Qt(e){var t=Jt(e.r),r=Jt(e.g),n=Jt(e.b),o=$t((.4124564*t+.3575761*r+.1804375*n)/.95047),i=$t((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*i-16,a:500*(o-i),b:200*(i-$t((.0193339*t+.119192*r+.9503041*n)/1.08883)),alpha:e.a}}function er(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Kt(t),r=.95047*Kt(r),n=1.08883*Kt(n),new et(Xt(3.2404542*r-1.5371385*t-.4985314*n),Xt(-.969266*r+1.8760108*t+.041556*n),Xt(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function tr(e,t,r){var n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}var rr={forward:Qt,reverse:er,interpolate:function(e,t,r){return{l:Ht(e.l,t.l,r),a:Ht(e.a,t.a,r),b:Ht(e.b,t.b,r),alpha:Ht(e.alpha,t.alpha,r)}}},nr={forward:function(e){var t=Qt(e),r=t.l,n=t.a,o=t.b,i=Math.atan2(o,n)*Yt;return{h:i<0?i+360:i,c:Math.sqrt(n*n+o*o),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Zt,r=e.c;return er({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:tr(e.h,t.h,r),c:Ht(e.c,t.c,r),l:Ht(e.l,t.l,r),alpha:Ht(e.alpha,t.alpha,r)}}},or=Object.freeze({__proto__:null,lab:rr,hcl:nr}),ir=function(e,t,r,n,o){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var i=0,a=o;i<a.length;i+=1){var s=a[i],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function ar(e,t,r,n){var o=n-r,i=e-r;return 0===o?0:1===t?i/o:(Math.pow(t,i)-1)/(Math.pow(t,o)-1)}ir.interpolationFactor=function(e,t,n,o){var i=0;if("exponential"===e.name)i=ar(t,e.base,n,o);else if("linear"===e.name)i=ar(t,1,n,o);else if("cubic-bezier"===e.name){var a=e.controlPoints;i=new r(a[0],a[1],a[2],a[3]).solve(ar(t,1,n,o))}return i},ir.parse=function(e,t){var r=e[0],n=e[1],o=e[2],i=e.slice(3);if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(4!==s.length||s.some((function(e){return"number"!=typeof e||e<0||e>1})))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(o=t.parse(o,2,Ne)))return null;var l=[],c=null;"interpolate-hcl"===r||"interpolate-lab"===r?c=Ve:t.expectedType&&"value"!==t.expectedType.kind&&(c=t.expectedType);for(var u=0;u<i.length;u+=2){var d=i[u],h=i[u+1],p=u+3,f=u+4;if("number"!=typeof d)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(l.length&&l[l.length-1][0]>=d)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var m=t.parse(h,f,c);if(!m)return null;c=c||m.type,l.push([d,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new ir(c,r,n,o,l):t.error("Type "+Ye(c)+" is not interpolatable.")},ir.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);var i=Ut(t,n),a=ir.interpolationFactor(this.interpolation,n,t[i],t[i+1]),s=r[i].evaluate(e),l=r[i+1].evaluate(e);return"interpolate"===this.operator?Wt[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?nr.reverse(nr.interpolate(nr.forward(s),nr.forward(l),a)):rr.reverse(rr.interpolate(rr.forward(s),rr.forward(l),a))},ir.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ir.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},ir.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var sr=function(e,t){this.type=e,this.args=t};sr.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,n=t.expectedType;n&&"value"!==n.kind&&(r=n);for(var o=[],i=0,a=e.slice(1);i<a.length;i+=1){var s=t.parse(a[i],1+o.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,o.push(s)}var l=n&&o.some((function(e){return Ke(n,e.type)}));return new sr(l?qe:r,o)},sr.prototype.evaluate=function(e){for(var t,r=null,n=0,o=0,i=this.args;o<i.length&&(n++,(r=i[o].evaluate(e))&&r instanceof ot&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null===r);o+=1);return r},sr.prototype.eachChild=function(e){this.args.forEach(e)},sr.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},sr.prototype.serialize=function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e};var lr=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};lr.prototype.evaluate=function(e){return this.result.evaluate(e)},lr.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},lr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],n=1;n<e.length-1;n+=2){var o=e[n];if("string"!=typeof o)return t.error("Expected string, but found "+typeof o+" instead.",n);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);var i=t.parse(e[n+1],n+1);if(!i)return null;r.push([o,i])}var a=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return a?new lr(r,a):null},lr.prototype.outputDefined=function(){return this.result.outputDefined()},lr.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var n=r[t];e.push(n[0],n[1].serialize())}return e.push(this.result.serialize()),e};var cr=function(e,t,r){this.type=e,this.index=t,this.input=r};cr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Ne),n=t.parse(e[2],2,Ze(t.expectedType||qe));return r&&n?new cr(n.type.itemType,r,n):null},cr.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ut("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new ut("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new ut("Array index must be an integer, but found "+t+" instead.");return r[t]},cr.prototype.eachChild=function(e){e(this.index),e(this.input)},cr.prototype.outputDefined=function(){return!1},cr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ur=function(e,t){this.type=Fe,this.needle=e,this.haystack=t};ur.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,qe),n=t.parse(e[2],2,qe);return r&&n?Xe(r.type,[Fe,Be,Ne,Le,qe])?new ur(r,n):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ye(r.type)+" instead"):null},ur.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Je(t,["boolean","string","number","null"]))throw new ut("Expected first argument to be of type boolean, string, number or null, but found "+Ye(st(t))+" instead.");if(!Je(r,["string","array"]))throw new ut("Expected second argument to be of type array or string, but found "+Ye(st(r))+" instead.");return r.indexOf(t)>=0},ur.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},ur.prototype.outputDefined=function(){return!0},ur.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var dr=function(e,t,r){this.type=Ne,this.needle=e,this.haystack=t,this.fromIndex=r};dr.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,qe),n=t.parse(e[2],2,qe);if(!r||!n)return null;if(!Xe(r.type,[Fe,Be,Ne,Le,qe]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ye(r.type)+" instead");if(4===e.length){var o=t.parse(e[3],3,Ne);return o?new dr(r,n,o):null}return new dr(r,n)},dr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Je(t,["boolean","string","number","null"]))throw new ut("Expected first argument to be of type boolean, string, number or null, but found "+Ye(st(t))+" instead.");if(!Je(r,["string","array"]))throw new ut("Expected second argument to be of type array or string, but found "+Ye(st(r))+" instead.");if(this.fromIndex){var n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)},dr.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},dr.prototype.outputDefined=function(){return!1},dr.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var hr=function(e,t,r,n,o,i){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=o,this.otherwise=i};hr.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var o={},i=[],a=2;a<e.length-1;a+=2){var s=e[a],l=e[a+1];Array.isArray(s)||(s=[s]);var c=t.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var u=0,d=s;u<d.length;u+=1){var h=d[u];if("number"!=typeof h&&"string"!=typeof h)return c.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,st(h)))return null}else r=st(h);if(void 0!==o[String(h)])return c.error("Branch labels must be unique.");o[String(h)]=i.length}var p=t.parse(l,a,n);if(!p)return null;n=n||p.type,i.push(p)}var f=t.parse(e[1],1,qe);if(!f)return null;var m=t.parse(e[e.length-1],e.length-1,n);return m?"value"!==f.type.kind&&t.concat(1).checkSubtype(r,f.type)?null:new hr(r,n,f,o,i,m):null},hr.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(st(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},hr.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},hr.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()},hr.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],n={},o=0,i=Object.keys(this.cases).sort();o<i.length;o+=1){var a=i[o];void 0===(d=n[this.cases[a]])?(n[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[d][1].push(a)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},l=0,c=r;l<c.length;l+=1){var u=c[l],d=u[0],h=u[1];t.push(1===h.length?s(h[0]):h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var pr=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};pr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var n=[],o=1;o<e.length-1;o+=2){var i=t.parse(e[o],o,Fe);if(!i)return null;var a=t.parse(e[o+1],o+1,r);if(!a)return null;n.push([i,a]),r=r||a.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new pr(r,n,s):null},pr.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],o=n[1];if(n[0].evaluate(e))return o.evaluate(e)}return this.otherwise.evaluate(e)},pr.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],o=n[1];e(n[0]),e(o)}e(this.otherwise)},pr.prototype.outputDefined=function(){return this.branches.every((function(e){return e[1].outputDefined()}))&&this.otherwise.outputDefined()},pr.prototype.serialize=function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e};var fr=function(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n};function mr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function gr(e,t,r,n){return 0===n.compare(t,r)}function br(e,t,r){var n="=="!==e&&"!="!==e;return function(){function o(e,t,r){this.type=Fe,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return o.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0],i=t.parse(e[1],1,qe);if(!i)return null;if(!mr(r,i.type))return t.concat(1).error('"'+r+"\" comparisons are not supported for type '"+Ye(i.type)+"'.");var a=t.parse(e[2],2,qe);if(!a)return null;if(!mr(r,a.type))return t.concat(2).error('"'+r+"\" comparisons are not supported for type '"+Ye(a.type)+"'.");if(i.type.kind!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error("Cannot compare types '"+Ye(i.type)+"' and '"+Ye(a.type)+"'.");n&&("value"===i.type.kind&&"value"!==a.type.kind?i=new ht(a.type,[i]):"value"!==i.type.kind&&"value"===a.type.kind&&(a=new ht(i.type,[a])));var s=null;if(4===e.length){if("string"!==i.type.kind&&"string"!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,He)))return null}return new o(i,a,s)},o.prototype.evaluate=function(o){var i=this.lhs.evaluate(o),a=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){var s=st(i),l=st(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new ut('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var c=st(i),u=st(a);if("string"!==c.kind||"string"!==u.kind)return t(o,i,a)}return this.collator?r(o,i,a,this.collator.evaluate(o)):t(o,i,a)},o.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},o.prototype.outputDefined=function(){return!0},o.prototype.serialize=function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t},o}()}fr.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,qe),n=t.parse(e[2],2,Ne);if(!r||!n)return null;if(!Xe(r.type,[Ze(qe),Be,qe]))return t.error("Expected first argument to be of type array or string, but found "+Ye(r.type)+" instead");if(4===e.length){var o=t.parse(e[3],3,Ne);return o?new fr(r.type,r,n,o):null}return new fr(r.type,r,n)},fr.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Je(t,["string","array"]))throw new ut("Expected first argument to be of type array or string, but found "+Ye(st(t))+" instead.");if(this.endIndex){var n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)},fr.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},fr.prototype.outputDefined=function(){return!1},fr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var vr=br("==",(function(e,t,r){return t===r}),gr),yr=br("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!gr(0,t,r,n)})),_r=br("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),wr=br(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),xr=br("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),kr=br(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0})),Cr=function(e,t,r,n,o){this.type=Be,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=o};Cr.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Ne);if(!r)return null;var n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");var o=null;if(n.locale&&!(o=t.parse(n.locale,1,Be)))return null;var i=null;if(n.currency&&!(i=t.parse(n.currency,1,Be)))return null;var a=null;if(n["min-fraction-digits"]&&!(a=t.parse(n["min-fraction-digits"],1,Ne)))return null;var s=null;return n["max-fraction-digits"]&&!(s=t.parse(n["max-fraction-digits"],1,Ne))?null:new Cr(r,o,i,a,s)},Cr.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Cr.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Cr.prototype.outputDefined=function(){return!1},Cr.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Er=function(e){this.type=Ne,this.input=e};Er.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+Ye(r.type)+" instead."):new Er(r):null},Er.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new ut("Expected value to be of type string or array, but found "+Ye(st(t))+" instead.")},Er.prototype.eachChild=function(e){e(this.input)},Er.prototype.outputDefined=function(){return!1},Er.prototype.serialize=function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e};var Sr={"==":vr,"!=":yr,">":wr,"<":_r,">=":kr,"<=":xr,array:ht,at:cr,boolean:ht,case:pr,coalesce:sr,collator:_t,format:pt,image:ft,in:ur,"index-of":dr,interpolate:ir,"interpolate-hcl":ir,"interpolate-lab":ir,length:Er,let:lr,literal:ct,match:hr,number:ht,"number-format":Cr,object:ht,slice:fr,step:qt,string:ht,"to-boolean":gt,"to-color":gt,"to-number":gt,"to-string":gt,var:Ft,within:Rt};function Tr(e,t){var r=t[0],n=t[1],o=t[2],i=t[3];r=r.evaluate(e),n=n.evaluate(e),o=o.evaluate(e);var a=i?i.evaluate(e):1,s=it(r,n,o,a);if(s)throw new ut(s);return new et(r/255*a,n/255*a,o/255*a,a)}function Ar(e,t){return e in t}function Pr(e,t){var r=t[e];return void 0===r?null:r}function Ir(e){return{type:e}}function Or(e){return{result:"success",value:e}}function Mr(e){return{result:"error",value:e}}function Dr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function zr(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function jr(e){return!!e.expression&&e.expression.interpolated}function Rr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Lr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Nr(e){return e}function Br(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Fr(e,t,r,n,o){return Br(typeof r===o?n[r]:void 0,e.default,t.default)}function Vr(e,t,r){if("number"!==Rr(r))return Br(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];var o=Ut(e.stops.map((function(e){return e[0]})),r);return e.stops[o][1]}function Ur(e,t,r){var n=void 0!==e.base?e.base:1;if("number"!==Rr(r))return Br(e.default,t.default);var o=e.stops.length;if(1===o)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[o-1][0])return e.stops[o-1][1];var i=Ut(e.stops.map((function(e){return e[0]})),r),a=function(e,t,r,n){var o=n-r,i=e-r;return 0===o?0:1===t?i/o:(Math.pow(t,i)-1)/(Math.pow(t,o)-1)}(r,n,e.stops[i][0],e.stops[i+1][0]),s=e.stops[i][1],l=e.stops[i+1][1],c=Wt[t.type]||Nr;if(e.colorSpace&&"rgb"!==e.colorSpace){var u=or[e.colorSpace];c=function(e,t){return u.reverse(u.interpolate(u.forward(e),u.forward(t),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=s.evaluate.apply(void 0,e),n=l.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==n)return c(r,n,a)}}:c(s,l,a)}function qr(e,t,r){return"color"===t.type?r=et.parse(r):"formatted"===t.type?r=nt.fromString(r.toString()):"resolvedImage"===t.type?r=ot.fromString(r.toString()):Rr(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Br(r,e.default,t.default)}yt.register(Sr,{error:[{kind:"error"},[Be],function(e,t){throw new ut(t[0].evaluate(e))}],typeof:[Be,[qe],function(e,t){return Ye(st(t[0].evaluate(e)))}],"to-rgba":[Ze(Ne,4),[Ve],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Ve,[Ne,Ne,Ne],Tr],rgba:[Ve,[Ne,Ne,Ne,Ne],Tr],has:{type:Fe,overloads:[[[Be],function(e,t){return Ar(t[0].evaluate(e),e.properties())}],[[Be,Ue],function(e,t){var r=t[1];return Ar(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:qe,overloads:[[[Be],function(e,t){return Pr(t[0].evaluate(e),e.properties())}],[[Be,Ue],function(e,t){var r=t[1];return Pr(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[qe,[Be],function(e,t){return Pr(t[0].evaluate(e),e.featureState||{})}],properties:[Ue,[],function(e){return e.properties()}],"geometry-type":[Be,[],function(e){return e.geometryType()}],id:[qe,[],function(e){return e.id()}],zoom:[Ne,[],function(e){return e.globals.zoom}],"heatmap-density":[Ne,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Ne,[],function(e){return e.globals.lineProgress||0}],accumulated:[qe,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Ne,Ir(Ne),function(e,t){for(var r=0,n=0,o=t;n<o.length;n+=1)r+=o[n].evaluate(e);return r}],"*":[Ne,Ir(Ne),function(e,t){for(var r=1,n=0,o=t;n<o.length;n+=1)r*=o[n].evaluate(e);return r}],"-":{type:Ne,overloads:[[[Ne,Ne],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Ne],function(e,t){return-t[0].evaluate(e)}]]},"/":[Ne,[Ne,Ne],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Ne,[Ne,Ne],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Ne,[],function(){return Math.LN2}],pi:[Ne,[],function(){return Math.PI}],e:[Ne,[],function(){return Math.E}],"^":[Ne,[Ne,Ne],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Ne,[Ne],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Ne,[Ne],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Ne,[Ne],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Ne,[Ne],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Ne,[Ne],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Ne,[Ne],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Ne,[Ne],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Ne,Ir(Ne),function(e,t){return Math.min.apply(Math,t.map((function(t){return t.evaluate(e)})))}],max:[Ne,Ir(Ne),function(e,t){return Math.max.apply(Math,t.map((function(t){return t.evaluate(e)})))}],abs:[Ne,[Ne],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Ne,[Ne],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ne,[Ne],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Ne,[Ne],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Fe,[Be,qe],function(e,t){var r=t[0],n=t[1];return e.properties()[r.value]===n.value}],"filter-id-==":[Fe,[qe],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Fe,[Be],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Fe,[Be,qe],function(e,t){var r=t[0],n=t[1],o=e.properties()[r.value],i=n.value;return typeof o==typeof i&&o<i}],"filter-id-<":[Fe,[qe],function(e,t){var r=t[0],n=e.id(),o=r.value;return typeof n==typeof o&&n<o}],"filter->":[Fe,[Be,qe],function(e,t){var r=t[0],n=t[1],o=e.properties()[r.value],i=n.value;return typeof o==typeof i&&o>i}],"filter-id->":[Fe,[qe],function(e,t){var r=t[0],n=e.id(),o=r.value;return typeof n==typeof o&&n>o}],"filter-<=":[Fe,[Be,qe],function(e,t){var r=t[0],n=t[1],o=e.properties()[r.value],i=n.value;return typeof o==typeof i&&o<=i}],"filter-id-<=":[Fe,[qe],function(e,t){var r=t[0],n=e.id(),o=r.value;return typeof n==typeof o&&n<=o}],"filter->=":[Fe,[Be,qe],function(e,t){var r=t[0],n=t[1],o=e.properties()[r.value],i=n.value;return typeof o==typeof i&&o>=i}],"filter-id->=":[Fe,[qe],function(e,t){var r=t[0],n=e.id(),o=r.value;return typeof n==typeof o&&n>=o}],"filter-has":[Fe,[qe],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Fe,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[Fe,[Ze(Be)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Fe,[Ze(qe)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Fe,[Be,Ze(qe)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[Fe,[Be,Ze(qe)],function(e,t){var r=t[0],n=t[1];return function(e,t,r,n){for(;r<=n;){var o=r+n>>1;if(t[o]===e)return!0;t[o]>e?n=o-1:r=o+1}return!1}(e.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Ir(Fe),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(!n[r].evaluate(e))return!1;return!0}]]},any:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Ir(Fe),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(n[r].evaluate(e))return!0;return!1}]]},"!":[Fe,[Fe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Fe,[Be],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Be,[Be],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Be,[Be],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Be,Ir(qe),function(e,t){return t.map((function(t){return lt(t.evaluate(e))})).join("")}],"resolved-locale":[Be,[He],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Hr=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new vt,this._defaultValue=t?function(e){return"color"===e.type&&Lr(e.default)?new et(0,0,0,0):"color"===e.type?et.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null};function Wr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Sr}function Gr(e,t){var r=new Vt(Sr,[],t?function(e){var t={color:Ve,string:Be,number:Ne,enum:Be,boolean:Fe,formatted:We,resolvedImage:Ge};return"array"===e.type?Ze(t[e.value]||qe,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Or(new Hr(n,t)):Mr(r.errors)}Hr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,o,i){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},Hr.prototype.evaluate=function(e,t,r,n,o,i){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ut("Expected value to be one of "+Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var Zr=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Nt(t.expression)};Zr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,o,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)},Zr.prototype.evaluate=function(e,t,r,n,o,i){return this._styleExpression.evaluate(e,t,r,n,o,i)};var Yr=function(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Nt(t.expression),this.interpolationType=n};function $r(e,t){if("error"===(e=Gr(e,t)).result)return e;var r=e.value.expression,n=Lt(r);if(!n&&!Dr(t))return Mr([new je("","data expressions not supported")]);var o=Bt(r,["zoom"]);if(!o&&!zr(t))return Mr([new je("","zoom expressions not supported")]);var i=function e(t){var r=null;if(t instanceof lr)r=e(t.result);else if(t instanceof sr)for(var n=0,o=t.args;n<o.length&&!(r=e(o[n]));n+=1);else(t instanceof qt||t instanceof ir)&&t.input instanceof yt&&"zoom"===t.input.name&&(r=t);return r instanceof je||t.eachChild((function(t){var n=e(t);n instanceof je?r=n:!r&&n?r=new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new je("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(r);return i||o?i instanceof je?Mr([i]):i instanceof ir&&!jr(t)?Mr([new je("",'"interpolate" expressions cannot be used with this property')]):Or(i?new Yr(n?"camera":"composite",e.value,i.labels,i instanceof ir?i.interpolation:void 0):new Zr(n?"constant":"source",e.value)):Mr([new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Yr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,o,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)},Yr.prototype.evaluate=function(e,t,r,n,o,i){return this._styleExpression.evaluate(e,t,r,n,o,i)},Yr.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?ir.interpolationFactor(this.interpolationType,e,t,r):0};var Kr=function(e,t){this._parameters=e,this._specification=t,Me(this,function e(t,r){var n,o,i,a="color"===r.type,s=t.stops&&"object"==typeof t.stops[0][0],l=s||!(s||void 0!==t.property),c=t.type||(jr(r)?"exponential":"interval");if(a&&((t=Me({},t)).stops&&(t.stops=t.stops.map((function(e){return[e[0],et.parse(e[1])]}))),t.default=et.parse(t.default?t.default:r.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!or[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===c)n=Ur;else if("interval"===c)n=Vr;else if("categorical"===c){n=Fr,o=Object.create(null);for(var u=0,d=t.stops;u<d.length;u+=1){var h=d[u];o[h[0]]=h[1]}i=typeof t.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');n=qr}if(s){for(var p={},f=[],m=0;m<t.stops.length;m++){var g=t.stops[m],b=g[0].zoom;void 0===p[b]&&(p[b]={zoom:b,type:t.type,property:t.property,default:t.default,stops:[]},f.push(b)),p[b].stops.push([g[0].value,g[1]])}for(var v=[],y=0,_=f;y<_.length;y+=1){var w=_[y];v.push([p[w].zoom,e(p[w],r)])}var x={name:"linear"};return{kind:"composite",interpolationType:x,interpolationFactor:ir.interpolationFactor.bind(void 0,x),zoomStops:v.map((function(e){return e[0]})),evaluate:function(e,n){var o=e.zoom;return Ur({stops:v,base:t.base},r,o).evaluate(o,n)}}}if(l){var k="exponential"===c?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:ir.interpolationFactor.bind(void 0,k),zoomStops:t.stops.map((function(e){return e[0]})),evaluate:function(e){return n(t,r,e.zoom,o,i)}}}return{kind:"source",evaluate:function(e,a){var s=a&&a.properties?a.properties[t.property]:void 0;return void 0===s?Br(t.default,r.default):n(t,r,s,o,i)}}}(this._parameters,this._specification))};function Xr(e){var t=e.key,r=e.value,n=e.valueSpec||{},o=e.objectElementValidators||{},i=e.style,a=e.styleSpec,s=[],l=Rr(r);if("object"!==l)return[new Ie(t,r,"object expected, "+l+" found")];for(var c in r){var u=c.split(".")[0],d=n[u]||n["*"],h=void 0;if(o[u])h=o[u];else if(n[u])h=kn;else if(o["*"])h=o["*"];else{if(!n["*"]){s.push(new Ie(t,r[c],'unknown property "'+c+'"'));continue}h=kn}s=s.concat(h({key:(t?t+".":t)+c,value:r[c],valueSpec:d,style:i,styleSpec:a,object:r,objectKey:c},r))}for(var p in n)o[p]||n[p].required&&void 0===n[p].default&&void 0===r[p]&&s.push(new Ie(t,r,'missing required property "'+p+'"'));return s}function Jr(e){var t=e.value,r=e.valueSpec,n=e.style,o=e.styleSpec,i=e.key,a=e.arrayElementValidator||kn;if("array"!==Rr(t))return[new Ie(i,t,"array expected, "+Rr(t)+" found")];if(r.length&&t.length!==r.length)return[new Ie(i,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Ie(i,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var s={type:r.value,values:r.values};o.$version<7&&(s.function=r.function),"object"===Rr(r.value)&&(s=r.value);for(var l=[],c=0;c<t.length;c++)l=l.concat(a({array:t,arrayIndex:c,value:t[c],valueSpec:s,style:n,styleSpec:o,key:i+"["+c+"]"}));return l}function Qr(e){var t=e.key,r=e.value,n=e.valueSpec,o=Rr(r);return"number"===o&&r!=r&&(o="NaN"),"number"!==o?[new Ie(t,r,"number expected, "+o+" found")]:"minimum"in n&&r<n.minimum?[new Ie(t,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new Ie(t,r,r+" is greater than the maximum value "+n.maximum)]:[]}function en(e){var t,r,n,o=e.valueSpec,i=De(e.value.type),a={},s="categorical"!==i&&void 0===e.value.property,l=!s,c="array"===Rr(e.value.stops)&&"array"===Rr(e.value.stops[0])&&"object"===Rr(e.value.stops[0][0]),u=Xr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new Ie(e.key,e.value,'identity function may not have a "stops" property')];var t=[],r=e.value;return t=t.concat(Jr({key:e.key,value:r,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:d})),"array"===Rr(r)&&0===r.length&&t.push(new Ie(e.key,r,"array must have at least one stop")),t},default:function(e){return kn({key:e.key,value:e.value,valueSpec:o,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===i&&s&&u.push(new Ie(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||u.push(new Ie(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!jr(e.valueSpec)&&u.push(new Ie(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!Dr(e.valueSpec)?u.push(new Ie(e.key,e.value,"property functions not supported")):s&&!zr(e.valueSpec)&&u.push(new Ie(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==e.value.property||u.push(new Ie(e.key,e.value,'"property" property is required')),u;function d(e){var t=[],i=e.value,s=e.key;if("array"!==Rr(i))return[new Ie(s,i,"array expected, "+Rr(i)+" found")];if(2!==i.length)return[new Ie(s,i,"array length 2 expected, length "+i.length+" found")];if(c){if("object"!==Rr(i[0]))return[new Ie(s,i,"object expected, "+Rr(i[0])+" found")];if(void 0===i[0].zoom)return[new Ie(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new Ie(s,i,"object stop key must have value")];if(n&&n>De(i[0].zoom))return[new Ie(s,i[0].zoom,"stop zoom values must appear in ascending order")];De(i[0].zoom)!==n&&(n=De(i[0].zoom),r=void 0,a={}),t=t.concat(Xr({key:s+"[0]",value:i[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Qr,value:h}}))}else t=t.concat(h({key:s+"[0]",value:i[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},i));return Wr(ze(i[1]))?t.concat([new Ie(s+"[1]",i[1],"expressions are not allowed in function stops.")]):t.concat(kn({key:s+"[1]",value:i[1],valueSpec:o,style:e.style,styleSpec:e.styleSpec}))}function h(e,n){var s=Rr(e.value),l=De(e.value),c=null!==e.value?e.value:n;if(t){if(s!==t)return[new Ie(e.key,c,s+" stop domain type must match previous stop domain type "+t)]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Ie(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==i){var u="number expected, "+s+" found";return Dr(o)&&void 0===i&&(u+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(e.key,c,u)]}return"categorical"!==i||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===s&&void 0!==r&&l<r?[new Ie(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in a?[new Ie(e.key,c,"stop domain values must be unique")]:(a[l]=!0,[])):[new Ie(e.key,c,"integer expected, found "+l)]}}function tn(e){var t=("property"===e.expressionContext?$r:Gr)(ze(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new Ie(""+e.key+t.key,e.value,t.message)}));var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Ie(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Nt(r))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Nt(r))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Bt(r,["zoom","feature-state"]))return[new Ie(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Lt(r))return[new Ie(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rn(e){var t=e.key,r=e.value,n=e.valueSpec,o=[];return Array.isArray(n.values)?-1===n.values.indexOf(De(r))&&o.push(new Ie(t,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(De(r))&&o.push(new Ie(t,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),o}function nn(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var n=r[t];if(!nn(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}Kr.deserialize=function(e){return new Kr(e._parameters,e._specification)},Kr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var on={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function an(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};nn(e)||(e=ln(e));var t=Gr(e,on);if("error"===t.result)throw new Error(t.value.map((function(e){return e.key+": "+e.message})).join(", "));return{filter:function(e,r,n){return t.value.evaluate(e,r,{},n)},needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)}}function sn(e,t){return e<t?-1:e>t?1:0}function ln(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?cn(e[1],e[2],"=="):"!="===r?hn(cn(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?cn(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(ln))):"all"===r?["all"].concat(e.slice(1).map(ln)):"none"===r?["all"].concat(e.slice(1).map(ln).map(hn)):"in"===r?un(e[1],e.slice(2)):"!in"===r?hn(un(e[1],e.slice(2))):"has"===r?dn(e[1]):"!has"===r?hn(dn(e[1])):"within"!==r||e}function cn(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function un(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(sn)]]:["filter-in-small",e,["literal",t]]}}function dn(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function hn(e){return["!",e]}function pn(e){return nn(ze(e.value))?tn(Me({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){var r=t.value,n=t.key;if("array"!==Rr(r))return[new Ie(n,r,"array expected, "+Rr(r)+" found")];var o,i=t.styleSpec,a=[];if(r.length<1)return[new Ie(n,r,"filter array must have at least 1 element")];switch(a=a.concat(rn({key:n+"[0]",value:r[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),De(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===De(r[1])&&a.push(new Ie(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new Ie(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(o=Rr(r[1]))&&a.push(new Ie(n+"[1]",r[1],"string expected, "+o+" found"));for(var s=2;s<r.length;s++)o=Rr(r[s]),"$type"===De(r[1])?a=a.concat(rn({key:n+"["+s+"]",value:r[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&a.push(new Ie(n+"["+s+"]",r[s],"string, number, or boolean expected, "+o+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(e({key:n+"["+l+"]",value:r[l],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":o=Rr(r[1]),2!==r.length?a.push(new Ie(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==o&&a.push(new Ie(n+"[1]",r[1],"string expected, "+o+" found"));break;case"within":o=Rr(r[1]),2!==r.length?a.push(new Ie(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"object"!==o&&a.push(new Ie(n+"[1]",r[1],"object expected, "+o+" found"))}return a}(e)}function fn(e,t){var r=e.key,n=e.style,o=e.styleSpec,i=e.value,a=e.objectKey,s=o[t+"_"+e.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return kn({key:r,value:i,valueSpec:o.transition,style:n,styleSpec:o});var c,u=e.valueSpec||s[a];if(!u)return[new Ie(r,i,'unknown property "'+a+'"')];if("string"===Rr(i)&&Dr(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(i)))return[new Ie(r,i,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var d=[];return"symbol"===e.layerType&&("text-field"===a&&n&&!n.glyphs&&d.push(new Ie(r,i,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Lr(ze(i))&&"identity"===De(i.type)&&d.push(new Ie(r,i,'"text-font" does not support identity functions'))),d.concat(kn({key:e.key,value:i,valueSpec:u,style:n,styleSpec:o,expressionContext:"property",propertyType:t,propertyKey:a}))}function mn(e){return fn(e,"paint")}function gn(e){return fn(e,"layout")}function bn(e){var t=[],r=e.value,n=e.key,o=e.style,i=e.styleSpec;r.type||r.ref||t.push(new Ie(n,r,'either "type" or "ref" is required'));var a,s=De(r.type),l=De(r.ref);if(r.id)for(var c=De(r.id),u=0;u<e.arrayIndex;u++){var d=o.layers[u];De(d.id)===c&&t.push(new Ie(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+d.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach((function(e){e in r&&t.push(new Ie(n,r[e],'"'+e+'" is prohibited for ref layers'))})),o.layers.forEach((function(e){De(e.id)===l&&(a=e)})),a?a.ref?t.push(new Ie(n,r.ref,"ref cannot reference another ref layer")):s=De(a.type):t.push(new Ie(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=o.sources&&o.sources[r.source],p=h&&De(h.type);h?"vector"===p&&"raster"===s?t.push(new Ie(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===p&&"raster"!==s?t.push(new Ie(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==p||r["source-layer"]?"raster-dem"===p&&"hillshade"!==s?t.push(new Ie(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||t.push(new Ie(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ie(n,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Ie(n,r.source,'source "'+r.source+'" not found'))}else t.push(new Ie(n,r,'missing required property "source"'));return t=t.concat(Xr({key:n,value:r,valueSpec:i.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:n+".type",value:r.type,valueSpec:i.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:pn,layout:function(e){return Xr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return gn(Me({layerType:s},e))}}})},paint:function(e){return Xr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return mn(Me({layerType:s},e))}}})}}}))}function vn(e){var t=e.value,r=e.key,n=Rr(t);return"string"!==n?[new Ie(r,t,"string expected, "+n+" found")]:[]}var yn={promoteId:function(e){var t=e.key,r=e.value;if("string"===Rr(r))return vn({key:t,value:r});var n=[];for(var o in r)n.push.apply(n,vn({key:t+"."+o,value:r[o]}));return n}};function _n(e){var t=e.value,r=e.key,n=e.styleSpec,o=e.style;if(!t.type)return[new Ie(r,t,'"type" is required')];var i,a=De(t.type);switch(a){case"vector":case"raster":case"raster-dem":return Xr({key:r,value:t,valueSpec:n["source_"+a.replace("-","_")],style:e.style,styleSpec:n,objectElementValidators:yn});case"geojson":if(i=Xr({key:r,value:t,valueSpec:n.source_geojson,style:o,styleSpec:n,objectElementValidators:yn}),t.cluster)for(var s in t.clusterProperties){var l=t.clusterProperties[s],c=l[0],u="string"==typeof c?[c,["accumulated"],["get",s]]:c;i.push.apply(i,tn({key:r+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),i.push.apply(i,tn({key:r+"."+s+".reduce",value:u,expressionContext:"cluster-reduce"}))}return i;case"video":return Xr({key:r,value:t,valueSpec:n.source_video,style:o,styleSpec:n});case"image":return Xr({key:r,value:t,valueSpec:n.source_image,style:o,styleSpec:n});case"canvas":return[new Ie(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rn({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:o,styleSpec:n})}}function wn(e){var t=e.value,r=e.styleSpec,n=r.light,o=e.style,i=[],a=Rr(t);if(void 0===t)return i;if("object"!==a)return i.concat([new Ie("light",t,"object expected, "+a+" found")]);for(var s in t){var l=s.match(/^(.*)-transition$/);i=i.concat(l&&n[l[1]]&&n[l[1]].transition?kn({key:s,value:t[s],valueSpec:r.transition,style:o,styleSpec:r}):n[s]?kn({key:s,value:t[s],valueSpec:n[s],style:o,styleSpec:r}):[new Ie(s,t[s],'unknown property "'+s+'"')])}return i}var xn={"*":function(){return[]},array:Jr,boolean:function(e){var t=e.value,r=e.key,n=Rr(t);return"boolean"!==n?[new Ie(r,t,"boolean expected, "+n+" found")]:[]},number:Qr,color:function(e){var t=e.key,r=e.value,n=Rr(r);return"string"!==n?[new Ie(t,r,"color expected, "+n+" found")]:null===Qe(r)?[new Ie(t,r,'color expected, "'+r+'" found')]:[]},constants:Oe,enum:rn,filter:pn,function:en,layer:bn,object:Xr,source:_n,light:wn,string:vn,formatted:function(e){return 0===vn(e).length?[]:tn(e)},resolvedImage:function(e){return 0===vn(e).length?[]:tn(e)}};function kn(e){var t=e.value,r=e.valueSpec,n=e.styleSpec;return r.expression&&Lr(De(t))?en(e):r.expression&&Wr(ze(t))?tn(e):r.type&&xn[r.type]?xn[r.type](e):Xr(Me({},e,{valueSpec:r.type?n[r.type]:r}))}function Cn(e){var t=e.value,r=e.key,n=vn(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Ie(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Ie(r,t,'"glyphs" url must include a "{range}" token'))),n}function En(e,t){void 0===t&&(t=Pe);var r=[];return r=r.concat(kn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Cn,"*":function(){return[]}}})),e.constants&&(r=r.concat(Oe({key:"constants",value:e.constants,style:e,styleSpec:t}))),Sn(r)}function Sn(e){return[].concat(e).sort((function(e,t){return e.line-t.line}))}function Tn(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Sn(e.apply(this,t))}}En.source=Tn(_n),En.light=Tn(wn),En.layer=Tn(bn),En.filter=Tn(pn),En.paintProperty=Tn(mn),En.layoutProperty=Tn(gn);var An=En,Pn=An.light,In=An.paintProperty,On=An.layoutProperty;function Mn(e,t){var r=!1;if(t&&t.length)for(var n=0,o=t;n<o.length;n+=1)e.fire(new Te(new Error(o[n].message))),r=!0;return r}var Dn=zn;function zn(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var o=new Int32Array(this.arrayBuffer);e=o[0],this.d=(t=o[1])+2*(r=o[2]);for(var i=0;i<this.d*this.d;i++){var a=o[3+i],s=o[3+i+1];n.push(a===s?null:o.subarray(a,s))}var l=o[3+n.length+1];this.keys=o.subarray(o[3+n.length],l),this.bboxes=o.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var u=r/t*e;this.min=-u,this.max=e+u}zn.prototype.insert=function(e,t,r,n,o){this._forEachCell(t,r,n,o,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(o)},zn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zn.prototype._insertCell=function(e,t,r,n,o,i){this.cells[o].push(i)},zn.prototype.query=function(e,t,r,n,o){var i=this.min,a=this.max;if(e<=i&&t<=i&&a<=r&&a<=n&&!o)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,n,this._queryCell,s,{},o),s},zn.prototype._queryCell=function(e,t,r,n,o,i,a,s){var l=this.cells[o];if(null!==l)for(var c=this.keys,u=this.bboxes,d=0;d<l.length;d++){var h=l[d];if(void 0===a[h]){var p=4*h;(s?s(u[p+0],u[p+1],u[p+2],u[p+3]):e<=u[p+2]&&t<=u[p+3]&&r>=u[p+0]&&n>=u[p+1])?(a[h]=!0,i.push(c[h])):a[h]=!1}}},zn.prototype._forEachCell=function(e,t,r,n,o,i,a,s){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(r),d=this._convertToCellCoord(n),h=l;h<=u;h++)for(var p=c;p<=d;p++){var f=this.d*p+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(p),this._convertFromCellCoord(h+1),this._convertFromCellCoord(p+1)))&&o.call(this,e,t,r,n,f,i,a,s))return}},zn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},zn.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},zn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var o=new Int32Array(t+r+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var i=t,a=0;a<e.length;a++){var s=e[a];o[3+a]=i,o.set(s,i),i+=s.length}return o[3+e.length]=i,o.set(this.keys,i),o[3+e.length+1]=i+=this.keys.length,o.set(this.bboxes,i),i+=this.bboxes.length,o.buffer};var jn=a.ImageData,Rn=a.ImageBitmap,Ln={};function Nn(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ln[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Bn in Nn("Object",Object),Dn.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Dn.deserialize=function(e){return new Dn(e.buffer)},Nn("Grid",Dn),Nn("Color",et),Nn("Error",Error),Nn("ResolvedImage",ot),Nn("StylePropertyFunction",Kr),Nn("StyleExpression",Hr,{omit:["_evaluator"]}),Nn("ZoomDependentExpression",Yr),Nn("ZoomConstantExpression",Zr),Nn("CompoundExpression",yt,{omit:["_evaluate"]}),Sr)Sr[Bn]._classRegistryKey||Nn("Expression_"+Bn,Sr[Bn]);function Fn(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Vn(e){return Rn&&e instanceof Rn}function Un(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Fn(e)||Vn(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof jn)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var n=[],o=0,i=e;o<i.length;o+=1)n.push(Un(i[o],t));return n}if("object"==typeof e){var a=e.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=a.serialize?a.serialize(e,t):{};if(!a.serialize){for(var c in e)if(e.hasOwnProperty(c)&&!(Ln[s].omit.indexOf(c)>=0)){var u=e[c];l[c]=Ln[s].shallow.indexOf(c)>=0?u:Un(u,t)}e instanceof Error&&(l.message=e.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}throw new Error("can't serialize object of type "+typeof e)}function qn(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Fn(e)||Vn(e)||ArrayBuffer.isView(e)||e instanceof jn)return e;if(Array.isArray(e))return e.map(qn);if("object"==typeof e){var t=e.$name||"Object",r=Ln[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var n=Object.create(r.prototype),o=0,i=Object.keys(e);o<i.length;o+=1){var a=i[o];if("$name"!==a){var s=e[a];n[a]=Ln[t].shallow.indexOf(a)>=0?s:qn(s)}}return n}throw new Error("can't deserialize object of type "+typeof e)}var Hn=function(){this.first=!0};Hn.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Wn={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Gn(e){for(var t=0,r=e;t<r.length;t+=1)if(Zn(r[t].charCodeAt(0)))return!0;return!1}function Zn(e){return!(746!==e&&747!==e&&(e<4352||!(Wn["Bopomofo Extended"](e)||Wn.Bopomofo(e)||Wn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Wn["CJK Compatibility Ideographs"](e)||Wn["CJK Compatibility"](e)||Wn["CJK Radicals Supplement"](e)||Wn["CJK Strokes"](e)||!(!Wn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Wn["CJK Unified Ideographs Extension A"](e)||Wn["CJK Unified Ideographs"](e)||Wn["Enclosed CJK Letters and Months"](e)||Wn["Hangul Compatibility Jamo"](e)||Wn["Hangul Jamo Extended-A"](e)||Wn["Hangul Jamo Extended-B"](e)||Wn["Hangul Jamo"](e)||Wn["Hangul Syllables"](e)||Wn.Hiragana(e)||Wn["Ideographic Description Characters"](e)||Wn.Kanbun(e)||Wn["Kangxi Radicals"](e)||Wn["Katakana Phonetic Extensions"](e)||Wn.Katakana(e)&&12540!==e||!(!Wn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Wn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Wn["Unified Canadian Aboriginal Syllabics"](e)||Wn["Unified Canadian Aboriginal Syllabics Extended"](e)||Wn["Vertical Forms"](e)||Wn["Yijing Hexagram Symbols"](e)||Wn["Yi Syllables"](e)||Wn["Yi Radicals"](e))))}function Yn(e){return!(Zn(e)||function(e){return!!(Wn["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Wn["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Wn["Letterlike Symbols"](e)||Wn["Number Forms"](e)||Wn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Wn["Control Pictures"](e)&&9251!==e||Wn["Optical Character Recognition"](e)||Wn["Enclosed Alphanumerics"](e)||Wn["Geometric Shapes"](e)||Wn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Wn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Wn["CJK Symbols and Punctuation"](e)||Wn.Katakana(e)||Wn["Private Use Area"](e)||Wn["CJK Compatibility Forms"](e)||Wn["Small Form Variants"](e)||Wn["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function $n(e){return e>=1424&&e<=2303||Wn["Arabic Presentation Forms-A"](e)||Wn["Arabic Presentation Forms-B"](e)}function Kn(e,t){return!(!t&&$n(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Wn.Khmer(e))}function Xn(e){for(var t=0,r=e;t<r.length;t+=1)if($n(r[t].charCodeAt(0)))return!0;return!1}var Jn=null,Qn="unavailable",eo=null,to=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Qn="error"),Jn&&Jn(e)};function ro(){no.fire(new Se("pluginStateChange",{pluginStatus:Qn,pluginURL:eo}))}var no=new Ae,oo=function(){return Qn},io=function(){if("deferred"!==Qn||!eo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qn="loading",ro(),eo&&_e({url:eo},(function(e){e?to(e):(Qn="loaded",ro())}))},ao={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Qn||null!=ao.applyArabicShaping},isLoading:function(){return"loading"===Qn},setState:function(e){Qn=e.pluginStatus,eo=e.pluginURL},isParsed:function(){return null!=ao.applyArabicShaping&&null!=ao.processBidirectionalText&&null!=ao.processStyledBidirectionalText},getPluginURL:function(){return eo}},so=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hn,this.transition={})};so.prototype.isSupportedScript=function(e){return function(e,t){for(var r=0,n=e;r<n.length;r+=1)if(!Kn(n[r].charCodeAt(0),t))return!1;return!0}(e,ao.isLoaded())},so.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},so.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var lo=function(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Lr(e))return new Kr(e,t);if(Wr(e)){var r=$r(e,t);if("error"===r.result)throw new Error(r.value.map((function(e){return e.key+": "+e.message})).join(", "));return r.value}var n=e;return"string"==typeof e&&"color"===t.type&&(n=et.parse(e)),{kind:"constant",evaluate:function(){return n}}}(void 0===t?e.specification.default:t,e.specification)};lo.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},lo.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var co=function(e){this.property=e,this.value=new lo(e,void 0)};co.prototype.transitioned=function(e,t){return new ho(this.property,this.value,t,h({},e.transition,this.transition),e.now)},co.prototype.untransitioned=function(){return new ho(this.property,this.value,null,{},0)};var uo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};uo.prototype.getValue=function(e){return w(this._values[e].value.value)},uo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new co(this._values[e].property)),this._values[e].value=new lo(this._values[e].property,null===t?void 0:w(t))},uo.prototype.getTransition=function(e){return w(this._values[e].transition)},uo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new co(this._values[e].property)),this._values[e].transition=w(t)||void 0},uo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],o=this.getValue(n);void 0!==o&&(e[n]=o);var i=this.getTransition(n);void 0!==i&&(e[n+"-transition"]=i)}return e},uo.prototype.transitioned=function(e,t){for(var r=new po(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var i=o[n];r._values[i]=this._values[i].transitioned(e,t._values[i])}return r},uo.prototype.untransitioned=function(){for(var e=new po(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t];e._values[n]=this._values[n].untransitioned()}return e};var ho=function(e,t,r,n,o){this.property=e,this.value=t,this.begin=o+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};ho.prototype.possiblyEvaluate=function(e,t,r){var n=e.now||0,o=this.value.possiblyEvaluate(e,t,r),i=this.prior;if(i){if(n>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(n<this.begin)return i.possiblyEvaluate(e,t,r);var a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(e,t,r),o,function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(a))}return o};var po=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};po.prototype.possiblyEvaluate=function(e,t,r){for(var n=new go(this._properties),o=0,i=Object.keys(this._values);o<i.length;o+=1){var a=i[o];n._values[a]=this._values[a].possiblyEvaluate(e,t,r)}return n},po.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var fo=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};fo.prototype.getValue=function(e){return w(this._values[e].value)},fo.prototype.setValue=function(e,t){this._values[e]=new lo(this._values[e].property,null===t?void 0:w(t))},fo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],o=this.getValue(n);void 0!==o&&(e[n]=o)}return e},fo.prototype.possiblyEvaluate=function(e,t,r){for(var n=new go(this._properties),o=0,i=Object.keys(this._values);o<i.length;o+=1){var a=i[o];n._values[a]=this._values[a].possiblyEvaluate(e,t,r)}return n};var mo=function(e,t,r){this.property=e,this.value=t,this.parameters=r};mo.prototype.isConstant=function(){return"constant"===this.value.kind},mo.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},mo.prototype.evaluate=function(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)};var go=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};go.prototype.get=function(e){return this._values[e]};var bo=function(e){this.specification=e};bo.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},bo.prototype.interpolate=function(e,t,r){var n=Wt[this.specification.type];return n?n(e,t,r):e};var vo=function(e,t){this.specification=e,this.overrides=t};vo.prototype.possiblyEvaluate=function(e,t,r,n){return new mo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)},vo.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new mo(this,{kind:"constant",value:void 0},e.parameters);var n=Wt[this.specification.type];return n?new mo(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e},vo.prototype.evaluate=function(e,t,r,n,o,i){return"constant"===e.kind?e.value:e.evaluate(t,r,n,o,i)};var yo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(e,t,r,n){if(void 0===e.value)return new mo(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var o=e.expression.evaluate(t,null,{},r,n),i="resolvedImage"===e.property.specification.type&&"string"!=typeof o?o.name:o,a=this._calculate(i,i,i,t);return new mo(this,{kind:"constant",value:a},t)}if("camera"===e.expression.kind){var s=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new mo(this,{kind:"constant",value:s},t)}return new mo(this,e.expression,t)},t.prototype.evaluate=function(e,t,r,n,o,i){if("source"===e.kind){var a=e.evaluate(t,r,n,o,i);return this._calculate(a,a,a,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value},t.prototype._calculate=function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},t.prototype.interpolate=function(e){return e},t}(vo),_o=function(e){this.specification=e};_o.prototype.possiblyEvaluate=function(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){var o=e.expression.evaluate(t,null,{},r,n);return this._calculate(o,o,o,t)}return this._calculate(e.expression.evaluate(new so(Math.floor(t.zoom-1),t)),e.expression.evaluate(new so(Math.floor(t.zoom),t)),e.expression.evaluate(new so(Math.floor(t.zoom+1),t)),t)}},_o.prototype._calculate=function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},_o.prototype.interpolate=function(e){return e};var wo=function(e){this.specification=e};wo.prototype.possiblyEvaluate=function(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)},wo.prototype.interpolate=function(){return!1};var xo=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var n=this.defaultPropertyValues[t]=new lo(r,void 0),o=this.defaultTransitionablePropertyValues[t]=new co(r);this.defaultTransitioningPropertyValues[t]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}};Nn("DataDrivenProperty",vo),Nn("DataConstantProperty",bo),Nn("CrossFadedDataDrivenProperty",yo),Nn("CrossFadedProperty",_o),Nn("ColorRampProperty",wo);var ko=function(e){function t(t,r){if(e.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new fo(r.layout)),r.paint)){for(var n in this._transitionablePaint=new uo(r.paint),t.paint)this.setPaintProperty(n,t.paint[n],{validate:!1});for(var o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new go(r.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(e,t,r){void 0===r&&(r={}),null!=t&&this._validate(On,"layers."+this.id+".layout."+e,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)},t.prototype.getPaintProperty=function(e){return v(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-"-transition".length)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(e,t,r){if(void 0===r&&(r={}),null!=t&&this._validate(In,"layers."+this.id+".paint."+e,e,t,r))return!1;if(v(e,"-transition"))return this._transitionablePaint.setTransition(e.slice(0,-"-transition".length),t||void 0),!1;var n=this._transitionablePaint._values[e],o="cross-faded-data-driven"===n.property.specification["property-type"],i=n.value.isDataDriven(),a=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||i||o||this._handleOverridablePaintPropertyUpdate(e,a,s)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){},t.prototype._handleOverridablePaintPropertyUpdate=function(e,t,r){return!1},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),_(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))},t.prototype._validate=function(e,t,r,n,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&Mn(this,e.call(An,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof mo&&Dr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},t}(Ae),Co={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Eo=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},So=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function To(e,t){void 0===t&&(t=1);var r=0,n=0;return{members:e.map((function(e){var o=Co[e.type].BYTES_PER_ELEMENT,i=r=Ao(r,Math.max(t,o)),a=e.components||1;return n=Math.max(n,o),r+=o*a,{name:e.name,type:e.type,components:a,offset:i}})),size:Ao(r,Math.max(n,t)),alignment:t}}function Ao(e,t){return Math.ceil(e/t)*t}So.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},So.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},So.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},So.prototype.clear=function(){this.length=0},So.prototype.resize=function(e){this.reserve(e),this.length=e},So.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},So.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Po=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e},t}(So);Po.prototype.bytesPerElement=4,Nn("StructArrayLayout2i4",Po);var Io=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,o){var i=4*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,this.int16[i+3]=o,e},t}(So);Io.prototype.bytesPerElement=8,Nn("StructArrayLayout4i8",Io);var Oo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,o,i)},t.prototype.emplace=function(e,t,r,n,o,i,a){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=o,this.int16[s+4]=i,this.int16[s+5]=a,e},t}(So);Oo.prototype.bytesPerElement=12,Nn("StructArrayLayout2i4i12",Oo);var Mo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,o,i)},t.prototype.emplace=function(e,t,r,n,o,i,a){var s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=o,this.uint8[l+6]=i,this.uint8[l+7]=a,e},t}(So);Mo.prototype.bytesPerElement=8,Nn("StructArrayLayout2i4ub8",Mo);var Do=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e},t}(So);Do.prototype.bytesPerElement=8,Nn("StructArrayLayout2f8",Do);var zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i,a,s,l,c){var u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,o,i,a,s,l,c)},t.prototype.emplace=function(e,t,r,n,o,i,a,s,l,c,u){var d=10*e;return this.uint16[d+0]=t,this.uint16[d+1]=r,this.uint16[d+2]=n,this.uint16[d+3]=o,this.uint16[d+4]=i,this.uint16[d+5]=a,this.uint16[d+6]=s,this.uint16[d+7]=l,this.uint16[d+8]=c,this.uint16[d+9]=u,e},t}(So);zo.prototype.bytesPerElement=20,Nn("StructArrayLayout10ui20",zo);var jo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i,a,s,l,c,u,d){var h=this.length;return this.resize(h+1),this.emplace(h,e,t,r,n,o,i,a,s,l,c,u,d)},t.prototype.emplace=function(e,t,r,n,o,i,a,s,l,c,u,d,h){var p=12*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=o,this.uint16[p+4]=i,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=d,this.int16[p+11]=h,e},t}(So);jo.prototype.bytesPerElement=24,Nn("StructArrayLayout4i4ui4i24",jo);var Ro=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var o=3*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,e},t}(So);Ro.prototype.bytesPerElement=12,Nn("StructArrayLayout3f12",Ro);var Lo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint32[1*e+0]=t,e},t}(So);Lo.prototype.bytesPerElement=4,Nn("StructArrayLayout1ul4",Lo);var No=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i,a,s,l){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,o,i,a,s,l)},t.prototype.emplace=function(e,t,r,n,o,i,a,s,l,c){var u=10*e,d=5*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=o,this.int16[u+4]=i,this.int16[u+5]=a,this.uint32[d+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,e},t}(So);No.prototype.bytesPerElement=20,Nn("StructArrayLayout6i1ul2ui20",No);var Bo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,o,i)},t.prototype.emplace=function(e,t,r,n,o,i,a){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=o,this.int16[s+4]=i,this.int16[s+5]=a,e},t}(So);Bo.prototype.bytesPerElement=12,Nn("StructArrayLayout2i2i2i12",Bo);var Fo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n,o)},t.prototype.emplace=function(e,t,r,n,o,i){var a=4*e,s=8*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.int16[s+6]=o,this.int16[s+7]=i,e},t}(So);Fo.prototype.bytesPerElement=16,Nn("StructArrayLayout2f1f2i16",Fo);var Vo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,o){var i=12*e,a=3*e;return this.uint8[i+0]=t,this.uint8[i+1]=r,this.float32[a+1]=n,this.float32[a+2]=o,e},t}(So);Vo.prototype.bytesPerElement=12,Nn("StructArrayLayout2ub2f12",Vo);var Uo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var o=3*e;return this.uint16[o+0]=t,this.uint16[o+1]=r,this.uint16[o+2]=n,e},t}(So);Uo.prototype.bytesPerElement=6,Nn("StructArrayLayout3ui6",Uo);var qo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g){var b=this.length;return this.resize(b+1),this.emplace(b,e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g)},t.prototype.emplace=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b){var v=24*e,y=12*e,_=48*e;return this.int16[v+0]=t,this.int16[v+1]=r,this.uint16[v+2]=n,this.uint16[v+3]=o,this.uint32[y+2]=i,this.uint32[y+3]=a,this.uint32[y+4]=s,this.uint16[v+10]=l,this.uint16[v+11]=c,this.uint16[v+12]=u,this.float32[y+7]=d,this.float32[y+8]=h,this.uint8[_+36]=p,this.uint8[_+37]=f,this.uint8[_+38]=m,this.uint32[y+10]=g,this.int16[v+22]=b,e},t}(So);qo.prototype.bytesPerElement=48,Nn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qo);var Ho=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b,v,y,_,w,x,k,C,E,S,T){var A=this.length;return this.resize(A+1),this.emplace(A,e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b,v,y,_,w,x,k,C,E,S,T)},t.prototype.emplace=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b,v,y,_,w,x,k,C,E,S,T,A){var P=34*e,I=17*e;return this.int16[P+0]=t,this.int16[P+1]=r,this.int16[P+2]=n,this.int16[P+3]=o,this.int16[P+4]=i,this.int16[P+5]=a,this.int16[P+6]=s,this.int16[P+7]=l,this.uint16[P+8]=c,this.uint16[P+9]=u,this.uint16[P+10]=d,this.uint16[P+11]=h,this.uint16[P+12]=p,this.uint16[P+13]=f,this.uint16[P+14]=m,this.uint16[P+15]=g,this.uint16[P+16]=b,this.uint16[P+17]=v,this.uint16[P+18]=y,this.uint16[P+19]=_,this.uint16[P+20]=w,this.uint16[P+21]=x,this.uint16[P+22]=k,this.uint32[I+12]=C,this.float32[I+13]=E,this.float32[I+14]=S,this.float32[I+15]=T,this.float32[I+16]=A,e},t}(So);Ho.prototype.bytesPerElement=68,Nn("StructArrayLayout8i15ui1ul4f68",Ho);var Wo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.float32[1*e+0]=t,e},t}(So);Wo.prototype.bytesPerElement=4,Nn("StructArrayLayout1f4",Wo);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var o=3*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,e},t}(So);Go.prototype.bytesPerElement=6,Nn("StructArrayLayout3i6",Go);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var o=4*e;return this.uint32[2*e+0]=t,this.uint16[o+2]=r,this.uint16[o+3]=n,e},t}(So);Zo.prototype.bytesPerElement=8,Nn("StructArrayLayout1ul2ui8",Zo);var Yo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e},t}(So);Yo.prototype.bytesPerElement=4,Nn("StructArrayLayout2ui4",Yo);var $o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint16[1*e+0]=t,e},t}(So);$o.prototype.bytesPerElement=2,Nn("StructArrayLayout1ui2",$o);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,o){var i=4*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,this.float32[i+3]=o,e},t}(So);Ko.prototype.bytesPerElement=16,Nn("StructArrayLayout4f16",Ko);var Xo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new o(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Eo);Xo.prototype.size=20;var Jo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new Xo(this,e)},t}(No);Nn("CollisionBoxArray",Jo);var Qo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Eo);Qo.prototype.size=48;var ei=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new Qo(this,e)},t}(qo);Nn("PlacedSymbolArray",ei);var ti=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+12]=e},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Eo);ti.prototype.size=68;var ri=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new ti(this,e)},t}(Ho);Nn("SymbolInstanceArray",ri);var ni=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t}(Wo);Nn("GlyphOffsetArray",ni);var oi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t}(Go);Nn("SymbolLineVertexArray",oi);var ii=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Eo);ii.prototype.size=8;var ai=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new ii(this,e)},t}(Zo);Nn("FeatureIndexArray",ai);var si=To([{name:"a_pos",components:2,type:"Int16"}],4).members,li=function(e){void 0===e&&(e=[]),this.segments=e};function ci(e,t){return 256*(e=u(Math.floor(e),0,255))+u(Math.floor(t),0,255)}li.prototype.prepareSegment=function(e,t,r,n){var o=this.segments[this.segments.length-1];return e>li.MAX_VERTEX_ARRAY_LENGTH&&k("Max vertices per segment is "+li.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!o||o.vertexLength+e>li.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==n)&&(o={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(o.sortKey=n),this.segments.push(o)),o},li.prototype.get=function(){return this.segments},li.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var n in r.vaos)r.vaos[n].destroy()}},li.simpleSegment=function(e,t,r,n){return new li([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])},li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn("SegmentVector",li);var ui=To([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),di=t((function(e){e.exports=function(e,t){var r,n,o,i,a,s,l,c;for(n=e.length-(r=3&e.length),o=t,a=3432918353,s=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,o=27492+(65535&(i=5*(65535&(o=(o^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:o^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0}})),hi=t((function(e){e.exports=function(e,t){for(var r,n=e.length,o=t^n,i=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(r>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++i;switch(n){case 3:o^=(255&e.charCodeAt(i+2))<<16;case 2:o^=(255&e.charCodeAt(i+1))<<8;case 1:o=1540483477*(65535&(o^=255&e.charCodeAt(i)))+((1540483477*(o>>>16)&65535)<<16)}return o=1540483477*(65535&(o^=o>>>13))+((1540483477*(o>>>16)&65535)<<16),(o^=o>>>15)>>>0}})),pi=di,fi=hi;pi.murmur3=di,pi.murmur2=fi;var mi=function(){this.ids=[],this.positions=[],this.indexed=!1};mi.prototype.add=function(e,t,r,n){this.ids.push(bi(e)),this.positions.push(t,r,n)},mi.prototype.getPositions=function(e){for(var t=bi(e),r=0,n=this.ids.length-1;r<n;){var o=r+n>>1;this.ids[o]>=t?n=o:r=o+1}for(var i=[];this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i},mi.serialize=function(e,t){var r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return function e(t,r,n,o){for(;n<o;){for(var i=t[n+o>>1],a=n-1,s=o+1;;){do{a++}while(t[a]<i);do{s--}while(t[s]>i);if(a>=s)break;vi(t,a,s),vi(r,3*a,3*s),vi(r,3*a+1,3*s+1),vi(r,3*a+2,3*s+2)}s-n<o-s?(e(t,r,n,s),n=s+1):(e(t,r,s+1,o),o=s)}}(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}},mi.deserialize=function(e){var t=new mi;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var gi=Math.pow(2,53)-1;function bi(e){var t=+e;return!isNaN(t)&&t<=gi?t:pi(String(e))}function vi(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}Nn("FeaturePositionMap",mi);var yi=function(e,t){this.gl=e.gl,this.location=t},_i=function(e){function t(t,r){e.call(this,t,r),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},t}(yi),wi=function(e){function t(t,r){e.call(this,t,r),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},t}(yi),xi=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},t}(yi),ki=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},t}(yi),Ci=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},t}(yi),Ei=function(e){function t(t,r){e.call(this,t,r),this.current=et.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},t}(yi),Si=new Float32Array(16),Ti=function(e){function t(t,r){e.call(this,t,r),this.current=Si}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}},t}(yi);function Ai(e){return[ci(255*e.r,255*e.g),ci(255*e.b,255*e.a)]}var Pi=function(e,t,r){this.value=e,this.uniformNames=t.map((function(e){return"u_"+e})),this.type=r};Pi.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Pi.prototype.getBinding=function(e,t,r){return"color"===this.type?new Ei(e,t):new wi(e,t)};var Ii=function(e,t){this.uniformNames=t.map((function(e){return"u_"+e})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ii.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Ii.prototype.setUniform=function(e,t,r,n){var o="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;o&&e.set(o)},Ii.prototype.getBinding=function(e,t,r){return"u_pattern"===r.substr(0,9)?new Ci(e,t):new wi(e,t)};var Oi=function(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}})),this.paintVertexArray=new n};Oi.prototype.populatePaintArray=function(e,t,r,n,o){var i=this.paintVertexArray.length,a=this.expression.evaluate(new so(0),t,{},n,[],o);this.paintVertexArray.resize(e),this._setPaintValue(i,e,a)},Oi.prototype.updatePaintArray=function(e,t,r,n){var o=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,o)},Oi.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var n=Ai(r),o=e;o<t;o++)this.paintVertexArray.emplace(o,n[0],n[1]);else{for(var i=e;i<t;i++)this.paintVertexArray.emplace(i,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Oi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Oi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Mi=function(e,t,r,n,o,i){this.expression=e,this.uniformNames=t.map((function(e){return"u_"+e+"_t"})),this.type=r,this.useIntegerZoom=n,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}})),this.paintVertexArray=new i};Mi.prototype.populatePaintArray=function(e,t,r,n,o){var i=this.expression.evaluate(new so(this.zoom),t,{},n,[],o),a=this.expression.evaluate(new so(this.zoom+1),t,{},n,[],o),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,i,a)},Mi.prototype.updatePaintArray=function(e,t,r,n){var o=this.expression.evaluate({zoom:this.zoom},r,n),i=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,o,i)},Mi.prototype._setPaintValue=function(e,t,r,n){if("color"===this.type)for(var o=Ai(r),i=Ai(n),a=e;a<t;a++)this.paintVertexArray.emplace(a,o[0],o[1],i[0],i[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}},Mi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Mi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Mi.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=u(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)},Mi.prototype.getBinding=function(e,t,r){return new wi(e,t)};var Di=function(e,t,r,n,o,i){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=i,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};Di.prototype.populatePaintArray=function(e,t,r){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)},Di.prototype.updatePaintArray=function(e,t,r,n,o){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],o)},Di.prototype._setPaintValues=function(e,t,r,n){if(n&&r){var o=n[r.min],i=n[r.mid],a=n[r.max];if(o&&i&&a)for(var s=e;s<t;s++)this.zoomInPaintVertexArray.emplace(s,i.tl[0],i.tl[1],i.br[0],i.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],i.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,i.tl[0],i.tl[1],i.br[0],i.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],i.pixelRatio,a.pixelRatio)}},Di.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ui.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ui.members,this.expression.isStateDependent))},Di.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var zi=function(e,t,r){this.binders={},this._buffers=[];var n=[];for(var o in e.paint._values)if(r(o)){var i=e.paint.get(o);if(i instanceof mo&&Dr(i.property.specification)){var a=Ri(o,e.type),s=i.value,l=i.property.specification.type,c=i.property.useIntegerZoom,u=i.property.specification["property-type"],d="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[o]=d?new Ii(s.value,a):new Pi(s.value,a,l),n.push("/u_"+o);else if("source"===s.kind||d){var h=Li(o,l,"source");this.binders[o]=d?new Di(s,l,c,t,h,e.id):new Oi(s,a,l,h),n.push("/a_"+o)}else{var p=Li(o,l,"composite");this.binders[o]=new Mi(s,a,l,c,t,p),n.push("/z_"+o)}}}this.cacheKey=n.sort().join("")};zi.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Oi||t instanceof Mi?t.maxValue:0},zi.prototype.populatePaintArrays=function(e,t,r,n,o){for(var i in this.binders){var a=this.binders[i];(a instanceof Oi||a instanceof Mi||a instanceof Di)&&a.populatePaintArray(e,t,r,n,o)}},zi.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var n=this.binders[r];n instanceof Ii&&n.setConstantPatternPositions(e,t)}},zi.prototype.updatePaintArrays=function(e,t,r,n,o){var i=!1;for(var a in e)for(var s=0,l=t.getPositions(a);s<l.length;s+=1){var c=l[s],u=r.feature(c.index);for(var d in this.binders){var h=this.binders[d];if((h instanceof Oi||h instanceof Mi||h instanceof Di)&&!0===h.expression.isStateDependent){var p=n.paint.get(d);h.expression=p.value,h.updatePaintArray(c.start,c.end,u,e[a],o),i=!0}}}return i},zi.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Pi||r instanceof Ii)&&e.push.apply(e,r.uniformNames.map((function(e){return"#define HAS_UNIFORM_"+e})))}return e},zi.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Oi||r instanceof Mi)for(var n=0;n<r.paintVertexAttributes.length;n++)e.push(r.paintVertexAttributes[n].name);else if(r instanceof Di)for(var o=0;o<ui.members.length;o++)e.push(ui.members[o].name)}return e},zi.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Pi||r instanceof Ii||r instanceof Mi)for(var n=0,o=r.uniformNames;n<o.length;n+=1)e.push(o[n])}return e},zi.prototype.getPaintVertexBuffers=function(){return this._buffers},zi.prototype.getUniforms=function(e,t){var r=[];for(var n in this.binders){var o=this.binders[n];if(o instanceof Pi||o instanceof Ii||o instanceof Mi)for(var i=0,a=o.uniformNames;i<a.length;i+=1){var s=a[i];if(t[s]){var l=o.getBinding(e,t[s],s);r.push({name:s,property:n,binding:l})}}}return r},zi.prototype.setUniforms=function(e,t,r,n){for(var o=0,i=t;o<i.length;o+=1){var a=i[o],s=a.name,l=a.property;this.binders[l].setUniform(a.binding,n,r.get(l),s)}},zi.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Di){var n=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(r instanceof Oi||r instanceof Mi)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},zi.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Oi||r instanceof Mi||r instanceof Di)&&r.upload(e)}this.updatePaintBuffers()},zi.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Oi||t instanceof Mi||t instanceof Di)&&t.destroy()}};var ji=function(e,t,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var n=0,o=e;n<o.length;n+=1){var i=o[n];this.programConfigurations[i.id]=new zi(i,t,r)}this.needsUpload=!1,this._featureMap=new mi,this._bufferOffset=0};function Ri(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Li(e,t,r){var n={color:{source:Do,composite:Ko},number:{source:Wo,composite:Do}},o=function(e){return{"line-pattern":{source:zo,composite:zo},"fill-pattern":{source:zo,composite:zo},"fill-extrusion-pattern":{source:zo,composite:zo}}[e]}(e);return o&&o[r]||n[t][r]}ji.prototype.populatePaintArrays=function(e,t,r,n,o,i){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,n,o,i);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},ji.prototype.updatePaintArrays=function(e,t,r,n){for(var o=0,i=r;o<i.length;o+=1){var a=i[o];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,n)||this.needsUpload}},ji.prototype.get=function(e){return this.programConfigurations[e]},ji.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},ji.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Nn("ConstantBinder",Pi),Nn("CrossFadedConstantBinder",Ii),Nn("SourceExpressionBinder",Oi),Nn("CrossFadedCompositeBinder",Di),Nn("CompositeExpressionBinder",Mi),Nn("ProgramConfiguration",zi,{omit:["_buffers"]}),Nn("ProgramConfigurationSet",ji);var Ni=Math.pow(2,14)-1,Bi=-Ni-1;function Fi(e){for(var t=8192/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var o=r[n],i=0;i<o.length;i++){var a=o[i],s=Math.round(a.x*t),l=Math.round(a.y*t);a.x=u(s,Bi,Ni),a.y=u(l,Bi,Ni),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&k("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Vi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Fi(e):[]}}function Ui(e,t,r,n,o){e.emplaceBack(2*t+(n+1)/2,2*r+(o+1)/2)}var qi=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Po,this.indexArray=new Uo,this.segments=new li,this.programConfigurations=new ji(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};function Hi(e,t){for(var r=0;r<e.length;r++)if(Qi(t,e[r]))return!0;for(var n=0;n<t.length;n++)if(Qi(e,t[n]))return!0;return!!Yi(e,t)}function Wi(e,t,r){return!!Qi(e,t)||!!Ki(t,e,r)}function Gi(e,t){if(1===e.length)return Ji(t,e[0]);for(var r=0;r<t.length;r++)for(var n=t[r],o=0;o<n.length;o++)if(Qi(e,n[o]))return!0;for(var i=0;i<e.length;i++)if(Ji(t,e[i]))return!0;for(var a=0;a<t.length;a++)if(Yi(e,t[a]))return!0;return!1}function Zi(e,t,r){if(e.length>1){if(Yi(e,t))return!0;for(var n=0;n<t.length;n++)if(Ki(t[n],e,r))return!0}for(var o=0;o<e.length;o++)if(Ki(e[o],t,r))return!0;return!1}function Yi(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var n=e[r],o=e[r+1],i=0;i<t.length-1;i++)if($i(n,o,t[i],t[i+1]))return!0;return!1}function $i(e,t,r,n){return C(e,r,n)!==C(t,r,n)&&C(e,t,r)!==C(e,t,n)}function Ki(e,t,r){var n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(var o=1;o<t.length;o++)if(Xi(e,t[o-1],t[o])<n)return!0;return!1}function Xi(e,t,r){var n=t.distSqr(r);if(0===n)return e.distSqr(t);var o=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(o<0?t:o>1?r:r.sub(t)._mult(o)._add(t))}function Ji(e,t){for(var r,n,o,i=!1,a=0;a<e.length;a++)for(var s=0,l=(r=e[a]).length-1;s<r.length;l=s++)(n=r[s]).y>t.y!=(o=r[l]).y>t.y&&t.x<(o.x-n.x)*(t.y-n.y)/(o.y-n.y)+n.x&&(i=!i);return i}function Qi(e,t){for(var r=!1,n=0,o=e.length-1;n<e.length;o=n++){var i=e[n],a=e[o];i.y>t.y!=a.y>t.y&&t.x<(a.x-i.x)*(t.y-i.y)/(a.y-i.y)+i.x&&(r=!r)}return r}function ea(e,t,r){var n=r[0],o=r[2];if(e.x<n.x&&t.x<n.x||e.x>o.x&&t.x>o.x||e.y<n.y&&t.y<n.y||e.y>o.y&&t.y>o.y)return!1;var i=C(e,t,r[0]);return i!==C(e,t,r[1])||i!==C(e,t,r[2])||i!==C(e,t,r[3])}function ta(e,t,r){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ra(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function na(e,t,r,n,i){if(!t[0]&&!t[1])return e;var a=o.convert(t)._mult(i);"viewport"===r&&a._rotate(-n);for(var s=[],l=0;l<e.length;l++)s.push(e[l].sub(a));return s}qi.prototype.populate=function(e,t,r){var n=this.layers[0],o=[],i=null;"circle"===n.type&&(i=n.layout.get("circle-sort-key"));for(var a=0,s=e;a<s.length;a+=1){var l=s[a],c=l.feature,u=l.id,d=l.index,h=l.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,f=Vi(c,p);if(this.layers[0]._featureFilter.filter(new so(this.zoom),f,r)){var m=i?i.evaluate(f,{},r):void 0,g={id:u,properties:c.properties,type:c.type,sourceLayerIndex:h,index:d,geometry:p?f.geometry:Fi(c),patterns:{},sortKey:m};o.push(g)}}i&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var b=0,v=o;b<v.length;b+=1){var y=v[b],_=y.geometry,w=y.index,x=y.sourceLayerIndex,k=e[w].feature;this.addFeature(y,_,w,r),t.featureIndex.insert(k,_,w,x,this.index)}},qi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},qi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,si),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qi.prototype.addFeature=function(e,t,r,n){for(var o=0,i=t;o<i.length;o+=1)for(var a=0,s=i[o];a<s.length;a+=1){var l=s[a],c=l.x,u=l.y;if(!(c<0||c>=8192||u<0||u>=8192)){var d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),h=d.vertexLength;Ui(this.layoutVertexArray,c,u,-1,-1),Ui(this.layoutVertexArray,c,u,1,-1),Ui(this.layoutVertexArray,c,u,1,1),Ui(this.layoutVertexArray,c,u,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),d.vertexLength+=4,d.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)},Nn("CircleBucket",qi,{omit:["layers"]});var oa=new xo({"circle-sort-key":new vo(Pe.layout_circle["circle-sort-key"])}),ia={paint:new xo({"circle-radius":new vo(Pe.paint_circle["circle-radius"]),"circle-color":new vo(Pe.paint_circle["circle-color"]),"circle-blur":new vo(Pe.paint_circle["circle-blur"]),"circle-opacity":new vo(Pe.paint_circle["circle-opacity"]),"circle-translate":new bo(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new bo(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bo(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bo(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new vo(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new vo(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new vo(Pe.paint_circle["circle-stroke-opacity"])}),layout:oa},aa="undefined"!=typeof Float32Array?Float32Array:Array;function sa(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function la(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],m=t[12],g=t[13],b=t[14],v=t[15],y=r[0],_=r[1],w=r[2],x=r[3];return e[0]=y*n+_*s+w*d+x*m,e[1]=y*o+_*l+w*h+x*g,e[2]=y*i+_*c+w*p+x*b,e[3]=y*a+_*u+w*f+x*v,e[4]=(y=r[4])*n+(_=r[5])*s+(w=r[6])*d+(x=r[7])*m,e[5]=y*o+_*l+w*h+x*g,e[6]=y*i+_*c+w*p+x*b,e[7]=y*a+_*u+w*f+x*v,e[8]=(y=r[8])*n+(_=r[9])*s+(w=r[10])*d+(x=r[11])*m,e[9]=y*o+_*l+w*h+x*g,e[10]=y*i+_*c+w*p+x*b,e[11]=y*a+_*u+w*f+x*v,e[12]=(y=r[12])*n+(_=r[13])*s+(w=r[14])*d+(x=r[15])*m,e[13]=y*o+_*l+w*h+x*g,e[14]=y*i+_*c+w*p+x*b,e[15]=y*a+_*u+w*f+x*v,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var ca,ua=la;function da(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3];return e[0]=r[0]*n+r[4]*o+r[8]*i+r[12]*a,e[1]=r[1]*n+r[5]*o+r[9]*i+r[13]*a,e[2]=r[2]*n+r[6]*o+r[10]*i+r[14]*a,e[3]=r[3]*n+r[7]*o+r[11]*i+r[15]*a,e}ca=new aa(3),aa!=Float32Array&&(ca[0]=0,ca[1]=0,ca[2]=0),function(){var e=new aa(4);aa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var ha=(function(){var e=new aa(2);aa!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(t){e.call(this,t,ia)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new qi(e)},t.prototype.queryRadius=function(e){var t=e;return ta("circle-radius",this,t)+ta("circle-stroke-width",this,t)+ra(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,o,i,a,s){for(var l=na(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,a),c=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),u="map"===this.paint.get("circle-pitch-alignment"),d=u?l:function(e,t){return e.map((function(e){return pa(e,t)}))}(l,s),h=u?c*a:c,p=0,f=n;p<f.length;p+=1)for(var m=0,g=f[p];m<g.length;m+=1){var b=g[m],v=u?b:pa(b,s),y=h,_=da([],[b.x,b.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?y*=_[3]/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(y*=i.cameraToCenterDistance/_[3]),Wi(d,v,y))return!0}return!1},t}(ko));function pa(e,t){var r=da([],[e.x,e.y,0,1],t);return new o(r[0]/r[3],r[1]/r[3])}var fa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(qi);function ma(e,t,r,n){var o=t.width,i=t.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==o*i*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(o*i*r);return e.width=o,e.height=i,e.data=n,e}function ga(e,t,r){var n=t.width,o=t.height;if(n!==e.width||o!==e.height){var i=ma({},{width:n,height:o},r);ba(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,o)},r),e.width=n,e.height=o,e.data=i.data}}function ba(e,t,r,n,o,i){if(0===o.width||0===o.height)return t;if(o.width>e.width||o.height>e.height||r.x>e.width-o.width||r.y>e.height-o.height)throw new RangeError("out of range source coordinates for image copy");if(o.width>t.width||o.height>t.height||n.x>t.width-o.width||n.y>t.height-o.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=e.data,s=t.data,l=0;l<o.height;l++)for(var c=((r.y+l)*e.width+r.x)*i,u=((n.y+l)*t.width+n.x)*i,d=0;d<o.width*i;d++)s[u+d]=a[c+d];return t}Nn("HeatmapBucket",fa,{omit:["layers"]});var va=function(e,t){ma(this,e,1,t)};va.prototype.resize=function(e){ga(this,e,1)},va.prototype.clone=function(){return new va({width:this.width,height:this.height},new Uint8Array(this.data))},va.copy=function(e,t,r,n,o){ba(e,t,r,n,o,1)};var ya=function(e,t){ma(this,e,4,t)};ya.prototype.resize=function(e){ga(this,e,4)},ya.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},ya.prototype.clone=function(){return new ya({width:this.width,height:this.height},new Uint8Array(this.data))},ya.copy=function(e,t,r,n,o){ba(e,t,r,n,o,4)},Nn("AlphaImage",va),Nn("RGBAImage",ya);var _a={paint:new xo({"heatmap-radius":new vo(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new vo(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bo(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wo(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bo(Pe.paint_heatmap["heatmap-opacity"])})};function wa(e){var t={},r=e.resolution||256,n=e.clips?e.clips.length:1,o=e.image||new ya({width:r,height:n}),i=function(r,n,i){t[e.evaluationKey]=i;var a=e.expression.evaluate(t);o.data[r+n+0]=Math.floor(255*a.r/a.a),o.data[r+n+1]=Math.floor(255*a.g/a.a),o.data[r+n+2]=Math.floor(255*a.b/a.a),o.data[r+n+3]=Math.floor(255*a.a)};if(e.clips)for(var a=0,s=0;a<n;++a,s+=4*r)for(var l=0,c=0;l<r;l++,c+=4){var u=l/(r-1),d=e.clips[a];i(s,c,d.start*(1-u)+d.end*u)}else for(var h=0,p=0;h<r;h++,p+=4)i(0,p,h/(r-1));return o}var xa=function(e){function t(t){e.call(this,t,_a),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new fa(e)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=wa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(ko),ka={paint:new xo({"hillshade-illumination-direction":new bo(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bo(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bo(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bo(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bo(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bo(Pe.paint_hillshade["hillshade-accent-color"])})},Ca=function(e){function t(t){e.call(this,t,ka)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(ko),Ea=To([{name:"a_pos",components:2,type:"Int16"}],4).members,Sa=Aa,Ta=Aa;function Aa(e,t,r){r=r||2;var n,o,i,a,s,l,c,u=t&&t.length,d=u?t[0]*r:e.length,h=Pa(e,0,d,r,!0),p=[];if(!h||h.next===h.prev)return p;if(u&&(h=function(e,t,r,n){var o,i,a,s=[];for(o=0,i=t.length;o<i;o++)(a=Pa(e,t[o]*n,o<i-1?t[o+1]*n:e.length,n,!1))===a.next&&(a.steiner=!0),s.push(Fa(a));for(s.sort(Ra),o=0;o<s.length;o++)La(s[o],r),r=Ia(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=i=e[0],o=a=e[1];for(var f=r;f<d;f+=r)(s=e[f])<n&&(n=s),(l=e[f+1])<o&&(o=l),s>i&&(i=s),l>a&&(a=l);c=0!==(c=Math.max(i-n,a-o))?1/c:0}return Oa(h,p,r,n,o,c),p}function Pa(e,t,r,n,o){var i,a;if(o===Qa(e,t,r,n)>0)for(i=t;i<r;i+=n)a=Ka(i,e[i],e[i+1],a);else for(i=r-n;i>=t;i-=n)a=Ka(i,e[i],e[i+1],a);return a&&Ha(a,a.next)&&(Xa(a),a=a.next),a}function Ia(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Ha(n,n.next)&&0!==qa(n.prev,n,n.next))n=n.next;else{if(Xa(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function Oa(e,t,r,n,o,i,a){if(e){!a&&i&&function(e,t,r,n){var o=e;do{null===o.z&&(o.z=Ba(o.x,o.y,t,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,r,n,o,i,a,s,l,c=1;do{for(r=e,e=null,i=null,a=0;r;){for(a++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(l=c;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(o=r,r=r.nextZ,s--):(o=n,n=n.nextZ,l--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(e,n,o,i);for(var s,l,c=e;e.prev!==e.next;)if(s=e.prev,l=e.next,i?Da(e,n,o,i):Ma(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),Xa(e),e=l.next,c=l.next;else if((e=l)===c){a?1===a?Oa(e=za(Ia(e),t,r),t,r,n,o,i,2):2===a&&ja(e,t,r,n,o,i):Oa(Ia(e),t,r,n,o,i,1);break}}}function Ma(e){var t=e.prev,r=e,n=e.next;if(qa(t,r,n)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(Va(t.x,t.y,r.x,r.y,n.x,n.y,o.x,o.y)&&qa(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function Da(e,t,r,n){var o=e.prev,i=e,a=e.next;if(qa(o,i,a)>=0)return!1;for(var s=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,l=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,c=Ba(o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,t,r,n),u=Ba(s,l,t,r,n),d=e.prevZ,h=e.nextZ;d&&d.z>=c&&h&&h.z<=u;){if(d!==e.prev&&d!==e.next&&Va(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&qa(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,h!==e.prev&&h!==e.next&&Va(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&qa(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;d&&d.z>=c;){if(d!==e.prev&&d!==e.next&&Va(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&qa(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;h&&h.z<=u;){if(h!==e.prev&&h!==e.next&&Va(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&qa(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function za(e,t,r){var n=e;do{var o=n.prev,i=n.next.next;!Ha(o,i)&&Wa(o,n,n.next,i)&&Ya(o,i)&&Ya(i,o)&&(t.push(o.i/r),t.push(n.i/r),t.push(i.i/r),Xa(n),Xa(n.next),n=e=i),n=n.next}while(n!==e);return Ia(n)}function ja(e,t,r,n,o,i){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ua(a,s)){var l=$a(a,s);return a=Ia(a,a.next),l=Ia(l,l.next),Oa(a,t,r,n,o,i),void Oa(l,t,r,n,o,i)}s=s.next}a=a.next}while(a!==e)}function Ra(e,t){return e.x-t.x}function La(e,t){if(t=function(e,t){var r,n=t,o=e.x,i=e.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=o&&s>a){if(a=s,s===o){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(o===a)return r;var l,c=r,u=r.x,d=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=u&&o!==n.x&&Va(i<d?o:a,i,u,d,i<d?a:o,i,n.x,n.y)&&(l=Math.abs(i-n.y)/(o-n.x),Ya(n,e)&&(l<h||l===h&&(n.x>r.x||n.x===r.x&&Na(r,n)))&&(r=n,h=l)),n=n.next}while(n!==c);return r}(e,t)){var r=$a(t,e);Ia(t,t.next),Ia(r,r.next)}}function Na(e,t){return qa(e.prev,e,t.prev)<0&&qa(t.next,e,e.next)<0}function Ba(e,t,r,n,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fa(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Va(e,t,r,n,o,i,a,s){return(o-a)*(t-s)-(e-a)*(i-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(i-s)-(o-a)*(n-s)>=0}function Ua(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Wa(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Ya(e,t)&&Ya(t,e)&&function(e,t){var r=e,n=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(qa(e.prev,e,t.prev)||qa(e,t.prev,t))||Ha(e,t)&&qa(e.prev,e,e.next)>0&&qa(t.prev,t,t.next)>0)}function qa(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ha(e,t){return e.x===t.x&&e.y===t.y}function Wa(e,t,r,n){var o=Za(qa(e,t,r)),i=Za(qa(e,t,n)),a=Za(qa(r,n,e)),s=Za(qa(r,n,t));return o!==i&&a!==s||!(0!==o||!Ga(e,r,t))||!(0!==i||!Ga(e,n,t))||!(0!==a||!Ga(r,e,n))||!(0!==s||!Ga(r,t,n))}function Ga(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Za(e){return e>0?1:e<0?-1:0}function Ya(e,t){return qa(e.prev,e,e.next)<0?qa(e,t,e.next)>=0&&qa(e,e.prev,t)>=0:qa(e,t,e.prev)<0||qa(e,e.next,t)<0}function $a(e,t){var r=new Ja(e.i,e.x,e.y),n=new Ja(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function Ka(e,t,r,n){var o=new Ja(e,t,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Xa(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ja(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qa(e,t,r,n){for(var o=0,i=t,a=r-n;i<r;i+=n)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}function es(e,t,r,n,o){!function e(t,r,n,o,i){for(;o>n;){if(o-n>600){var a=o-n+1,s=r-n+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);e(t,r,Math.max(n,Math.floor(r-s*c/a+u)),Math.min(o,Math.floor(r+(a-s)*c/a+u)),i)}var d=t[r],h=n,p=o;for(ts(t,n,r),i(t[o],d)>0&&ts(t,n,o);h<p;){for(ts(t,h,p),h++,p--;i(t[h],d)<0;)h++;for(;i(t[p],d)>0;)p--}0===i(t[n],d)?ts(t,n,p):ts(t,++p,o),p<=r&&(n=p+1),r<=p&&(o=p-1)}}(e,t,r||0,n||e.length-1,o||rs)}function ts(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function rs(e,t){return e<t?-1:e>t?1:0}function ns(e,t){var r=e.length;if(r<=1)return[e];for(var n,o,i=[],a=0;a<r;a++){var s=E(e[a]);0!==s&&(e[a].area=Math.abs(s),void 0===o&&(o=s<0),o===s<0?(n&&i.push(n),n=[e[a]]):n.push(e[a]))}if(n&&i.push(n),t>1)for(var l=0;l<i.length;l++)i[l].length<=t||(es(i[l],t,1,i[l].length-1,os),i[l]=i[l].slice(0,t));return i}function os(e,t){return t.area-e.area}function is(e,t,r){for(var n=r.patternDependencies,o=!1,i=0,a=t;i<a.length;i+=1){var s=a[i].paint.get(e+"-pattern");s.isConstant()||(o=!0);var l=s.constantOr(null);l&&(o=!0,n[l.to]=!0,n[l.from]=!0)}return o}function as(e,t,r,n,o){for(var i=o.patternDependencies,a=0,s=t;a<s.length;a+=1){var l=s[a],c=l.paint.get(e+"-pattern").value;if("constant"!==c.kind){var u=c.evaluate({zoom:n-1},r,{},o.availableImages),d=c.evaluate({zoom:n},r,{},o.availableImages),h=c.evaluate({zoom:n+1},r,{},o.availableImages);d=d&&d.name?d.name:d,h=h&&h.name?h.name:h,i[u=u&&u.name?u.name:u]=!0,i[d]=!0,i[h]=!0,r.patterns[l.id]={min:u,mid:d,max:h}}}return r}Aa.deviation=function(e,t,r,n){var o=t&&t.length,i=Math.abs(Qa(e,0,o?t[0]*r:e.length,r));if(o)for(var a=0,s=t.length;a<s;a++)i-=Math.abs(Qa(e,t[a]*r,a<s-1?t[a+1]*r:e.length,r));var l=0;for(a=0;a<n.length;a+=3){var c=n[a]*r,u=n[a+1]*r,d=n[a+2]*r;l+=Math.abs((e[c]-e[d])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[d+1]-e[c+1]))}return 0===i&&0===l?0:Math.abs((l-i)/i)},Aa.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;a<t;a++)r.vertices.push(e[o][i][a]);o>0&&r.holes.push(n+=e[o-1].length)}return r},Sa.default=Ta;var ss=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Po,this.indexArray=new Uo,this.indexArray2=new Yo,this.programConfigurations=new ji(e.layers,e.zoom),this.segments=new li,this.segments2=new li,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};ss.prototype.populate=function(e,t,r){this.hasPattern=is("fill",this.layers,t);for(var n=this.layers[0].layout.get("fill-sort-key"),o=[],i=0,a=e;i<a.length;i+=1){var s=a[i],l=s.feature,c=s.id,u=s.index,d=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,p=Vi(l,h);if(this.layers[0]._featureFilter.filter(new so(this.zoom),p,r)){var f=n?n.evaluate(p,{},r,t.availableImages):void 0,m={id:c,properties:l.properties,type:l.type,sourceLayerIndex:d,index:u,geometry:h?p.geometry:Fi(l),patterns:{},sortKey:f};o.push(m)}}n&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,b=o;g<b.length;g+=1){var v=b[g],y=v.geometry,_=v.index,w=v.sourceLayerIndex;if(this.hasPattern){var x=as("fill",this.layers,v,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(v,y,_,r,{});t.featureIndex.insert(e[_].feature,y,_,w,this.index)}},ss.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ss.prototype.addFeatures=function(e,t,r){for(var n=0,o=this.patternFeatures;n<o.length;n+=1){var i=o[n];this.addFeature(i,i.geometry,i.index,t,r)}},ss.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ss.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ss.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ea),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},ss.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ss.prototype.addFeature=function(e,t,r,n,o){for(var i=0,a=ns(t,500);i<a.length;i+=1){for(var s=a[i],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var d=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=d.vertexLength,p=[],f=[],m=0,g=s;m<g.length;m+=1){var b=g[m];if(0!==b.length){b!==s[0]&&f.push(p.length/2);var v=this.segments2.prepareSegment(b.length,this.layoutVertexArray,this.indexArray2),y=v.vertexLength;this.layoutVertexArray.emplaceBack(b[0].x,b[0].y),this.indexArray2.emplaceBack(y+b.length-1,y),p.push(b[0].x),p.push(b[0].y);for(var _=1;_<b.length;_++)this.layoutVertexArray.emplaceBack(b[_].x,b[_].y),this.indexArray2.emplaceBack(y+_-1,y+_),p.push(b[_].x),p.push(b[_].y);v.vertexLength+=b.length,v.primitiveLength+=b.length}}for(var w=Sa(p,f),x=0;x<w.length;x+=3)this.indexArray.emplaceBack(h+w[x],h+w[x+1],h+w[x+2]);d.vertexLength+=l,d.primitiveLength+=w.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,o,n)},Nn("FillBucket",ss,{omit:["layers","patternFeatures"]});var ls=new xo({"fill-sort-key":new vo(Pe.layout_fill["fill-sort-key"])}),cs={paint:new xo({"fill-antialias":new bo(Pe.paint_fill["fill-antialias"]),"fill-opacity":new vo(Pe.paint_fill["fill-opacity"]),"fill-color":new vo(Pe.paint_fill["fill-color"]),"fill-outline-color":new vo(Pe.paint_fill["fill-outline-color"]),"fill-translate":new bo(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new bo(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new yo(Pe.paint_fill["fill-pattern"])}),layout:ls},us=function(e){function t(t){e.call(this,t,cs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,r){e.prototype.recalculate.call(this,t,r);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new ss(e)},t.prototype.queryRadius=function(){return ra(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,o,i,a){return Gi(na(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,a),n)},t.prototype.isTileClipped=function(){return!0},t}(ko),ds=To([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,hs=ps;function ps(e,t,r,n,o){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=o,e.readFields(fs,this,t)}function fs(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],o=t._values[e.readVarint()];t.properties[n]=o}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function ms(e){for(var t,r,n=0,o=0,i=e.length,a=i-1;o<i;a=o++)n+=((r=e[a]).x-(t=e[o]).x)*(t.y+r.y);return n}ps.types=["Unknown","Point","LineString","Polygon"],ps.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,a=0,s=0,l=[];e.pos<r;){if(i<=0){var c=e.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)a+=e.readSVarint(),s+=e.readSVarint(),1===n&&(t&&l.push(t),t=[]),t.push(new o(a,s));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&l.push(t),l},ps.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,o=0,i=0,a=1/0,s=-1/0,l=1/0,c=-1/0;e.pos<t;){if(n<=0){var u=e.readVarint();r=7&u,n=u>>3}if(n--,1===r||2===r)(o+=e.readSVarint())<a&&(a=o),o>s&&(s=o),(i+=e.readSVarint())<l&&(l=i),i>c&&(c=i);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,c]},ps.prototype.toGeoJSON=function(e,t,r){var n,o,i=this.extent*Math.pow(2,r),a=this.extent*e,s=this.extent*t,l=this.loadGeometry(),c=ps.types[this.type];function u(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+a)/i-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/i)*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(n=0;n<l.length;n++)d[n]=l[n][0];u(l=d);break;case 2:for(n=0;n<l.length;n++)u(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,o=[],i=0;i<t;i++){var a=ms(e[i]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&o.push(r),r=[e[i]]):r.push(e[i]))}return r&&o.push(r),o}(l),n=0;n<l.length;n++)for(o=0;o<l[n].length;o++)u(l[n][o])}1===l.length?l=l[0]:c="Multi"+c;var h={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var gs=bs;function bs(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(vs,this,t),this.length=this._features.length}function vs(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}function ys(e,t,r){if(3===e){var n=new gs(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}bs.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new hs(this._pbf,t,this.extent,this._keys,this._values)};var _s={VectorTile:function(e,t){this.layers=e.readFields(ys,{},t)},VectorTileFeature:hs,VectorTileLayer:gs},ws=_s.VectorTileFeature.types,xs=Math.pow(2,13);function ks(e,t,r,n,o,i,a,s){e.emplaceBack(t,r,2*Math.floor(n*xs)+a,o*xs*2,i*xs*2,Math.round(s))}var Cs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Oo,this.indexArray=new Uo,this.programConfigurations=new ji(e.layers,e.zoom),this.segments=new li,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};function Es(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Cs.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=is("fill-extrusion",this.layers,t);for(var n=0,o=e;n<o.length;n+=1){var i=o[n],a=i.feature,s=i.id,l=i.index,c=i.sourceLayerIndex,u=this.layers[0]._featureFilter.needGeometry,d=Vi(a,u);if(this.layers[0]._featureFilter.filter(new so(this.zoom),d,r)){var h={id:s,sourceLayerIndex:c,index:l,geometry:u?d.geometry:Fi(a),properties:a.properties,type:a.type,patterns:{}};this.hasPattern?this.features.push(as("fill-extrusion",this.layers,h,this.zoom,t)):this.addFeature(h,h.geometry,l,r,{}),t.featureIndex.insert(a,h.geometry,l,c,this.index,!0)}}},Cs.prototype.addFeatures=function(e,t,r){for(var n=0,o=this.features;n<o.length;n+=1){var i=o[n];this.addFeature(i,i.geometry,i.index,t,r)}},Cs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Cs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Cs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ds),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Cs.prototype.addFeature=function(e,t,r,n,o){for(var i=0,a=ns(t,500);i<a.length;i+=1){for(var s=a[i],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,p=s;h<p.length;h+=1){var f=p[h];if(0!==f.length&&!((M=f).every((function(e){return e.x<0}))||M.every((function(e){return e.x>8192}))||M.every((function(e){return e.y<0}))||M.every((function(e){return e.y>8192}))))for(var m=0,g=0;g<f.length;g++){var b=f[g];if(g>=1){var v=f[g-1];if(!Es(b,v)){d.vertexLength+4>li.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var y=b.sub(v)._perp()._unit(),_=v.dist(b);m+_>32768&&(m=0),ks(this.layoutVertexArray,b.x,b.y,y.x,y.y,0,0,m),ks(this.layoutVertexArray,b.x,b.y,y.x,y.y,0,1,m),ks(this.layoutVertexArray,v.x,v.y,y.x,y.y,0,0,m+=_),ks(this.layoutVertexArray,v.x,v.y,y.x,y.y,0,1,m);var w=d.vertexLength;this.indexArray.emplaceBack(w,w+2,w+1),this.indexArray.emplaceBack(w+1,w+2,w+3),d.vertexLength+=4,d.primitiveLength+=2}}}}if(d.vertexLength+l>li.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===ws[e.type]){for(var x=[],k=[],C=d.vertexLength,E=0,S=s;E<S.length;E+=1){var T=S[E];if(0!==T.length){T!==s[0]&&k.push(x.length/2);for(var A=0;A<T.length;A++){var P=T[A];ks(this.layoutVertexArray,P.x,P.y,0,0,1,1,0),x.push(P.x),x.push(P.y)}}}for(var I=Sa(x,k),O=0;O<I.length;O+=3)this.indexArray.emplaceBack(C+I[O],C+I[O+2],C+I[O+1]);d.primitiveLength+=I.length/3,d.vertexLength+=l}}var M;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,o,n)},Nn("FillExtrusionBucket",Cs,{omit:["layers","features"]});var Ss={paint:new xo({"fill-extrusion-opacity":new bo(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new vo(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bo(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bo(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yo(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new vo(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new vo(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bo(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ts=function(e){function t(t){e.call(this,t,Ss)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new Cs(e)},t.prototype.queryRadius=function(){return ra(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a,s,l){var c=na(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(t,r),d=this.paint.get("fill-extrusion-base").evaluate(t,r),h=function(e,t,r,n){for(var i=[],a=0,s=e;a<s.length;a+=1){var l=s[a],c=[l.x,l.y,0,1];da(c,c,t),i.push(new o(c[0]/c[3],c[1]/c[3]))}return i}(c,l),p=function(e,t,r,n){for(var i=[],a=[],s=n[8]*t,l=n[9]*t,c=n[10]*t,u=n[11]*t,d=n[8]*r,h=n[9]*r,p=n[10]*r,f=n[11]*r,m=0,g=e;m<g.length;m+=1){for(var b=[],v=[],y=0,_=g[m];y<_.length;y+=1){var w=_[y],x=w.x,k=w.y,C=n[0]*x+n[4]*k+n[12],E=n[1]*x+n[5]*k+n[13],S=n[2]*x+n[6]*k+n[14],T=n[3]*x+n[7]*k+n[15],A=S+c,P=T+u,I=C+d,O=E+h,M=S+p,D=T+f,z=new o((C+s)/P,(E+l)/P);z.z=A/P,b.push(z);var j=new o(I/D,O/D);j.z=M/D,v.push(j)}i.push(b),a.push(v)}return[i,a]}(n,d,u,l);return function(e,t,r){var n=1/0;Gi(r,t)&&(n=Ps(r,t[0]));for(var o=0;o<t.length;o++)for(var i=t[o],a=e[o],s=0;s<i.length-1;s++){var l=i[s],c=[l,i[s+1],a[s+1],a[s],l];Hi(r,c)&&(n=Math.min(n,Ps(r,c)))}return n!==1/0&&n}(p[0],p[1],h)},t}(ko);function As(e,t){return e.x*t.x+e.y*t.y}function Ps(e,t){if(1===e.length){for(var r,n=0,o=t[n++];!r||o.equals(r);)if(!(r=t[n++]))return 1/0;for(;n<t.length;n++){var i=t[n],a=e[0],s=r.sub(o),l=i.sub(o),c=a.sub(o),u=As(s,s),d=As(s,l),h=As(l,l),p=As(c,s),f=As(c,l),m=u*h-d*d,g=(h*p-d*f)/m,b=(u*f-d*p)/m,v=o.z*(1-g-b)+r.z*g+i.z*b;if(isFinite(v))return v}return 1/0}for(var y=1/0,_=0,w=t;_<w.length;_+=1)y=Math.min(y,w[_].z);return y}var Is=To([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Os=To([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Ms=_s.VectorTileFeature.types,Ds=Math.cos(Math.PI/180*37.5),zs=Math.pow(2,14)/.5,js=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(e){t.gradients[e.id]={}})),this.layoutVertexArray=new Mo,this.layoutVertexArray2=new Do,this.indexArray=new Uo,this.programConfigurations=new ji(e.layers,e.zoom),this.segments=new li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};js.prototype.populate=function(e,t,r){this.hasPattern=is("line",this.layers,t);for(var n=this.layers[0].layout.get("line-sort-key"),o=[],i=0,a=e;i<a.length;i+=1){var s=a[i],l=s.feature,c=s.id,u=s.index,d=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,p=Vi(l,h);if(this.layers[0]._featureFilter.filter(new so(this.zoom),p,r)){var f=n?n.evaluate(p,{},r):void 0,m={id:c,properties:l.properties,type:l.type,sourceLayerIndex:d,index:u,geometry:h?p.geometry:Fi(l),patterns:{},sortKey:f};o.push(m)}}n&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,b=o;g<b.length;g+=1){var v=b[g],y=v.geometry,_=v.index,w=v.sourceLayerIndex;if(this.hasPattern){var x=as("line",this.layers,v,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(v,y,_,r,{});t.featureIndex.insert(e[_].feature,y,_,w,this.index)}},js.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},js.prototype.addFeatures=function(e,t,r){for(var n=0,o=this.patternFeatures;n<o.length;n+=1){var i=o[n];this.addFeature(i,i.geometry,i.index,t,r)}},js.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},js.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},js.prototype.upload=function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Os)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Is),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},js.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},js.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},js.prototype.addFeature=function(e,t,r,n,o){var i=this.layers[0].layout,a=i.get("line-join").evaluate(e,{}),s=i.get("line-cap"),l=i.get("line-miter-limit"),c=i.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var u=0,d=t;u<d.length;u+=1)this.addLine(d[u],e,a,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,o,n)},js.prototype.addLine=function(e,t,r,n,o,i){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var a=0;a<e.length-1;a++)this.totalDistance+=e[a].dist(e[a+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===Ms[t.type],l=e.length;l>=2&&e[l-1].equals(e[l-2]);)l--;for(var c=0;c<l-1&&e[c].equals(e[c+1]);)c++;if(!(l<(s?3:2))){"bevel"===r&&(o=1.05);var u,d=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),p=void 0,f=void 0,m=void 0,g=void 0;this.e1=this.e2=-1,s&&(g=e[c].sub(u=e[l-2])._unit()._perp());for(var b=c;b<l;b++)if(!(f=b===l-1?s?e[c+1]:void 0:e[b+1])||!e[b].equals(f)){g&&(m=g),u&&(p=u),u=e[b],g=f?f.sub(u)._unit()._perp():m;var v=(m=m||g).add(g);0===v.x&&0===v.y||v._unit();var y=m.x*g.x+m.y*g.y,_=v.x*g.x+v.y*g.y,w=0!==_?1/_:1/0,x=2*Math.sqrt(2-2*_),k=_<Ds&&p&&f,C=m.x*g.y-m.y*g.x>0;if(k&&b>c){var E=u.dist(p);if(E>2*d){var S=u.sub(u.sub(p)._mult(d/E)._round());this.updateDistance(p,S),this.addCurrentVertex(S,m,0,0,h),p=S}}var T=p&&f,A=T?r:s?"butt":n;if(T&&"round"===A&&(w<i?A="miter":w<=2&&(A="fakeround")),"miter"===A&&w>o&&(A="bevel"),"bevel"===A&&(w>2&&(A="flipbevel"),w<o&&(A="miter")),p&&this.updateDistance(p,u),"miter"===A)v._mult(w),this.addCurrentVertex(u,v,0,0,h);else if("flipbevel"===A){if(w>100)v=g.mult(-1);else{var P=w*m.add(g).mag()/m.sub(g).mag();v._perp()._mult(P*(C?-1:1))}this.addCurrentVertex(u,v,0,0,h),this.addCurrentVertex(u,v.mult(-1),0,0,h)}else if("bevel"===A||"fakeround"===A){var I=-Math.sqrt(w*w-1),O=C?I:0,M=C?0:I;if(p&&this.addCurrentVertex(u,m,O,M,h),"fakeround"===A)for(var D=Math.round(180*x/Math.PI/20),z=1;z<D;z++){var j=z/D;if(.5!==j){var R=j-.5;j+=j*R*(j-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*R*R+(.848013+y*(.215638*y-1.06021)))}var L=g.sub(m)._mult(j)._add(m)._unit()._mult(C?-1:1);this.addHalfVertex(u,L.x,L.y,!1,C,0,h)}f&&this.addCurrentVertex(u,g,-O,-M,h)}else if("butt"===A)this.addCurrentVertex(u,v,0,0,h);else if("square"===A){var N=p?1:-1;this.addCurrentVertex(u,v,N,N,h)}else"round"===A&&(p&&(this.addCurrentVertex(u,m,0,0,h),this.addCurrentVertex(u,m,1,1,h,!0)),f&&(this.addCurrentVertex(u,g,-1,-1,h,!0),this.addCurrentVertex(u,g,0,0,h)));if(k&&b<l-1){var B=u.dist(f);if(B>2*d){var F=u.add(f.sub(u)._mult(d/B)._round());this.updateDistance(u,F),this.addCurrentVertex(F,g,0,0,h),u=F}}}}},js.prototype.addCurrentVertex=function(e,t,r,n,o,i){void 0===i&&(i=!1);var a=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,i,!1,r,o),this.addHalfVertex(e,a,s,i,!0,-n,o),this.distance>zs/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,n,o,i))},js.prototype.addHalfVertex=function(e,t,r,n,o,i,a){var s=.5*(this.lineClips?this.scaledDistance*(zs-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(n?1:0),(e.y<<1)+(o?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===i?0:i<0?-1:1)|(63&s)<<2,s>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),o?this.e2=l:this.e1=l},js.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},js.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Nn("LineBucket",js,{omit:["layers","patternFeatures"]});var Rs=new xo({"line-cap":new bo(Pe.layout_line["line-cap"]),"line-join":new vo(Pe.layout_line["line-join"]),"line-miter-limit":new bo(Pe.layout_line["line-miter-limit"]),"line-round-limit":new bo(Pe.layout_line["line-round-limit"]),"line-sort-key":new vo(Pe.layout_line["line-sort-key"])}),Ls={paint:new xo({"line-opacity":new vo(Pe.paint_line["line-opacity"]),"line-color":new vo(Pe.paint_line["line-color"]),"line-translate":new bo(Pe.paint_line["line-translate"]),"line-translate-anchor":new bo(Pe.paint_line["line-translate-anchor"]),"line-width":new vo(Pe.paint_line["line-width"]),"line-gap-width":new vo(Pe.paint_line["line-gap-width"]),"line-offset":new vo(Pe.paint_line["line-offset"]),"line-blur":new vo(Pe.paint_line["line-blur"]),"line-dasharray":new _o(Pe.paint_line["line-dasharray"]),"line-pattern":new yo(Pe.paint_line["line-pattern"]),"line-gradient":new wo(Pe.paint_line["line-gradient"])}),layout:Rs},Ns=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(t,r){return r=new so(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),e.prototype.possiblyEvaluate.call(this,t,r)},t.prototype.evaluate=function(t,r,n,o){return r=h({},r,{zoom:Math.floor(r.zoom)}),e.prototype.evaluate.call(this,t,r,n,o)},t}(vo))(Ls.paint.properties["line-width"].specification);Ns.useIntegerZoom=!0;var Bs=function(e){function t(t){e.call(this,t,Ls),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof qt,this.gradientVersion=(this.gradientVersion+1)%s)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(t,r){e.prototype.recalculate.call(this,t,r),this.paint._values["line-floorwidth"]=Ns.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new js(e)},t.prototype.queryRadius=function(e){var t=e,r=Fs(ta("line-width",this,t),ta("line-gap-width",this,t)),n=ta("line-offset",this,t);return r/2+Math.abs(n)+ra(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a,s){var l=na(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*Fs(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(n=function(e,t){for(var r=[],n=new o(0,0),i=0;i<e.length;i++){for(var a=e[i],s=[],l=0;l<a.length;l++){var c=a[l],u=a[l+1],d=0===l?n:c.sub(a[l-1])._unit()._perp(),h=l===a.length-1?n:u.sub(c)._unit()._perp(),p=d._add(h)._unit();p._mult(1/(p.x*h.x+p.y*h.y)),s.push(p._mult(t)._add(c))}r.push(s)}return r}(n,u*s)),function(e,t,r){for(var n=0;n<t.length;n++){var o=t[n];if(e.length>=3)for(var i=0;i<o.length;i++)if(Qi(e,o[i]))return!0;if(Zi(e,o,r))return!0}return!1}(l,n,c)},t.prototype.isTileClipped=function(){return!0},t}(ko);function Fs(e,t){return t>0?t+2*e:e}var Vs=To([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Us=To([{name:"a_projected_pos",components:3,type:"Float32"}],4),qs=(To([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),To([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Hs=(To([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),To([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ws=To([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gs(e,t,r){return e.sections.forEach((function(e){e.text=function(e,t,r){var n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),ao.applyArabicShaping&&(e=ao.applyArabicShaping(e)),e}(e.text,t,r)})),e}To([{name:"triangle",components:3,type:"Uint16"}]),To([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),To([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),To([{type:"Float32",name:"offsetX"}]),To([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zs={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Ys=function(e,t,r,n,o){var i,a,s=8*o-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?o-1:0,h=r?-1:1,p=e[t+d];for(d+=h,i=p&(1<<-u)-1,p>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=h,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),i-=c}return(p?-1:1)*a*Math.pow(2,i-n)},$s=function(e,t,r,n,o,i){var a,s,l,c=8*i-o-1,u=(1<<c)-1,d=u>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[r+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[r+p]=255&a,p+=f,a/=256,c-=8);e[r+p-f]|=128*m},Ks=Xs;function Xs(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Xs.Varint=0,Xs.Fixed64=1,Xs.Bytes=2,Xs.Fixed32=5;var Js="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Qs(e){return e.type===Xs.Bytes?e.readVarint()+e.pos:e.pos+1}function el(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function tl(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var o=r.pos-1;o>=e;o--)r.buf[o+n]=r.buf[o]}function rl(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function nl(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function ol(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function il(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function al(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function sl(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function ll(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function cl(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function ul(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function dl(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function hl(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function pl(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function fl(e,t,r){1===e&&r.readMessage(ml,t)}function ml(e,t,r){if(3===e){var n=r.readMessage(gl,{}),o=n.width,i=n.height,a=n.left,s=n.top,l=n.advance;t.push({id:n.id,bitmap:new va({width:o+6,height:i+6},n.bitmap),metrics:{width:o,height:i,left:a,top:s,advance:l}})}}function gl(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function bl(e){for(var t=0,r=0,n=0,o=e;n<o.length;n+=1){var i=o[n];t+=i.w*i.h,r=Math.max(r,i.w)}e.sort((function(e,t){return t.h-e.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],s=0,l=0,c=0,u=e;c<u.length;c+=1)for(var d=u[c],h=a.length-1;h>=0;h--){var p=a[h];if(!(d.w>p.w||d.h>p.h)){if(d.x=p.x,d.y=p.y,l=Math.max(l,d.y+d.h),s=Math.max(s,d.x+d.w),d.w===p.w&&d.h===p.h){var f=a.pop();h<a.length&&(a[h]=f)}else d.h===p.h?(p.x+=d.w,p.w-=d.w):d.w===p.w?(p.y+=d.h,p.h-=d.h):(a.push({x:p.x+d.w,y:p.y,w:p.w-d.w,h:d.h}),p.y+=d.h,p.h-=d.h);break}}return{w:s,h:l,fill:t/(s*l)||0}}Xs.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),o=n>>3,i=this.pos;this.type=7&n,e(o,t,this),this.pos===i&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=dl(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=pl(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=dl(this.buf,this.pos)+4294967296*dl(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=dl(this.buf,this.pos)+4294967296*pl(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Ys(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Ys(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,o,i=r.buf;if(n=(112&(o=i[r.pos++]))>>4,o<128)return el(e,n,t);if(n|=(127&(o=i[r.pos++]))<<3,o<128)return el(e,n,t);if(n|=(127&(o=i[r.pos++]))<<10,o<128)return el(e,n,t);if(n|=(127&(o=i[r.pos++]))<<17,o<128)return el(e,n,t);if(n|=(127&(o=i[r.pos++]))<<24,o<128)return el(e,n,t);if(n|=(1&(o=i[r.pos++]))<<31,o<128)return el(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Js?function(e,t,r){return Js.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",o=t;o<r;){var i,a,s,l=e[o],c=null,u=l>239?4:l>223?3:l>191?2:1;if(o+u>r)break;1===u?l<128&&(c=l):2===u?128==(192&(i=e[o+1]))&&(c=(31&l)<<6|63&i)<=127&&(c=null):3===u?(a=e[o+2],128==(192&(i=e[o+1]))&&128==(192&a)&&((c=(15&l)<<12|(63&i)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(a=e[o+2],s=e[o+3],128==(192&(i=e[o+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),o+=u}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Xs.Bytes)return e.push(this.readVarint(t));var r=Qs(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Xs.Bytes)return e.push(this.readSVarint());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Xs.Bytes)return e.push(this.readBoolean());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Xs.Bytes)return e.push(this.readFloat());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Xs.Bytes)return e.push(this.readDouble());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Xs.Bytes)return e.push(this.readFixed32());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Xs.Bytes)return e.push(this.readSFixed32());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Xs.Bytes)return e.push(this.readFixed64());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Xs.Bytes)return e.push(this.readSFixed64());var t=Qs(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Xs.Varint)for(;this.buf[this.pos++]>127;);else if(t===Xs.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Xs.Fixed32)this.pos+=4;else{if(t!==Xs.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,o,i=0;i<t.length;i++){if((n=t.charCodeAt(i))>55295&&n<57344){if(!o){n>56319||i+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):o=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,o=n;continue}n=o-55296<<10|n-56320|65536,o=null}else o&&(e[r++]=239,e[r++]=191,e[r++]=189,o=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&tl(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),$s(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),$s(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&tl(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Xs.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,rl,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,nl,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,al,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,ol,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,il,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,sl,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,ll,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,cl,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,ul,t)},writeBytesField:function(e,t){this.writeTag(e,Xs.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Xs.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Xs.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Xs.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Xs.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Xs.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Xs.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Xs.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Xs.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Xs.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var vl=function(e,t){var r=t.pixelRatio,n=t.version,o=t.stretchX,i=t.stretchY,a=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=o,this.stretchY=i,this.content=a,this.version=n},yl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yl.tlbr.get=function(){return this.tl.concat(this.br)},yl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(vl.prototype,yl);var _l=function(e,t){var r={},n={};this.haveRenderCallbacks=[];var o=[];this.addImages(e,r,o),this.addImages(t,n,o);var i=bl(o),a=new ya({width:i.w||1,height:i.h||1});for(var s in e){var l=e[s],c=r[s].paddedRect;ya.copy(l.data,a,{x:0,y:0},{x:c.x+1,y:c.y+1},l.data)}for(var u in t){var d=t[u],h=n[u].paddedRect,p=h.x+1,f=h.y+1,m=d.data.width,g=d.data.height;ya.copy(d.data,a,{x:0,y:0},{x:p,y:f},d.data),ya.copy(d.data,a,{x:0,y:g-1},{x:p,y:f-1},{width:m,height:1}),ya.copy(d.data,a,{x:0,y:0},{x:p,y:f+g},{width:m,height:1}),ya.copy(d.data,a,{x:m-1,y:0},{x:p-1,y:f},{width:1,height:g}),ya.copy(d.data,a,{x:0,y:0},{x:p+m,y:f},{width:1,height:g})}this.image=a,this.iconPositions=r,this.patternPositions=n};_l.prototype.addImages=function(e,t,r){for(var n in e){var o=e[n],i={x:0,y:0,w:o.data.width+2,h:o.data.height+2};r.push(i),t[n]=new vl(i,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(n)}},_l.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},_l.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var n=e.tl;r.update(t.data,void 0,{x:n[0],y:n[1]})}},Nn("ImagePosition",vl),Nn("ImageAtlas",_l);var wl={horizontal:1,vertical:2,horizontalOnly:3},xl=function(){this.scale=1,this.fontStack="",this.imageName=null};xl.forText=function(e,t){var r=new xl;return r.scale=e||1,r.fontStack=t,r},xl.forImage=function(e){var t=new xl;return t.imageName=e,t};var kl=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Cl(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m){var g,b=kl.fromFeature(e,o);d===wl.vertical&&b.verticalizePunctuation();var v=ao.processBidirectionalText,y=ao.processStyledBidirectionalText;if(v&&1===b.sections.length){g=[];for(var _=0,w=v(b.toString(),Ol(b,c,i,t,n,p,f));_<w.length;_+=1){var x=w[_],k=new kl;k.text=x,k.sections=b.sections;for(var C=0;C<x.length;C++)k.sectionIndex.push(0);g.push(k)}}else if(y){g=[];for(var E=0,S=y(b.text,b.sectionIndex,Ol(b,c,i,t,n,p,f));E<S.length;E+=1){var T=S[E],A=new kl;A.text=T[0],A.sectionIndex=T[1],A.sections=b.sections,g.push(A)}}else g=function(e,t){for(var r=[],n=e.text,o=0,i=0,a=t;i<a.length;i+=1){var s=a[i];r.push(e.substring(o,s)),o=s}return o<n.length&&r.push(e.substring(o,n.length)),r}(b,Ol(b,c,i,t,n,p,f));var P=[],I={positionedLines:P,text:b.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(e,t,r,n,o,i,a,s,l,c,u,d){for(var h=0,p=-17,f=0,m=0,g="right"===s?1:"left"===s?0:.5,b=0,v=0,y=o;v<y.length;v+=1){var _=y[v];_.trim();var w=_.getMaxScale(),x=24*(w-1),k={positionedGlyphs:[],lineOffset:0};e.positionedLines[b]=k;var C=k.positionedGlyphs,E=0;if(_.length()){for(var S=0;S<_.length();S++){var T=_.getSection(S),A=_.getSectionIndex(S),P=_.getCharCode(S),I=0,O=null,M=null,D=null,z=24,j=!(l===wl.horizontal||!u&&!Zn(P)||u&&(El[P]||(H=P,Wn.Arabic(H)||Wn["Arabic Supplement"](H)||Wn["Arabic Extended-A"](H)||Wn["Arabic Presentation Forms-A"](H)||Wn["Arabic Presentation Forms-B"](H))));if(T.imageName){var R=n[T.imageName];if(!R)continue;D=T.imageName,e.iconsInText=e.iconsInText||!0,M=R.paddedRect;var L=R.displaySize;T.scale=24*T.scale/d,I=x+(24-L[1]*T.scale),z=(O={width:L[0],height:L[1],left:1,top:-3,advance:j?L[1]:L[0]}).advance;var N=j?L[0]*T.scale-24*w:L[1]*T.scale-24*w;N>0&&N>E&&(E=N)}else{var B=r[T.fontStack],F=B&&B[P];if(F&&F.rect)M=F.rect,O=F.metrics;else{var V=t[T.fontStack],U=V&&V[P];if(!U)continue;O=U.metrics}I=24*(w-T.scale)}j?(e.verticalizable=!0,C.push({glyph:P,imageName:D,x:h,y:p+I,vertical:j,scale:T.scale,fontStack:T.fontStack,sectionIndex:A,metrics:O,rect:M}),h+=z*T.scale+c):(C.push({glyph:P,imageName:D,x:h,y:p+I,vertical:j,scale:T.scale,fontStack:T.fontStack,sectionIndex:A,metrics:O,rect:M}),h+=O.advance*T.scale+c)}0!==C.length&&(f=Math.max(h-c,f),Dl(C,0,C.length-1,g,E)),h=0;var q=i*w+E;k.lineOffset=Math.max(E,x),p+=q,m=Math.max(q,m),++b}else p+=i,++b}var H,W=p- -17,G=Ml(a),Z=G.horizontalAlign,Y=G.verticalAlign;(function(e,t,r,n,o,i,a,s,l){var c,u=(t-r)*o;c=i!==a?-s*n- -17:(-n*l+.5)*a;for(var d=0,h=e;d<h.length;d+=1)for(var p=0,f=h[d].positionedGlyphs;p<f.length;p+=1){var m=f[p];m.x+=u,m.y+=c}})(e.positionedLines,g,Z,Y,f,m,i,W,o.length),e.top+=-Y*W,e.bottom=e.top+W,e.left+=-Z*f,e.right=e.left+f}(I,t,r,n,g,a,s,l,d,c,h,m),!function(e){for(var t=0,r=e;t<r.length;t+=1)if(0!==r[t].positionedGlyphs.length)return!1;return!0}(P)&&I}kl.fromFeature=function(e,t){for(var r=new kl,n=0;n<e.sections.length;n++){var o=e.sections[n];o.image?r.addImageSection(o):r.addTextSection(o,t)}return r},kl.prototype.length=function(){return this.text.length},kl.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},kl.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},kl.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},kl.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r+1)||null,o=e.charCodeAt(r-1)||null;t+=n&&Yn(n)&&!Zs[e[r+1]]||o&&Yn(o)&&!Zs[e[r-1]]||!Zs[e[r]]?e[r]:Zs[e[r]]}return t}(this.text)},kl.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&El[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=e&&El[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},kl.prototype.substring=function(e,t){var r=new kl;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},kl.prototype.toString=function(){return this.text},kl.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce((function(t,r){return Math.max(t,e.sections[r].scale)}),0)},kl.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(xl.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,n=0;n<e.text.length;++n)this.sectionIndex.push(r)},kl.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(xl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}else k("Can't add FormattedSection with an empty image.")},kl.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var El={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Sl={};function Tl(e,t,r,n,o,i){if(t.imageName){var a=n[t.imageName];return a?a.displaySize[0]*t.scale*24/i+o:0}var s=r[t.fontStack],l=s&&s[e];return l?l.metrics.advance*t.scale+o:0}function Al(e,t,r,n){var o=Math.pow(e-t,2);return n?e<t?o/2:2*o:o+Math.abs(r)*r}function Pl(e,t,r){var n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function Il(e,t,r,n,o,i){for(var a=null,s=Al(t,r,o,i),l=0,c=n;l<c.length;l+=1){var u=c[l],d=Al(t-u.x,r,o,i)+u.badness;d<=s&&(a=u,s=d)}return{index:e,x:t,priorBreak:a,badness:s}}function Ol(e,t,r,n,o,i,a){if("point"!==i)return[];if(!e)return[];for(var s,l=[],c=function(e,t,r,n,o,i){for(var a=0,s=0;s<e.length();s++){var l=e.getSection(s);a+=Tl(e.getCharCode(s),l,n,o,t,i)}return a/Math.max(1,Math.ceil(a/r))}(e,t,r,n,o,a),u=e.text.indexOf("")>=0,d=0,h=0;h<e.length();h++){var p=e.getSection(h),f=e.getCharCode(h);if(El[f]||(d+=Tl(f,p,n,o,t,a)),h<e.length()-1){var m=!((s=f)<11904||!(Wn["Bopomofo Extended"](s)||Wn.Bopomofo(s)||Wn["CJK Compatibility Forms"](s)||Wn["CJK Compatibility Ideographs"](s)||Wn["CJK Compatibility"](s)||Wn["CJK Radicals Supplement"](s)||Wn["CJK Strokes"](s)||Wn["CJK Symbols and Punctuation"](s)||Wn["CJK Unified Ideographs Extension A"](s)||Wn["CJK Unified Ideographs"](s)||Wn["Enclosed CJK Letters and Months"](s)||Wn["Halfwidth and Fullwidth Forms"](s)||Wn.Hiragana(s)||Wn["Ideographic Description Characters"](s)||Wn["Kangxi Radicals"](s)||Wn["Katakana Phonetic Extensions"](s)||Wn.Katakana(s)||Wn["Vertical Forms"](s)||Wn["Yi Radicals"](s)||Wn["Yi Syllables"](s)));(Sl[f]||m||p.imageName)&&l.push(Il(h+1,d,c,l,Pl(f,e.getCharCode(h+1),m&&u),!1))}}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(Il(e.length(),d,c,l,0,!0))}function Ml(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Dl(e,t,r,n,o){if(n||o)for(var i=e[r],a=(e[r].x+i.metrics.advance*i.scale)*n,s=t;s<=r;s++)e[s].x-=a,e[s].y+=o}function zl(e,t,r,n,o,i){var a,s=e.image;if(s.content){var l=s.content,c=s.pixelRatio||1;a=[l[0]/c,l[1]/c,s.displaySize[0]-l[2]/c,s.displaySize[1]-l[3]/c]}var u,d,h,p,f=t.left*i,m=t.right*i;"width"===r||"both"===r?(p=o[0]+f-n[3],d=o[0]+m+n[1]):d=(p=o[0]+(f+m-s.displaySize[0])/2)+s.displaySize[0];var g=t.top*i,b=t.bottom*i;return"height"===r||"both"===r?(u=o[1]+g-n[0],h=o[1]+b+n[2]):h=(u=o[1]+(g+b-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:u,right:d,bottom:h,left:p,collisionPadding:a}}Sl[10]=!0,Sl[32]=!0,Sl[38]=!0,Sl[40]=!0,Sl[41]=!0,Sl[43]=!0,Sl[45]=!0,Sl[47]=!0,Sl[173]=!0,Sl[183]=!0,Sl[8203]=!0,Sl[8208]=!0,Sl[8211]=!0,Sl[8231]=!0;var jl=function(e){function t(t,r,n,o){e.call(this,t,r),this.angle=n,void 0!==o&&(this.segment=o)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(o);function Rl(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new so(e+1))};if("source"===r.kind)return{kind:"source"};for(var n=r.zoomStops,o=r.interpolationType,i=0;i<n.length&&n[i]<=e;)i++;for(var a=i=Math.max(0,i-1);a<n.length&&n[a]<e+1;)a++;a=Math.min(n.length-1,a);var s=n[i],l=n[a];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:o}:{kind:"camera",minZoom:s,maxZoom:l,minSize:r.evaluate(new so(s)),maxSize:r.evaluate(new so(l)),interpolationType:o}}function Ll(e,t,r){var n=t.uSize,o=r.lowerSize;return"source"===e.kind?o/128:"composite"===e.kind?Ht(o/128,r.upperSize/128,t.uSizeT):n}function Nl(e,t){var r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){var o=e.interpolationType,i=o?u(ir.interpolationFactor(o,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?n=Ht(e.minSize,e.maxSize,i):r=i}return{uSizeT:r,uSize:n}}Nn("Anchor",jl);var Bl=Object.freeze({__proto__:null,getSizeData:Rl,evaluateSizeForFeature:Ll,evaluateSizeForZoom:Nl,SIZE_PACK_FACTOR:128});function Fl(e,t,r,n,o){if(void 0===t.segment)return!0;for(var i=t,a=t.segment+1,s=0;s>-r/2;){if(--a<0)return!1;s-=e[a].dist(i),i=e[a]}s+=e[a].dist(e[a+1]),a++;for(var l=[],c=0;s<r/2;){var u=e[a],d=e[a+1];if(!d)return!1;var h=e[a-1].angleTo(u)-u.angleTo(d);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:h}),c+=h;s-l[0].distance>n;)c-=l.shift().angleDelta;if(c>o)return!1;a++,s+=u.dist(d)}return!0}function Vl(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Ul(e,t,r){return e?.6*t*r:0}function ql(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Hl(e,t,r,n,o,i){for(var a=Ul(r,o,i),s=ql(r,n)*i,l=0,c=Vl(e)/2,u=0;u<e.length-1;u++){var d=e[u],h=e[u+1],p=d.dist(h);if(l+p>c){var f=(c-l)/p,m=Ht(d.x,h.x,f),g=Ht(d.y,h.y,f),b=new jl(m,g,h.angleTo(d),u);return b._round(),!a||Fl(e,b,s,a,t)?b:void 0}l+=p}}function Wl(e,t,r,n,o,i,a,s,l){var c=Ul(n,i,a),u=ql(n,o),d=u*a,h=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-d<t/4&&(t=d+t/4),function e(t,r,n,o,i,a,s,l,c){for(var u=a/2,d=Vl(t),h=0,p=r-n,f=[],m=0;m<t.length-1;m++){for(var g=t[m],b=t[m+1],v=g.dist(b),y=b.angleTo(g);p+n<h+v;){var _=((p+=n)-h)/v,w=Ht(g.x,b.x,_),x=Ht(g.y,b.y,_);if(w>=0&&w<c&&x>=0&&x<c&&p-u>=0&&p+u<=d){var k=new jl(w,x,y,m);k._round(),o&&!Fl(t,k,a,o,i)||f.push(k)}}h+=v}return l||f.length||s||(f=e(t,h/2,n,o,i,a,s,!0,c)),f}(e,h?t/2*s%t:(u/2+2*i)*a*s%t,t,c,r,d,h,!1,l)}function Gl(e,t,r,n,i){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],c=void 0,u=0;u<l.length-1;u++){var d=l[u],h=l[u+1];d.x<t&&h.x<t||(d.x<t?d=new o(t,d.y+(t-d.x)/(h.x-d.x)*(h.y-d.y))._round():h.x<t&&(h=new o(t,d.y+(t-d.x)/(h.x-d.x)*(h.y-d.y))._round()),d.y<r&&h.y<r||(d.y<r?d=new o(d.x+(r-d.y)/(h.y-d.y)*(h.x-d.x),r)._round():h.y<r&&(h=new o(d.x+(r-d.y)/(h.y-d.y)*(h.x-d.x),r)._round()),d.x>=n&&h.x>=n||(d.x>=n?d=new o(n,d.y+(n-d.x)/(h.x-d.x)*(h.y-d.y))._round():h.x>=n&&(h=new o(n,d.y+(n-d.x)/(h.x-d.x)*(h.y-d.y))._round()),d.y>=i&&h.y>=i||(d.y>=i?d=new o(d.x+(i-d.y)/(h.y-d.y)*(h.x-d.x),i)._round():h.y>=i&&(h=new o(d.x+(i-d.y)/(h.y-d.y)*(h.x-d.x),i)._round()),c&&d.equals(c[c.length-1])||a.push(c=[d]),c.push(h)))))}return a}function Zl(e,t,r,n){var i=[],a=e.image,s=a.pixelRatio,l=a.paddedRect.w-2,c=a.paddedRect.h-2,u=e.right-e.left,d=e.bottom-e.top,h=a.stretchX||[[0,l]],p=a.stretchY||[[0,c]],f=function(e,t){return e+t[1]-t[0]},m=h.reduce(f,0),g=p.reduce(f,0),b=l-m,v=c-g,y=0,_=m,w=0,x=g,k=0,C=b,E=0,S=v;if(a.content&&n){var T=a.content;y=Yl(h,0,T[0]),w=Yl(p,0,T[1]),_=Yl(h,T[0],T[2]),x=Yl(p,T[1],T[3]),k=T[0]-y,E=T[1]-w,C=T[2]-T[0]-_,S=T[3]-T[1]-x}var A=function(n,i,l,c){var h=Kl(n.stretch-y,_,u,e.left),p=Xl(n.fixed-k,C,n.stretch,m),f=Kl(i.stretch-w,x,d,e.top),b=Xl(i.fixed-E,S,i.stretch,g),v=Kl(l.stretch-y,_,u,e.left),T=Xl(l.fixed-k,C,l.stretch,m),A=Kl(c.stretch-w,x,d,e.top),P=Xl(c.fixed-E,S,c.stretch,g),I=new o(h,f),O=new o(v,f),M=new o(v,A),D=new o(h,A),z=new o(p/s,b/s),j=new o(T/s,P/s),R=t*Math.PI/180;if(R){var L=Math.sin(R),N=Math.cos(R),B=[N,-L,L,N];I._matMult(B),O._matMult(B),D._matMult(B),M._matMult(B)}var F=n.stretch+n.fixed,V=i.stretch+i.fixed;return{tl:I,tr:O,bl:D,br:M,tex:{x:a.paddedRect.x+1+F,y:a.paddedRect.y+1+V,w:l.stretch+l.fixed-F,h:c.stretch+c.fixed-V},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:j,minFontScaleX:C/s/u,minFontScaleY:S/s/d,isSDF:r}};if(n&&(a.stretchX||a.stretchY))for(var P=$l(h,b,m),I=$l(p,v,g),O=0;O<P.length-1;O++)for(var M=P[O],D=P[O+1],z=0;z<I.length-1;z++)i.push(A(M,I[z],D,I[z+1]));else i.push(A({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return i}function Yl(e,t,r){for(var n=0,o=0,i=e;o<i.length;o+=1){var a=i[o];n+=Math.max(t,Math.min(r,a[1]))-Math.max(t,Math.min(r,a[0]))}return n}function $l(e,t,r){for(var n=[{fixed:-1,stretch:0}],o=0,i=e;o<i.length;o+=1){var a=i[o],s=a[0],l=a[1],c=n[n.length-1];n.push({fixed:s-c.stretch,stretch:c.stretch}),n.push({fixed:s-c.stretch,stretch:c.stretch+(l-s)})}return n.push({fixed:t+1,stretch:r}),n}function Kl(e,t,r,n){return e/t*r+n}function Xl(e,t,r,n){return e-t*r/n}var Jl=function(e,t,r,n,i,a,s,l,c,u){if(this.boxStartIndex=e.length,c){var d=a.top,h=a.bottom,p=a.collisionPadding;p&&(d-=p[1],h+=p[3]);var f=h-d;f>0&&(f=Math.max(10,f),this.circleDiameter=f)}else{var m=a.top*s-l,g=a.bottom*s+l,b=a.left*s-l,v=a.right*s+l,y=a.collisionPadding;if(y&&(b-=y[0]*s,m-=y[1]*s,v+=y[2]*s,g+=y[3]*s),u){var _=new o(b,m),w=new o(v,m),x=new o(b,g),k=new o(v,g),C=u*Math.PI/180;_._rotate(C),w._rotate(C),x._rotate(C),k._rotate(C),b=Math.min(_.x,w.x,x.x,k.x),v=Math.max(_.x,w.x,x.x,k.x),m=Math.min(_.y,w.y,x.y,k.y),g=Math.max(_.y,w.y,x.y,k.y)}e.emplaceBack(t.x,t.y,b,m,v,g,r,n,i)}this.boxEndIndex=e.length},Ql=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=ec),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function ec(e,t){return e<t?-1:e>t?1:0}function tc(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var n=1/0,i=1/0,a=-1/0,s=-1/0,l=e[0],c=0;c<l.length;c++){var u=l[c];(!c||u.x<n)&&(n=u.x),(!c||u.y<i)&&(i=u.y),(!c||u.x>a)&&(a=u.x),(!c||u.y>s)&&(s=u.y)}var d=Math.min(a-n,s-i),h=d/2,p=new Ql([],rc);if(0===d)return new o(n,i);for(var f=n;f<a;f+=d)for(var m=i;m<s;m+=d)p.push(new nc(f+h,m+h,h,e));for(var g=function(e){for(var t=0,r=0,n=0,o=e[0],i=0,a=o.length,s=a-1;i<a;s=i++){var l=o[i],c=o[s],u=l.x*c.y-c.x*l.y;r+=(l.x+c.x)*u,n+=(l.y+c.y)*u,t+=3*u}return new nc(r/t,n/t,0,e)}(e),b=p.length;p.length;){var v=p.pop();(v.d>g.d||!g.d)&&(g=v,r&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,b)),v.max-g.d<=t||(p.push(new nc(v.p.x-(h=v.h/2),v.p.y-h,h,e)),p.push(new nc(v.p.x+h,v.p.y-h,h,e)),p.push(new nc(v.p.x-h,v.p.y+h,h,e)),p.push(new nc(v.p.x+h,v.p.y+h,h,e)),b+=4)}return r&&(console.log("num probes: "+b),console.log("best distance: "+g.d)),g.p}function rc(e,t){return t.max-e.max}function nc(e,t,r,n){this.p=new o(e,t),this.h=r,this.d=function(e,t){for(var r=!1,n=1/0,o=0;o<t.length;o++)for(var i=t[o],a=0,s=i.length,l=s-1;a<s;l=a++){var c=i[a],u=i[l];c.y>e.y!=u.y>e.y&&e.x<(u.x-c.x)*(e.y-c.y)/(u.y-c.y)+c.x&&(r=!r),n=Math.min(n,Xi(e,c,u))}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}Ql.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Ql.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Ql.prototype.peek=function(){return this.data[0]},Ql.prototype._up=function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var o=e-1>>1,i=t[o];if(r(n,i)>=0)break;t[e]=i,e=o}t[e]=n},Ql.prototype._down=function(e){for(var t=this.data,r=this.compare,n=this.length>>1,o=t[e];e<n;){var i=1+(e<<1),a=t[i],s=i+1;if(s<this.length&&r(t[s],a)<0&&(i=s,a=t[s]),r(a,o)>=0)break;t[e]=a,e=i}t[e]=o};var oc=Number.POSITIVE_INFINITY;function ic(e,t){return t[1]!==oc?function(e,t,r){var n=0,o=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":o=r-7;break;case"bottom-right":case"bottom-left":case"bottom":o=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,o]}(e,t[0],t[1]):function(e,t){var r=0,n=0;t<0&&(t=0);var o=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":n=o-7;break;case"bottom-right":case"bottom-left":n=7-o;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-o;break;case"top-left":case"bottom-left":r=o;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function ac(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sc(e,t,r,n,i,a,s,l,c,u,d,h,p,f,m){var g=function(e,t,r,n,i,a,s,l){for(var c=n.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,u=[],d=0,h=t.positionedLines;d<h.length;d+=1)for(var p=h[d],f=0,m=p.positionedGlyphs;f<m.length;f+=1){var g=m[f];if(g.rect){var b=g.rect||{},v=4,y=!0,_=1,w=0,x=(i||l)&&g.vertical,k=g.metrics.advance*g.scale/2;if(l&&t.verticalizable&&(w=p.lineOffset/2-(g.imageName?-(24-g.metrics.width*g.scale)/2:24*(g.scale-1))),g.imageName){var C=s[g.imageName];y=C.sdf,v=1/(_=C.pixelRatio)}var E=i?[g.x+k,g.y]:[0,0],S=i?[0,0]:[g.x+k+r[0],g.y+r[1]-w],T=[0,0];x&&(T=S,S=[0,0]);var A=(g.metrics.left-v)*g.scale-k+S[0],P=(-g.metrics.top-v)*g.scale+S[1],I=A+b.w*g.scale/_,O=P+b.h*g.scale/_,M=new o(A,P),D=new o(I,P),z=new o(A,O),j=new o(I,O);if(x){var R=new o(-k,k- -17),L=-Math.PI/2,N=12-k,B=new o(22-N,-(g.imageName?N:0)),F=new(Function.prototype.bind.apply(o,[null].concat(T)));M._rotateAround(L,R)._add(B)._add(F),D._rotateAround(L,R)._add(B)._add(F),z._rotateAround(L,R)._add(B)._add(F),j._rotateAround(L,R)._add(B)._add(F)}if(c){var V=Math.sin(c),U=Math.cos(c),q=[U,-V,V,U];M._matMult(q),D._matMult(q),z._matMult(q),j._matMult(q)}var H=new o(0,0),W=new o(0,0);u.push({tl:M,tr:D,bl:z,br:j,tex:b,writingMode:t.writingMode,glyphOffset:E,sectionIndex:g.sectionIndex,isSDF:y,pixelOffsetTL:H,pixelOffsetBR:W,minFontScaleX:0,minFontScaleY:0})}}return u}(0,r,l,i,a,s,n,e.allowVerticalPlacement),b=e.textSizeData,v=null;"source"===b.kind?(v=[128*i.layout.get("text-size").evaluate(s,{})])[0]>32640&&k(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===b.kind&&((v=[128*f.compositeTextSizes[0].evaluate(s,{},m),128*f.compositeTextSizes[1].evaluate(s,{},m)])[0]>32640||v[1]>32640)&&k(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,g,v,l,a,s,u,t,c.lineStartIndex,c.lineLength,p,m);for(var y=0,_=d;y<_.length;y+=1)h[_[y]]=e.text.placedSymbolArray.length-1;return 4*g.length}function lc(e){for(var t in e)return e[t];return null}function cc(e,t,r,n){var o=e.compareText;if(t in o){for(var i=o[t],a=i.length-1;a>=0;a--)if(n.dist(i[a])<r)return!0}else o[t]=[];return o[t].push(n),!1}var uc=_s.VectorTileFeature.types,dc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hc(e,t,r,n,o,i,a,s,l,c,u,d,h){var p=s?Math.min(32640,Math.round(s[0])):0,f=s?Math.min(32640,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*o),i,a,(p<<1)+(l?1:0),f,16*c,16*u,256*d,256*h)}function pc(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function fc(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Xn(r[t].text))return!0;return!1}var mc=function(e){this.layoutVertexArray=new jo,this.indexArray=new Uo,this.programConfigurations=e,this.segments=new li,this.dynamicLayoutVertexArray=new Ro,this.opacityVertexArray=new Lo,this.placedSymbolArray=new ei};mc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},mc.prototype.upload=function(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vs.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Us.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,dc,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))},mc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Nn("SymbolBuffers",mc);var gc=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new li,this.collisionVertexArray=new Vo};gc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,qs.members,!0)},gc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Nn("CollisionBuffers",gc);var bc=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sa([]),this.placementViewportMatrix=sa([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Rl(this.zoom,t["text-size"]),this.iconSizeData=Rl(this.zoom,t["icon-size"]);var r=this.layers[0].layout,n=r.get("symbol-sort-key"),o=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==o&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((function(e){return wl[e]}))),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=e.sourceID};bc.prototype.createArrays=function(){this.text=new mc(new ji(this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new mc(new ji(this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new ni,this.lineVertexArray=new oi,this.symbolInstances=new ri},bc.prototype.calculateGlyphDependencies=function(e,t,r,n,o){for(var i=0;i<e.length;i++)if(t[e.charCodeAt(i)]=!0,(r||n)&&o){var a=Zs[e.charAt(i)];a&&(t[a.charCodeAt(0)]=!0)}},bc.prototype.populate=function(e,t,r){var n=this.layers[0],o=n.layout,i=o.get("text-font"),a=o.get("text-field"),s=o.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof nt&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),c="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,u=o.get("symbol-sort-key");if(this.features=[],l||c){for(var d=t.iconDependencies,h=t.glyphDependencies,p=t.availableImages,f=new so(this.zoom),m=0,g=e;m<g.length;m+=1){var b=g[m],v=b.feature,y=b.id,_=b.index,w=b.sourceLayerIndex,x=n._featureFilter.needGeometry,k=Vi(v,x);if(n._featureFilter.filter(f,k,r)){x||(k.geometry=Fi(v));var C=void 0;if(l){var E=n.getValueAndResolveTokens("text-field",k,r,p),S=nt.factory(E);fc(S)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===oo()||this.hasRTLText&&ao.isParsed())&&(C=Gs(S,n,k))}var T=void 0;if(c){var A=n.getValueAndResolveTokens("icon-image",k,r,p);T=A instanceof ot?A:ot.fromString(A)}if(C||T){var P=this.sortFeaturesByKey?u.evaluate(k,{},r):void 0;if(this.features.push({id:y,text:C,icon:T,index:_,sourceLayerIndex:w,geometry:k.geometry,properties:v.properties,type:uc[v.type],sortKey:P}),T&&(d[T.name]=!0),C){var I=i.evaluate(k,{},r).join(","),O="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wl.vertical)>=0;for(var M=0,D=C.sections;M<D.length;M+=1){var z=D[M];if(z.image)d[z.image.name]=!0;else{var j=Gn(C.toString()),R=z.fontStack||I,L=h[R]=h[R]||{};this.calculateGlyphDependencies(z.text,L,O,this.allowVerticalPlacement,j)}}}}}}"line"===o.get("symbol-placement")&&(this.features=function(e){var t={},r={},n=[],o=0;function i(t){n.push(e[t]),o++}function a(e,t,o){var i=r[e];return delete r[e],r[t]=i,n[i].geometry[0].pop(),n[i].geometry[0]=n[i].geometry[0].concat(o[0]),i}function s(e,r,o){var i=t[r];return delete t[r],t[e]=i,n[i].geometry[0].shift(),n[i].geometry[0]=o[0].concat(n[i].geometry[0]),i}function l(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return e+":"+n.x+":"+n.y}for(var c=0;c<e.length;c++){var u=e[c],d=u.geometry,h=u.text?u.text.toString():null;if(h){var p=l(h,d),f=l(h,d,!0);if(p in r&&f in t&&r[p]!==t[f]){var m=s(p,f,d),g=a(p,f,n[m].geometry);delete t[p],delete r[f],r[l(h,n[g].geometry,!0)]=g,n[m].geometry=null}else p in r?a(p,f,d):f in t?s(p,f,d):(i(c),t[p]=o-1,r[f]=o-1)}else i(c)}return n.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}},bc.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},bc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},bc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},bc.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},bc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},bc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},bc.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var n=e.dist(t[e.segment+1]),o=e.dist(t[e.segment]),i={},a=e.segment+1;a<t.length;a++)i[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:n},a<t.length-1&&(n+=t[a+1].dist(t[a]));for(var s=e.segment||0;s>=0;s--)i[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=t[s-1].dist(t[s]));for(var l=0;l<t.length;l++){var c=i[l];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},bc.prototype.addSymbols=function(e,t,r,n,o,i,a,s,l,c,u,d){for(var h=e.indexArray,p=e.layoutVertexArray,f=e.segments.prepareSegment(4*t.length,p,h,this.canOverlap?i.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,b=this.allowVerticalPlacement&&a===wl.vertical?Math.PI/2:0,v=i.text&&i.text.sections,y=0;y<t.length;y++){var _=t[y],w=_.tl,x=_.tr,k=_.bl,C=_.br,E=_.tex,S=_.pixelOffsetTL,T=_.pixelOffsetBR,A=_.minFontScaleX,P=_.minFontScaleY,I=_.glyphOffset,O=_.isSDF,M=_.sectionIndex,D=f.vertexLength,z=I[1];hc(p,s.x,s.y,w.x,z+w.y,E.x,E.y,r,O,S.x,S.y,A,P),hc(p,s.x,s.y,x.x,z+x.y,E.x+E.w,E.y,r,O,T.x,S.y,A,P),hc(p,s.x,s.y,k.x,z+k.y,E.x,E.y+E.h,r,O,S.x,T.y,A,P),hc(p,s.x,s.y,C.x,z+C.y,E.x+E.w,E.y+E.h,r,O,T.x,T.y,A,P),pc(e.dynamicLayoutVertexArray,s,b),h.emplaceBack(D,D+1,D+2),h.emplaceBack(D+1,D+2,D+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(I[0]),y!==t.length-1&&M===t[y+1].sectionIndex||e.programConfigurations.populatePaintArrays(p.length,i,i.index,{},d,v&&v[M])}e.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,g,l,c,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,0,!1,0,u)},bc.prototype._addCollisionDebugVertex=function(e,t,r,n,o,i){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,o,Math.round(i.x),Math.round(i.y))},bc.prototype.addCollisionDebugVertices=function(e,t,r,n,i,a,s){var l=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),c=l.vertexLength,u=i.layoutVertexArray,d=i.collisionVertexArray,h=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,d,a,h,p,new o(e,t)),this._addCollisionDebugVertex(u,d,a,h,p,new o(r,t)),this._addCollisionDebugVertex(u,d,a,h,p,new o(r,n)),this._addCollisionDebugVertex(u,d,a,h,p,new o(e,n)),l.vertexLength+=4;var f=i.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4},bc.prototype.addDebugCollisionBoxes=function(e,t,r,n){for(var o=e;o<t;o++){var i=this.collisionBoxArray.get(o);this.addCollisionDebugVertices(i.x1,i.y1,i.x2,i.y2,n?this.textCollisionBox:this.iconCollisionBox,i.anchorPoint,r)}},bc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gc(Bo,Hs.members,Yo),this.iconCollisionBox=new gc(Bo,Hs.members,Yo);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},bc.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,n,o,i,a,s,l){for(var c={},u=t;u<r;u++){var d=e.get(u);c.textBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.textFeatureIndex=d.featureIndex;break}for(var h=n;h<o;h++){var p=e.get(h);c.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},c.verticalTextFeatureIndex=p.featureIndex;break}for(var f=i;f<a;f++){var m=e.get(f);c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},c.iconFeatureIndex=m.featureIndex;break}for(var g=s;g<l;g++){var b=e.get(g);c.verticalIconBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},c.verticalIconFeatureIndex=b.featureIndex;break}return c},bc.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},bc.prototype.hasTextData=function(){return this.text.segments.get().length>0},bc.prototype.hasIconData=function(){return this.icon.segments.get().length>0},bc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},bc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},bc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},bc.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs,o=r.vertexStartIndex;o<n;o+=4)e.indexArray.emplaceBack(o,o+1,o+2),e.indexArray.emplaceBack(o+1,o+2,o+3)},bc.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),n=[],o=[],i=[],a=0;a<this.symbolInstances.length;++a){i.push(a);var s=this.symbolInstances.get(a);n.push(0|Math.round(t*s.anchorX+r*s.anchorY)),o.push(s.featureIndex)}return i.sort((function(e,t){return n[e]-n[t]||o[t]-o[e]})),i},bc.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},bc.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,n=this.symbolInstanceIndexes;r<n.length;r+=1){var o=this.symbolInstances.get(n[r]);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(e,r,n){e>=0&&n.indexOf(e)===r&&t.addIndicesForPlacedSymbol(t.text,e)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Nn("SymbolBucket",bc,{omit:["layers","collisionBoxArray","features","compareText"]}),bc.MAX_GLYPHS=65535,bc.addDynamicAttributes=pc;var vc=new xo({"symbol-placement":new bo(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new bo(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bo(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new vo(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bo(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bo(Pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new bo(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new bo(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bo(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new vo(Pe.layout_symbol["icon-size"]),"icon-text-fit":new bo(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bo(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new vo(Pe.layout_symbol["icon-image"]),"icon-rotate":new vo(Pe.layout_symbol["icon-rotate"]),"icon-padding":new bo(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new bo(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new vo(Pe.layout_symbol["icon-offset"]),"icon-anchor":new vo(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bo(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bo(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bo(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new vo(Pe.layout_symbol["text-field"]),"text-font":new vo(Pe.layout_symbol["text-font"]),"text-size":new vo(Pe.layout_symbol["text-size"]),"text-max-width":new vo(Pe.layout_symbol["text-max-width"]),"text-line-height":new bo(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new vo(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new vo(Pe.layout_symbol["text-justify"]),"text-radial-offset":new vo(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bo(Pe.layout_symbol["text-variable-anchor"]),"text-anchor":new vo(Pe.layout_symbol["text-anchor"]),"text-max-angle":new bo(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new bo(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new vo(Pe.layout_symbol["text-rotate"]),"text-padding":new bo(Pe.layout_symbol["text-padding"]),"text-keep-upright":new bo(Pe.layout_symbol["text-keep-upright"]),"text-transform":new vo(Pe.layout_symbol["text-transform"]),"text-offset":new vo(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new bo(Pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new bo(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new bo(Pe.layout_symbol["text-optional"])}),yc={paint:new xo({"icon-opacity":new vo(Pe.paint_symbol["icon-opacity"]),"icon-color":new vo(Pe.paint_symbol["icon-color"]),"icon-halo-color":new vo(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new vo(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new vo(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new bo(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new bo(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new vo(Pe.paint_symbol["text-opacity"]),"text-color":new vo(Pe.paint_symbol["text-color"],{runtimeType:Ve,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new vo(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new vo(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new vo(Pe.paint_symbol["text-halo-blur"]),"text-translate":new bo(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new bo(Pe.paint_symbol["text-translate-anchor"])}),layout:vc},_c=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Le,this.defaultValue=e};_c.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},_c.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},_c.prototype.outputDefined=function(){return!1},_c.prototype.serialize=function(){return null},Nn("FormatSectionOverride",_c,{omit:["defaultValue"]});var wc=function(e){function t(t){e.call(this,t,yc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,r){if(e.prototype.recalculate.call(this,t,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var n=this.layout.get("text-writing-mode");if(n){for(var o=[],i=0,a=n;i<a.length;i+=1){var s=a[i];o.indexOf(s)<0&&o.push(s)}this.layout._values["text-writing-mode"]=o}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(e,t,r,n){var o=this.layout.get(e).evaluate(t,{},r,n),i=this._unevaluatedLayout._values[e];return i.isDataDriven()||Wr(i.value)||!o?o:function(e,t){return t.replace(/{([^{}]+)}/g,(function(t,r){return r in e?String(e[r]):""}))}(t.properties,o)},t.prototype.createBucket=function(e){return new bc(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var e=0,r=yc.paint.overridableProperties;e<r.length;e+=1){var n=r[e];if(t.hasPaintOverride(this.layout,n)){var o,i=this.paint.get(n),a=new _c(i),s=new Hr(a,i.property.specification);o="constant"===i.value.kind||"source"===i.value.kind?new Zr("source",s):new Yr("composite",s,i.value.zoomStops,i.value._interpolationType),this.paint._values[n]=new mo(i.property,o,i.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(e,r,n){return!(!this.layout||r.isDataDriven()||n.isDataDriven())&&t.hasPaintOverride(this.layout,e)},t.hasPaintOverride=function(e,t){var r=e.get("text-field"),n=yc.paint.properties[t],o=!1,i=function(e){for(var t=0,r=e;t<r.length;t+=1)if(n.overrides&&n.overrides.hasOverride(r[t]))return void(o=!0)};if("constant"===r.value.kind&&r.value.value instanceof nt)i(r.value.value.sections);else if("source"===r.value.kind){var a=function(e){o||(e instanceof ct&&st(e.value)===We?i(e.value.sections):e instanceof pt?i(e.sections):e.eachChild(a))},s=r.value;s._styleExpression&&a(s._styleExpression.expression)}return o},t}(ko),xc={paint:new xo({"background-color":new bo(Pe.paint_background["background-color"]),"background-pattern":new _o(Pe.paint_background["background-pattern"]),"background-opacity":new bo(Pe.paint_background["background-opacity"])})},kc=function(e){function t(t){e.call(this,t,xc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ko),Cc={paint:new xo({"raster-opacity":new bo(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new bo(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bo(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bo(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new bo(Pe.paint_raster["raster-saturation"]),"raster-contrast":new bo(Pe.paint_raster["raster-contrast"]),"raster-resampling":new bo(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new bo(Pe.paint_raster["raster-fade-duration"])})},Ec=function(e){function t(t){e.call(this,t,Cc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ko),Sc=function(e){function t(t){e.call(this,t,{}),this.implementation=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},t.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},t}(ko),Tc={circle:ha,heatmap:xa,hillshade:Ca,fill:us,"fill-extrusion":Ts,line:Bs,symbol:wc,background:kc,raster:Ec},Ac=a.HTMLImageElement,Pc=a.HTMLCanvasElement,Ic=a.HTMLVideoElement,Oc=a.ImageData,Mc=a.ImageBitmap,Dc=function(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)};Dc.prototype.update=function(e,t,r){var n=e.width,o=e.height,i=!(this.size&&this.size[0]===n&&this.size[1]===o||r),a=this.context,s=a.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),i)this.size=[n,o],e instanceof Ac||e instanceof Pc||e instanceof Ic||e instanceof Oc||Mc&&e instanceof Mc?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,n,o,0,this.format,s.UNSIGNED_BYTE,e.data);else{var l=r||{x:0,y:0},c=l.x,u=l.y;e instanceof Ac||e instanceof Pc||e instanceof Ic||e instanceof Oc||Mc&&e instanceof Mc?s.texSubImage2D(s.TEXTURE_2D,0,c,u,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,c,u,n,o,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Dc.prototype.bind=function(e,t,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)},Dc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Dc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var zc=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};zc.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))},zc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jc=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},b(["receive","process"],this),this.invoker=new zc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?e:a};function Rc(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}jc.prototype.send=function(e,t,r,n,o){var i=this;void 0===o&&(o=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[a]=r);var s=P(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:e,hasCallback:!!r,targetMapId:n,mustQueue:o,sourceMapId:this.mapId,data:Un(t,s)},s),{cancel:function(){r&&delete i.callbacks[a],i.target.postMessage({id:a,type:"<cancel>",targetMapId:n,sourceMapId:i.mapId})}}},jc.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var n=this.cancelCallbacks[r];delete this.cancelCallbacks[r],n&&n()}else S()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},jc.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},jc.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(qn(t.error)):n(null,qn(t.data)))}else{var o=!1,i=P(this.globalScope)?void 0:[],a=t.hasCallback?function(t,n){o=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:t?Un(t):null,data:Un(n,i)},i)}:function(e){o=!0},s=null,l=qn(t.data);if(this.parent[t.type])s=this.parent[t.type](t.sourceMapId,l,a);else if(this.parent.getWorkerSource){var c=t.type.split(".");s=this.parent.getWorkerSource(t.sourceMapId,c[0],l.source)[c[1]](l,a)}else a(new Error("Could not find function "+t.type));!o&&s&&s.cancel&&(this.cancelCallbacks[e]=s.cancel)}},jc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Lc=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Lc.prototype.setNorthEast=function(e){return this._ne=e instanceof Nc?new Nc(e.lng,e.lat):Nc.convert(e),this},Lc.prototype.setSouthWest=function(e){return this._sw=e instanceof Nc?new Nc(e.lng,e.lat):Nc.convert(e),this},Lc.prototype.extend=function(e){var t,r,n=this._sw,o=this._ne;if(e instanceof Nc)t=e,r=e;else{if(!(e instanceof Lc))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Lc.convert(e)):this.extend(Nc.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return n||o?(n.lng=Math.min(t.lng,n.lng),n.lat=Math.min(t.lat,n.lat),o.lng=Math.max(r.lng,o.lng),o.lat=Math.max(r.lat,o.lat)):(this._sw=new Nc(t.lng,t.lat),this._ne=new Nc(r.lng,r.lat)),this},Lc.prototype.getCenter=function(){return new Nc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Lc.prototype.getSouthWest=function(){return this._sw},Lc.prototype.getNorthEast=function(){return this._ne},Lc.prototype.getNorthWest=function(){return new Nc(this.getWest(),this.getNorth())},Lc.prototype.getSouthEast=function(){return new Nc(this.getEast(),this.getSouth())},Lc.prototype.getWest=function(){return this._sw.lng},Lc.prototype.getSouth=function(){return this._sw.lat},Lc.prototype.getEast=function(){return this._ne.lng},Lc.prototype.getNorth=function(){return this._ne.lat},Lc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Lc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Lc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Lc.prototype.contains=function(e){var t=Nc.convert(e),r=t.lng,n=t.lat,o=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(o=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&o},Lc.convert=function(e){return!e||e instanceof Lc?e:new Lc(e)};var Nc=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Nc.prototype.wrap=function(){return new Nc(d(this.lng,-180,180),this.lat)},Nc.prototype.toArray=function(){return[this.lng,this.lat]},Nc.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Nc.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,n=e.lat*t,o=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(o,1))},Nc.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Lc(new Nc(this.lng-r,this.lat-t),new Nc(this.lng+r,this.lat+t))},Nc.convert=function(e){if(e instanceof Nc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Nc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Nc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Bc=2*Math.PI*6371008.8;function Fc(e){return Bc*Math.cos(e*Math.PI/180)}function Vc(e){return(180+e)/360}function Uc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function qc(e,t){return e/Fc(t)}function Hc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Wc=function(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r};Wc.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Nc.convert(e);return new Wc(Vc(r.lng),Uc(r.lat),qc(t,r.lat))},Wc.prototype.toLngLat=function(){return new Nc(360*this.x-180,Hc(this.y))},Wc.prototype.toAltitude=function(){return this.z*Fc(Hc(this.y))},Wc.prototype.meterInMercatorCoordinateUnits=function(){return 1/Bc*(e=Hc(this.y),1/Math.cos(e*Math.PI/180));var e};var Gc=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=$c(0,e,e,t,r)};Gc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Gc.prototype.url=function(e,t){var r,n,o,i,a,s=(n=this.y,o=this.z,i=Rc(256*(r=this.x),256*(n=Math.pow(2,o)-n-1),o),a=Rc(256*(r+1),256*(n+1),o),i[0]+","+i[1]+","+a[0]+","+a[1]),l=function(e,t,r){for(var n,o="",i=e;i>0;i--)o+=(t&(n=1<<i-1)?1:0)+(r&n?2:0);return o}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Gc.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new o(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Gc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Zc=function(e,t){this.wrap=e,this.canonical=t,this.key=$c(e,t.z,t.z,t.x,t.y)},Yc=function(e,t,r,n,o){this.overscaledZ=e,this.wrap=t,this.canonical=new Gc(r,+n,+o),this.key=$c(t,e,r,n,o)};function $c(e,t,r,n,o){(e*=2)<0&&(e=-1*e-1);var i=1<<r;return(i*i*e+i*o+n).toString(36)+r.toString(36)+t.toString(36)}Yc.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Yc.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Yc(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yc(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Yc.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?$c(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):$c(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Yc.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Yc.prototype.children=function(e){if(this.overscaledZ>=e)return[new Yc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Yc(t,this.wrap,t,r,n),new Yc(t,this.wrap,t,r+1,n),new Yc(t,this.wrap,t,r,n+1),new Yc(t,this.wrap,t,r+1,n+1)]},Yc.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Yc.prototype.wrapped=function(){return new Yc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Yc.prototype.unwrapTo=function(e){return new Yc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Yc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Yc.prototype.toUnwrapped=function(){return new Zc(this.wrap,this.canonical)},Yc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Yc.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Wc(e.x-this.wrap,e.y))},Nn("CanonicalTileID",Gc),Nn("OverscaledTileID",Yc,{omit:["posMatrix"]});var Kc=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return k('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var n=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var o=0;o<n;o++)this.data[this._idx(-1,o)]=this.data[this._idx(0,o)],this.data[this._idx(n,o)]=this.data[this._idx(n-1,o)],this.data[this._idx(o,-1)]=this.data[this._idx(o,0)],this.data[this._idx(o,n)]=this.data[this._idx(o,n-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(n,-1)]=this.data[this._idx(n-1,0)],this.data[this._idx(-1,n)]=this.data[this._idx(0,n-1)],this.data[this._idx(n,n)]=this.data[this._idx(n-1,n-1)]};Kc.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[n],r[n+1],r[n+2])},Kc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Kc.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Kc.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Kc.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Kc.prototype.getPixels=function(){return new ya({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Kc.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var n=t*this.dim,o=t*this.dim+this.dim,i=r*this.dim,a=r*this.dim+this.dim;switch(t){case-1:n=o-1;break;case 1:o=n+1}switch(r){case-1:i=a-1;break;case 1:a=i+1}for(var s=-t*this.dim,l=-r*this.dim,c=i;c<a;c++)for(var u=n;u<o;u++)this.data[this._idx(u,c)]=e.data[this._idx(u+s,c+l)]},Nn("DEMData",Kc);var Xc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};Xc.prototype.encode=function(e){return this._stringToNumber[e]},Xc.prototype.decode=function(e){return this._numberToString[e]};var Jc=function(e,t,r,n,o){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=o},Qc={geometry:{configurable:!0}};Qc.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Qc.geometry.set=function(e){this._geometry=e},Jc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(Jc.prototype,Qc);var eu=function(){this.state={},this.stateChanges={},this.deletedStates={}};eu.prototype.updateState=function(e,t,r){var n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},h(this.stateChanges[e][n],r),null===this.deletedStates[e])for(var o in this.deletedStates[e]={},this.state[e])o!==n&&(this.deletedStates[e][o]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][n])for(var i in this.deletedStates[e][n]={},this.state[e][n])r[i]||(this.deletedStates[e][n][i]=null);else for(var a in r)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][a]&&delete this.deletedStates[e][n][a]},eu.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}},eu.prototype.getState=function(e,t){var r=String(t),n=h({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var o=this.deletedStates[e][t];if(null===o)return{};for(var i in o)delete n[i]}return n},eu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},eu.prototype.coalesceChanges=function(e,t){var r={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var o={};for(var i in this.stateChanges[n])this.state[n][i]||(this.state[n][i]={}),h(this.state[n][i],this.stateChanges[n][i]),o[i]=this.state[n][i];r[n]=o}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var u=0,d=Object.keys(this.deletedStates[a][c]);u<d.length;u+=1)delete this.state[a][c][d[u]];s[c]=this.state[a][c]}r[a]=r[a]||{},h(r[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var p in e)e[p].setFeatureState(r,t)};var tu=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Dn(8192,16,0),this.grid3D=new Dn(8192,16,0),this.featureIndexArray=new ai,this.promoteId=t};function ru(e,t,r,n,o){return y(e,(function(e,i){var a=t instanceof go?t.get(i):null;return a&&a.evaluate?a.evaluate(r,n,o):a}))}function nu(e){for(var t=1/0,r=1/0,n=-1/0,o=-1/0,i=0,a=e;i<a.length;i+=1){var s=a[i];t=Math.min(t,s.x),r=Math.min(r,s.y),n=Math.max(n,s.x),o=Math.max(o,s.y)}return{minX:t,minY:r,maxX:n,maxY:o}}function ou(e,t){return t-e}tu.prototype.insert=function(e,t,r,n,o,i){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,o);for(var s=i?this.grid3D:this.grid,l=0;l<t.length;l++){for(var c=t[l],u=[1/0,1/0,-1/0,-1/0],d=0;d<c.length;d++){var h=c[d];u[0]=Math.min(u[0],h.x),u[1]=Math.min(u[1],h.y),u[2]=Math.max(u[2],h.x),u[3]=Math.max(u[3],h.y)}u[0]<8192&&u[1]<8192&&u[2]>=0&&u[3]>=0&&s.insert(a,u[0],u[1],u[2],u[3])}},tu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new _s.VectorTile(new Ks(this.rawTileData)).layers,this.sourceLayerCoder=new Xc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},tu.prototype.query=function(e,t,r,n){var i=this;this.loadVTLayers();for(var a=e.params||{},s=8192/e.tileSize/e.scale,l=an(a.filter),c=e.queryGeometry,u=e.queryPadding*s,d=nu(c),h=this.grid.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u),p=nu(e.cameraQueryGeometry),f=0,m=this.grid3D.query(p.minX-u,p.minY-u,p.maxX+u,p.maxY+u,(function(t,r,n,i){return function(e,t,r,n,i){for(var a=0,s=e;a<s.length;a+=1){var l=s[a];if(t<=l.x&&r<=l.y&&n>=l.x&&i>=l.y)return!0}var c=[new o(t,r),new o(t,i),new o(n,i),new o(n,r)];if(e.length>2)for(var u=0,d=c;u<d.length;u+=1)if(Qi(e,d[u]))return!0;for(var h=0;h<e.length-1;h++)if(ea(e[h],e[h+1],c))return!0;return!1}(e.cameraQueryGeometry,t-u,r-u,n+u,i+u)}));f<m.length;f+=1)h.push(m[f]);h.sort(ou);for(var g,b={},v=function(o){var u=h[o];if(u!==g){g=u;var d=i.featureIndexArray.get(u),p=null;i.loadMatchingFeature(b,d.bucketIndex,d.sourceLayerIndex,d.featureIndex,l,a.layers,a.availableImages,t,r,n,(function(t,r,n){return p||(p=Fi(t)),r.queryIntersectsFeature(c,t,n,p,i.z,e.transform,s,e.pixelPosMatrix)}))}},y=0;y<h.length;y++)v(y);return b},tu.prototype.loadMatchingFeature=function(e,t,r,n,o,i,a,s,l,c,u){var d=this.bucketLayerIDs[t];if(!i||function(e,t){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(i,d)){var p=this.sourceLayerCoder.decode(r),f=this.vtLayers[p].feature(n);if(o.needGeometry){var m=Vi(f,!0);if(!o.filter(new so(this.tileID.overscaledZ),m,this.tileID.canonical))return}else if(!o.filter(new so(this.tileID.overscaledZ),f))return;for(var g=this.getId(f,p),b=0;b<d.length;b++){var v=d[b];if(!(i&&i.indexOf(v)<0)){var y=s[v];if(y){var _={};void 0!==g&&c&&(_=c.getState(y.sourceLayer||"_geojsonTileLayer",g));var w=h({},l[v]);w.paint=ru(w.paint,y.paint,f,_,a),w.layout=ru(w.layout,y.layout,f,_,a);var x=!u||u(f,y,_);if(x){var k=new Jc(f,this.z,this.x,this.y,g);k.layer=w;var C=e[v];void 0===C&&(C=e[v]=[]),C.push({featureIndex:n,feature:k,intersectionZ:x})}}}}}},tu.prototype.lookupSymbolFeatures=function(e,t,r,n,o,i,a,s){var l={};this.loadVTLayers();for(var c=an(o),u=0,d=e;u<d.length;u+=1)this.loadMatchingFeature(l,r,n,d[u],c,i,a,s,t);return l},tu.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var n=0,o=r[t];n<o.length;n+=1)if(e===o[n])return!0;return!1},tu.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},Nn("FeatureIndex",tu,{omit:["rawTileData","sourceLayerCoder"]});var iu=function(e,t){this.tileID=e,this.uid=f(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};iu.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<N.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},iu.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},iu.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var n in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var r={};if(!t)return r;for(var n=function(){var e=i[o],n=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==n.length){e.layers=n,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return n.filter((function(t){return t.id===e}))[0]})));for(var a=0,s=n;a<s.length;a+=1)r[s[a].id]=e}},o=0,i=e;o<i.length;o+=1)n();return r}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var o=this.buckets[n];if(o instanceof bc){if(this.hasSymbolBuckets=!0,!r)break;o.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var i in this.buckets){var a=this.buckets[i];if(a instanceof bc&&a.hasRTLText){this.hasRTLText=!0,ao.isLoading()||ao.isLoaded()||"deferred"!==oo()||io();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new Jo},iu.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},iu.prototype.getBucket=function(e){return this.buckets[e.id]},iu.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Dc(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Dc(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},iu.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},iu.prototype.queryRenderedFeatures=function(e,t,r,n,o,i,a,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:o,scale:i,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*l},e,t,r):{}},iu.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var n=r.loadVTLayers(),o=t?t.sourceLayer:"",i=n._geojsonTileLayer||n[o];if(i)for(var a=an(t&&t.filter),s=this.tileID.canonical,l=s.z,c=s.x,u=s.y,d={z:l,x:c,y:u},h=0;h<i.length;h++){var p=i.feature(h);if(a.needGeometry){var f=Vi(p,!0);if(!a.filter(new so(this.tileID.overscaledZ),f,this.tileID.canonical))continue}else if(!a.filter(new so(this.tileID.overscaledZ),p))continue;var m=r.getId(p,o),g=new Jc(p,l,c,u,m);g.tile=d,e.push(g)}}},iu.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},iu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},iu.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=T(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var n=Date.now(),o=!1;if(this.expirationTime>n)o=!1;else if(t)if(this.expirationTime<t)o=!0;else{var i=this.expirationTime-t;i?this.expirationTime=n+Math.max(i,3e4):o=!0}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},iu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},iu.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets)if(t.style.hasLayer(n)){var o=this.buckets[n],i=o.layers[0].sourceLayer||"_geojsonTileLayer",a=r[i],s=e[i];if(a&&s&&0!==Object.keys(s).length){o.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=t&&t.style&&t.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(o)))}}}},iu.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},iu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},iu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},iu.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=N.now()+e},iu.prototype.setDependencies=function(e,t){for(var r={},n=0,o=t;n<o.length;n+=1)r[o[n]]=!0;this.dependencies[e]=r},iu.prototype.hasDependency=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var o=this.dependencies[n[r]];if(o)for(var i=0,a=t;i<a.length;i+=1)if(o[a[i]])return!0}return!1};var au=a.performance,su=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},au.mark(this._marks.start)};su.prototype.finish=function(){au.mark(this._marks.end);var e=au.getEntriesByName(this._marks.measure);return 0===e.length&&(au.measure(this._marks.measure,this._marks.start,this._marks.end),e=au.getEntriesByName(this._marks.measure),au.clearMarks(this._marks.start),au.clearMarks(this._marks.end),au.clearMeasures(this._marks.measure)),e},e.Actor=jc,e.AlphaImage=va,e.CanonicalTileID=Gc,e.CollisionBoxArray=Jo,e.Color=et,e.DEMData=Kc,e.DataConstantProperty=bo,e.DictionaryCoder=Xc,e.EXTENT=8192,e.ErrorEvent=Te,e.EvaluationParameters=so,e.Event=Se,e.Evented=Ae,e.FeatureIndex=tu,e.FillBucket=ss,e.FillExtrusionBucket=Cs,e.ImageAtlas=_l,e.ImagePosition=vl,e.LineBucket=js,e.LngLat=Nc,e.LngLatBounds=Lc,e.MercatorCoordinate=Wc,e.ONE_EM=24,e.OverscaledTileID=Yc,e.Point=o,e.Point$1=o,e.Properties=xo,e.Protobuf=Ks,e.RGBAImage=ya,e.RequestManager=W,e.RequestPerformance=su,e.ResourceType=fe,e.SegmentVector=li,e.SourceFeatureState=eu,e.StructArrayLayout1ui2=$o,e.StructArrayLayout2f1f2i16=Fo,e.StructArrayLayout2i4=Po,e.StructArrayLayout3ui6=Uo,e.StructArrayLayout4i8=Io,e.SymbolBucket=bc,e.Texture=Dc,e.Tile=iu,e.Transitionable=uo,e.Uniform1f=wi,e.Uniform1i=_i,e.Uniform2f=xi,e.Uniform3f=ki,e.Uniform4f=Ci,e.UniformColor=Ei,e.UniformMatrix4f=Ti,e.UnwrappedTileID=Zc,e.ValidationError=Ie,e.WritingMode=wl,e.ZoomHistory=Hn,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=pc,e.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var n=e.length,o=new Array(e.length),i=null;e.forEach((function(e,a){t(e,(function(e,t){e&&(i=e),o[a]=t,0==--n&&r(i,o)}))}))},e.bezier=l,e.bindAll=b,e.browser=N,e.cacheEntryPossiblyAdded=function(e){++he>le&&(e.getActor().send("enforceCacheSizeLimit",se),he=0)},e.clamp=u,e.clearTileCache=function(e){var t=a.caches.delete("mapbox-tiles");e&&t.catch(e).then((function(){return e()}))},e.clipLine=Gl,e.clone=function(e){var t=new aa(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=w,e.clone$2=function(e){var t=new aa(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.collisionCircleLayout=Ws,e.config=B,e.create=function(){var e=new aa(16);return aa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=function(){var e=new aa(9);return aa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},e.create$2=function(){var e=new aa(4);return aa!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},e.createCommonjsModule=t,e.createExpression=Gr,e.createLayout=To,e.createStyleLayer=function(e){return"custom"===e.type?new Sc(e):new Tc[e.type](e)},e.cross=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[0],s=r[1],l=r[2];return e[0]=o*l-i*s,e[1]=i*a-n*l,e[2]=n*s-o*a,e},e.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var o in t)if(!e(t[o],r[o]))return!1;return!0}return t===r},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=c,e.emitValidationErrors=Mn,e.endsWith=v,e.enforceCacheSizeLimit=function(e){ce(),ee&&ee.then((function(t){t.keys().then((function(r){for(var n=0;n<r.length-e;n++)t.delete(r[n])}))}))},e.evaluateSizeForFeature=Ll,e.evaluateSizeForZoom=Nl,e.evaluateVariableOffset=ic,e.evented=no,e.extend=h,e.featureFilter=an,e.filterObject=_,e.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.getAnchorAlignment=Ml,e.getAnchorJustification=ac,e.getArrayBuffer=_e,e.getImage=ke,e.getJSON=function(e,t){return ye(h(e,{type:"json"}),t)},e.getRTLTextPluginStatus=oo,e.getReferrer=ve,e.getVideo=function(e,t){var r,n,o=a.document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(var i=0;i<e.length;i++){var s=a.document.createElement("source");r=e[i],n=void 0,(n=a.document.createElement("a")).href=r,(n.protocol!==a.document.location.protocol||n.host!==a.document.location.host)&&(o.crossOrigin="Anonymous"),s.src=e[i],o.appendChild(s)}return{cancel:function(){}}},e.identity=sa,e.invert=function(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],m=t[13],g=t[14],b=t[15],v=r*s-n*a,y=r*l-o*a,_=r*c-i*a,w=n*l-o*s,x=n*c-i*s,k=o*c-i*l,C=u*m-d*f,E=u*g-h*f,S=u*b-p*f,T=d*g-h*m,A=d*b-p*m,P=h*b-p*g,I=v*P-y*A+_*T+w*S-x*E+k*C;return I?(e[0]=(s*P-l*A+c*T)*(I=1/I),e[1]=(o*A-n*P-i*T)*I,e[2]=(m*k-g*x+b*w)*I,e[3]=(h*x-d*k-p*w)*I,e[4]=(l*S-a*P-c*E)*I,e[5]=(r*P-o*S+i*E)*I,e[6]=(g*_-f*k-b*y)*I,e[7]=(u*k-h*_+p*y)*I,e[8]=(a*A-s*S+c*C)*I,e[9]=(n*S-r*A-i*C)*I,e[10]=(f*x-m*_+b*v)*I,e[11]=(d*_-u*x-p*v)*I,e[12]=(s*E-a*T-l*C)*I,e[13]=(r*T-n*E+o*C)*I,e[14]=(m*y-f*w-g*v)*I,e[15]=(u*w-d*y+h*v)*I,e):null},e.isChar=Wn,e.isMapboxURL=G,e.keysDifference=function(e,t){var r=[];for(var n in e)n in t||r.push(n);return r},e.makeRequest=ye,e.mapObject=y,e.mercatorXfromLng=Vc,e.mercatorYfromLat=Uc,e.mercatorZfromAltitude=qc,e.mul=ua,e.multiply=la,e.mvt=_s,e.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.normalize=function(e,t){var r=t[0],n=t[1],o=t[2],i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},e.number=Ht,e.offscreenCanvasSupported=pe,e.ortho=function(e,t,r,n,o,i,a){var s=1/(t-r),l=1/(n-o),c=1/(i-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(o+n)*l,e[14]=(a+i)*c,e[15]=1,e},e.parseGlyphPBF=function(e){return new Ks(e).readFields(fl,[])},e.pbf=Ks,e.performSymbolLayout=function(e,t,r,n,o,i,a){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var s=e.layers[0].layout,l=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.kind){var u=e.textSizeData,d=u.maxZoom;c.compositeTextSizes=[l["text-size"].possiblyEvaluate(new so(u.minZoom),a),l["text-size"].possiblyEvaluate(new so(d),a)]}if("composite"===e.iconSizeData.kind){var h=e.iconSizeData,p=h.maxZoom;c.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new so(h.minZoom),a),l["icon-size"].possiblyEvaluate(new so(p),a)]}c.layoutTextSize=l["text-size"].possiblyEvaluate(new so(e.zoom+1),a),c.layoutIconSize=l["icon-size"].possiblyEvaluate(new so(e.zoom+1),a),c.textMaxSize=l["text-size"].possiblyEvaluate(new so(18));for(var f=24*s.get("text-line-height"),m="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),g=s.get("text-keep-upright"),b=s.get("text-size"),v=function(){var i=_[y],l=s.get("text-font").evaluate(i,{},a).join(","),u=b.evaluate(i,{},a),d=c.layoutTextSize.evaluate(i,{},a),h=c.layoutIconSize.evaluate(i,{},a),p={horizontal:{},vertical:void 0},v=i.text,w=[0,0];if(v){var x=v.toString(),C=24*s.get("text-letter-spacing").evaluate(i,{},a),E=function(e){for(var t=0,r=e;t<r.length;t+=1)if(n=r[t].charCodeAt(0),Wn.Arabic(n)||Wn["Arabic Supplement"](n)||Wn["Arabic Extended-A"](n)||Wn["Arabic Presentation Forms-A"](n)||Wn["Arabic Presentation Forms-B"](n))return!1;var n;return!0}(x)?C:0,S=s.get("text-anchor").evaluate(i,{},a),T=s.get("text-variable-anchor");if(!T){var A=s.get("text-radial-offset").evaluate(i,{},a);w=A?ic(S,[24*A,oc]):s.get("text-offset").evaluate(i,{},a).map((function(e){return 24*e}))}var P=m?"center":s.get("text-justify").evaluate(i,{},a),I=s.get("symbol-placement"),O="point"===I?24*s.get("text-max-width").evaluate(i,{},a):0,M=function(){e.allowVerticalPlacement&&Gn(x)&&(p.vertical=Cl(v,t,r,o,l,O,f,S,"left",E,w,wl.vertical,!0,I,d,u))};if(!m&&T){for(var D="auto"===P?T.map((function(e){return ac(e)})):[P],z=!1,j=0;j<D.length;j++){var R=D[j];if(!p.horizontal[R])if(z)p.horizontal[R]=p.horizontal[0];else{var L=Cl(v,t,r,o,l,O,f,"center",R,E,w,wl.horizontal,!1,I,d,u);L&&(p.horizontal[R]=L,z=1===L.positionedLines.length)}}M()}else{"auto"===P&&(P=ac(S));var N=Cl(v,t,r,o,l,O,f,S,P,E,w,wl.horizontal,!1,I,d,u);N&&(p.horizontal[P]=N),M(),Gn(x)&&m&&g&&(p.vertical=Cl(v,t,r,o,l,O,f,S,P,E,w,wl.vertical,!1,I,d,u))}}var B=void 0,F=!1;if(i.icon&&i.icon.name){var V=n[i.icon.name];V&&(B=function(e,t,r){var n=Ml(r),o=t[0]-e.displaySize[0]*n.horizontalAlign,i=t[1]-e.displaySize[1]*n.verticalAlign;return{image:e,top:i,bottom:i+e.displaySize[1],left:o,right:o+e.displaySize[0]}}(o[i.icon.name],s.get("icon-offset").evaluate(i,{},a),s.get("icon-anchor").evaluate(i,{},a)),F=V.sdf,void 0===e.sdfIcons?e.sdfIcons=V.sdf:e.sdfIcons!==V.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(V.pixelRatio!==e.pixelRatio||0!==s.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var U=lc(p.horizontal)||p.vertical;e.iconsInText=!!U&&U.iconsInText,(U||B)&&function(e,t,r,n,o,i,a,s,l,c,u){var d=i.textMaxSize.evaluate(t,{});void 0===d&&(d=a);var h,p=e.layers[0].layout,f=p.get("icon-offset").evaluate(t,{},u),m=lc(r.horizontal),g=a/24,b=e.tilePixelRatio*g,v=e.tilePixelRatio*d/24,y=e.tilePixelRatio*s,_=e.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*e.tilePixelRatio,x=p.get("icon-padding")*e.tilePixelRatio,C=p.get("text-max-angle")/180*Math.PI,E="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),S="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),T=p.get("symbol-placement"),A=_/2,P=p.get("icon-text-fit");n&&"none"!==P&&(e.allowVerticalPlacement&&r.vertical&&(h=zl(n,r.vertical,P,p.get("icon-text-fit-padding"),f,g)),m&&(n=zl(n,m,P,p.get("icon-text-fit-padding"),f,g)));var I=function(s,d){d.x<0||d.x>=8192||d.y<0||d.y>=8192||function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b,v,y,_,w,x,C,E){var S,T,A,P,I,O=e.addToLineVertexArray(t,r),M=0,D=0,z=0,j=0,R=-1,L=-1,N={},B=pi(""),F=0,V=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(F=(S=s.layout.get("text-offset").evaluate(_,{},C).map((function(e){return 24*e})))[0],V=S[1]):(F=24*s.layout.get("text-radial-offset").evaluate(_,{},C),V=oc),e.allowVerticalPlacement&&n.vertical){var U=s.layout.get("text-rotate").evaluate(_,{},C)+90;P=new Jl(l,t,c,u,d,n.vertical,h,p,f,U),a&&(I=new Jl(l,t,c,u,d,a,g,b,f,U))}if(o){var q=s.layout.get("icon-rotate").evaluate(_,{}),H="none"!==s.layout.get("icon-text-fit"),W=Zl(o,q,x,H),G=a?Zl(a,q,x,H):void 0;A=new Jl(l,t,c,u,d,o,g,b,!1,q),M=4*W.length;var Z=e.iconSizeData,Y=null;"source"===Z.kind?(Y=[128*s.layout.get("icon-size").evaluate(_,{})])[0]>32640&&k(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Z.kind&&((Y=[128*w.compositeIconSizes[0].evaluate(_,{},C),128*w.compositeIconSizes[1].evaluate(_,{},C)])[0]>32640||Y[1]>32640)&&k(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),e.addSymbols(e.icon,W,Y,y,v,_,!1,t,O.lineStartIndex,O.lineLength,-1,C),R=e.icon.placedSymbolArray.length-1,G&&(D=4*G.length,e.addSymbols(e.icon,G,Y,y,v,_,wl.vertical,t,O.lineStartIndex,O.lineLength,-1,C),L=e.icon.placedSymbolArray.length-1)}for(var $ in n.horizontal){var K=n.horizontal[$];if(!T){B=pi(K.text);var X=s.layout.get("text-rotate").evaluate(_,{},C);T=new Jl(l,t,c,u,d,K,h,p,f,X)}var J=1===K.positionedLines.length;if(z+=sc(e,t,K,i,s,f,_,m,O,n.vertical?wl.horizontal:wl.horizontalOnly,J?Object.keys(n.horizontal):[$],N,R,w,C),J)break}n.vertical&&(j+=sc(e,t,n.vertical,i,s,f,_,m,O,wl.vertical,["vertical"],N,L,w,C));var Q=T?T.boxStartIndex:e.collisionBoxArray.length,ee=T?T.boxEndIndex:e.collisionBoxArray.length,te=P?P.boxStartIndex:e.collisionBoxArray.length,re=P?P.boxEndIndex:e.collisionBoxArray.length,ne=A?A.boxStartIndex:e.collisionBoxArray.length,oe=A?A.boxEndIndex:e.collisionBoxArray.length,ie=I?I.boxStartIndex:e.collisionBoxArray.length,ae=I?I.boxEndIndex:e.collisionBoxArray.length,se=-1,le=function(e,t){return e&&e.circleDiameter?Math.max(e.circleDiameter,t):t};se=le(T,se),se=le(P,se),se=le(A,se);var ce=(se=le(I,se))>-1?1:0;ce&&(se*=E/24),e.glyphOffsetArray.length>=bc.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==_.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,_.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,N.right>=0?N.right:-1,N.center>=0?N.center:-1,N.left>=0?N.left:-1,N.vertical||-1,R,L,B,Q,ee,te,re,ne,oe,ie,ae,c,z,j,M,D,ce,0,h,F,V,se)}(e,d,s,r,n,o,h,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,b,w,E,l,y,x,S,f,t,i,c,u,a)};if("line"===T)for(var O=0,M=Gl(t.geometry,0,0,8192,8192);O<M.length;O+=1)for(var D=M[O],z=0,j=Wl(D,_,C,r.vertical||m,n,24,v,e.overscaling,8192);z<j.length;z+=1){var R=j[z];m&&cc(e,m.text,A,R)||I(D,R)}else if("line-center"===T)for(var L=0,N=t.geometry;L<N.length;L+=1){var B=N[L];if(B.length>1){var F=Hl(B,C,r.vertical||m,n,24,v);F&&I(B,F)}}else if("Polygon"===t.type)for(var V=0,U=ns(t.geometry,0);V<U.length;V+=1){var q=U[V],H=tc(q,16);I(q[0],new jl(H.x,H.y,0))}else if("LineString"===t.type)for(var W=0,G=t.geometry;W<G.length;W+=1){var Z=G[W];I(Z,new jl(Z[0].x,Z[0].y,0))}else if("Point"===t.type)for(var Y=0,$=t.geometry;Y<$.length;Y+=1)for(var K=0,X=$[Y];K<X.length;K+=1){var J=X[K];I([J],new jl(J.x,J.y,0))}}(e,i,p,B,n,c,d,h,w,F,a)},y=0,_=e.features;y<_.length;y+=1)v();i&&e.generateCollisionDebugBuffers()},e.perspective=function(e,t,r,n,o){var i,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(e[10]=(o+n)*(i=1/(n-o)),e[14]=2*o*n*i):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){for(var r={},n=0;n<t.length;n++){var o=t[n];o in e&&(r[o]=e[o])}return r},e.plugin=ao,e.polygonIntersectsPolygon=Hi,e.postMapLoadEvent=ae,e.postTurnstileEvent=oe,e.potpack=bl,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Nn,e.registerForPluginStateChange=function(e){return e({pluginStatus:Qn,pluginURL:eo}),no.on("pluginStateChange",e),e},e.renderColorRamp=wa,e.rotate=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*s,e[1]=o*l+a*s,e[2]=n*-s+i*l,e[3]=o*-s+a*l,e},e.rotateX=function(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+c*n,e[5]=a*o+u*n,e[6]=s*o+d*n,e[7]=l*o+h*n,e[8]=c*o-i*n,e[9]=u*o-a*n,e[10]=d*o-s*n,e[11]=h*o-l*n,e},e.rotateZ=function(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[0],a=t[1],s=t[2],l=t[3],c=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+c*n,e[1]=a*o+u*n,e[2]=s*o+d*n,e[3]=l*o+h*n,e[4]=c*o-i*n,e[5]=u*o-a*n,e[6]=d*o-s*n,e[7]=h*o-l*n,e},e.scale=function(e,t,r){var n=r[0],o=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.setCacheLimits=function(e,t){se=e,le=t},e.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===Qn||"loading"===Qn||"loaded"===Qn)throw new Error("setRTLTextPlugin cannot be called multiple times.");eo=N.resolveURL(e),Qn="deferred",Jn=t,ro(),r||io()},e.sphericalToCartesian=function(e){var t=e[0],r=e[1],n=e[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(n),y:t*Math.sin(r)*Math.sin(n),z:t*Math.cos(n)}},e.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},e.styleSpec=Pe,e.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.symbolSize=Bl,e.transformMat3=function(e,t,r){var n=t[0],o=t[1],i=t[2];return e[0]=n*r[0]+o*r[3]+i*r[6],e[1]=n*r[1]+o*r[4]+i*r[7],e[2]=n*r[2]+o*r[5]+i*r[8],e},e.transformMat4=da,e.translate=function(e,t,r){var n,o,i,a,s,l,c,u,d,h,p,f,m=r[0],g=r[1],b=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*b+t[12],e[13]=t[1]*m+t[5]*g+t[9]*b+t[13],e[14]=t[2]*m+t[6]*g+t[10]*b+t[14],e[15]=t[3]*m+t[7]*g+t[11]*b+t[15]):(o=t[1],i=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],e[0]=n=t[0],e[1]=o,e[2]=i,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=h,e[10]=p,e[11]=f,e[12]=n*m+s*g+d*b+t[12],e[13]=o*m+l*g+h*b+t[13],e[14]=i*m+c*g+p*b+t[14],e[15]=a*m+u*g+f*b+t[15]),e},e.triggerPluginCompletionEvent=to,e.uniqueId=f,e.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},e.validateLight=Pn,e.validateStyle=An,e.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},e.vectorTile=_s,e.version="1.13.1",e.warnOnce=k,e.webpSupported=F,e.window=a,e.wrap=d})),n(0,(function(e){function t(e){var r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){for(var n="[",o=0,i=e;o<i.length;o+=1)n+=t(i[o])+",";return n+"]"}for(var a=Object.keys(e).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+t(e[a[l]])+",";return s+"}"}function r(r){for(var n="",o=0,i=e.refProperties;o<i.length;o+=1)n+="/"+t(r[i[o]]);return n}var n=function(e){this.keyCache={},e&&this.replace(e)};n.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},n.prototype.update=function(t,n){for(var o=this,i=0,a=t;i<a.length;i+=1){var s=a[i];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=e.createStyleLayer(s);l._featureFilter=e.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,u=n;c<u.length;c+=1){var d=u[c];delete this.keyCache[d],delete this._layerConfigs[d],delete this._layers[d]}this.familiesBySource={};for(var h=0,p=function(e,t){for(var n={},o=0;o<e.length;o++){var i=t&&t[e[o].id]||r(e[o]);t&&(t[e[o].id]=i);var a=n[i];a||(a=n[i]=[]),a.push(e[o])}var s=[];for(var l in n)s.push(n[l]);return s}(e.values(this._layerConfigs),this.keyCache);h<p.length;h+=1){var f=p[h].map((function(e){return o._layers[e.id]})),m=f[0];if("none"!==m.visibility){var g=m.source||"",b=this.familiesBySource[g];b||(b=this.familiesBySource[g]={});var v=m.sourceLayer||"_geojsonTileLayer",y=b[v];y||(y=b[v]=[]),y.push(f)}}};var o=function(t){var r={},n=[];for(var o in t){var i=t[o],a=r[o]={};for(var s in i){var l=i[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var c={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};n.push(c),a[s]={rect:c,metrics:l.metrics}}}}var u=e.potpack(n),d=new e.AlphaImage({width:u.w||1,height:u.h||1});for(var h in t){var p=t[h];for(var f in p){var m=p[+f];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var g=r[h][f].rect;e.AlphaImage.copy(m.bitmap,d,{x:0,y:0},{x:g.x+1,y:g.y+1},m.bitmap)}}}this.image=d,this.positions=r};e.register("GlyphAtlas",o);var i=function(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId};function a(t,r,n){for(var o=new e.EvaluationParameters(r),i=0,a=t;i<a.length;i+=1)a[i].recalculate(o,n)}function s(t,r){var n=e.getArrayBuffer(t.request,(function(t,n,o,i){t?r(t):n&&r(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(n)),rawData:n,cacheControl:o,expires:i})}));return function(){n.cancel(),r()}}i.prototype.parse=function(t,r,n,i,s){var l=this;this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var c=new e.DictionaryCoder(Object.keys(t.layers).sort()),u=new e.FeatureIndex(this.tileID,this.promoteId);u.bucketLayerIDs=[];var d,h,p,f,m={},g={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},b=r.familiesBySource[this.source];for(var v in b){var y=t.layers[v];if(y){1===y.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var _=c.encode(v),w=[],x=0;x<y.length;x++){var k=y.feature(x),C=u.getId(k,v);w.push({feature:k,id:C,index:x,sourceLayerIndex:_})}for(var E=0,S=b[v];E<S.length;E+=1){var T=S[E],A=T[0];A.minzoom&&this.zoom<Math.floor(A.minzoom)||A.maxzoom&&this.zoom>=A.maxzoom||"none"!==A.visibility&&(a(T,this.zoom,n),(m[A.id]=A.createBucket({index:u.bucketLayerIDs.length,layers:T,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_,sourceID:this.source})).populate(w,g,this.tileID.canonical),u.bucketLayerIDs.push(T.map((function(e){return e.id}))))}}}var P=e.mapObject(g.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(P).length?i.send("getGlyphs",{uid:this.uid,stacks:P},(function(e,t){d||(d=e,h=t,M.call(l))})):h={};var I=Object.keys(g.iconDependencies);I.length?i.send("getImages",{icons:I,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){d||(d=e,p=t,M.call(l))})):p={};var O=Object.keys(g.patternDependencies);function M(){if(d)return s(d);if(h&&p&&f){var t=new o(h),r=new e.ImageAtlas(p,f);for(var i in m){var l=m[i];l instanceof e.SymbolBucket?(a(l.layers,this.zoom,n),e.performSymbolLayout(l,h,t.positions,p,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof e.LineBucket||l instanceof e.FillBucket||l instanceof e.FillExtrusionBucket)&&(a(l.layers,this.zoom,n),l.addFeatures(g,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:e.values(m).filter((function(e){return!e.isEmpty()})),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:r,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?t.positions:null})}}O.length?i.send("getImages",{icons:O,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){d||(d=e,f=t,M.call(l))})):f={},M.call(this)};var l=function(e,t,r,n){this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=n||s,this.loading={},this.loaded={}};l.prototype.loadTile=function(t,r){var n=this,o=t.uid;this.loading||(this.loading={});var a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),s=this.loading[o]=new i(t);s.abort=this.loadVectorData(t,(function(t,i){if(delete n.loading[o],t||!i)return s.status="done",n.loaded[o]=s,r(t);var l=i.rawData,c={};i.expires&&(c.expires=i.expires),i.cacheControl&&(c.cacheControl=i.cacheControl);var u={};if(a){var d=a.finish();d&&(u.resourceTiming=JSON.parse(JSON.stringify(d)))}s.vectorTile=i.vectorTile,s.parse(i.vectorTile,n.layerIndex,n.availableImages,n.actor,(function(t,n){if(t||!n)return r(t);r(null,e.extend({rawTileData:l.slice(0)},n,c,u))})),n.loaded=n.loaded||{},n.loaded[o]=s}))},l.prototype.reloadTile=function(e,t){var r=this,n=this.loaded,o=e.uid,i=this;if(n&&n[o]){var a=n[o];a.showCollisionBoxes=e.showCollisionBoxes;var s=function(e,n){var o=a.reloadCallback;o&&(delete a.reloadCallback,a.parse(a.vectorTile,i.layerIndex,r.availableImages,i.actor,o)),t(e,n)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},l.prototype.abortTile=function(e,t){var r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),t()},l.prototype.removeTile=function(e,t){var r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()};var c=e.window.ImageBitmap,u=function(){this.loaded={}};function d(e,t){if(0!==e.length){h(e[0],t);for(var r=1;r<e.length;r++)h(e[r],!t)}}function h(e,t){for(var r=0,n=0,o=e.length,i=o-1;n<o;i=n++)r+=(e[n][0]-e[i][0])*(e[i][1]+e[n][1]);r>=0!=!!t&&e.reverse()}u.prototype.loadTile=function(t,r){var n=t.uid,o=t.encoding,i=t.rawImageData,a=c&&i instanceof c?this.getImageData(i):i,s=new e.DEMData(n,a,o);this.loaded=this.loaded||{},this.loaded[n]=s,r(null,s)},u.prototype.getImageData=function(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var r=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:r.width,height:r.height},r.data)},u.prototype.removeTile=function(e){var t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]};var p=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))};f.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var o=n[r];t.push([new e.Point$1(o[0],o[1])])}return t}for(var i=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],c=0,u=s[a];c<u.length;c+=1){var d=u[c];l.push(new e.Point$1(d[0],d[1]))}i.push(l)}return i},f.prototype.toGeoJSON=function(e,t,r){return p.call(this,e,t,r)};var m=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t};m.prototype.feature=function(e){return new f(this._features[e])};var g=e.vectorTile.VectorTileFeature,b=v;function v(e,t){this.options=t||{},this.features=e,this.length=e.length}function y(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}v.prototype.feature=function(e){return new y(this.features[e],this.options.extent)},y.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var n=t[r],o=[],i=0;i<n.length;i++)o.push(new e.Point$1(n[i][0],n[i][1]));this.geometry.push(o)}return this.geometry},y.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,o=-1/0,i=0;i<e.length;i++)for(var a=e[i],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),o=Math.max(o,l.y)}return[t,n,r,o]},y.prototype.toGeoJSON=g.prototype.toGeoJSON;var _=x,w=b;function x(t){var r=new e.pbf;return function(e,t){for(var r in e.layers)t.writeMessage(3,k,e.layers[r])}(t,r),r.finish()}function k(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,C,n);var o=n.keys;for(r=0;r<o.length;r++)t.writeStringField(3,o[r]);var i=n.values;for(r=0;r<i.length;r++)t.writeMessage(4,P,i[r])}function C(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,E,e),t.writeVarintField(3,r.type),t.writeMessage(4,A,r)}function E(e,t){var r=e.feature,n=e.keys,o=e.values,i=e.keycache,a=e.valuecache;for(var s in r.properties){var l=i[s];void 0===l&&(n.push(s),i[s]=l=n.length-1),t.writeVarint(l);var c=r.properties[s],u=typeof c;"string"!==u&&"boolean"!==u&&"number"!==u&&(c=JSON.stringify(c));var d=u+":"+c,h=a[d];void 0===h&&(o.push(c),a[d]=h=o.length-1),t.writeVarint(h)}}function S(e,t){return(t<<3)+(7&e)}function T(e){return e<<1^e>>31}function A(e,t){for(var r=e.loadGeometry(),n=e.type,o=0,i=0,a=r.length,s=0;s<a;s++){var l=r[s],c=1;1===n&&(c=l.length),t.writeVarint(S(1,c));for(var u=3===n?l.length-1:l.length,d=0;d<u;d++){1===d&&1!==n&&t.writeVarint(S(2,u-1));var h=l[d].x-o,p=l[d].y-i;t.writeVarint(T(h)),t.writeVarint(T(p)),o+=h,i+=p}3===n&&t.writeVarint(S(7,1))}}function P(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function I(e,t,r,n){O(e,r,n),O(t,2*r,2*n),O(t,2*r+1,2*n+1)}function O(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function M(e,t,r,n){var o=e-r,i=t-n;return o*o+i*i}_.fromVectorTileJs=x,_.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new b(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return x({layers:r})},_.GeoJSONWrapper=w;var D=function(e){return e[0]},z=function(e){return e[1]},j=function(e,t,r,n,o){void 0===t&&(t=D),void 0===r&&(r=z),void 0===n&&(n=64),void 0===o&&(o=Float64Array),this.nodeSize=n,this.points=e;for(var i=e.length<65536?Uint16Array:Uint32Array,a=this.ids=new i(e.length),s=this.coords=new o(2*e.length),l=0;l<e.length;l++)a[l]=l,s[2*l]=t(e[l]),s[2*l+1]=r(e[l]);!function e(t,r,n,o,i,a){if(!(i-o<=n)){var s=o+i>>1;!function e(t,r,n,o,i,a){for(;i>o;){if(i-o>600){var s=i-o+1,l=n-o+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(t,r,n,Math.max(o,Math.floor(n-l*u/s+d)),Math.min(i,Math.floor(n+(s-l)*u/s+d)),a)}var h=r[2*n+a],p=o,f=i;for(I(t,r,o,n),r[2*i+a]>h&&I(t,r,o,i);p<f;){for(I(t,r,p,f),p++,f--;r[2*p+a]<h;)p++;for(;r[2*f+a]>h;)f--}r[2*o+a]===h?I(t,r,o,f):I(t,r,++f,i),f<=n&&(o=f+1),n<=f&&(i=f-1)}}(t,r,s,o,i,a%2),e(t,r,n,o,s-1,a+1),e(t,r,n,s+1,i,a+1)}}(a,s,n,0,a.length-1,0)};j.prototype.range=function(e,t,r,n){return function(e,t,r,n,o,i,a){for(var s,l,c=[0,e.length-1,0],u=[];c.length;){var d=c.pop(),h=c.pop(),p=c.pop();if(h-p<=a)for(var f=p;f<=h;f++)l=t[2*f+1],(s=t[2*f])>=r&&s<=o&&l>=n&&l<=i&&u.push(e[f]);else{var m=Math.floor((p+h)/2);l=t[2*m+1],(s=t[2*m])>=r&&s<=o&&l>=n&&l<=i&&u.push(e[m]);var g=(d+1)%2;(0===d?r<=s:n<=l)&&(c.push(p),c.push(m-1),c.push(g)),(0===d?o>=s:i>=l)&&(c.push(m+1),c.push(h),c.push(g))}}return u}(this.ids,this.coords,e,t,r,n,this.nodeSize)},j.prototype.within=function(e,t,r){return function(e,t,r,n,o,i){for(var a=[0,e.length-1,0],s=[],l=o*o;a.length;){var c=a.pop(),u=a.pop(),d=a.pop();if(u-d<=i)for(var h=d;h<=u;h++)M(t[2*h],t[2*h+1],r,n)<=l&&s.push(e[h]);else{var p=Math.floor((d+u)/2),f=t[2*p],m=t[2*p+1];M(f,m,r,n)<=l&&s.push(e[p]);var g=(c+1)%2;(0===c?r-o<=f:n-o<=m)&&(a.push(d),a.push(p-1),a.push(g)),(0===c?r+o>=f:n+o>=m)&&(a.push(p+1),a.push(u),a.push(g))}}return s}(this.ids,this.coords,e,t,r,this.nodeSize)};var R={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},L=function(e){this.options=H(Object.create(R),e),this.trees=new Array(this.options.maxZoom+1)};function N(e,t,r,n,o){return{x:e,y:t,zoom:1/0,id:r,parentId:-1,numPoints:n,properties:o}}function B(e,t){var r=e.geometry.coordinates,n=r[1];return{x:U(r[0]),y:q(n),zoom:1/0,index:t,parentId:-1}}function F(e){return{type:"Feature",id:e.id,properties:V(e),geometry:{type:"Point",coordinates:[(n=e.x,360*(n-.5)),(t=e.y,r=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var t,r,n}function V(e){var t=e.numPoints,r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return H(H({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function U(e){return e/360+.5}function q(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function H(e,t){for(var r in t)e[r]=t[r];return e}function W(e){return e.x}function G(e){return e.y}function Z(e,t,r,n,o,i){var a=o-r,s=i-n;if(0!==a||0!==s){var l=((e-r)*a+(t-n)*s)/(a*a+s*s);l>1?(r=o,n=i):l>0&&(r+=a*l,n+=s*l)}return(a=e-r)*a+(s=t-n)*s}function Y(e,t,r,n){var o={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)$(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)$(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)$(e,t[n][o])}(o),o}function $(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function K(e,t,r,n){if(t.geometry){var o=t.geometry.coordinates,i=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===i)X(o,s);else if("MultiPoint"===i)for(var c=0;c<o.length;c++)X(o[c],s);else if("LineString"===i)J(o,s,a,!1);else if("MultiLineString"===i){if(r.lineMetrics){for(c=0;c<o.length;c++)J(o[c],s=[],a,!1),e.push(Y(l,"LineString",s,t.properties));return}Q(o,s,a,!1)}else if("Polygon"===i)Q(o,s,a,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(c=0;c<t.geometry.geometries.length;c++)K(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<o.length;c++){var u=[];Q(o[c],u,a,!0),s.push(u)}}e.push(Y(l,i,s,t.properties))}}function X(e,t){t.push(ee(e[0])),t.push(te(e[1])),t.push(0)}function J(e,t,r,n){for(var o,i,a=0,s=0;s<e.length;s++){var l=ee(e[s][0]),c=te(e[s][1]);t.push(l),t.push(c),t.push(0),s>0&&(a+=n?(o*c-l*i)/2:Math.sqrt(Math.pow(l-o,2)+Math.pow(c-i,2))),o=l,i=c}var u=t.length-3;t[2]=1,function e(t,r,n,o){for(var i,a=o,s=n-r>>1,l=n-r,c=t[r],u=t[r+1],d=t[n],h=t[n+1],p=r+3;p<n;p+=3){var f=Z(t[p],t[p+1],c,u,d,h);if(f>a)i=p,a=f;else if(f===a){var m=Math.abs(p-s);m<l&&(i=p,l=m)}}a>o&&(i-r>3&&e(t,r,i,o),t[i+2]=a,n-i>3&&e(t,i,n,o))}(t,0,u,r),t[u+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function Q(e,t,r,n){for(var o=0;o<e.length;o++){var i=[];J(e[o],i,r,n),t.push(i)}}function ee(e){return e/360+.5}function te(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function re(e,t,r,n,o,i,a,s){if(n/=t,i>=(r/=t)&&a<n)return e;if(a<r||i>=n)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],d=u.geometry,h=u.type,p=0===o?u.minX:u.minY,f=0===o?u.maxX:u.maxY;if(p>=r&&f<n)l.push(u);else if(!(f<r||p>=n)){var m=[];if("Point"===h||"MultiPoint"===h)ne(d,m,r,n,o);else if("LineString"===h)oe(d,m,r,n,o,!1,s.lineMetrics);else if("MultiLineString"===h)ae(d,m,r,n,o,!1);else if("Polygon"===h)ae(d,m,r,n,o,!0);else if("MultiPolygon"===h)for(var g=0;g<d.length;g++){var b=[];ae(d[g],b,r,n,o,!0),b.length&&m.push(b)}if(m.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)l.push(Y(u.id,h,m[g],u.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),l.push(Y(u.id,h,m,u.tags))}}}return l.length?l:null}function ne(e,t,r,n,o){for(var i=0;i<e.length;i+=3){var a=e[i+o];a>=r&&a<=n&&(t.push(e[i]),t.push(e[i+1]),t.push(e[i+2]))}}function oe(e,t,r,n,o,i,a){for(var s,l,c=ie(e),u=0===o?le:ce,d=e.start,h=0;h<e.length-3;h+=3){var p=e[h],f=e[h+1],m=e[h+2],g=e[h+3],b=e[h+4],v=0===o?p:f,y=0===o?g:b,_=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-b,2))),v<r?y>r&&(l=u(c,p,f,g,b,r),a&&(c.start=d+s*l)):v>n?y<n&&(l=u(c,p,f,g,b,n),a&&(c.start=d+s*l)):se(c,p,f,m),y<r&&v>=r&&(l=u(c,p,f,g,b,r),_=!0),y>n&&v<=n&&(l=u(c,p,f,g,b,n),_=!0),!i&&_&&(a&&(c.end=d+s*l),t.push(c),c=ie(e)),a&&(d+=s)}var w=e.length-3;p=e[w],f=e[w+1],m=e[w+2],(v=0===o?p:f)>=r&&v<=n&&se(c,p,f,m),w=c.length-3,i&&w>=3&&(c[w]!==c[0]||c[w+1]!==c[1])&&se(c,c[0],c[1],c[2]),c.length&&t.push(c)}function ie(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function ae(e,t,r,n,o,i){for(var a=0;a<e.length;a++)oe(e[a],t,r,n,o,i,!1)}function se(e,t,r,n){e.push(t),e.push(r),e.push(n)}function le(e,t,r,n,o,i){var a=(i-t)/(n-t);return e.push(i),e.push(r+(o-r)*a),e.push(1),a}function ce(e,t,r,n,o,i){var a=(i-r)/(o-r);return e.push(t+(n-t)*a),e.push(i),e.push(1),a}function ue(e,t){for(var r=[],n=0;n<e.length;n++){var o,i=e[n],a=i.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=de(i.geometry,t);else if("MultiLineString"===a||"Polygon"===a){o=[];for(var s=0;s<i.geometry.length;s++)o.push(de(i.geometry[s],t))}else if("MultiPolygon"===a)for(o=[],s=0;s<i.geometry.length;s++){for(var l=[],c=0;c<i.geometry[s].length;c++)l.push(de(i.geometry[s][c],t));o.push(l)}r.push(Y(i.id,a,o,i.tags))}return r}function de(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function he(e,t){if(e.transformed)return e;var r,n,o,i=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(n=0;n<c.length;n+=2)l.geometry.push(pe(c[n],c[n+1],t,i,a,s));else for(n=0;n<c.length;n++){var d=[];for(o=0;o<c[n].length;o+=2)d.push(pe(c[n][o],c[n][o+1],t,i,a,s));l.geometry.push(d)}}return e.transformed=!0,e}function pe(e,t,r,n,o,i){return[Math.round(r*(e*n-o)),Math.round(r*(t*n-i))]}function fe(e,t,r,n,o){for(var i=t===o.maxZoom?0:o.tolerance/((1<<t)*o.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,me(a,e[s],i,o);var l=e[s].minX,c=e[s].minY,u=e[s].maxX,d=e[s].maxY;l<a.minX&&(a.minX=l),c<a.minY&&(a.minY=c),u>a.maxX&&(a.maxX=u),d>a.maxY&&(a.maxY=d)}return a}function me(e,t,r,n){var o=t.geometry,i=t.type,a=[];if("Point"===i||"MultiPoint"===i)for(var s=0;s<o.length;s+=3)a.push(o[s]),a.push(o[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===i)ge(a,o,e,r,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(s=0;s<o.length;s++)ge(a,o[s],e,r,"Polygon"===i,0===s);else if("MultiPolygon"===i)for(var l=0;l<o.length;l++){var c=o[l];for(s=0;s<c.length;s++)ge(a,c[s],e,r,!0,0===s)}if(a.length){var u=t.tags||null;if("LineString"===i&&n.lineMetrics){for(var d in u={},t.tags)u[d]=t.tags[d];u.mapbox_clip_start=o.start/o.size,u.mapbox_clip_end=o.end/o.size}var h={geometry:a,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:u};null!==t.id&&(h.id=t.id),e.features.push(h)}}function ge(e,t,r,n,o,i){var a=n*n;if(n>0&&t.size<(o?a:n))r.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;o&&function(e,t){for(var r=0,n=0,o=e.length,i=o-2;n<o;i=n,n+=2)r+=(e[n]-e[i])*(e[n+1]+e[i+1]);if(r>0===t)for(n=0,o=e.length;n<o/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[o-2-n],e[n+1]=e[o-1-n],e[o-2-n]=a,e[o-1-n]=s}}(s,i),e.push(s)}}function be(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)K(r,e.features[n],t,n);else K(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var r=t.buffer/t.extent,n=e,o=re(e,1,-1-r,r,0,-1,2,t),i=re(e,1,1-r,2+r,0,-1,2,t);return(o||i)&&(n=re(e,1,-r,1+r,0,-1,2,t)||[],o&&(n=ue(o,1).concat(n)),i&&(n=n.concat(ue(i,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ve(e,t,r){return 32*((1<<e)*r+t)+e}function ye(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);var o=new m(n.features),i=_(o);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),t(null,{vectorTile:o,rawData:i.buffer})}L.prototype.load=function(e){var t=this.options,r=t.log,n=t.minZoom,o=t.maxZoom,i=t.nodeSize;r&&console.time("total time");var a="prepare "+e.length+" points";r&&console.time(a),this.points=e;for(var s=[],l=0;l<e.length;l++)e[l].geometry&&s.push(B(e[l],l));this.trees[o+1]=new j(s,W,G,i,Float32Array),r&&console.timeEnd(a);for(var c=o;c>=n;c--){var u=+Date.now();s=this._cluster(s,c),this.trees[c]=new j(s,W,G,i,Float32Array),r&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-u)}return r&&console.timeEnd("total time"),this},L.prototype.getClusters=function(e,t){var r=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),o=180===e[2]?180:((e[2]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,o=180;else if(r>o){var a=this.getClusters([r,n,180,i],t),s=this.getClusters([-180,n,o,i],t);return a.concat(s)}for(var l=this.trees[this._limitZoom(t)],c=[],u=0,d=l.range(U(r),q(i),U(o),q(n));u<d.length;u+=1){var h=l.points[d[u]];c.push(h.numPoints?F(h):this.points[h.index])}return c},L.prototype.getChildren=function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(n);var i=o.points[t];if(!i)throw new Error(n);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=[],l=0,c=o.within(i.x,i.y,a);l<c.length;l+=1){var u=o.points[c[l]];u.parentId===e&&s.push(u.numPoints?F(u):this.points[u.index])}if(0===s.length)throw new Error(n);return s},L.prototype.getLeaves=function(e,t,r){var n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n},L.prototype.getTile=function(e,t,r){var n=this.trees[this._limitZoom(e)],o=Math.pow(2,e),i=this.options,a=i.radius/i.extent,s=(r-a)/o,l=(r+1+a)/o,c={features:[]};return this._addTileFeatures(n.range((t-a)/o,s,(t+1+a)/o,l),n.points,t,r,o,c),0===t&&this._addTileFeatures(n.range(1-a/o,s,1,l),n.points,o,r,o,c),t===o-1&&this._addTileFeatures(n.range(0,s,a/o,l),n.points,-1,r,o,c),c.features.length?c:null},L.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t},L.prototype._appendLeaves=function(e,t,r,n,o){for(var i=0,a=this.getChildren(t);i<a.length;i+=1){var s=a[i],l=s.properties;if(l&&l.cluster?o+l.point_count<=n?o+=l.point_count:o=this._appendLeaves(e,l.cluster_id,r,n,o):o<n?o++:e.push(s),e.length===r)break}return o},L.prototype._addTileFeatures=function(e,t,r,n,o,i){for(var a=0,s=e;a<s.length;a+=1){var l=t[s[a]],c=l.numPoints,u={type:1,geometry:[[Math.round(this.options.extent*(l.x*o-r)),Math.round(this.options.extent*(l.y*o-n))]],tags:c?V(l):this.points[l.index].properties},d=void 0;c?d=l.id:this.options.generateId?d=l.index:this.points[l.index].id&&(d=this.points[l.index].id),void 0!==d&&(u.id=d),i.features.push(u)}},L.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))},L.prototype._cluster=function(e,t){for(var r=[],n=this.options,o=n.reduce,i=n.minPoints,a=n.radius/(n.extent*Math.pow(2,t)),s=0;s<e.length;s++){var l=e[s];if(!(l.zoom<=t)){l.zoom=t;for(var c=this.trees[t+1],u=c.within(l.x,l.y,a),d=l.numPoints||1,h=d,p=0,f=u;p<f.length;p+=1){var m=c.points[f[p]];m.zoom>t&&(h+=m.numPoints||1)}if(h>=i){for(var g=l.x*d,b=l.y*d,v=o&&d>1?this._map(l,!0):null,y=(s<<5)+(t+1)+this.points.length,_=0,w=u;_<w.length;_+=1){var x=c.points[w[_]];if(!(x.zoom<=t)){x.zoom=t;var k=x.numPoints||1;g+=x.x*k,b+=x.y*k,x.parentId=y,o&&(v||(v=this._map(l,!0)),o(v,this._map(x)))}}l.parentId=y,r.push(N(g/h,b/h,y,h,v))}else if(r.push(l),h>1)for(var C=0,E=u;C<E.length;C+=1){var S=c.points[E[C]];S.zoom<=t||(S.zoom=t,r.push(S))}}}return r},L.prototype._getOriginId=function(e){return e-this.points.length>>5},L.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},L.prototype._map=function(e,t){if(e.numPoints)return t?H({},e.properties):e.properties;var r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?H({},n):n},be.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},be.prototype.splitTile=function(e,t,r,n,o,i,a){for(var s=[e,t,r,n],l=this.options,c=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var u=1<<t,d=ve(t,r,n),h=this.tiles[d];if(!h&&(c>1&&console.time("creation"),h=this.tiles[d]=fe(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=e,o){if(t===l.maxZoom||t===o)continue;var f=1<<o-t;if(r!==Math.floor(i/f)||n!==Math.floor(a/f))continue}else if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,b,v,y,_,w=.5*l.buffer/l.extent,x=.5-w,k=.5+w,C=1+w;m=g=b=v=null,y=re(e,u,r-w,r+k,0,h.minX,h.maxX,l),_=re(e,u,r+x,r+C,0,h.minX,h.maxX,l),e=null,y&&(m=re(y,u,n-w,n+k,1,h.minY,h.maxY,l),g=re(y,u,n+x,n+C,1,h.minY,h.maxY,l),y=null),_&&(b=re(_,u,n-w,n+k,1,h.minY,h.maxY,l),v=re(_,u,n+x,n+C,1,h.minY,h.maxY,l),_=null),c>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*r,2*n),s.push(g||[],t+1,2*r,2*n+1),s.push(b||[],t+1,2*r+1,2*n),s.push(v||[],t+1,2*r+1,2*n+1)}}},be.prototype.getTile=function(e,t,r){var n=this.options,o=n.extent,i=n.debug;if(e<0||e>24)return null;var a=1<<e,s=ve(e,t=(t%a+a)%a,r);if(this.tiles[s])return he(this.tiles[s],o);i>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,c=e,u=t,d=r;!l&&c>0;)c--,u=Math.floor(u/2),d=Math.floor(d/2),l=this.tiles[ve(c,u,d)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",c,u,d),i>1&&console.time("drilling down"),this.splitTile(l.source,c,u,d,e,t,r),i>1&&console.timeEnd("drilling down"),this.tiles[s]?he(this.tiles[s],o):null):null};var _e=function(t){function r(e,r,n,o){t.call(this,e,r,n,ye),o&&(this.loadGeoJSON=o)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.loadData=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=t,this._pendingLoadDataParams=e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var r=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var o=!!(n&&n.request&&n.request.collectResourceTiming)&&new e.RequestPerformance(n.request);this.loadGeoJSON(n,(function(i,a){if(i||!a)return r(i);if("object"!=typeof a)return r(new Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."));!function e(t,r){var n,o=t&&t.type;if("FeatureCollection"===o)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===o)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===o)e(t.geometry,r);else if("Polygon"===o)d(t.coordinates,r);else if("MultiPolygon"===o)for(n=0;n<t.coordinates.length;n++)d(t.coordinates[n],r);return t}(a,!0);try{if(n.filter){var s=e.createExpression(n.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===s.result)throw new Error(s.value.map((function(e){return e.key+": "+e.message})).join(", "));var l=a.features.filter((function(e){return s.value.evaluate({zoom:0},e)}));a={type:"FeatureCollection",features:l}}t._geoJSONIndex=n.cluster?new L(function(t){var r=t.superclusterOptions,n=t.clusterProperties;if(!n||!r)return r;for(var o={},i={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(n),c=0,u=l;c<u.length;c+=1){var d=u[c],h=n[d],p=h[0],f=e.createExpression(h[1]),m=e.createExpression("string"==typeof p?[p,["accumulated"],["get",d]]:p);o[d]=f.value,i[d]=m.value}return r.map=function(e){s.properties=e;for(var t={},r=0,n=l;r<n.length;r+=1){var i=n[r];t[i]=o[i].evaluate(a,s)}return t},r.reduce=function(e,t){s.properties=t;for(var r=0,n=l;r<n.length;r+=1){var o=n[r];a.accumulated=e[o],e[o]=i[o].evaluate(a,s)}},r}(n)).load(a.features):function(e,t){return new be(e,t)}(a,n.geojsonVtOptions)}catch(i){return r(i)}t.loaded={};var c={};if(o){var u=o.finish();u&&(c.resourceTiming={},c.resourceTiming[n.source]=JSON.parse(JSON.stringify(u)))}r(null,c)}))}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(e,r){var n=this.loaded;return n&&n[e.uid]?t.prototype.reloadTile.call(this,e,r):this.loadTile(e,r)},r.prototype.loadGeoJSON=function(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()},r.prototype.getClusterExpansionZoom=function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}},r.prototype.getClusterChildren=function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}},r.prototype.getClusterLeaves=function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}},r}(l),we=function(t){var r=this;this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:_e},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(r.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');r.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}};return we.prototype.setReferrer=function(e,t){this.referrer=t},we.prototype.setImages=function(e,t,r){for(var n in this.availableImages[e]=t,this.workerSources[e]){var o=this.workerSources[e][n];for(var i in o)o[i].availableImages=t}r()},we.prototype.setLayers=function(e,t,r){this.getLayerIndex(e).replace(t),r()},we.prototype.updateLayers=function(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()},we.prototype.loadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)},we.prototype.loadDEMTile=function(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)},we.prototype.reloadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)},we.prototype.abortTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)},we.prototype.removeTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)},we.prototype.removeDEMTile=function(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)},we.prototype.removeSource=function(e,t,r){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}},we.prototype.loadWorkerSource=function(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}},we.prototype.syncRTLPluginState=function(t,r,n){try{e.plugin.setState(r);var o=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=o){this.self.importScripts(o);var i=e.plugin.isParsed();n(i?void 0:new Error("RTL Text Plugin failed to import scripts from "+o),i)}}catch(e){n(e.toString())}},we.prototype.getAvailableImages=function(e){var t=this.availableImages[e];return t||(t=[]),t},we.prototype.getLayerIndex=function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t},we.prototype.getWorkerSource=function(e,t,r){var n=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][r]||(this.workerSources[e][t][r]=new this.workerSourceTypes[t]({send:function(t,r,o){n.actor.send(t,r,o,e)}},this.getLayerIndex(e),this.getAvailableImages(e))),this.workerSources[e][t][r]},we.prototype.getDEMWorkerSource=function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new u),this.demWorkerSources[e][t]},we.prototype.enforceCacheSizeLimit=function(t,r){e.enforceCacheSizeLimit(r)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new we(self)),we})),n(0,(function(e){var t=e.createCommonjsModule((function(e){function t(e){return!r(e)}function r(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}()?(void 0===n[r=e&&e.failIfMajorPerformanceCaveat]&&(n[r]=function(e){var r=function(e){var r=document.createElement("canvas"),n=Object.create(t.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(e);if(!r)return!1;var n=r.createShader(r.VERTEX_SHADER);return!(!n||r.isContextLost())&&(r.shaderSource(n,"void main() {}"),r.compileShader(n),!0===r.getShaderParameter(n,r.COMPILE_STATUS))}(r)),n[r]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}e.exports?e.exports=t:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=t,window.mapboxgl.notSupportedReason=r);var n={};t.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),r={create:function(t,r,n){var o=e.window.document.createElement(t);return void 0!==r&&(o.className=r),n&&n.appendChild(o),o},createNS:function(t,r){return e.window.document.createElementNS(t,r)}},n=e.window.document&&e.window.document.documentElement.style;function o(e){if(!n)return e[0];for(var t=0;t<e.length;t++)if(e[t]in n)return e[t];return e[0]}var i,a=o(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){n&&a&&(i=n[a],n[a]="none")},r.enableDrag=function(){n&&a&&(n[a]=i)};var s=o(["transform","WebkitTransform"]);r.setTransform=function(e,t){e.style[s]=t};var l=!1;try{var c=Object.defineProperty({},"passive",{get:function(){l=!0}});e.window.addEventListener("test",c,c),e.window.removeEventListener("test",c,c)}catch(e){l=!1}r.addEventListener=function(e,t,r,n){void 0===n&&(n={}),e.addEventListener(t,r,"passive"in n&&l?n:n.capture)},r.removeEventListener=function(e,t,r,n){void 0===n&&(n={}),e.removeEventListener(t,r,"passive"in n&&l?n:n.capture)};var u=function(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",u,!0)};function d(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}r.suppressClick=function(){e.window.addEventListener("click",u,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",u,!0)}),0)},r.mousePos=function(t,r){var n=t.getBoundingClientRect();return new e.Point(r.clientX-n.left-t.clientLeft,r.clientY-n.top-t.clientTop)},r.touchPos=function(t,r){for(var n=t.getBoundingClientRect(),o=[],i=0;i<r.length;i++)o.push(new e.Point(r[i].clientX-n.left-t.clientLeft,r[i].clientY-n.top-t.clientTop));return o},r.mouseButton=function(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button},r.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var h=function(t){function r(){t.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.isLoaded=function(){return this.loaded},r.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e,e)){for(var t=0,r=this.requestors;t<r.length;t+=1){var n=r[t];this._notify(n.ids,n.callback)}this.requestors=[]}},r.prototype.getImage=function(e){return this.images[e]},r.prototype.addImage=function(e,t){this._validate(e,t)&&(this.images[e]=t)},r.prototype._validate=function(t,r){var n=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchX" value'))),n=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchY" value'))),n=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "content" value'))),n=!1),n},r.prototype._validateStretch=function(e,t){if(!e)return!0;for(var r=0,n=0,o=e;n<o.length;n+=1){var i=o[n];if(i[0]<r||i[1]<i[0]||t<i[1])return!1;r=i[1]}return!0},r.prototype._validateContent=function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))},r.prototype.updateImage=function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0},r.prototype.removeImage=function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},r.prototype.listImages=function(){return Object.keys(this.images)},r.prototype.getImages=function(e,t){var r=!0;if(!this.isLoaded())for(var n=0,o=e;n<o.length;n+=1)this.images[o[n]]||(r=!1);this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})},r.prototype._notify=function(t,r){for(var n={},o=0,i=t;o<i.length;o+=1){var a=i[o];this.images[a]||this.fire(new e.Event("styleimagemissing",{id:a}));var s=this.images[a];s?n[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}r(null,n)},r.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},r.prototype.getPattern=function(t){var r=this.patterns[t],n=this.getImage(t);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{var o={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new e.ImagePosition(o,n);this.patterns[t]={bin:o,position:i}}return this._updatePatternAtlas(),this.patterns[t].position},r.prototype.bind=function(t){var r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)},r.prototype._updatePatternAtlas=function(){var t=[];for(var r in this.patterns)t.push(this.patterns[r].bin);var n=e.potpack(t),o=n.w,i=n.h,a=this.atlasImage;for(var s in a.resize({width:o||1,height:i||1}),this.patterns){var l=this.patterns[s].bin,c=l.x+1,u=l.y+1,d=this.images[s].data,h=d.width,p=d.height;e.RGBAImage.copy(d,a,{x:0,y:0},{x:c,y:u},{width:h,height:p}),e.RGBAImage.copy(d,a,{x:0,y:p-1},{x:c,y:u-1},{width:h,height:1}),e.RGBAImage.copy(d,a,{x:0,y:0},{x:c,y:u+p},{width:h,height:1}),e.RGBAImage.copy(d,a,{x:h-1,y:0},{x:c-1,y:u},{width:1,height:p}),e.RGBAImage.copy(d,a,{x:0,y:0},{x:c+h,y:u},{width:1,height:p})}this.dirty=!0},r.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},r.prototype.dispatchRenderCallbacks=function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(!this.callbackDispatchedThisFrame[n]){this.callbackDispatchedThisFrame[n]=!0;var o=this.images[n];d(o)&&this.updateImage(n,o)}}},r}(e.Evented),p=g,f=g,m=1e20;function g(e,t,r,n,o,i){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=n||.25,this.fontFamily=o||"sans-serif",this.fontWeight=i||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function b(e,t,r,n,o,i,a){for(var s=0;s<t;s++){for(var l=0;l<r;l++)n[l]=e[l*t+s];for(v(n,o,i,a,r),l=0;l<r;l++)e[l*t+s]=o[l]}for(l=0;l<r;l++){for(s=0;s<t;s++)n[s]=e[l*t+s];for(v(n,o,i,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(o[s])}}function v(e,t,r,n,o){r[0]=0,n[0]=-m,n[1]=+m;for(var i=1,a=0;i<o;i++){for(var s=(e[i]+i*i-(e[r[a]]+r[a]*r[a]))/(2*i-2*r[a]);s<=n[a];)a--,s=(e[i]+i*i-(e[r[a]]+r[a]*r[a]))/(2*i-2*r[a]);r[++a]=i,n[a]=s,n[a+1]=+m}for(i=0,a=0;i<o;i++){for(;n[a+1]<i;)a++;t[i]=(i-r[a])*(i-r[a])+e[r[a]]}}g.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var o=t.data[4*n+3]/255;this.gridOuter[n]=1===o?0:0===o?m:Math.pow(Math.max(0,.5-o),2),this.gridInner[n]=1===o?m:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++)r[n]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[n]-this.gridInner[n])/this.radius+this.cutoff))));return r},p.default=f;var y=function(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}};y.prototype.setURL=function(e){this.url=e},y.prototype.getGlyphs=function(t,r){var n=this,o=[];for(var i in t)for(var a=0,s=t[i];a<s.length;a+=1)o.push({stack:i,id:s[a]});e.asyncAll(o,(function(e,t){var r=e.stack,o=e.id,i=n.entries[r];i||(i=n.entries[r]={glyphs:{},requests:{},ranges:{}});var a=i.glyphs[o];if(void 0===a){if(a=n._tinySDF(i,r,o))return i.glyphs[o]=a,void t(null,{stack:r,id:o,glyph:a});var s=Math.floor(o/256);if(256*s>65535)t(new Error("glyphs > 65535 not supported"));else if(i.ranges[s])t(null,{stack:r,id:o,glyph:a});else{var l=i.requests[s];l||(l=i.requests[s]=[],y.loadGlyphRange(r,s,n.url,n.requestManager,(function(e,t){if(t){for(var r in t)n._doesCharSupportLocalGlyph(+r)||(i.glyphs[+r]=t[+r]);i.ranges[s]=!0}for(var o=0,a=l;o<a.length;o+=1)(0,a[o])(e,t);delete i.requests[s]}))),l.push((function(e,n){e?t(e):n&&t(null,{stack:r,id:o,glyph:n[o]||null})}))}}else t(null,{stack:r,id:o,glyph:a})}),(function(e,t){if(e)r(e);else if(t){for(var n={},o=0,i=t;o<i.length;o+=1){var a=i[o],s=a.stack,l=a.id,c=a.glyph;(n[s]||(n[s]={}))[l]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}r(null,n)}}))},y.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](t)||e.isChar["Hangul Syllables"](t)||e.isChar.Hiragana(t)||e.isChar.Katakana(t))},y.prototype._tinySDF=function(t,r,n){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(n)){var i=t.tinySDF;if(!i){var a="400";/bold/i.test(r)?a="900":/medium/i.test(r)?a="500":/light/i.test(r)&&(a="200"),i=t.tinySDF=new y.TinySDF(24,3,8,.25,o,a)}return{id:n,bitmap:new e.AlphaImage({width:30,height:30},i.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},y.loadGlyphRange=function(t,r,n,o,i){var a=256*r,s=a+255,l=o.transformRequest(o.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",a+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,(function(t,r){if(t)i(t);else if(r){for(var n={},o=0,a=e.parseGlyphPBF(r);o<a.length;o+=1){var s=a[o];n[s.id]=s}i(null,n)}}))},y.TinySDF=p;var _=function(){this.specification=e.styleSpec.light.position};_.prototype.possiblyEvaluate=function(t,r){return e.sphericalToCartesian(t.expression.evaluate(r))},_.prototype.interpolate=function(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n)}};var w=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new _,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),x=function(t){function r(r){t.call(this),this._transitionable=new e.Transitionable(w),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(t,r){if(void 0===r&&(r={}),!this._validate(e.validateLight,t,r))for(var n in t){var o=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),o):this._transitionable.setValue(n,o)}},r.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},r.prototype._validate=function(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},r}(e.Evented),k=function(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};k.prototype.getDash=function(e,t){var r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]},k.prototype.getDashRanges=function(e,t,r){var n=[],o=e.length%2==1?-e[e.length-1]*r:0,i=e[0]*r,a=!0;n.push({left:o,right:i,isDash:a,zeroLength:0===e[0]});for(var s=e[0],l=1;l<e.length;l++){var c=e[l];n.push({left:o=s*r,right:i=(s+=c)*r,isDash:a=!a,zeroLength:0===c})}return n},k.prototype.addRoundDash=function(e,t,r){for(var n=t/2,o=-r;o<=r;o++)for(var i=this.width*(this.nextRow+r+o),a=0,s=e[a],l=0;l<this.width;l++){l/s.right>1&&(s=e[++a]);var c=Math.abs(l-s.left),u=Math.abs(l-s.right),d=Math.min(c,u),h=void 0,p=o/r*(n+1);if(s.isDash){var f=n-Math.abs(p);h=Math.sqrt(d*d+f*f)}else h=n-Math.sqrt(d*d+p*p);this.data[i+l]=Math.max(0,Math.min(255,h+128))}},k.prototype.addRegularDash=function(e){for(var t=e.length-1;t>=0;--t){var r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}var o=e[0],i=e[e.length-1];o.isDash===i.isDash&&(o.left=i.left-this.width,i.right=o.right+this.width);for(var a=this.width*this.nextRow,s=0,l=e[s],c=0;c<this.width;c++){c/l.right>1&&(l=e[++s]);var u=Math.abs(c-l.left),d=Math.abs(c-l.right),h=Math.min(u,d);this.data[a+c]=Math.max(0,Math.min(255,(l.isDash?h:-h)+128))}},k.prototype.addDash=function(t,r){var n=r?7:0,o=2*n+1;if(this.nextRow+o>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var i=0,a=0;a<t.length;a++)i+=t[a];if(0!==i){var s=this.width/i,l=this.getDashRanges(t,this.width,s);r?this.addRoundDash(l,s,n):this.addRegularDash(l)}var c={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:i};return this.nextRow+=o,this.dirty=!0,c},k.prototype.bind=function(e){var t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))};var C=function t(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var o=this.workerPool.acquire(this.id),i=0;i<o.length;i++){var a=new t.Actor(o[i],n,this.id);a.name="Worker "+i,this.actors.push(a)}};function E(t,r,n){var o=function(o,i){if(o)return n(o);if(i){var a=e.pick(e.extend(i,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(a.vectorLayers=i.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(e){return e.id}))),a.tiles=r.canonicalizeTileset(a,t.url),n(null,a)}};return t.url?e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url),e.ResourceType.Source),o):e.browser.frame((function(){return o(null,t)}))}C.prototype.broadcast=function(t,r,n){e.asyncAll(this.actors,(function(e,n){e.send(t,r,n)}),n=n||function(){})},C.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},C.prototype.remove=function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)},C.Actor=e.Actor;var S=function(t,r,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=n||24};S.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]},S.prototype.contains=function(t){var r=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),o=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),i=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),a=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=n&&t.x<i&&t.y>=o&&t.y<a};var T=function(t){function r(r,n,o,i){if(t.call(this),this.id=r,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(n,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,(function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new S(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles,t.map._requestManager._customAccessToken),e.postMapLoadEvent(n.tiles,t.map._getMapId(),t.map._requestManager._skuToken,t.map._requestManager._customAccessToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},r.prototype.loaded=function(){return this._loaded},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setSourceProperty=function(e){this._tileJSONRequest&&this._tileJSONRequest.cancel(),e(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},r.prototype.setTiles=function(e){var t=this;return this.setSourceProperty((function(){t._options.tiles=e})),this},r.prototype.setUrl=function(e){var t=this;return this.setSourceProperty((function(){t.url=e,t._options.url=e})),this},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.loadTile=function(t,r){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function i(n,o){return delete t.request,t.aborted?r(null):n&&404!==n.status?r(n):(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}o.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",o,i.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",o,i.bind(this)))},r.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)},r.prototype.unloadTile=function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)},r.prototype.hasTransition=function(){return!1},r}(e.Evented),A=function(t){function r(r,n,o,i){t.call(this),this.id=r,this.dispatcher=o,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},n),e.extend(this,e.pick(n,["url","scheme","tileSize"]))}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,(function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new S(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles),e.postMapLoadEvent(n.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},r.prototype.loaded=function(){return this._loaded},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.loadTile=function(t,r){var n=this,o=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(o,e.ResourceType.Tile),(function(o,i){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(o)t.state="errored",r(o);else if(i){n.map._refreshExpiredTiles&&t.setExpiryData(i),delete i.cacheControl,delete i.expires;var a=n.map.painter.context,s=a.gl;t.texture=n.map.painter.getTileTexture(i.width),t.texture?t.texture.update(i,{useMipmap:!0}):(t.texture=new e.Texture(a,i,s.RGBA,{useMipmap:!0}),t.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(n.dispatcher),r(null)}}))},r.prototype.abortTile=function(e,t){e.request&&(e.request.cancel(),delete e.request),t()},r.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},r.prototype.hasTransition=function(){return!1},r}(e.Evented),P=function(t){function r(r,n,o,i){t.call(this,r,n,o,i),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(t,r){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function o(e,n){e&&(t.state="errored",r(e)),n&&(t.dem=n,t.needsHillshadePrepare=!0,t.state="loaded",r(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,i){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(i){this.map._refreshExpiredTiles&&t.setExpiryData(i),delete i.cacheControl,delete i.expires;var a=e.window.ImageBitmap&&i instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?i:e.browser.getImageData(i,1),s={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:a,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",s,o.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)},r.prototype._getNeighboringTiles=function(t){var r=t.canonical,n=Math.pow(2,r.z),o=(r.x-1+n)%n,i=0===r.x?t.wrap-1:t.wrap,a=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,i,r.z,o,r.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,i,r.z,o,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,i,r.z,o,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})},r}(A),I=function(t){function r(r,n,o,i){t.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(i),this._data=n.data,this._options=e.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;var a=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:e.EXTENT,radius:(n.clusterRadius||50)*a,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(r){if(r)t.fire(new e.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&t._resourceTiming.length>0&&(n.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new e.Event("data",n))}}))},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setData=function(t){var r=this;return this._data=t,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(t){if(t)r.fire(new e.ErrorEvent(t));else{var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new e.Event("data",n))}})),this},r.prototype.getClusterExpansionZoom=function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this},r.prototype.getClusterChildren=function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this},r.prototype.getClusterLeaves=function(e,t,r,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},n),this},r.prototype._updateWorkerData=function(t){var r=this;this._loaded=!1;var n=e.extend({},this.workerOptions),o=this._data;"string"==typeof o?(n.request=this.map._requestManager.transformRequest(e.browser.resolveURL(o),e.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(o),this.actor.send(this.type+".loadData",n,(function(e,o){r._removed||o&&o.abandoned||(r._loaded=!0,o&&o.resourceTiming&&o.resourceTiming[r.id]&&(r._resourceTiming=o.resourceTiming[r.id].slice(0)),r.actor.send(r.type+".coalesce",{source:n.source},null),t(e))}))},r.prototype.loaded=function(){return this._loaded},r.prototype.loadTile=function(t,r){var n=this,o=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(o,{type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,i){return delete t.request,t.unloadVectorData(),t.aborted?r(null):e?r(e):(t.loadVectorData(i,n.map.painter,"reloadTile"===o),r(null))}))},r.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0},r.prototype.unloadTile=function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})},r.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},r.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(e.Evented),O=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),M=function(t){function r(e,r,n,o){t.call(this),this.id=e,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=r}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(t,r){var n=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(o,i){n._loaded=!0,o?n.fire(new e.ErrorEvent(o)):i&&(n.image=i,t&&(n.coordinates=t),r&&r(),n._finishLoading())}))},r.prototype.loaded=function(){return this._loaded},r.prototype.updateImage=function(e){var t=this;return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,(function(){t.texture=null})),this):this},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setCoordinates=function(t){var r=this;this.coordinates=t;var n=t.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(t){for(var r=1/0,n=1/0,o=-1/0,i=-1/0,a=0,s=t;a<s.length;a+=1){var l=s[a];r=Math.min(r,l.x),n=Math.min(n,l.y),o=Math.max(o,l.x),i=Math.max(i,l.y)}var c=Math.max(o-r,i-n),u=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),d=Math.pow(2,u);return new e.CanonicalTileID(u,Math.floor((r+o)/2*d),Math.floor((n+i)/2*d))}(n),this.minzoom=this.maxzoom=this.tileID.z;var o=n.map((function(e){return r.tileID.getTilePoint(e)._round()}));return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[n];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},r.prototype.loadTile=function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(e.Evented),D=function(t){function r(e,r,n,o){t.call(this,e,r,n,o),this.roundZoom=!0,this.type="video",this.options=r}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1;var r=this.options;this.urls=[];for(var n=0,o=r.urls;n<o.length;n+=1)this.urls.push(this.map._requestManager.transformRequest(o[n],e.ResourceType.Source).url);e.getVideo(this.urls,(function(r,n){t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(t.video=n,t.video.loop=!0,t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))},r.prototype.pause=function(){this.video&&this.video.pause()},r.prototype.play=function(){this.video&&this.video.play()},r.prototype.seek=function(t){if(this.video){var r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+r.start(0)+" and "+r.end(0)+"-second mark."))):this.video.currentTime=t}},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[n];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(M),z=function(t){function r(r,n,o,i){t.call(this,r,n,o,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(r,this.canvas,n.RGBA,{premultiply:!0}),this.tiles){var i=this.tiles[o];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e+=1){var r=t[e];if(isNaN(r)||r<=0)return!0}return!1},r}(M),j={vector:T,raster:A,"raster-dem":P,geojson:I,video:D,image:M,canvas:z};function R(t,r){var n=e.identity([]);return e.translate(n,n,[1,1,0]),e.scale(n,n,[.5*t.width,.5*t.height,1]),e.multiply(n,n,t.calculatePosMatrix(r.toUnwrapped()))}function L(e,t,r,n,o,i){var a=function(e,t,r){if(e)for(var n=0,o=e;n<o.length;n+=1){var i=t[o[n]];if(i&&i.source===r&&"fill-extrusion"===i.type)return!0}else for(var a in t){var s=t[a];if(s.source===r&&"fill-extrusion"===s.type)return!0}return!1}(o&&o.layers,t,e.id),s=i.maxPitchScaleFactor(),l=e.tilesIn(n,s,a);l.sort(N);for(var c=[],u=0,d=l;u<d.length;u+=1){var h=d[u];c.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,r,e._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,o,i,s,R(e.transform,h.tileID))})}var p=function(e){for(var t={},r={},n=0,o=e;n<o.length;n+=1){var i=o[n],a=i.queryResults,s=i.wrappedTileID,l=r[s]=r[s]||{};for(var c in a)for(var u=a[c],d=l[c]=l[c]||{},h=t[c]=t[c]||[],p=0,f=u;p<f.length;p+=1){var m=f[p];d[m.featureIndex]||(d[m.featureIndex]=!0,h.push(m))}}return t}(c);for(var f in p)p[f].forEach((function(t){var r=t.feature,n=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}));return p}function N(e,t){var r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var B=function(e,t){this.max=e,this.onRemove=t,this.reset()};B.prototype.reset=function(){for(var e in this.data)for(var t=0,r=this.data[e];t<r.length;t+=1){var n=r[t];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},B.prototype.add=function(e,t,r){var n=this,o=e.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);var i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((function(){n.remove(e,i)}),r)),this.data[o].push(i),this.order.push(o),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},B.prototype.has=function(e){return e.wrapped().key in this.data},B.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},B.prototype._getAndRemoveByKey=function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value},B.prototype.getByKey=function(e){var t=this.data[e];return t?t[0].value:null},B.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},B.prototype.remove=function(e,t){if(!this.has(e))return this;var r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),o=this.data[r][n];return this.data[r].splice(n,1),o.timeout&&clearTimeout(o.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(o.value),this.order.splice(this.order.indexOf(r),1),this},B.prototype.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this},B.prototype.filter=function(e){var t=[];for(var r in this.data)for(var n=0,o=this.data[r];n<o.length;n+=1){var i=o[n];e(i.value)||t.push(i)}for(var a=0,s=t;a<s.length;a+=1){var l=s[a];this.remove(l.value.tileID,l)}};var F=function(e,t,r){this.context=e;var n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};F.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},F.prototype.updateData=function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},F.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var V={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},U=function(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;var o=e.gl;this.buffer=o.createBuffer(),e.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};U.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},U.prototype.updateData=function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)},U.prototype.enableAttributes=function(e,t){for(var r=0;r<this.attributes.length;r++){var n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}},U.prototype.setVertexAttribPointers=function(e,t,r){for(var n=0;n<this.attributes.length;n++){var o=this.attributes[n],i=t.attributes[o.name];void 0!==i&&e.vertexAttribPointer(i,o.components,e[V[o.type]],!1,this.itemSize,o.offset+this.itemSize*(r||0))}},U.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var q=function(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(e){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var H=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getDefault=function(){return e.Color.transparent},r.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},r}(q),W=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 1},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},t}(q),G=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},t}(q),Z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[!0,!0,!0,!0]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(q),Y=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)},t}(q),$=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 255},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},t}(q),K=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},t.prototype.set=function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)},t}(q),X=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)},t}(q),J=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}},t}(q),Q=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[0,1]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)},t}(q),ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}},t}(q),te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.LESS},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},t}(q),re=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}},t}(q),ne=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)},t}(q),oe=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getDefault=function(){return e.Color.transparent},r.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},r}(q),ie=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.FUNC_ADD},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},t}(q),ae=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}},t}(q),se=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.BACK},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)},t}(q),le=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.CCW},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)},t}(q),ce=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)},t}(q),ue=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.TEXTURE0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},t}(q),de=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(q),he=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}},t}(q),pe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(q),fe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}},t}(q),me=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},t}(q),ge=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1},t}(q),be=function(e){function t(t){e.call(this,t),this.vao=t.extVertexArrayObject}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},t}(q),ve=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 4},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}},t}(q),ye=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}},t}(q),_e=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}},t}(q),we=function(e){function t(t,r){e.call(this,t),this.context=t,this.parent=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t}(q),xe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.setDirty=function(){this.dirty=!0},t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},t}(we),ke=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(we),Ce=function(e,t,r,n){this.context=e,this.width=t,this.height=r;var o=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new xe(e,o),n&&(this.depthAttachment=new ke(e,o))};Ce.prototype.destroy=function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)};var Ee=function(e,t,r){this.func=e,this.mask=t,this.range=r};Ee.ReadOnly=!1,Ee.ReadWrite=!0,Ee.disabled=new Ee(519,Ee.ReadOnly,[0,1]);var Se=function(e,t,r,n,o,i){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=o,this.pass=i};Se.disabled=new Se({func:519,mask:0},0,0,7680,7680,7680);var Te=function(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r};Te.disabled=new Te(Te.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Te.unblended=new Te(Te.Replace,e.Color.transparent,[!0,!0,!0,!0]),Te.alphaBlended=new Te([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Ae=function(e,t,r){this.enable=e,this.mode=t,this.frontFace=r};Ae.disabled=new Ae(!1,1029,2305),Ae.backCCW=new Ae(!0,1029,2305);var Pe=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new H(this),this.clearDepth=new W(this),this.clearStencil=new G(this),this.colorMask=new Z(this),this.depthMask=new Y(this),this.stencilMask=new $(this),this.stencilFunc=new K(this),this.stencilOp=new X(this),this.stencilTest=new J(this),this.depthRange=new Q(this),this.depthTest=new ee(this),this.depthFunc=new te(this),this.blend=new re(this),this.blendFunc=new ne(this),this.blendColor=new oe(this),this.blendEquation=new ie(this),this.cullFace=new ae(this),this.cullFaceSide=new se(this),this.frontFace=new le(this),this.program=new ce(this),this.activeTexture=new ue(this),this.viewport=new de(this),this.bindFramebuffer=new he(this),this.bindRenderbuffer=new pe(this),this.bindTexture=new fe(this),this.bindVertexBuffer=new me(this),this.bindElementBuffer=new ge(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new be(this),this.pixelStoreUnpack=new ve(this),this.pixelStoreUnpackPremultiplyAlpha=new ye(this),this.pixelStoreUnpackFlipY=new _e(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)};Pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pe.prototype.createIndexBuffer=function(e,t){return new F(this,e,t)},Pe.prototype.createVertexBuffer=function(e,t,r){return new U(this,e,t,r)},Pe.prototype.createRenderbuffer=function(e,t,r){var n=this.gl,o=n.createRenderbuffer();return this.bindRenderbuffer.set(o),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),o},Pe.prototype.createFramebuffer=function(e,t,r){return new Ce(this,e,t,r)},Pe.prototype.clear=function(e){var t=e.color,r=e.depth,n=this.gl,o=0;t&&(o|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(o|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(o)},Pe.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},Pe.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Pe.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Pe.prototype.setColorMode=function(t){e.deepEqual(t.blendFunction,Te.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},Pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ie=function(t){function r(r,n,o){var i=this;t.call(this),this.id=r,this.dispatcher=o,this.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))})),this.on("error",(function(){i._sourceErrored=!0})),this._source=function(t,r,n,o){var i=new j[r.type](t,r,n,o);if(i.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+i.id);return e.bindAll(["load","abort","unload","serialize","prepare"],i),i}(r,n,o,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},r.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},r.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))},r.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}},r.prototype.getIds=function(){return e.values(this._tiles).map((function(e){return e.tileID})).sort(Oe).map((function(e){return e.key}))},r.prototype.getRenderableIds=function(t){var r=this,n=[];for(var o in this._tiles)this._isIdRenderable(o,t)&&n.push(this._tiles[o]);return t?n.sort((function(t,n){var o=t.tileID,i=n.tileID,a=new e.Point(o.canonical.x,o.canonical.y)._rotate(r.transform.angle),s=new e.Point(i.canonical.x,i.canonical.y)._rotate(r.transform.angle);return o.overscaledZ-i.overscaledZ||s.y-a.y||s.x-a.x})).map((function(e){return e.tileID.key})):n.map((function(e){return e.tileID})).sort(Oe).map((function(e){return e.key}))},r.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)},r.prototype._isIdRenderable=function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},r.prototype._reloadTile=function(e,t){var r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))},r.prototype._tileLoaded=function(t,r,n,o){if(o)return t.state="errored",void(404!==o.status?this._source.fire(new e.ErrorEvent(o,{tile:t})):this.update(this.transform));t.timeAdded=e.browser.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},r.prototype._backfillDEM=function(e){for(var t=this.getRenderableIds(),r=0;r<t.length;r++){var n=t[r];if(e.neighboringTiles&&e.neighboringTiles[n]){var o=this.getTileByID(n);i(e,o),i(o,e)}}function i(e,t){e.needsHillshadePrepare=!0;var r=t.tileID.canonical.x-e.tileID.canonical.x,n=t.tileID.canonical.y-e.tileID.canonical.y,o=Math.pow(2,e.tileID.canonical.z),i=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+o)?r+=o:1===Math.abs(r-o)&&(r-=o)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[i]&&(e.neighboringTiles[i].backfilled=!0)))}},r.prototype.getTile=function(e){return this.getTileByID(e.key)},r.prototype.getTileByID=function(e){return this._tiles[e]},r.prototype._retainLoadedChildren=function(e,t,r,n){for(var o in this._tiles){var i=this._tiles[o];if(!(n[o]||!i.hasData()||i.tileID.overscaledZ<=t||i.tileID.overscaledZ>r)){for(var a=i.tileID;i&&i.tileID.overscaledZ>t+1;){var s=i.tileID.scaledTo(i.tileID.overscaledZ-1);(i=this._tiles[s.key])&&i.hasData()&&(a=s)}for(var l=a;l.overscaledZ>t;)if(e[(l=l.scaledTo(l.overscaledZ-1)).key]){n[a.key]=a;break}}}},r.prototype.findLoadedParent=function(e,t){if(e.key in this._loadedParentTiles){var r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(var n=e.overscaledZ-1;n>=t;n--){var o=e.scaledTo(n),i=this._getLoadedTile(o);if(i)return i}},r.prototype._getLoadedTile=function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)},r.prototype.updateCacheSize=function(e){var t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=Math.floor(t*r*5),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(o)},r.prototype.handleWrapJump=function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var r={};for(var n in this._tiles){var o=this._tiles[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),r[o.tileID.key]=o}for(var i in this._tiles=r,this._timers)clearTimeout(this._timers[i]),delete this._timers[i];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},r.prototype.update=function(t){var n=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var o;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?o=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)})):(o=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(o=o.filter((function(e){return n._source.hasTile(e)})))):o=[];var i=t.coveringZoomLevel(this._source),a=Math.max(i-r.maxOverzooming,this._source.minzoom),s=Math.max(i+r.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(o,i);if(Me(this._source.type)){for(var c={},u={},d=0,h=Object.keys(l);d<h.length;d+=1){var p=h[d],f=l[p],m=this._tiles[p];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=e.browser.now())){var g=this.findLoadedParent(f,a);g&&(this._addTile(g.tileID),c[g.tileID.key]=g.tileID),u[p]=f}}for(var b in this._retainLoadedChildren(u,i,s,l),c)l[b]||(this._coveredTiles[b]=!0,l[b]=c[b])}for(var v in l)this._tiles[v].clearFadeHold();for(var y=0,_=e.keysDifference(this._tiles,l);y<_.length;y+=1){var w=_[y],x=this._tiles[w];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(w)}this._updateLoadedParentTileCache()}},r.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},r.prototype._updateRetainedTiles=function(e,t){for(var n={},o={},i=Math.max(t-r.maxOverzooming,this._source.minzoom),a=Math.max(t+r.maxUnderzooming,this._source.minzoom),s={},l=0,c=e;l<c.length;l+=1){var u=c[l],d=this._addTile(u);n[u.key]=u,d.hasData()||t<this._source.maxzoom&&(s[u.key]=u)}this._retainLoadedChildren(s,t,a,n);for(var h=0,p=e;h<p.length;h+=1){var f=p[h],m=this._tiles[f.key];if(!m.hasData()){if(t+1>this._source.maxzoom){var g=f.children(this._source.maxzoom)[0],b=this.getTile(g);if(b&&b.hasData()){n[g.key]=g;continue}}else{var v=f.children(this._source.maxzoom);if(n[v[0].key]&&n[v[1].key]&&n[v[2].key]&&n[v[3].key])continue}for(var y=m.wasRequested(),_=f.overscaledZ-1;_>=i;--_){var w=f.scaledTo(_);if(o[w.key])break;if(o[w.key]=!0,!(m=this.getTile(w))&&y&&(m=this._addTile(w)),m&&(n[w.key]=w,y=m.wasRequested(),m.hasData()))break}}}return n},r.prototype._updateLoadedParentTileCache=function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],r=void 0,n=this._tiles[e].tileID;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);var o=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(o))break;n=o}for(var i=0,a=t;i<a.length;i+=1)this._loadedParentTiles[a[i]]=r}},r.prototype._addTile=function(t){var r=this._tiles[t.key];if(r)return r;(r=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));var n=Boolean(r);return n||(r=new e.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))),r?(r.uses++,this._tiles[t.key]=r,n||this._source.fire(new e.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(e,t){var r=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((function(){r._reloadTile(e,"expired"),delete r._timers[e]}),n))},r.prototype._removeTile=function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},r.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},r.prototype.tilesIn=function(t,r,n){var o=this,i=[],a=this.transform;if(!a)return i;for(var s=n?a.getCameraQueryGeometry(t):t,l=t.map((function(e){return a.pointCoordinate(e)})),c=s.map((function(e){return a.pointCoordinate(e)})),u=this.getIds(),d=1/0,h=1/0,p=-1/0,f=-1/0,m=0,g=c;m<g.length;m+=1){var b=g[m];d=Math.min(d,b.x),h=Math.min(h,b.y),p=Math.max(p,b.x),f=Math.max(f,b.y)}for(var v=function(t){var n=o._tiles[u[t]];if(!n.holdingForFade()){var s=n.tileID,m=Math.pow(2,a.zoom-n.tileID.overscaledZ),g=r*n.queryPadding*e.EXTENT/n.tileSize/m,b=[s.getTilePoint(new e.MercatorCoordinate(d,h)),s.getTilePoint(new e.MercatorCoordinate(p,f))];if(b[0].x-g<e.EXTENT&&b[0].y-g<e.EXTENT&&b[1].x+g>=0&&b[1].y+g>=0){var v=l.map((function(e){return s.getTilePoint(e)})),y=c.map((function(e){return s.getTilePoint(e)}));i.push({tile:n,tileID:s,queryGeometry:v,cameraQueryGeometry:y,scale:m})}}},y=0;y<u.length;y++)v(y);return i},r.prototype.getVisibleCoordinates=function(e){for(var t=this,r=this.getRenderableIds(e).map((function(e){return t._tiles[e].tileID})),n=0,o=r;n<o.length;n+=1){var i=o[n];i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped())}return r},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Me(this._source.type))for(var t in this._tiles){var r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=e.browser.now())return!0}return!1},r.prototype.setFeatureState=function(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)},r.prototype.removeFeatureState=function(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)},r.prototype.getFeatureState=function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)},r.prototype.setDependencies=function(e,t,r){var n=this._tiles[e];n&&n.setDependencies(t,r)},r.prototype.reloadTilesForDependencies=function(e,t){for(var r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter((function(r){return!r.hasDependency(e,t)}))},r}(e.Evented);function Oe(e,t){var r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Me(e){return"raster"===e||"image"===e||"video"===e}function De(){return new e.window.Worker(Ko.workerUrl)}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;var ze="mapboxgl_preloaded_worker_pool",je=function(){this.active={}};je.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new De);return this.active[e]=!0,this.workers.slice()},je.prototype.release=function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)},je.prototype.isPreloaded=function(){return!!this.active[ze]},je.prototype.numActive=function(){return Object.keys(this.active).length};var Re,Le=Math.floor(e.browser.hardwareConcurrency/2);function Ne(){return Re||(Re=new je),Re}function Be(t,r){var n={};for(var o in t)"ref"!==o&&(n[o]=t[o]);return e.refProperties.forEach((function(e){e in r&&(n[e]=r[e])})),n}function Fe(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=Be(e[n],t[e[n].ref]));return e}je.workerCount=Math.max(Math.min(Le,6),1);var Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ue(e,t,r){r.push({command:Ve.addSource,args:[e,t[e]]})}function qe(e,t,r){t.push({command:Ve.removeSource,args:[e]}),r[e]=!0}function He(e,t,r,n){qe(e,r,n),Ue(e,t,r)}function We(t,r,n){var o;for(o in t[n])if(t[n].hasOwnProperty(o)&&"data"!==o&&!e.deepEqual(t[n][o],r[n][o]))return!1;for(o in r[n])if(r[n].hasOwnProperty(o)&&"data"!==o&&!e.deepEqual(t[n][o],r[n][o]))return!1;return!0}function Ge(t,r,n,o,i,a){var s;for(s in r=r||{},t=t||{})t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||n.push({command:a,args:[o,s,r[s],i]}));for(s in r)r.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||n.push({command:a,args:[o,s,r[s],i]}))}function Ze(e){return e.id}function Ye(e,t){return e[t.id]=t,e}var $e=function(e,t){this.reset(e,t)};$e.prototype.reset=function(e,t){this.points=e||[],this._distances=[0];for(var r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding},$e.prototype.lerp=function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var r=1,n=this._distances[r],o=t*this.paddedLength+this.padding;n<o&&r<this._distances.length;)n=this._distances[++r];var i=r-1,a=this._distances[i],s=n-a,l=s>0?(o-a)/s:0;return this.points[i].mult(1-l).add(this.points[r].mult(l))};var Ke=function(e,t,r){var n=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(var i=0;i<this.xCellCount*this.yCellCount;i++)n.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};function Xe(t,r,n,o,i){var a=e.create();return r?(e.scale(a,a,[1/i,1/i,1]),n||e.rotateZ(a,a,o.angle)):e.multiply(a,o.labelPlaneMatrix,t),a}function Je(t,r,n,o,i){if(r){var a=e.clone(t);return e.scale(a,a,[i,i,1]),n||e.rotateZ(a,a,-o.angle),a}return o.glCoordMatrix}function Qe(t,r){var n=[t.x,t.y,0,1];ut(n,n,r);var o=n[3];return{point:new e.Point(n[0]/o,n[1]/o),signedDistanceFromCamera:o}}function et(e,t){return.5+e/t*.5}function tt(e,t){var r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function rt(t,r,n,o,i,a,s,l){var c=o?t.textSizeData:t.iconSizeData,u=e.evaluateSizeForZoom(c,n.transform.zoom),d=[256/n.width*2+1,256/n.height*2+1],h=o?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,f=o?t.text.placedSymbolArray:t.icon.placedSymbolArray,m=n.transform.width/n.transform.height,g=!1,b=0;b<f.length;b++){var v=f.get(b);if(v.hidden||v.writingMode===e.WritingMode.vertical&&!g)ct(v.numGlyphs,h);else{g=!1;var y=[v.anchorX,v.anchorY,0,1];if(e.transformMat4(y,y,r),tt(y,d)){var _=et(n.transform.cameraToCenterDistance,y[3]),w=e.evaluateSizeForFeature(c,u,v),x=s?w/_:w*_,k=new e.Point(v.anchorX,v.anchorY),C=Qe(k,i).point,E={},S=it(v,x,!1,l,r,i,a,t.glyphOffsetArray,p,h,C,k,E,m);g=S.useVertical,(S.notEnoughRoom||g||S.needsFlipping&&it(v,x,!0,l,r,i,a,t.glyphOffsetArray,p,h,C,k,E,m).notEnoughRoom)&&ct(v.numGlyphs,h)}else ct(v.numGlyphs,h)}}o?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function nt(e,t,r,n,o,i,a,s,l,c,u){var d=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,p=s.lineStartIndex+s.lineLength,f=t.getoffsetX(s.glyphStartIndex),m=t.getoffsetX(d-1),g=st(e*f,r,n,o,i,a,s.segment,h,p,l,c,u);if(!g)return null;var b=st(e*m,r,n,o,i,a,s.segment,h,p,l,c,u);return b?{first:g,last:b}:null}function ot(t,r,n,o){return t===e.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*o?{useVertical:!0}:(t===e.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function it(t,r,n,o,i,a,s,l,c,u,d,h,p,f){var m,g=r/24,b=t.lineOffsetX*g,v=t.lineOffsetY*g;if(t.numGlyphs>1){var y=t.glyphStartIndex+t.numGlyphs,_=t.lineStartIndex,w=t.lineStartIndex+t.lineLength,x=nt(g,l,b,v,n,d,h,t,c,a,p);if(!x)return{notEnoughRoom:!0};var k=Qe(x.first.point,s).point,C=Qe(x.last.point,s).point;if(o&&!n){var E=ot(t.writingMode,k,C,f);if(E)return E}m=[x.first];for(var S=t.glyphStartIndex+1;S<y-1;S++)m.push(st(g*l.getoffsetX(S),b,v,n,d,h,t.segment,_,w,c,a,p));m.push(x.last)}else{if(o&&!n){var T=Qe(h,i).point,A=t.lineStartIndex+t.segment+1,P=new e.Point(c.getx(A),c.gety(A)),I=Qe(P,i),O=I.signedDistanceFromCamera>0?I.point:at(h,P,T,1,i),M=ot(t.writingMode,T,O,f);if(M)return M}var D=st(g*l.getoffsetX(t.glyphStartIndex),b,v,n,d,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,c,a,p);if(!D)return{notEnoughRoom:!0};m=[D]}for(var z=0,j=m;z<j.length;z+=1){var R=j[z];e.addDynamicAttributes(u,R.point,R.angle)}return{}}function at(e,t,r,n,o){var i=Qe(e.add(e.sub(t)._unit()),o).point,a=r.sub(i);return r.add(a._mult(n/a.mag()))}function st(t,r,n,o,i,a,s,l,c,u,d,h){var p=o?t-r:t+r,f=p>0?1:-1,m=0;o&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var g=f>0?l+s:l+s+1,b=i,v=i,y=0,_=0,w=Math.abs(p),x=[];y+_<=w;){if((g+=f)<l||g>=c)return null;if(v=b,x.push(b),void 0===(b=h[g])){var k=new e.Point(u.getx(g),u.gety(g)),C=Qe(k,d);if(C.signedDistanceFromCamera>0)b=h[g]=C.point;else{var E=g-f;b=at(0===y?a:new e.Point(u.getx(E),u.gety(E)),k,v,w-y+1,d)}}y+=_,_=v.dist(b)}var S=(w-y)/_,T=b.sub(v),A=T.mult(S)._add(v);A._add(T._unit()._perp()._mult(n*f));var P=m+Math.atan2(b.y-v.y,b.x-v.x);return x.push(A),{point:A,angle:P,path:x}}Ke.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ke.prototype.insert=function(e,t,r,n,o){this._forEachCell(t,r,n,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(o)},Ke.prototype.insertCircle=function(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)},Ke.prototype._insertBoxCell=function(e,t,r,n,o,i){this.boxCells[o].push(i)},Ke.prototype._insertCircleCell=function(e,t,r,n,o,i){this.circleCells[o].push(i)},Ke.prototype._query=function(e,t,r,n,o,i){if(r<0||e>this.width||n<0||t>this.height)return!o&&[];var a=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(o)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var c=this.circles[3*l],u=this.circles[3*l+1],d=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:c-d,y1:u-d,x2:c+d,y2:u+d})}return i?a.filter(i):a}return this._forEachCell(e,t,r,n,this._queryCell,a,{hitTest:o,seenUids:{box:{},circle:{}}},i),o?a.length>0:a},Ke.prototype._queryCircle=function(e,t,r,n,o){var i=e-r,a=e+r,s=t-r,l=t+r;if(a<0||i>this.width||l<0||s>this.height)return!n&&[];var c=[];return this._forEachCell(i,s,a,l,this._queryCellCircle,c,{hitTest:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},o),n?c.length>0:c},Ke.prototype.query=function(e,t,r,n,o){return this._query(e,t,r,n,!1,o)},Ke.prototype.hitTest=function(e,t,r,n,o){return this._query(e,t,r,n,!0,o)},Ke.prototype.hitTestCircle=function(e,t,r,n){return this._queryCircle(e,t,r,!0,n)},Ke.prototype._queryCell=function(e,t,r,n,o,i,a,s){var l=a.seenUids,c=this.boxCells[o];if(null!==c)for(var u=this.bboxes,d=0,h=c;d<h.length;d+=1){var p=h[d];if(!l.box[p]){l.box[p]=!0;var f=4*p;if(e<=u[f+2]&&t<=u[f+3]&&r>=u[f+0]&&n>=u[f+1]&&(!s||s(this.boxKeys[p]))){if(a.hitTest)return i.push(!0),!0;i.push({key:this.boxKeys[p],x1:u[f],y1:u[f+1],x2:u[f+2],y2:u[f+3]})}}}var m=this.circleCells[o];if(null!==m)for(var g=this.circles,b=0,v=m;b<v.length;b+=1){var y=v[b];if(!l.circle[y]){l.circle[y]=!0;var _=3*y;if(this._circleAndRectCollide(g[_],g[_+1],g[_+2],e,t,r,n)&&(!s||s(this.circleKeys[y]))){if(a.hitTest)return i.push(!0),!0;var w=g[_],x=g[_+1],k=g[_+2];i.push({key:this.circleKeys[y],x1:w-k,y1:x-k,x2:w+k,y2:x+k})}}}},Ke.prototype._queryCellCircle=function(e,t,r,n,o,i,a,s){var l=a.circle,c=a.seenUids,u=this.boxCells[o];if(null!==u)for(var d=this.bboxes,h=0,p=u;h<p.length;h+=1){var f=p[h];if(!c.box[f]){c.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,d[m+0],d[m+1],d[m+2],d[m+3])&&(!s||s(this.boxKeys[f])))return i.push(!0),!0}}var g=this.circleCells[o];if(null!==g)for(var b=this.circles,v=0,y=g;v<y.length;v+=1){var _=y[v];if(!c.circle[_]){c.circle[_]=!0;var w=3*_;if(this._circlesCollide(b[w],b[w+1],b[w+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[_])))return i.push(!0),!0}}},Ke.prototype._forEachCell=function(e,t,r,n,o,i,a,s){for(var l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(r),d=this._convertToYCellCoord(n),h=l;h<=u;h++)for(var p=c;p<=d;p++)if(o.call(this,e,t,r,n,this.xCellCount*p+h,i,a,s))return},Ke.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},Ke.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},Ke.prototype._circlesCollide=function(e,t,r,n,o,i){var a=n-e,s=o-t,l=r+i;return l*l>a*a+s*s},Ke.prototype._circleAndRectCollide=function(e,t,r,n,o,i,a){var s=(i-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;var c=(a-o)/2,u=Math.abs(t-(o+c));if(u>c+r)return!1;if(l<=s||u<=c)return!0;var d=l-s,h=u-c;return d*d+h*h<=r*r};var lt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ct(e,t){for(var r=0;r<e;r++){var n=t.length;t.resize(n+4),t.float32.set(lt,3*n)}}function ut(e,t,r){var n=t[0],o=t[1];return e[0]=r[0]*n+r[4]*o+r[12],e[1]=r[1]*n+r[5]*o+r[13],e[3]=r[3]*n+r[7]*o+r[15],e}var dt=function(e,t,r){void 0===t&&(t=new Ke(e.width+200,e.height+200,25)),void 0===r&&(r=new Ke(e.width+200,e.height+200,25)),this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200};function ht(t,r,n){return r*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}dt.prototype.placeCollisionBox=function(e,t,r,n,o){var i=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY),a=r*i.perspectiveRatio,s=e.x1*a+i.point.x,l=e.y1*a+i.point.y,c=e.x2*a+i.point.x,u=e.y2*a+i.point.y;return!this.isInsideGrid(s,l,c,u)||!t&&this.grid.hitTest(s,l,c,u,o)?{box:[],offscreen:!1}:{box:[s,l,c,u],offscreen:this.isOffscreen(s,l,c,u)}},dt.prototype.placeCollisionCircles=function(t,r,n,o,i,a,s,l,c,u,d,h,p){var f=[],m=new e.Point(r.anchorX,r.anchorY),g=Qe(m,a),b=et(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera),v=(u?i/b:i*b)/e.ONE_EM,y=Qe(m,s).point,_=nt(v,o,r.lineOffsetX*v,r.lineOffsetY*v,!1,y,m,r,n,s,{}),w=!1,x=!1,k=!0;if(_){for(var C=.5*h*b+p,E=new e.Point(-100,-100),S=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),T=new $e,A=_.first,P=_.last,I=[],O=A.path.length-1;O>=1;O--)I.push(A.path[O]);for(var M=1;M<P.path.length;M++)I.push(P.path[M]);var D=2.5*C;if(l){var z=I.map((function(e){return Qe(e,l)}));I=z.some((function(e){return e.signedDistanceFromCamera<=0}))?[]:z.map((function(e){return e.point}))}var j=[];if(I.length>0){for(var R=I[0].clone(),L=I[0].clone(),N=1;N<I.length;N++)R.x=Math.min(R.x,I[N].x),R.y=Math.min(R.y,I[N].y),L.x=Math.max(L.x,I[N].x),L.y=Math.max(L.y,I[N].y);j=R.x>=E.x&&L.x<=S.x&&R.y>=E.y&&L.y<=S.y?[I]:L.x<E.x||R.x>S.x||L.y<E.y||R.y>S.y?[]:e.clipLine([I],E.x,E.y,S.x,S.y)}for(var B=0,F=j;B<F.length;B+=1){var V;T.reset(F[B],.25*C),V=T.length<=.5*C?1:Math.ceil(T.paddedLength/D)+1;for(var U=0;U<V;U++){var q=U/Math.max(V-1,1),H=T.lerp(q),W=H.x+100,G=H.y+100;f.push(W,G,C,0);var Z=W-C,Y=G-C,$=W+C,K=G+C;if(k=k&&this.isOffscreen(Z,Y,$,K),x=x||this.isInsideGrid(Z,Y,$,K),!t&&this.grid.hitTestCircle(W,G,C,d)&&(w=!0,!c))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!c&&w||!x?[]:f,offscreen:k,collisionDetected:w}},dt.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,o=1/0,i=-1/0,a=-1/0,s=0,l=t;s<l.length;s+=1){var c=l[s],u=new e.Point(c.x+100,c.y+100);n=Math.min(n,u.x),o=Math.min(o,u.y),i=Math.max(i,u.x),a=Math.max(a,u.y),r.push(u)}for(var d={},h={},p=0,f=this.grid.query(n,o,i,a).concat(this.ignoredGrid.query(n,o,i,a));p<f.length;p+=1){var m=f[p],g=m.key;if(void 0===d[g.bucketInstanceId]&&(d[g.bucketInstanceId]={}),!d[g.bucketInstanceId][g.featureIndex]){var b=[new e.Point(m.x1,m.y1),new e.Point(m.x2,m.y1),new e.Point(m.x2,m.y2),new e.Point(m.x1,m.y2)];e.polygonIntersectsPolygon(r,b)&&(d[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},dt.prototype.insertCollisionBox=function(e,t,r,n,o){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:o},e[0],e[1],e[2],e[3])},dt.prototype.insertCollisionCircles=function(e,t,r,n,o){for(var i=t?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:n,collisionGroupID:o},s=0;s<e.length;s+=4)i.insertCircle(a,e[s],e[s+1],e[s+2])},dt.prototype.projectAndGetPerspectiveRatio=function(t,r,n){var o=[r,n,0,1];return ut(o,o,t),{point:new e.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}},dt.prototype.isOffscreen=function(e,t,r,n){return r<100||e>=this.screenRightBoundary||n<100||t>this.screenBottomBoundary},dt.prototype.isInsideGrid=function(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary},dt.prototype.getViewportMatrix=function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t};var pt=function(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r};pt.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ft=function(e,t,r,n,o){this.text=new pt(e?e.text:null,t,r,o),this.icon=new pt(e?e.icon:null,t,n,o)};ft.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var mt=function(e,t,r){this.text=e,this.icon=t,this.skipFade=r},gt=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},bt=function(e,t,r,n,o){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=o},vt=function(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}};function yt(t,r,n,o,i){var a=e.getAnchorAlignment(t),s=-(a.horizontalAlign-.5)*r,l=-(a.verticalAlign-.5)*n,c=e.evaluateVariableOffset(t,o);return new e.Point(s+c[0]*i,l+c[1]*i)}function _t(t,r,n,o,i,a){var s=t.x1,l=t.x2,c=t.y1,u=t.y2,d=t.anchorPointX,h=t.anchorPointY,p=new e.Point(r,n);return o&&p._rotate(i?a:-a),{x1:s+p.x,y1:c+p.y,x2:l+p.x,y2:u+p.y,anchorPointX:d,anchorPointY:h}}vt.prototype.get=function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]};var wt=function(e,t,r,n){this.transform=e.clone(),this.collisionIndex=new dt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new vt(r),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}};function xt(e,t,r,n,o){e.emplaceBack(t?1:0,r?1:0,n||0,o||0),e.emplaceBack(t?1:0,r?1:0,n||0,o||0),e.emplaceBack(t?1:0,r?1:0,n||0,o||0),e.emplaceBack(t?1:0,r?1:0,n||0,o||0)}wt.prototype.getBucketParts=function(t,r,n,o){var i=n.getBucket(r),a=n.latestFeatureIndex;if(i&&a&&r.id===i.layerIds[0]){var s=n.collisionBoxArray,l=i.layers[0].layout,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),u=n.tileSize/e.EXTENT,d=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),f=ht(n,1,this.transform.zoom),m=Xe(d,h,p,this.transform,f),g=null;if(h){var b=Je(d,h,p,this.transform,f);g=e.multiply([],this.transform.labelPlaneMatrix,b)}this.retainedQueryData[i.bucketInstanceId]=new bt(i.bucketInstanceId,a,i.sourceLayerIndex,i.index,n.tileID);var v={bucket:i,layout:l,posMatrix:d,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(i.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(i.sourceID)};if(o)for(var y=0,_=i.sortKeyRanges;y<_.length;y+=1){var w=_[y];t.push({sortKey:w.sortKey,symbolInstanceStart:w.symbolInstanceStart,symbolInstanceEnd:w.symbolInstanceEnd,parameters:v})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:i.symbolInstances.length,parameters:v})}},wt.prototype.attemptAnchorPlacement=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f){var m,g=[d.textOffset0,d.textOffset1],b=yt(e,r,n,g,o),v=this.collisionIndex.placeCollisionBox(_t(t,b.x,b.y,i,a,this.transform.angle),u,s,l,c.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(_t(f,b.x,b.y,i,a,this.transform.angle),u,s,l,c.predicate).box.length)return v.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(m=this.prevPlacement.variableOffsets[d.crossTileID].anchor),this.variableOffsets[d.crossTileID]={textOffset:g,width:r,height:n,anchor:e,textBoxScale:o,prevAnchor:m},this.markUsedJustification(h,e,d,p),h.allowVerticalPlacement&&(this.markUsedOrientation(h,p,d),this.placedOrientations[d.crossTileID]=p),{shift:b,placedGlyphBoxes:v}):void 0},wt.prototype.placeLayerBucketPart=function(t,r,n){var o=this,i=t.parameters,a=i.bucket,s=i.layout,l=i.posMatrix,c=i.textLabelPlaneMatrix,u=i.labelToScreenMatrix,d=i.textPixelRatio,h=i.holdingForFade,p=i.collisionBoxArray,f=i.partiallyEvaluatedTextSize,m=i.collisionGroup,g=s.get("text-optional"),b=s.get("icon-optional"),v=s.get("text-allow-overlap"),y=s.get("icon-allow-overlap"),_="map"===s.get("text-rotation-alignment"),w="map"===s.get("text-pitch-alignment"),x="none"!==s.get("icon-text-fit"),k="viewport-y"===s.get("symbol-z-order"),C=v&&(y||!a.hasIconData()||b),E=y&&(v||!a.hasTextData()||g);!a.collisionArrays&&p&&a.deserializeCollisionBoxes(p);var S=function(t,i){if(!r[t.crossTileID])if(h)o.placements[t.crossTileID]=new mt(!1,!1,!1);else{var p,k=!1,S=!1,T=!0,A=null,P={box:null,offscreen:null},I={box:null,offscreen:null},O=null,M=null,D=0,z=0,j=0;i.textFeatureIndex?D=i.textFeatureIndex:t.useRuntimeCollisionCircles&&(D=t.featureIndex),i.verticalTextFeatureIndex&&(z=i.verticalTextFeatureIndex);var R=i.textBox;if(R){var L=function(r){var n=e.WritingMode.horizontal;if(a.allowVerticalPlacement&&!r&&o.prevPlacement){var i=o.prevPlacement.placedOrientations[t.crossTileID];i&&(o.placedOrientations[t.crossTileID]=i,o.markUsedOrientation(a,n=i,t))}return n},N=function(r,n){if(a.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&i.verticalTextBox)for(var o=0,s=a.writingModes;o<s.length&&(s[o]===e.WritingMode.vertical?(P=n(),I=P):P=r(),!(P&&P.box&&P.box.length));o+=1);else P=r()};if(s.get("text-variable-anchor")){var B=s.get("text-variable-anchor");if(o.prevPlacement&&o.prevPlacement.variableOffsets[t.crossTileID]){var F=o.prevPlacement.variableOffsets[t.crossTileID];B.indexOf(F.anchor)>0&&(B=B.filter((function(e){return e!==F.anchor}))).unshift(F.anchor)}var V=function(e,r,n){for(var i=e.x2-e.x1,s=e.y2-e.y1,c=t.textBoxScale,u=x&&!y?r:null,h={box:[],offscreen:!1},p=v?2*B.length:B.length,f=0;f<p;++f){var g=o.attemptAnchorPlacement(B[f%B.length],e,i,s,c,_,w,d,l,m,f>=B.length,t,a,n,u);if(g&&(h=g.placedGlyphBoxes)&&h.box&&h.box.length){k=!0,A=g.shift;break}}return h};N((function(){return V(R,i.iconBox,e.WritingMode.horizontal)}),(function(){var r=i.verticalTextBox;return a.allowVerticalPlacement&&!(P&&P.box&&P.box.length)&&t.numVerticalGlyphVertices>0&&r?V(r,i.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}})),P&&(k=P.box,T=P.offscreen);var U=L(P&&P.box);if(!k&&o.prevPlacement){var q=o.prevPlacement.variableOffsets[t.crossTileID];q&&(o.variableOffsets[t.crossTileID]=q,o.markUsedJustification(a,q.anchor,t,U))}}else{var H=function(e,r){var n=o.collisionIndex.placeCollisionBox(e,v,d,l,m.predicate);return n&&n.box&&n.box.length&&(o.markUsedOrientation(a,r,t),o.placedOrientations[t.crossTileID]=r),n};N((function(){return H(R,e.WritingMode.horizontal)}),(function(){var r=i.verticalTextBox;return a.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&r?H(r,e.WritingMode.vertical):{box:null,offscreen:null}})),L(P&&P.box&&P.box.length)}}if(k=(p=P)&&p.box&&p.box.length>0,T=p&&p.offscreen,t.useRuntimeCollisionCircles){var W=a.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),G=e.evaluateSizeForFeature(a.textSizeData,f,W),Z=s.get("text-padding");O=o.collisionIndex.placeCollisionCircles(v,W,a.lineVertexArray,a.glyphOffsetArray,G,l,c,u,n,w,m.predicate,t.collisionCircleDiameter,Z),k=v||O.circles.length>0&&!O.collisionDetected,T=T&&O.offscreen}if(i.iconFeatureIndex&&(j=i.iconFeatureIndex),i.iconBox){var Y=function(e){var t=x&&A?_t(e,A.x,A.y,_,w,o.transform.angle):e;return o.collisionIndex.placeCollisionBox(t,y,d,l,m.predicate)};S=I&&I.box&&I.box.length&&i.verticalIconBox?(M=Y(i.verticalIconBox)).box.length>0:(M=Y(i.iconBox)).box.length>0,T=T&&M.offscreen}var $=g||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,K=b||0===t.numIconVertices;if($||K?K?$||(S=S&&k):k=S&&k:S=k=S&&k,k&&p&&p.box&&o.collisionIndex.insertCollisionBox(p.box,s.get("text-ignore-placement"),a.bucketInstanceId,I&&I.box&&z?z:D,m.ID),S&&M&&o.collisionIndex.insertCollisionBox(M.box,s.get("icon-ignore-placement"),a.bucketInstanceId,j,m.ID),O&&(k&&o.collisionIndex.insertCollisionCircles(O.circles,s.get("text-ignore-placement"),a.bucketInstanceId,D,m.ID),n)){var X=a.bucketInstanceId,J=o.collisionCircleArrays[X];void 0===J&&(J=o.collisionCircleArrays[X]=new gt);for(var Q=0;Q<O.circles.length;Q+=4)J.circles.push(O.circles[Q+0]),J.circles.push(O.circles[Q+1]),J.circles.push(O.circles[Q+2]),J.circles.push(O.collisionDetected?1:0)}o.placements[t.crossTileID]=new mt(k||C,S||E,T||a.justReloaded),r[t.crossTileID]=!0}};if(k)for(var T=a.getSortedSymbolIndexes(this.transform.angle),A=T.length-1;A>=0;--A){var P=T[A];S(a.symbolInstances.get(P),a.collisionArrays[P])}else for(var I=t.symbolInstanceStart;I<t.symbolInstanceEnd;I++)S(a.symbolInstances.get(I),a.collisionArrays[I]);if(n&&a.bucketInstanceId in this.collisionCircleArrays){var O=this.collisionCircleArrays[a.bucketInstanceId];e.invert(O.invProjMatrix,l),O.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},wt.prototype.markUsedJustification=function(t,r,n,o){var i;i=o===e.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(r)];for(var a=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var l=s[a];l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=i>=0&&l!==i?0:n.crossTileID)}},wt.prototype.markUsedOrientation=function(t,r,n){for(var o=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,i=r===e.WritingMode.vertical?r:0,a=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];a<s.length;a+=1)t.text.placedSymbolArray.get(s[a]).placedOrientation=o;n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=i)},wt.prototype.commit=function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var n=t?t.symbolFadeChange(e):1,o=t?t.opacities:{},i=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],c=o[s];c?(this.opacities[s]=new ft(c,n,l.text,l.icon),r=r||l.text!==c.text.placed||l.icon!==c.icon.placed):(this.opacities[s]=new ft(null,n,l.text,l.icon,l.skipFade),r=r||l.text||l.icon)}for(var u in o){var d=o[u];if(!this.opacities[u]){var h=new ft(d,n,!1,!1);h.isHidden()||(this.opacities[u]=h,r=r||d.text.placed||d.icon.placed)}}for(var p in i)this.variableOffsets[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.variableOffsets[p]=i[p]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},wt.prototype.updateLayerOpacities=function(e,t){for(var r={},n=0,o=t;n<o.length;n+=1){var i=o[n],a=i.getBucket(e);a&&i.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,i.collisionBoxArray)}},wt.prototype.updateBucketOpacities=function(t,r,n){var o=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var i=t.layers[0].layout,a=new ft(null,0,!1,!1,!0),s=i.get("text-allow-overlap"),l=i.get("icon-allow-overlap"),c=i.get("text-variable-anchor"),u="map"===i.get("text-rotation-alignment"),d="map"===i.get("text-pitch-alignment"),h="none"!==i.get("icon-text-fit"),p=new ft(null,0,s&&(l||!t.hasIconData()||i.get("icon-optional")),l&&(s||!t.hasTextData()||i.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);for(var f=function(e,t,r){for(var n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r)},m=function(n){var i=t.symbolInstances.get(n),s=i.numHorizontalGlyphVertices,l=i.numVerticalGlyphVertices,m=i.crossTileID,g=o.opacities[m];r[m]?g=a:g||(o.opacities[m]=g=p),r[m]=!0;var b=i.numIconVertices>0,v=o.placedOrientations[i.crossTileID],y=v===e.WritingMode.vertical,_=v===e.WritingMode.horizontal||v===e.WritingMode.horizontalOnly;if(s>0||l>0){var w=It(g.text);f(t.text,s,y?Ot:w),f(t.text,l,_?Ot:w);var x=g.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((function(e){e>=0&&(t.text.placedSymbolArray.get(e).hidden=x||y?1:0)})),i.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=x||_?1:0);var k=o.variableOffsets[i.crossTileID];k&&o.markUsedJustification(t,k.anchor,i,v);var C=o.placedOrientations[i.crossTileID];C&&(o.markUsedJustification(t,"left",i,C),o.markUsedOrientation(t,C,i))}if(b){var E=It(g.icon),S=!(h&&i.verticalPlacedIconSymbolIndex&&y);i.placedIconSymbolIndex>=0&&(f(t.icon,i.numIconVertices,S?E:Ot),t.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=g.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,i.numVerticalIconVertices,S?Ot:E),t.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var T=t.collisionArrays[n];if(T){var A=new e.Point(0,0);if(T.textBox||T.verticalTextBox){var P=!0;if(c){var I=o.variableOffsets[m];I?(A=yt(I.anchor,I.width,I.height,I.textOffset,I.textBoxScale),u&&A._rotate(d?o.transform.angle:-o.transform.angle)):P=!1}T.textBox&&xt(t.textCollisionBox.collisionVertexArray,g.text.placed,!P||y,A.x,A.y),T.verticalTextBox&&xt(t.textCollisionBox.collisionVertexArray,g.text.placed,!P||_,A.x,A.y)}var O=Boolean(!_&&T.verticalIconBox);T.iconBox&&xt(t.iconCollisionBox.collisionVertexArray,g.icon.placed,O,h?A.x:0,h?A.y:0),T.verticalIconBox&&xt(t.iconCollisionBox.collisionVertexArray,g.icon.placed,!O,h?A.x:0,h?A.y:0)}}},g=0;g<t.symbolInstances.length;g++)m(g);if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var b=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=b.invProjMatrix,t.placementViewportMatrix=b.viewportMatrix,t.collisionCircleArray=b.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}},wt.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},wt.prototype.zoomAdjustment=function(e){return Math.max(0,(this.transform.zoom-e)/1.5)},wt.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},wt.prototype.stillRecent=function(e,t){var r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e},wt.prototype.setStale=function(){this.stale=!0};var kt=Math.pow(2,25),Ct=Math.pow(2,24),Et=Math.pow(2,17),St=Math.pow(2,16),Tt=Math.pow(2,9),At=Math.pow(2,8),Pt=Math.pow(2,1);function It(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*kt+t*Ct+r*Et+t*St+r*Tt+t*At+r*Pt+t}var Ot=0,Mt=function(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Mt.prototype.continuePlacement=function(e,t,r,n,o){for(var i=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(i,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,o())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,i.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<i.length;)if(t.placeLayerBucketPart(i[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,o())return!0;return!1};var Dt=function(e,t,r,n,o,i,a){this.placement=new wt(e,o,i,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};Dt.prototype.isDone=function(){return this._done},Dt.prototype.continuePlacement=function(t,r,n){for(var o=this,i=e.browser.now(),a=function(){var t=e.browser.now()-i;return!o._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=r[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Mt(s)),this._inProgressLayer.continuePlacement(n[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Dt.prototype.commit=function(e){return this.placement.commit(e),this.placement};var zt=512/e.EXTENT/2,jt=function(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0;n<t.length;n++){var o=t.get(n),i=o.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,e)})}};jt.prototype.getScaledCoordinates=function(t,r){var n=zt/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.anchorX)*n),y:Math.floor((r.canonical.y*e.EXTENT+t.anchorY)*n)}},jt.prototype.findMatches=function(e,t,r){for(var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),o=0;o<e.length;o++){var i=e.get(o);if(!i.crossTileID){var a=this.indexedSymbolInstances[i.key];if(a)for(var s=this.getScaledCoordinates(i,t),l=0,c=a;l<c.length;l+=1){var u=c[l];if(Math.abs(u.coord.x-s.x)<=n&&Math.abs(u.coord.y-s.y)<=n&&!r[u.crossTileID]){r[u.crossTileID]=!0,i.crossTileID=u.crossTileID;break}}}}};var Rt=function(){this.maxCrossTileID=0};Rt.prototype.generate=function(){return++this.maxCrossTileID};var Lt=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Lt.prototype.handleWrapJump=function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var r in this.indexes){var n=this.indexes[r],o={};for(var i in n){var a=n[i];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),o[a.tileID.key]=a}this.indexes[r]=o}this.lng=e},Lt.prototype.addBucket=function(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var n=0;n<t.symbolInstances.length;n++)t.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var o=this.usedCrossTileIDs[e.overscaledZ];for(var i in this.indexes){var a=this.indexes[i];if(Number(i)>e.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,o)}else{var c=a[e.scaledTo(Number(i)).key];c&&c.findMatches(t.symbolInstances,e,o)}}for(var u=0;u<t.symbolInstances.length;u++){var d=t.symbolInstances.get(u);d.crossTileID||(d.crossTileID=r.generate(),o[d.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new jt(e,t.symbolInstances,t.bucketInstanceId),!0},Lt.prototype.removeBucketCrossTileIDs=function(e,t){for(var r in t.indexedSymbolInstances)for(var n=0,o=t.indexedSymbolInstances[r];n<o.length;n+=1)delete this.usedCrossTileIDs[e][o[n].crossTileID]},Lt.prototype.removeStaleBuckets=function(e){var t=!1;for(var r in this.indexes){var n=this.indexes[r];for(var o in n)e[n[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[o]),delete n[o],t=!0)}return t};var Nt=function(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Nt.prototype.addLayer=function(e,t,r){var n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Lt);var o=!1,i={};n.handleWrapJump(r);for(var a=0,s=t;a<s.length;a+=1){var l=s[a],c=l.getBucket(e);c&&e.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,c,this.crossTileIDs)&&(o=!0),i[c.bucketInstanceId]=!0)}return n.removeStaleBuckets(i)&&(o=!0),o},Nt.prototype.pruneUnusedLayers=function(e){var t={};for(var r in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[r]||delete this.layerIndexes[r]};var Bt=function(t,r){return e.emitValidationErrors(t,r&&r.filter((function(e){return"source.canvas"!==e.identifier})))},Ft=e.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Vt=e.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),Ut=function(){var t={},r=e.styleSpec.$version;for(var n in e.styleSpec.$root){var o,i=e.styleSpec.$root[n];i.required&&null!=(o="version"===n?r:"array"===i.type?[]:{})&&(t[n]=o)}return t}(),qt=function(t){function r(n,o){var i=this;void 0===o&&(o={}),t.call(this),this.map=n,this.dispatcher=new C(Ne(),this),this.imageManager=new h,this.imageManager.setEventedParent(this),this.glyphManager=new y(n._requestManager,o.localIdeographFontFamily),this.lineAtlas=new k(256,512),this.crossTileSymbolIndex=new Nt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var a=this;this._rtlTextPluginCallback=r.registerForPluginStateChange((function(t){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,r){if(e.triggerPluginCompletionEvent(t),r&&r.every((function(e){return e})))for(var n in a.sourceCaches)a.sourceCaches[n].reload()}))})),this.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=i.sourceCaches[e.sourceId];if(t){var r=t.getSource();if(r&&r.vectorLayerIds)for(var n in i._layers){var o=i._layers[n];o.source===r.id&&i._validateLayer(o)}}}}))}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.loadURL=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var o="boolean"==typeof r.validate?r.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken);var i=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(i,(function(t,r){n._request=null,t?n.fire(new e.ErrorEvent(t)):r&&n._load(r,o)}))},r.prototype.loadJSON=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame((function(){n._request=null,n._load(t,!1!==r.validate)}))},r.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Ut,!1)},r.prototype._load=function(t,r){if(!r||!Bt(this,e.validateStyle(t))){for(var n in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(n,t.sources[n],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var o=Fe(this.stylesheet.layers);this._order=o.map((function(e){return e.id})),this._layers={},this._serializedLayers={};for(var i=0,a=o;i<a.length;i+=1){var s=a[i];(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new x(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},r.prototype._loadSprite=function(t){var r=this;this._spriteRequest=function(t,r,n){var o,i,a,s=e.browser.devicePixelRatio>1?"@2x":"",l=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){l=null,a||(a=e,o=t,u())})),c=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){c=null,a||(a=e,i=t,u())}));function u(){if(a)n(a);else if(o&&i){var t=e.browser.getImageData(i),r={};for(var s in o){var l=o[s],c=l.width,u=l.height,d=l.x,h=l.y,p=l.sdf,f=l.pixelRatio,m=l.stretchX,g=l.stretchY,b=l.content,v=new e.RGBAImage({width:c,height:u});e.RGBAImage.copy(t,v,{x:d,y:h},{x:0,y:0},{width:c,height:u}),r[s]={data:v,pixelRatio:f,sdf:p,stretchX:m,stretchY:g,content:b}}n(null,r)}}return{cancel:function(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,(function(t,n){if(r._spriteRequest=null,t)r.fire(new e.ErrorEvent(t));else if(n)for(var o in n)r.imageManager.addImage(o,n[o]);r.imageManager.setLoaded(!0),r._availableImages=r.imageManager.listImages(),r.dispatcher.broadcast("setImages",r._availableImages),r.fire(new e.Event("data",{dataType:"style"}))}))},r.prototype._validateLayer=function(t){var r=this.sourceCaches[t.source];if(r){var n=t.sourceLayer;if(n){var o=r.getSource();("geojson"===o.type||o.vectorLayerIds&&-1===o.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+o.id+'" as specified by style layer "'+t.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(e){for(var t=[],r=0,n=e;r<n.length;r+=1){var o=this._layers[n[r]];"custom"!==o.type&&t.push(o.serialize())}return t},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(t){if(this._loaded){var r=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers),o=Object.keys(this._removedLayers);for(var i in(n.length||o.length)&&this._updateWorkerLayers(n,o),this._updatedSources){var a=this._updatedSources[i];"reload"===a?this._reloadSource(i):"clear"===a&&this._clearSource(i)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}var l={};for(var c in this.sourceCaches){var u=this.sourceCaches[c];l[c]=u.used,u.used=!1}for(var d=0,h=this._order;d<h.length;d+=1){var p=this._layers[h[d]];p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(var f in l){var m=this.sourceCaches[f];l[f]!==m.used&&m.fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.z=t.zoom,r&&this.fire(new e.Event("data",{dataType:"style"}))}},r.prototype._updateTilesForChangedImages=function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}},r.prototype._updateWorkerLayers=function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},r.prototype.setState=function(t){var r=this;if(this._checkLoaded(),Bt(this,e.validateStyle(t)))return!1;(t=e.clone$1(t)).layers=Fe(t.layers);var n=function(t,r){if(!t)return[{command:Ve.setStyle,args:[r]}];var n=[];try{if(!e.deepEqual(t.version,r.version))return[{command:Ve.setStyle,args:[r]}];e.deepEqual(t.center,r.center)||n.push({command:Ve.setCenter,args:[r.center]}),e.deepEqual(t.zoom,r.zoom)||n.push({command:Ve.setZoom,args:[r.zoom]}),e.deepEqual(t.bearing,r.bearing)||n.push({command:Ve.setBearing,args:[r.bearing]}),e.deepEqual(t.pitch,r.pitch)||n.push({command:Ve.setPitch,args:[r.pitch]}),e.deepEqual(t.sprite,r.sprite)||n.push({command:Ve.setSprite,args:[r.sprite]}),e.deepEqual(t.glyphs,r.glyphs)||n.push({command:Ve.setGlyphs,args:[r.glyphs]}),e.deepEqual(t.transition,r.transition)||n.push({command:Ve.setTransition,args:[r.transition]}),e.deepEqual(t.light,r.light)||n.push({command:Ve.setLight,args:[r.light]});var o={},i=[];!function(t,r,n,o){var i;for(i in r=r||{},t=t||{})t.hasOwnProperty(i)&&(r.hasOwnProperty(i)||qe(i,n,o));for(i in r)r.hasOwnProperty(i)&&(t.hasOwnProperty(i)?e.deepEqual(t[i],r[i])||("geojson"===t[i].type&&"geojson"===r[i].type&&We(t,r,i)?n.push({command:Ve.setGeoJSONSourceData,args:[i,r[i].data]}):He(i,r,n,o)):Ue(i,r,n))}(t.sources,r.sources,i,o);var a=[];t.layers&&t.layers.forEach((function(e){o[e.source]?n.push({command:Ve.removeLayer,args:[e.id]}):a.push(e)})),n=n.concat(i),function(t,r,n){r=r||[];var o,i,a,s,l,c,u,d=(t=t||[]).map(Ze),h=r.map(Ze),p=t.reduce(Ye,{}),f=r.reduce(Ye,{}),m=d.slice(),g=Object.create(null);for(o=0,i=0;o<d.length;o++)f.hasOwnProperty(a=d[o])?i++:(n.push({command:Ve.removeLayer,args:[a]}),m.splice(m.indexOf(a,i),1));for(o=0,i=0;o<h.length;o++)m[m.length-1-o]!==(a=h[h.length-1-o])&&(p.hasOwnProperty(a)?(n.push({command:Ve.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-i),1)):i++,n.push({command:Ve.addLayer,args:[f[a],c=m[m.length-o]]}),m.splice(m.length-o,0,a),g[a]=!0);for(o=0;o<h.length;o++)if(s=p[a=h[o]],l=f[a],!g[a]&&!e.deepEqual(s,l))if(e.deepEqual(s.source,l.source)&&e.deepEqual(s["source-layer"],l["source-layer"])&&e.deepEqual(s.type,l.type)){for(u in Ge(s.layout,l.layout,n,a,null,Ve.setLayoutProperty),Ge(s.paint,l.paint,n,a,null,Ve.setPaintProperty),e.deepEqual(s.filter,l.filter)||n.push({command:Ve.setFilter,args:[a,l.filter]}),e.deepEqual(s.minzoom,l.minzoom)&&e.deepEqual(s.maxzoom,l.maxzoom)||n.push({command:Ve.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Ge(s[u],l[u],n,a,u.slice(6),Ve.setPaintProperty):e.deepEqual(s[u],l[u])||n.push({command:Ve.setLayerProperty,args:[a,u,l[u]]}));for(u in l)l.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Ge(s[u],l[u],n,a,u.slice(6),Ve.setPaintProperty):e.deepEqual(s[u],l[u])||n.push({command:Ve.setLayerProperty,args:[a,u,l[u]]}))}else n.push({command:Ve.removeLayer,args:[a]}),c=m[m.lastIndexOf(a)+1],n.push({command:Ve.addLayer,args:[l,c]})}(a,r.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:Ve.setStyle,args:[r]}]}return n}(this.serialize(),t).filter((function(e){return!(e.command in Vt)}));if(0===n.length)return!1;var o=n.filter((function(e){return!(e.command in Ft)}));if(o.length>0)throw new Error("Unimplemented: "+o.map((function(e){return e.command})).join(", ")+".");return n.forEach((function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)})),this.stylesheet=t,!0},r.prototype.addImage=function(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,r),this._afterImageUpdated(t)},r.prototype.updateImage=function(e,t){this.imageManager.updateImage(e,t)},r.prototype.getImage=function(e){return this.imageManager.getImage(e)},r.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._afterImageUpdated(t)},r.prototype._afterImageUpdated=function(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))},r.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},r.prototype.addSource=function(t,r,n){var o=this;if(void 0===n&&(n={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(e.validateStyle.source,"sources."+t,r,null,n))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var i=this.sourceCaches[t]=new Ie(t,r,this.dispatcher);i.style=this,i.setEventedParent(this,(function(){return{isSourceLoaded:o.loaded(),source:i.serialize(),sourceId:t}})),i.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(e,t){this._checkLoaded(),this.sourceCaches[e].getSource().setData(t),this._changed=!0},r.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},r.prototype.addLayer=function(t,r,n){void 0===n&&(n={}),this._checkLoaded();var o=t.id;if(this.getLayer(o))this.fire(new e.ErrorEvent(new Error('Layer with id "'+o+'" already exists on this map')));else{var i;if("custom"===t.type){if(Bt(this,e.validateCustomStyleLayer(t)))return;i=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(o,t.source),t=e.clone$1(t),t=e.extend(t,{source:o})),this._validate(e.validateStyle.layer,"layers."+o,t,{arrayIndex:-1},n))return;i=e.createStyleLayer(t),this._validateLayer(i),i.setEventedParent(this,{layer:{id:o}}),this._serializedLayers[i.id]=i.serialize()}var a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(a,0,o),this._layerOrderChanged=!0,this._layers[o]=i,this._removedLayers[o]&&i.source&&"custom"!==i.type){var s=this._removedLayers[o];delete this._removedLayers[o],s.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause())}this._updateLayer(i),i.onAdd&&i.onAdd(this.map)}}},r.prototype.moveLayer=function(t,r){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==r){var n=this._order.indexOf(t);this._order.splice(n,1);var o=r?this._order.indexOf(r):this._order.length;r&&-1===o?this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(o,0,t),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(t){this._checkLoaded();var r=this._layers[t];if(r){r.setEventedParent(null);var n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(e){return this._layers[e]},r.prototype.hasLayer=function(e){return e in this._layers},r.prototype.setLayerZoomRange=function(t,r,n){this._checkLoaded();var o=this.getLayer(t);o?o.minzoom===r&&o.maxzoom===n||(null!=r&&(o.minzoom=r),null!=n&&(o.maxzoom=n),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(t,r,n){void 0===n&&(n={}),this._checkLoaded();var o=this.getLayer(t);if(o){if(!e.deepEqual(o.filter,r))return null==r?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(e.validateStyle.filter,"layers."+o.id+".filter",r,null,n)||(o.filter=e.clone$1(r),this._updateLayer(o)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(t){return e.clone$1(this.getLayer(t).filter)},r.prototype.setLayoutProperty=function(t,r,n,o){void 0===o&&(o={}),this._checkLoaded();var i=this.getLayer(t);i?e.deepEqual(i.getLayoutProperty(r),n)||(i.setLayoutProperty(r,n,o),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(t,r){var n=this.getLayer(t);if(n)return n.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},r.prototype.setPaintProperty=function(t,r,n,o){void 0===o&&(o={}),this._checkLoaded();var i=this.getLayer(t);i?e.deepEqual(i.getPaintProperty(r),n)||(i.setPaintProperty(r,n,o)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(e,t){return this.getLayer(e).getPaintProperty(t)},r.prototype.setFeatureState=function(t,r){this._checkLoaded();var n=t.source,o=t.sourceLayer,i=this.sourceCaches[n];if(void 0!==i){var a=i.getSource().type;"geojson"===a&&o?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||o?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),i.setFeatureState(o,t.id,r)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.removeFeatureState=function(t,r){this._checkLoaded();var n=t.source,o=this.sourceCaches[n];if(void 0!==o){var i=o.getSource().type,a="vector"===i?t.sourceLayer:void 0;"vector"!==i||a?r&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):o.removeFeatureState(a,t.id,r):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.getFeatureState=function(t){this._checkLoaded();var r=t.source,n=t.sourceLayer,o=this.sourceCaches[r];if(void 0!==o){if("vector"!==o.getSource().type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),o.getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},r.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,(function(e){return e.serialize()})),layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))},r.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},r.prototype._flattenAndSortRenderedFeatures=function(e){for(var t=this,r=function(e){return"fill-extrusion"===t._layers[e].type},n={},o=[],i=this._order.length-1;i>=0;i--){var a=this._order[i];if(r(a)){n[a]=i;for(var s=0,l=e;s<l.length;s+=1){var c=l[s][a];if(c)for(var u=0,d=c;u<d.length;u+=1)o.push(d[u])}}}o.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var h=[],p=this._order.length-1;p>=0;p--){var f=this._order[p];if(r(f))for(var m=o.length-1;m>=0;m--){var g=o[m].feature;if(n[g.layer.id]<p)break;h.push(g),o.pop()}else for(var b=0,v=e;b<v.length;b+=1){var y=v[b][f];if(y)for(var _=0,w=y;_<w.length;_+=1)h.push(w[_].feature)}}return h},r.prototype.queryRenderedFeatures=function(t,r,n){r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var o={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var i=0,a=r.layers;i<a.length;i+=1){var s=a[i],l=this._layers[s];if(!l)return this.fire(new e.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];o[l.source]=!0}}var c=[];for(var u in r.availableImages=this._availableImages,this.sourceCaches)r.layers&&!o[u]||c.push(L(this.sourceCaches[u],this._layers,this._serializedLayers,t,r,n));return this.placement&&c.push(function(e,t,r,n,o,i,a){for(var s={},l=i.queryRenderedSymbols(n),c=[],u=0,d=Object.keys(l).map(Number);u<d.length;u+=1)c.push(a[d[u]]);c.sort(N);for(var h=function(){var r=f[p],n=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,o.filter,o.layers,o.availableImages,e);for(var i in n){var a=s[i]=s[i]||[],c=n[i];c.sort((function(e,t){var n=r.featureSortOrder;if(n){var o=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-o}return t.featureIndex-e.featureIndex}));for(var u=0,d=c;u<d.length;u+=1)a.push(d[u])}},p=0,f=c;p<f.length;p+=1)h();var m=function(t){s[t].forEach((function(n){var o=n.feature,i=r[e[t].source].getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=i}))};for(var g in s)m(g);return s}(this._layers,this._serializedLayers,this.sourceCaches,t,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},r.prototype.querySourceFeatures=function(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);var n=this.sourceCaches[t];return n?function(e,t){for(var r=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),n=[],o={},i=0;i<r.length;i++){var a=r[i],s=a.tileID.canonical.key;o[s]||(o[s]=!0,a.querySourceFeatures(n,t))}return n}(n,r):[]},r.prototype.addSourceType=function(e,t,n){return r.getSourceType(e)?n(new Error('A source type called "'+e+'" already exists.')):(r.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(t,r){void 0===r&&(r={}),this._checkLoaded();var n=this.light.getLight(),o=!1;for(var i in t)if(!e.deepEqual(t[i],n[i])){o=!0;break}if(o){var a={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(a)}},r.prototype._validate=function(t,r,n,o,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Bt(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.styleSpec},o)))},r.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var r in this.sourceCaches)this.sourceCaches[r].clearTiles(),this.sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},r.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},r.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},r.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},r.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},r.prototype._updatePlacement=function(t,r,n,o,i){void 0===i&&(i=!1);for(var a=!1,s=!1,l={},c=0,u=this._order;c<u.length;c+=1){var d=this._layers[u[c]];if("symbol"===d.type){if(!l[d.source]){var h=this.sourceCaches[d.source];l[d.source]=h.getRenderableIds(!0).map((function(e){return h.getTileByID(e)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}var p=this.crossTileSymbolIndex.addLayer(d,l[d.source],t.center.lng);a=a||p}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),t.zoom))&&(this.pauseablePlacement=new Dt(t,this._order,i,r,n,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var f=0,m=this._order;f<m.length;f+=1){var g=this._layers[m[f]];"symbol"===g.type&&this.placement.updateLayerOpacities(g,l[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},r.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},r.prototype.getImages=function(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();var n=this.sourceCaches[t.source];n&&n.setDependencies(t.tileID.key,t.type,t.icons)},r.prototype.getGlyphs=function(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)},r.prototype.getResource=function(t,r,n){return e.makeRequest(r,n)},r}(e.Evented);qt.getSourceType=function(e){return j[e]},qt.setSourceType=function(e,t){j[e]=t},qt.registerForPluginStateChange=e.registerForPluginStateChange;var Ht=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Wt=br("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Gt=br("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Zt=br("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Yt=br("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),$t=br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Kt=br("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Xt=br("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Jt=br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qt=br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),er=br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),tr=br("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),rr=br("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),nr=br("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),or=br("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),ir=br("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),ar=br("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),sr=br("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),lr=br("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),cr=br("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),ur=br("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),dr=br("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),hr=br("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pr=br("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),fr=br("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),mr=br("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),gr=br("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function br(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute ([\w]+) ([\w]+)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),i=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=i?i.concat(o):o,s={};return{fragmentSource:e=e.replace(r,(function(e,t,r,n,o){return s[o]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+r+" "+n+" "+o+";\n#else\nuniform "+r+" "+n+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+r+" "+n+" "+o+" = u_"+o+";\n#endif\n"})),vertexSource:t=t.replace(r,(function(e,t,r,n,o){var i="float"===n?"vec2":"vec4",a=o.match(/color/)?"color":i;return s[o]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+r+" "+i+" a_"+o+";\nvarying "+r+" "+n+" "+o+";\n#else\nuniform "+r+" "+n+" u_"+o+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+r+" "+n+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+a+"(a_"+o+", u_"+o+"_t);\n#else\n    "+r+" "+n+" "+o+" = u_"+o+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+r+" "+i+" a_"+o+";\n#else\nuniform "+r+" "+n+" u_"+o+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+r+" "+n+" "+o+" = a_"+o+";\n#else\n    "+r+" "+n+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+r+" "+n+" "+o+" = unpack_mix_"+a+"(a_"+o+", u_"+o+"_t);\n#else\n    "+r+" "+n+" "+o+" = u_"+o+";\n#endif\n"})),staticAttributes:n,staticUniforms:a}}var vr=Object.freeze({__proto__:null,prelude:Wt,background:Gt,backgroundPattern:Zt,circle:Yt,clippingMask:$t,heatmap:Kt,heatmapTexture:Xt,collisionBox:Jt,collisionCircle:Qt,debug:er,fill:tr,fillOutline:rr,fillOutlinePattern:nr,fillPattern:or,fillExtrusion:ir,fillExtrusionPattern:ar,hillshadePrepare:sr,hillshade:lr,line:cr,lineGradient:ur,linePattern:dr,lineSDF:hr,raster:pr,symbolIcon:fr,symbolSDF:mr,symbolTextAndIcon:gr}),yr=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function _r(e){for(var t=[],r=0;r<e.length;r++)if(null!==e[r]){var n=e[r].split(" ");t.push(n.pop())}return t}yr.prototype.bind=function(e,t,r,n,o,i,a,s){this.context=e;for(var l=this.boundPaintVertexBuffers.length!==n.length,c=0;!l&&c<n.length;c++)this.boundPaintVertexBuffers[c]!==n[c]&&(l=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===r&&!l&&this.boundIndexBuffer===o&&this.boundVertexOffset===i&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(e.bindVertexArrayOES.set(this.vao),a&&a.bind(),o&&o.dynamicDraw&&o.bind(),s&&s.bind()):this.freshBind(t,r,n,o,i,a,s)},yr.prototype.freshBind=function(e,t,r,n,o,i,a){var s,l=e.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=i,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var d=l;d<s;d++)u.disableVertexAttribArray(d)}t.enableAttributes(u,e);for(var h=0,p=r;h<p.length;h+=1)p[h].enableAttributes(u,e);i&&i.enableAttributes(u,e),a&&a.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,o);for(var f=0,m=r;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(u,e,o)}i&&(i.bind(),i.setVertexAttribPointers(u,e,o)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(u,e,o)),c.currentNumAttributes=l},yr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var wr=function(e,t,r,n,o,i){var a=e.gl;this.program=a.createProgram();for(var s=_r(r.staticAttributes),l=n?n.getBinderAttributes():[],c=s.concat(l),u=r.staticUniforms?_r(r.staticUniforms):[],d=n?n.getBinderUniforms():[],h=[],p=0,f=u.concat(d);p<f.length;p+=1){var m=f[p];h.indexOf(m)<0&&h.push(m)}var g=n?n.defines():[];i&&g.push("#define OVERDRAW_INSPECTOR;");var b=g.concat(Wt.fragmentSource,r.fragmentSource).join("\n"),v=g.concat(Wt.vertexSource,r.vertexSource).join("\n"),y=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(y,b),a.compileShader(y),a.attachShader(this.program,y);var _=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,v),a.compileShader(_),a.attachShader(this.program,_),this.attributes={};var w={};this.numAttributes=c.length;for(var x=0;x<this.numAttributes;x++)c[x]&&(a.bindAttribLocation(this.program,x,c[x]),this.attributes[c[x]]=x);a.linkProgram(this.program),a.deleteShader(_),a.deleteShader(y);for(var k=0;k<h.length;k++){var C=h[k];if(C&&!w[C]){var E=a.getUniformLocation(this.program,C);E&&(w[C]=E)}}this.fixedUniforms=o(e,w),this.binderUniforms=n?n.getUniforms(e,w):[]}}};function xr(e,t,r){var n=1/ht(r,1,t.transform.tileZoom),o=Math.pow(2,r.tileID.overscaledZ),i=r.tileSize*Math.pow(2,t.transform.tileZoom)/o,a=i*(r.tileID.canonical.x+r.tileID.wrap*o),s=i*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}wr.prototype.draw=function(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,m){var g,b=e.gl;if(!this.failedToCreate){for(var v in e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(o),e.setCullFace(i),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);p&&p.setUniforms(e,this.binderUniforms,d,{zoom:h});for(var y=(g={},g[b.LINES]=2,g[b.TRIANGLES]=3,g[b.LINE_STRIP]=1,g)[t],_=0,w=u.get();_<w.length;_+=1){var x=w[_],k=x.vaos||(x.vaos={});(k[s]||(k[s]=new yr)).bind(e,this,l,p?p.getPaintVertexBuffers():[],c,x.vertexOffset,f,m),b.drawElements(t,x.primitiveLength*y,b.UNSIGNED_SHORT,x.primitiveOffset*y*2)}}};var kr=function(t,r,n,o){var i=r.style.light,a=i.properties.get("position"),s=[a.x,a.y,a.z],l=e.create$1();"viewport"===i.properties.get("anchor")&&e.fromRotation(l,-r.transform.angle),e.transformMat3(s,s,l);var c=i.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+n,u_opacity:o}},Cr=function(t,r,n,o,i,a,s){return e.extend(kr(t,r,n,o),xr(a,r,s),{u_height_factor:-Math.pow(2,i.overscaledZ)/s.tileSize/8})},Er=function(e){return{u_matrix:e}},Sr=function(t,r,n,o){return e.extend(Er(t),xr(n,r,o))},Tr=function(e,t){return{u_matrix:e,u_world:t}},Ar=function(t,r,n,o,i){return e.extend(Sr(t,r,n,o),{u_world:i})},Pr=function(t,r,n,o){var i,a,s=t.transform;if("map"===o.paint.get("circle-pitch-alignment")){var l=ht(n,1,s.zoom);i=!0,a=[l,l]}else i=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(r.posMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:a}},Ir=function(e,t,r){var n=ht(r,1,t.zoom),o=Math.pow(2,t.zoom-r.tileID.overscaledZ),i=r.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[t.pixelsToGLUnits[0]/(n*o),t.pixelsToGLUnits[1]/(n*o)],u_overscale_factor:i}},Or=function(e,t,r){return{u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}},Mr=function(e,t,r){return void 0===r&&(r=1),{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}},Dr=function(e){return{u_matrix:e}},zr=function(e,t,r,n){return{u_matrix:e,u_extrude_scale:ht(t,1,r),u_intensity:n}},jr=function(t,r,n){var o=t.transform;return{u_matrix:Fr(t,r,n),u_ratio:1/ht(r,1,o.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Rr=function(t,r,n,o){return e.extend(jr(t,r,n),{u_image:0,u_image_height:o})},Lr=function(t,r,n,o){var i=t.transform,a=Br(r,i);return{u_matrix:Fr(t,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:1/ht(r,1,i.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[a,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Nr=function(t,r,n,o,i){var a=t.lineAtlas,s=Br(r,t.transform),l="round"===n.layout.get("line-cap"),c=a.getDash(o.from,l),u=a.getDash(o.to,l),d=c.width*i.fromScale,h=u.width*i.toScale;return e.extend(jr(t,r,n),{u_patternscale_a:[s/d,-c.height/2],u_patternscale_b:[s/h,-u.height/2],u_sdfgamma:a.width/(256*Math.min(d,h)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:i.t})};function Br(e,t){return 1/ht(e,1,t.tileZoom)}function Fr(e,t,r){return e.translatePosMatrix(t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var Vr=function(e,t,r,n,o){return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(a=o.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(i=o.paint.get("raster-contrast"),i>0?1/(1-i):1+i),u_spin_weights:Ur(o.paint.get("raster-hue-rotate"))};var i,a};function Ur(e){e*=Math.PI/180;var t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}var qr,Hr=function(e,t,r,n,o,i,a,s,l,c){var u=o.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:u.width/u.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:i,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+n,u_texsize:c,u_texture:0}},Wr=function(t,r,n,o,i,a,s,l,c,u,d){var h=i.transform;return e.extend(Hr(t,r,n,o,i,a,s,l,c,u),{u_gamma_scale:o?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+d})},Gr=function(t,r,n,o,i,a,s,l,c,u){return e.extend(Wr(t,r,n,o,i,a,s,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1})},Zr=function(e,t,r){return{u_matrix:e,u_opacity:t,u_color:r}},Yr=function(t,r,n,o,i,a){return e.extend(function(e,t,r,n){var o=r.imageManager.getPattern(e.from.toString()),i=r.imageManager.getPattern(e.to.toString()),a=r.imageManager.getPixelSize(),s=a.width,l=a.height,c=Math.pow(2,n.tileID.overscaledZ),u=n.tileSize*Math.pow(2,r.transform.tileZoom)/c,d=u*(n.tileID.canonical.x+n.tileID.wrap*c),h=u*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:o.tl,u_pattern_br_a:o.br,u_pattern_tl_b:i.tl,u_pattern_br_b:i.br,u_texsize:[s,l],u_mix:t.t,u_pattern_size_a:o.displaySize,u_pattern_size_b:i.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/ht(n,1,r.transform.tileZoom),u_pixel_coord_upper:[d>>16,h>>16],u_pixel_coord_lower:[65535&d,65535&h]}}(o,a,n,i),{u_matrix:t,u_opacity:r})},$r={fillExtrusion:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fillExtrusionPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fill:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},fillPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},fillOutline:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}},fillOutlinePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},circle:function(t,r){return{u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,r.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},collisionBox:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,r.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,r.u_overscale_factor)}},collisionCircle:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}},debug:function(t,r){return{u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}},clippingMask:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmap:function(t,r){return{u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmapTexture:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}},hillshade:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}},hillshadePrepare:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}},line:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}},lineGradient:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image),u_image_height:new e.Uniform1f(t,r.u_image_height)}},linePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},lineSDF:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,r.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,r.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,r.u_sdfgamma),u_image:new e.Uniform1i(t,r.u_image),u_tex_y_a:new e.Uniform1f(t,r.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,r.u_tex_y_b),u_mix:new e.Uniform1f(t,r.u_mix)}},raster:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}},symbolIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}},symbolSDF:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},symbolTextAndIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},background:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}},backgroundPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}}};function Kr(t,r,n,o,i,a,s){for(var l=t.context,c=l.gl,u=t.useProgram("collisionBox"),d=[],h=0,p=0,f=0;f<o.length;f++){var m=o[f],g=r.getTile(m),b=g.getBucket(n);if(b){var v=m.posMatrix;0===i[0]&&0===i[1]||(v=t.translatePosMatrix(m.posMatrix,g,i,a));var y=s?b.textCollisionBox:b.iconCollisionBox,_=b.collisionCircleArray;if(_.length>0){var w=e.create(),x=v;e.mul(w,b.placementInvProjMatrix,t.transform.glCoordMatrix),e.mul(w,w,b.placementViewportMatrix),d.push({circleArray:_,circleOffset:p,transform:x,invTransform:w}),p=h+=_.length/4}y&&u.draw(l,c.LINES,Ee.disabled,Se.disabled,t.colorModeForRenderPass(),Ae.disabled,Ir(v,t.transform,g),n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,t.transform.zoom,null,null,y.collisionVertexBuffer)}}if(s&&d.length){var k=t.useProgram("collisionCircle"),C=new e.StructArrayLayout2f1f2i16;C.resize(4*h),C._trim();for(var E=0,S=0,T=d;S<T.length;S+=1)for(var A=T[S],P=0;P<A.circleArray.length/4;P++){var I=4*P,O=A.circleArray[I+0],M=A.circleArray[I+1],D=A.circleArray[I+2],z=A.circleArray[I+3];C.emplace(E++,O,M,D,z,0),C.emplace(E++,O,M,D,z,1),C.emplace(E++,O,M,D,z,2),C.emplace(E++,O,M,D,z,3)}(!qr||qr.length<2*h)&&(qr=function(t){var r=2*t,n=new e.StructArrayLayout3ui6;n.resize(r),n._trim();for(var o=0;o<r;o++){var i=6*o;n.uint16[i+0]=4*o+0,n.uint16[i+1]=4*o+1,n.uint16[i+2]=4*o+2,n.uint16[i+3]=4*o+2,n.uint16[i+4]=4*o+3,n.uint16[i+5]=4*o+0}return n}(h));for(var j=l.createIndexBuffer(qr,!0),R=l.createVertexBuffer(C,e.collisionCircleLayout.members,!0),L=0,N=d;L<N.length;L+=1){var B=N[L],F=Or(B.transform,B.invTransform,t.transform);k.draw(l,c.TRIANGLES,Ee.disabled,Se.disabled,t.colorModeForRenderPass(),Ae.disabled,F,n.id,R,j,e.SegmentVector.simpleSegment(0,2*B.circleOffset,B.circleArray.length,B.circleArray.length/2),null,t.transform.zoom,null,null,null)}R.destroy(),j.destroy()}}var Xr=e.identity(new Float32Array(16));function Jr(t,r,n,o,i,a){var s=e.getAnchorAlignment(t),l=-(s.horizontalAlign-.5)*r,c=-(s.verticalAlign-.5)*n,u=e.evaluateVariableOffset(t,o);return new e.Point((l/i+u[0])*a,(c/i+u[1])*a)}function Qr(t,r,n,o,i,a,s,l,c,u,d){var h=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={};p.clear();for(var g=0;g<h.length;g++){var b=h.get(g),v=b.hidden||!b.crossTileID||t.allowVerticalPlacement&&!b.placedOrientation?null:o[b.crossTileID];if(v){var y=new e.Point(b.anchorX,b.anchorY),_=Qe(y,n?l:s),w=et(a.cameraToCenterDistance,_.signedDistanceFromCamera),x=i.evaluateSizeForFeature(t.textSizeData,u,b)*w/e.ONE_EM;n&&(x*=t.tilePixelRatio/c);for(var k=Jr(v.anchor,v.width,v.height,v.textOffset,v.textBoxScale,x),C=n?Qe(y.add(k),s).point:_.point.add(r?k.rotate(-a.angle):k),E=t.allowVerticalPlacement&&b.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,S=0;S<b.numGlyphs;S++)e.addDynamicAttributes(p,C,E);d&&b.associatedIconIndex>=0&&(m[b.associatedIconIndex]={shiftedAnchor:C,angle:E})}else ct(b.numGlyphs,p)}if(d){f.clear();for(var T=t.icon.placedSymbolArray,A=0;A<T.length;A++){var P=T.get(A);if(P.hidden)ct(P.numGlyphs,f);else{var I=m[A];if(I)for(var O=0;O<P.numGlyphs;O++)e.addDynamicAttributes(f,I.shiftedAnchor,I.angle);else ct(P.numGlyphs,f)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function en(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function tn(t,r,n,o,i,a,s,l,c,u,d,h){for(var p=t.context,f=p.gl,m=t.transform,g="map"===l,b="map"===c,v=g&&"point"!==n.layout.get("symbol-placement"),y=g&&!b&&!v,_=void 0!==n.layout.get("symbol-sort-key").constantOr(1),w=!1,x=t.depthModeForSublayer(0,Ee.ReadOnly),k=n.layout.get("text-variable-anchor"),C=[],E=0,S=o;E<S.length;E+=1){var T=S[E],A=r.getTile(T),P=A.getBucket(n);if(P){var I=i?P.text:P.icon;if(I&&I.segments.get().length){var O=I.programConfigurations.get(n.id),M=i||P.sdfIcons,D=i?P.textSizeData:P.iconSizeData,z=b||0!==m.pitch,j=t.useProgram(en(M,i,P),O),R=e.evaluateSizeForZoom(D,m.zoom),L=void 0,N=[0,0],B=void 0,F=void 0,V=null,U=void 0;if(i)B=A.glyphAtlasTexture,F=f.LINEAR,L=A.glyphAtlasTexture.size,P.iconsInText&&(N=A.imageAtlasTexture.size,V=A.imageAtlasTexture,U=z||t.options.rotating||t.options.zooming||"composite"===D.kind||"camera"===D.kind?f.LINEAR:f.NEAREST);else{var q=1!==n.layout.get("icon-size").constantOr(0)||P.iconsNeedLinear;B=A.imageAtlasTexture,F=M||t.options.rotating||t.options.zooming||q||z?f.LINEAR:f.NEAREST,L=A.imageAtlasTexture.size}var H=ht(A,1,t.transform.zoom),W=Xe(T.posMatrix,b,g,t.transform,H),G=Je(T.posMatrix,b,g,t.transform,H),Z=k&&P.hasTextData(),Y="none"!==n.layout.get("icon-text-fit")&&Z&&P.hasIconData();v&&rt(P,T.posMatrix,t,i,W,G,b,u);var $=t.translatePosMatrix(T.posMatrix,A,a,s),K=v||i&&k||Y?Xr:W,X=t.translatePosMatrix(G,A,a,s,!0),J=M&&0!==n.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:j,buffers:I,uniformValues:M?P.iconsInText?Gr(D.kind,R,y,b,t,$,K,X,L,N):Wr(D.kind,R,y,b,t,$,K,X,i,L,!0):Hr(D.kind,R,y,b,t,$,K,X,i,L),atlasTexture:B,atlasTextureIcon:V,atlasInterpolation:F,atlasInterpolationIcon:U,isSDF:M,hasHalo:J};if(_&&P.canOverlap){w=!0;for(var ee=0,te=I.segments.get();ee<te.length;ee+=1){var re=te[ee];C.push({segments:new e.SegmentVector([re]),sortKey:re.sortKey,state:Q})}}else C.push({segments:I.segments,sortKey:0,state:Q})}}}w&&C.sort((function(e,t){return e.sortKey-t.sortKey}));for(var ne=0,oe=C;ne<oe.length;ne+=1){var ie=oe[ne],ae=ie.state;if(p.activeTexture.set(f.TEXTURE0),ae.atlasTexture.bind(ae.atlasInterpolation,f.CLAMP_TO_EDGE),ae.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),ae.atlasTextureIcon&&ae.atlasTextureIcon.bind(ae.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),ae.isSDF){var se=ae.uniformValues;ae.hasHalo&&(se.u_is_halo=1,rn(ae.buffers,ie.segments,n,t,ae.program,x,d,h,se)),se.u_is_halo=0}rn(ae.buffers,ie.segments,n,t,ae.program,x,d,h,ae.uniformValues)}}function rn(e,t,r,n,o,i,a,s,l){var c=n.context;o.draw(c,c.gl.TRIANGLES,i,a,s,Ae.disabled,l,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function nn(e,t,r,n,o,i,a){var s,l,c,u,d,h=e.context.gl,p=r.paint.get("fill-pattern"),f=p&&p.constantOr(1),m=r.getCrossfadeParameters();a?(l=f&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=h.LINES):(l=f?"fillPattern":"fill",s=h.TRIANGLES);for(var g=0,b=n;g<b.length;g+=1){var v=b[g],y=t.getTile(v);if(!f||y.patternsLoaded()){var _=y.getBucket(r);if(_){var w=_.programConfigurations.get(r.id),x=e.useProgram(l,w);f&&(e.context.activeTexture.set(h.TEXTURE0),y.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),w.updatePaintBuffers(m));var k=p.constantOr(null);if(k&&y.imageAtlas){var C=y.imageAtlas,E=C.patternPositions[k.to.toString()],S=C.patternPositions[k.from.toString()];E&&S&&w.setConstantPatternPositions(E,S)}var T=e.translatePosMatrix(v.posMatrix,y,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(a){u=_.indexBuffer2,d=_.segments2;var A=[h.drawingBufferWidth,h.drawingBufferHeight];c="fillOutlinePattern"===l&&f?Ar(T,e,m,y,A):Tr(T,A)}else u=_.indexBuffer,d=_.segments,c=f?Sr(T,e,m,y):Er(T);x.draw(e.context,s,o,e.stencilModeForClipping(v),i,Ae.disabled,c,r.id,_.layoutVertexBuffer,u,d,r.paint,e.transform.zoom,w)}}}}function on(e,t,r,n,o,i,a){for(var s=e.context,l=s.gl,c=r.paint.get("fill-extrusion-pattern"),u=c.constantOr(1),d=r.getCrossfadeParameters(),h=r.paint.get("fill-extrusion-opacity"),p=0,f=n;p<f.length;p+=1){var m=f[p],g=t.getTile(m),b=g.getBucket(r);if(b){var v=b.programConfigurations.get(r.id),y=e.useProgram(u?"fillExtrusionPattern":"fillExtrusion",v);u&&(e.context.activeTexture.set(l.TEXTURE0),g.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(d));var _=c.constantOr(null);if(_&&g.imageAtlas){var w=g.imageAtlas,x=w.patternPositions[_.to.toString()],k=w.patternPositions[_.from.toString()];x&&k&&v.setConstantPatternPositions(x,k)}var C=e.translatePosMatrix(m.posMatrix,g,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),E=r.paint.get("fill-extrusion-vertical-gradient"),S=u?Cr(C,e,E,h,m,d,g):kr(C,e,E,h);y.draw(s,s.gl.TRIANGLES,o,i,a,Ae.backCCW,S,r.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,r.paint,e.transform.zoom,v)}}}function an(t,r,n,o,i,a){var s=t.context,l=s.gl,c=r.fbo;if(c){var u=t.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get());var d=function(t,r,n){var o=n.paint.get("hillshade-shadow-color"),i=n.paint.get("hillshade-highlight-color"),a=n.paint.get("hillshade-accent-color"),s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);var l,c,u,d=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(r.tileID.toUnwrapped(),d),u_image:0,u_latrange:(l=r.tileID,c=Math.pow(2,l.canonical.z),u=l.canonical.y,[new e.MercatorCoordinate(0,u/c).toLngLat().lat,new e.MercatorCoordinate(0,(u+1)/c).toLngLat().lat]),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:o,u_highlight:i,u_accent:a}}(t,r,n);u.draw(s,l.TRIANGLES,o,i,a,Ae.disabled,d,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function sn(t,r,n,o,i,a){var s=t.context,l=s.gl,c=r.dem;if(c&&c.data){var u=c.dim,d=c.stride,h=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(d),r.demTexture){var p=r.demTexture;p.update(h,{premultiply:!1}),p.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else r.demTexture=new e.Texture(s,h,l.RGBA,{premultiply:!1}),r.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var f=r.fbo;if(!f){var m=new e.Texture(s,{width:u,height:u,data:null},l.RGBA);m.bind(l.LINEAR,l.CLAMP_TO_EDGE),(f=r.fbo=s.createFramebuffer(u,u,!0)).colorAttachment.set(m.texture)}s.bindFramebuffer.set(f.framebuffer),s.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,o,i,a,Ae.disabled,function(t,r){var n=r.stride,o=e.create();return e.ortho(o,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(o,o,[0,-e.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:r.getUnpackVector()}}(r.tileID,c),n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function ln(t,r,n,o,i){var a=o.paint.get("raster-fade-duration");if(a>0){var s=e.browser.now(),l=(s-t.timeAdded)/a,c=r?(s-r.timeAdded)/a:-1,u=n.getSource(),d=i.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-d)>Math.abs(t.tileID.overscaledZ-d),p=h&&t.refreshedUponExpiration?1:e.clamp(h?l:1-c,0,1);return t.refreshedUponExpiration&&l>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var cn=new e.Color(1,0,0,1),un=new e.Color(0,1,0,1),dn=new e.Color(0,0,1,1),hn=new e.Color(1,0,1,1),pn=new e.Color(0,1,1,1);function fn(e,t,r,n){gn(e,0,t+r/2,e.transform.width,r,n)}function mn(e,t,r,n){gn(e,t-r/2,0,r,e.transform.height,n)}function gn(t,r,n,o,i,a){var s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(r*e.browser.devicePixelRatio,n*e.browser.devicePixelRatio,o*e.browser.devicePixelRatio,i*e.browser.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}function bn(t,r,n){var o=t.context,i=o.gl,a=n.posMatrix,s=t.useProgram("debug"),l=Ee.disabled,c=Se.disabled,u=t.colorModeForRenderPass();o.activeTexture.set(i.TEXTURE0),t.emptyTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),s.draw(o,i.LINE_STRIP,l,c,u,Ae.disabled,Mr(a,e.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var d=r.getTileByID(n.key).latestRawTileData,h=Math.floor((d&&d.byteLength||0)/1024),p=r.getTile(n).tileSize,f=512/Math.min(p,512)*(n.overscaledZ/t.transform.zoom)*.5,m=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(m+=" => "+n.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas,n=e.context.gl,o=e.debugOverlayCanvas.getContext("2d");o.clearRect(0,0,r.width,r.height),o.shadowColor="white",o.shadowBlur=2,o.lineWidth=1.5,o.strokeStyle="white",o.textBaseline="top",o.font="bold 36px Open Sans, sans-serif",o.fillText(t,5,5),o.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,m+" "+h+"kb"),s.draw(o,i.TRIANGLES,l,c,Te.alphaBlended,Ae.disabled,Mr(a,e.Color.transparent,f),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}var vn={symbol:function(t,r,n,o,i){if("translucent"===t.renderPass){var a=Se.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,r,n,o,i,a,s){for(var l=r.transform,c="map"===i,u="map"===a,d=0,h=t;d<h.length;d+=1){var p=h[d],f=o.getTile(p),m=f.getBucket(n);if(m&&m.text&&m.text.segments.get().length){var g=e.evaluateSizeForZoom(m.textSizeData,l.zoom),b=ht(f,1,r.transform.zoom),v=Xe(p.posMatrix,u,c,r.transform,b),y="none"!==n.layout.get("icon-text-fit")&&m.hasIconData();if(g){var _=Math.pow(2,l.zoom-f.tileID.overscaledZ);Qr(m,c,u,s,e.symbolSize,l,v,p.posMatrix,_,g,y)}}}}(o,t,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),i),0!==n.paint.get("icon-opacity").constantOr(1)&&tn(t,r,n,o,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),a,s),0!==n.paint.get("text-opacity").constantOr(1)&&tn(t,r,n,o,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),a,s),r.map.showCollisionBoxes&&(Kr(t,r,n,o,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Kr(t,r,n,o,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(t,r,n,o){if("translucent"===t.renderPass){var i=n.paint.get("circle-opacity"),a=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0!==i.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=t.context,u=c.gl,d=t.depthModeForSublayer(0,Ee.ReadOnly),h=Se.disabled,p=t.colorModeForRenderPass(),f=[],m=0;m<o.length;m++){var g=o[m],b=r.getTile(g),v=b.getBucket(n);if(v){var y=v.programConfigurations.get(n.id),_={programConfiguration:y,program:t.useProgram("circle",y),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:Pr(t,g,b,n)};if(l)for(var w=0,x=v.segments.get();w<x.length;w+=1){var k=x[w];f.push({segments:new e.SegmentVector([k]),sortKey:k.sortKey,state:_})}else f.push({segments:v.segments,sortKey:0,state:_})}}l&&f.sort((function(e,t){return e.sortKey-t.sortKey}));for(var C=0,E=f;C<E.length;C+=1){var S=E[C],T=S.state;T.program.draw(c,u.TRIANGLES,d,h,p,Ae.disabled,T.uniformValues,n.id,T.layoutVertexBuffer,T.indexBuffer,S.segments,n.paint,t.transform.zoom,T.programConfiguration)}}}},heatmap:function(t,r,n,o){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var i=t.context,a=i.gl,s=Se.disabled,l=new Te([a.ONE,a.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r){var n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var o=r.heatmapFbo;if(o)n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),e.bindFramebuffer.set(o.framebuffer);else{var i=n.createTexture();n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),o=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),function(e,t,r,n){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t.width/4,t.height/4,0,o.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(r)}(e,t,i,o)}}(i,t,n),i.clear({color:e.Color.transparent});for(var c=0;c<o.length;c++){var u=o[c];if(!r.hasRenderableParent(u)){var d=r.getTile(u),h=d.getBucket(n);if(h){var p=h.programConfigurations.get(n.id);t.useProgram("heatmap",p).draw(i,a.TRIANGLES,Ee.disabled,s,l,Ae.disabled,zr(u.posMatrix,d,t.transform.zoom,n.paint.get("heatmap-intensity")),n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,n.paint,t.transform.zoom,p)}}}i.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){var n=t.context,o=n.gl,i=r.heatmapFbo;if(i){n.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i.colorAttachment.get()),n.activeTexture.set(o.TEXTURE1);var a=r.colorRampTexture;a||(a=r.colorRampTexture=new e.Texture(n,r.colorRamp,o.RGBA)),a.bind(o.LINEAR,o.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,o.TRIANGLES,Ee.disabled,Se.disabled,t.colorModeForRenderPass(),Ae.disabled,function(t,r,n,o){var i=e.create();e.ortho(i,0,t.width,t.height,0,0,1);var a=t.context.gl;return{u_matrix:i,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}}(t,r),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}}(t,n))},line:function(t,r,n,o){if("translucent"===t.renderPass){var i=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(0!==i.constantOr(1)&&0!==a.constantOr(1))for(var s=t.depthModeForSublayer(0,Ee.ReadOnly),l=t.colorModeForRenderPass(),c=n.paint.get("line-dasharray"),u=n.paint.get("line-pattern"),d=u.constantOr(1),h=n.paint.get("line-gradient"),p=n.getCrossfadeParameters(),f=d?"linePattern":c?"lineSDF":h?"lineGradient":"line",m=t.context,g=m.gl,b=!0,v=0,y=o;v<y.length;v+=1){var _=y[v],w=r.getTile(_);if(!d||w.patternsLoaded()){var x=w.getBucket(n);if(x){var k=x.programConfigurations.get(n.id),C=t.context.program.get(),E=t.useProgram(f,k),S=b||E.program!==C,T=u.constantOr(null);if(T&&w.imageAtlas){var A=w.imageAtlas,P=A.patternPositions[T.to.toString()],I=A.patternPositions[T.from.toString()];P&&I&&k.setConstantPatternPositions(P,I)}var O=d?Lr(t,w,n,p):c?Nr(t,w,n,c,p):h?Rr(t,w,n,x.lineClipsArray.length):jr(t,w,n);if(d)m.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),k.updatePaintBuffers(p);else if(c&&(S||t.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(m);else if(h){var M=x.gradients[n.id],D=M.texture;if(n.gradientVersion!==M.version){var z=256;if(n.stepInterpolant){var j=r.getSource().maxzoom,R=_.canonical.z===j?Math.ceil(1<<t.transform.maxZoom-_.canonical.z):1;z=e.clamp(e.nextPowerOfTwo(x.maxLineLength/e.EXTENT*1024*R),256,m.maxTextureSize)}M.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:z,image:M.gradient||void 0,clips:x.lineClipsArray}),M.texture?M.texture.update(M.gradient):M.texture=new e.Texture(m,M.gradient,g.RGBA),M.version=n.gradientVersion,D=M.texture}m.activeTexture.set(g.TEXTURE0),D.bind(n.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}E.draw(m,g.TRIANGLES,s,t.stencilModeForClipping(_),l,Ae.disabled,O,n.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,n.paint,t.transform.zoom,k,x.layoutVertexBuffer2),b=!1}}}}},fill:function(t,r,n,o){var i=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===i.constantOr(e.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){var u=t.depthModeForSublayer(1,"opaque"===t.renderPass?Ee.ReadWrite:Ee.ReadOnly);nn(t,r,n,o,u,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){var d=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ee.ReadOnly);nn(t,r,n,o,d,s,!0)}}},"fill-extrusion":function(e,t,r,n){var o=r.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===e.renderPass){var i=new Ee(e.context.gl.LEQUAL,Ee.ReadWrite,e.depthRangeFor3D);if(1!==o||r.paint.get("fill-extrusion-pattern").constantOr(1))on(e,t,r,n,i,Se.disabled,Te.disabled),on(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass());else{var a=e.colorModeForRenderPass();on(e,t,r,n,i,Se.disabled,a)}}},hillshade:function(e,t,r,n){if("offscreen"===e.renderPass||"translucent"===e.renderPass){for(var o=e.context,i=e.depthModeForSublayer(0,Ee.ReadOnly),a=e.colorModeForRenderPass(),s="translucent"===e.renderPass?e.stencilConfigForOverlap(n):[{},n],l=s[0],c=0,u=s[1];c<u.length;c+=1){var d=u[c],h=t.getTile(d);h.needsHillshadePrepare&&"offscreen"===e.renderPass?sn(e,h,r,i,Se.disabled,a):"translucent"===e.renderPass&&an(e,h,r,i,l[d.overscaledZ],a)}o.viewport.set([0,0,e.width,e.height])}},raster:function(e,t,r,n){if("translucent"===e.renderPass&&0!==r.paint.get("raster-opacity")&&n.length)for(var o=e.context,i=o.gl,a=t.getSource(),s=e.useProgram("raster"),l=e.colorModeForRenderPass(),c=a instanceof M?[{},n]:e.stencilConfigForOverlap(n),u=c[0],d=c[1],h=d[d.length-1].overscaledZ,p=!e.options.moving,f=0,m=d;f<m.length;f+=1){var g=m[f],b=e.depthModeForSublayer(g.overscaledZ-h,1===r.paint.get("raster-opacity")?Ee.ReadWrite:Ee.ReadOnly,i.LESS),v=t.getTile(g),y=e.transform.calculatePosMatrix(g.toUnwrapped(),p);v.registerFadeDuration(r.paint.get("raster-fade-duration"));var _=t.findLoadedParent(g,0),w=ln(v,_,t,r,e.transform),x=void 0,k=void 0,C="nearest"===r.paint.get("raster-resampling")?i.NEAREST:i.LINEAR;o.activeTexture.set(i.TEXTURE0),v.texture.bind(C,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(i.TEXTURE1),_?(_.texture.bind(C,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),x=Math.pow(2,_.tileID.overscaledZ-v.tileID.overscaledZ),k=[v.tileID.canonical.x*x%1,v.tileID.canonical.y*x%1]):v.texture.bind(C,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST);var E=Vr(y,k||[0,0],x||1,w,r);a instanceof M?s.draw(o,i.TRIANGLES,b,Se.disabled,l,Ae.disabled,E,r.id,a.boundsBuffer,e.quadTriangleIndexBuffer,a.boundsSegments):s.draw(o,i.TRIANGLES,b,u[g.overscaledZ],l,Ae.disabled,E,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,t,r){var n=r.paint.get("background-color"),o=r.paint.get("background-opacity");if(0!==o){var i=e.context,a=i.gl,s=e.transform,l=s.tileSize,c=r.paint.get("background-pattern");if(!e.isPatternMissing(c)){var u=!c&&1===n.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass===u){var d=Se.disabled,h=e.depthModeForSublayer(0,"opaque"===u?Ee.ReadWrite:Ee.ReadOnly),p=e.colorModeForRenderPass(),f=e.useProgram(c?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:l});c&&(i.activeTexture.set(a.TEXTURE0),e.imageManager.bind(e.context));for(var g=r.getCrossfadeParameters(),b=0,v=m;b<v.length;b+=1){var y=v[b],_=e.transform.calculatePosMatrix(y.toUnwrapped()),w=c?Yr(_,o,e,c,{tileID:y,tileSize:l},g):Zr(_,o,n);f.draw(i,a.TRIANGLES,h,d,p,Ae.disabled,w,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}}}},debug:function(e,t,r){for(var n=0;n<r.length;n++)bn(e,t,r[n])},custom:function(e,t,r){var n=e.context,o=r.implementation;if("offscreen"===e.renderPass){var i=o.prerender;i&&(e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),i.call(o,n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),n.setStencilMode(Se.disabled);var a="3d"===o.renderingMode?new Ee(e.context.gl.LEQUAL,Ee.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Ee.ReadOnly);n.setDepthMode(a),o.render(n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState(),n.bindFramebuffer.set(null)}}},yn=function(e,t){this.context=new Pe(e),this.transform=t,this._tileTextures={},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Nt,this.gpuTimers={}};yn.prototype.resize=function(t,r){if(this.width=t*e.browser.devicePixelRatio,this.height=r*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,o=this.style._order;n<o.length;n+=1)this.style._layers[o[n]].resize()},yn.prototype.setup=function(){var t=this.context,r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,Ht.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,Ht.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var o=new e.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(e.EXTENT,0,e.EXTENT,0),o.emplaceBack(0,e.EXTENT,0,e.EXTENT),o.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(o,O.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(1,0),i.emplaceBack(0,1),i.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(i,Ht.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);var s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new Se({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},yn.prototype.clearStencil=function(){var t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=e.create();e.ortho(n,0,this.width,this.height,0,0,1),e.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,r.TRIANGLES,Ee.disabled,this.stencilClearMode,Te.disabled,Ae.disabled,Dr(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},yn.prototype._renderTileClippingMasks=function(e,t){if(this.currentStencilSource!==e.source&&e.isTileClipped()&&t&&t.length){this.currentStencilSource=e.source;var r=this.context,n=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(Te.disabled),r.setDepthMode(Ee.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var i=0,a=t;i<a.length;i+=1){var s=a[i],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;o.draw(r,n.TRIANGLES,Ee.disabled,new Se({func:n.ALWAYS,mask:0},l,255,n.KEEP,n.KEEP,n.REPLACE),Te.disabled,Ae.disabled,Dr(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},yn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var e=this.nextStencilID++,t=this.context.gl;return new Se({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)},yn.prototype.stencilModeForClipping=function(e){var t=this.context.gl;return new Se({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)},yn.prototype.stencilConfigForOverlap=function(e){var t,r=this.context.gl,n=e.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),o=n[n.length-1].overscaledZ,i=n[0].overscaledZ-o+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();for(var a={},s=0;s<i;s++)a[s+o]=new Se({func:r.GEQUAL,mask:255},s+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=i,[a,n]}return[(t={},t[o]=Se.disabled,t),n]},yn.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new Te([t.CONSTANT_COLOR,t.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Te.unblended:Te.alphaBlended},yn.prototype.depthModeForSublayer=function(e,t,r){if(!this.opaquePassEnabledForLayer())return Ee.disabled;var n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ee(r||this.context.gl.LEQUAL,t,[n,n])},yn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},yn.prototype.render=function(t,r){var n=this;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var o=this.style._order,i=this.style.sourceCaches;for(var a in i){var s=i[a];s.used&&s.prepare(this.context)}var l,c,u={},d={},h={};for(var p in i){var f=i[p];u[p]=f.getVisibleCoordinates(),d[p]=u[p].slice().reverse(),h[p]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<o.length;m++)if(this.style._layers[o[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var g=0,b=o;g<b.length;g+=1){var v=this.style._layers[b[g]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var y=d[v.source];("custom"===v.type||y.length)&&this.renderLayer(this,i[v.source],v,y)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){var _=this.style._layers[o[this.currentLayer]],w=i[_.source],x=u[_.source];this._renderTileClippingMasks(_,x),this.renderLayer(this,w,_,x)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){var k=this.style._layers[o[this.currentLayer]],C=i[k.source],E=("symbol"===k.type?h:d)[k.source];this._renderTileClippingMasks(k,u[k.source]),this.renderLayer(this,C,k,E)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach((function(e){e.source&&!e.isHidden(n.transform.zoom)&&(e.source!==(c&&c.id)&&(c=n.style.sourceCaches[e.source]),(!l||l.getSource().maxzoom<c.getSource().maxzoom)&&(l=c))})),l&&vn.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(e){var t=e.transform.padding;fn(e,e.transform.height-(t.top||0),3,cn),fn(e,t.bottom||0,3,un),mn(e,t.left||0,3,dn),mn(e,e.transform.width-(t.right||0),3,hn);var r=e.transform.centerPoint;!function(e,t,r,n){gn(e,t-1,r-10,2,20,n),gn(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,pn)}(this),this.context.setDefault()},yn.prototype.renderLayer=function(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"custom"===r.type||n.length)&&(this.id=r.id,this.gpuTimingStart(r),vn[r.type](e,t,r,n,this.style.placement.variableOffsets),this.gpuTimingEnd())},yn.prototype.gpuTimingStart=function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),r.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}},yn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}},yn.prototype.collectGpuTimers=function(){var e=this.gpuTimers;return this.gpuTimers={},e},yn.prototype.queryGpuTimers=function(e){var t={};for(var r in e){var n=e[r],o=this.context.extTimerQuery,i=o.getQueryObjectEXT(n.query,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n.query),t[r]=i}return t},yn.prototype.translatePosMatrix=function(t,r,n,o,i){if(!n[0]&&!n[1])return t;var a=i?"map"===o?this.transform.angle:0:"viewport"===o?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var c=[i?n[0]:ht(r,n[0],this.transform.zoom),i?n[1]:ht(r,n[1],this.transform.zoom),0],u=new Float32Array(16);return e.translate(u,t,c),u},yn.prototype.saveTileTexture=function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]},yn.prototype.getTileTexture=function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null},yn.prototype.isPatternMissing=function(e){if(!e)return!1;if(!e.from||!e.to)return!0;var t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r},yn.prototype.useProgram=function(e,t){this.cache=this.cache||{};var r=""+e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new wr(this.context,e,vr[e],t,$r[e],this._showOverdrawInspector)),this.cache[r]},yn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},yn.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)},yn.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},yn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var _n=function(e,t){this.points=e,this.planes=t};_n.fromInvProjectionMatrix=function(t,r,n){var o=Math.pow(2,n),i=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(r){return e.transformMat4([],r,t)})).map((function(t){return e.scale$1([],t,1/t[3]/r*o)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(t){var r=e.sub([],i[t[0]],i[t[1]]),n=e.sub([],i[t[2]],i[t[1]]),o=e.normalize([],e.cross([],r,n)),a=-e.dot(o,i[t[1]]);return o.concat(a)}));return new _n(i,a)};var wn=function(t,r){this.min=t,this.max=r,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};wn.prototype.quadrant=function(t){for(var r=[t%2==0,t<2],n=e.clone$2(this.min),o=e.clone$2(this.max),i=0;i<r.length;i++)n[i]=r[i]?this.min[i]:this.center[i],o[i]=r[i]?this.center[i]:this.max[i];return o[2]=this.max[2],new wn(n,o)},wn.prototype.distanceX=function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]},wn.prototype.distanceY=function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]},wn.prototype.intersects=function(t){for(var r=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,o=0;o<t.planes.length;o++){for(var i=t.planes[o],a=0,s=0;s<r.length;s++)a+=e.dot$1(i,r[s])>=0;if(0===a)return 0;a!==r.length&&(n=!1)}if(n)return 2;for(var l=0;l<3;l++){for(var c=Number.MAX_VALUE,u=-Number.MAX_VALUE,d=0;d<t.points.length;d++){var h=t.points[d][l]-this.min[l];c=Math.min(c,h),u=Math.max(u,h)}if(u<0||c>this.max[l]-this.min[l])return 0}return 1};var xn=function(e,t,r,n){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n};xn.prototype.interpolate=function(t,r,n){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,n)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,n)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,n)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,n)),this},xn.prototype.getCenter=function(t,r){var n=e.clamp((this.left+t-this.right)/2,0,t),o=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.Point(n,o)},xn.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right},xn.prototype.clone=function(){return new xn(this.top,this.bottom,this.left,this.right)},xn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var kn=function(t,r,n,o,i){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===i||i,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=null==n?0:n,this._maxPitch=null==o?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new xn,this._posMatrixCache={},this._alignedPosMatrixCache={}},Cn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};kn.prototype.clone=function(){var e=new kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e},Cn.minZoom.get=function(){return this._minZoom},Cn.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))},Cn.maxZoom.get=function(){return this._maxZoom},Cn.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))},Cn.minPitch.get=function(){return this._minPitch},Cn.minPitch.set=function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))},Cn.maxPitch.get=function(){return this._maxPitch},Cn.maxPitch.set=function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))},Cn.renderWorldCopies.get=function(){return this._renderWorldCopies},Cn.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},Cn.worldSize.get=function(){return this.tileSize*this.scale},Cn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Cn.size.get=function(){return new e.Point(this.width,this.height)},Cn.bearing.get=function(){return-this.angle/Math.PI*180},Cn.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Cn.pitch.get=function(){return this._pitch/Math.PI*180},Cn.pitch.set=function(t){var r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Cn.fov.get=function(){return this._fov/Math.PI*180},Cn.fov.set=function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())},Cn.zoom.get=function(){return this._zoom},Cn.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},Cn.center.get=function(){return this._center},Cn.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},Cn.padding.get=function(){return this._edgeInsets.toJSON()},Cn.padding.set=function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())},Cn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},kn.prototype.isPaddingEqual=function(e){return this._edgeInsets.equals(e)},kn.prototype.interpolatePadding=function(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()},kn.prototype.coveringZoomLevel=function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)},kn.prototype.getVisibleUnwrappedCoordinates=function(t){var r=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new e.Point(0,0)),o=this.pointCoordinate(new e.Point(this.width,0)),i=this.pointCoordinate(new e.Point(this.width,this.height)),a=this.pointCoordinate(new e.Point(0,this.height)),s=Math.floor(Math.min(n.x,o.x,i.x,a.x)),l=Math.floor(Math.max(n.x,o.x,i.x,a.x)),c=s-1;c<=l+1;c++)0!==c&&r.push(new e.UnwrappedTileID(c,t));return r},kn.prototype.coveringTiles=function(t){var r=this.coveringZoomLevel(t),n=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);var o=e.MercatorCoordinate.fromLngLat(this.center),i=Math.pow(2,r),a=[i*o.x,i*o.y,0],s=_n.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r),l=t.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(l=r);var c=function(e){return{aabb:new wn([e*i,0,0],[(e+1)*i,i,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}},u=[],d=[],h=r,p=t.reparseOverscaled?n:r;if(this._renderWorldCopies)for(var f=1;f<=3;f++)u.push(c(-f)),u.push(c(f));for(u.push(c(0));u.length>0;){var m=u.pop(),g=m.x,b=m.y,v=m.fullyVisible;if(!v){var y=m.aabb.intersects(s);if(0===y)continue;v=2===y}var _=m.aabb.distanceX(a),w=m.aabb.distanceY(a),x=Math.max(Math.abs(_),Math.abs(w));if(m.zoom===h||x>3+(1<<h-m.zoom)-2&&m.zoom>=l)d.push({tileID:new e.OverscaledTileID(m.zoom===h?p:m.zoom,m.wrap,m.zoom,g,b),distanceSq:e.sqrLen([a[0]-.5-g,a[1]-.5-b])});else for(var k=0;k<4;k++){var C=(g<<1)+k%2,E=(b<<1)+(k>>1);u.push({aabb:m.aabb.quadrant(k),zoom:m.zoom+1,x:C,y:E,wrap:m.wrap,fullyVisible:v})}}return d.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))},kn.prototype.resize=function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()},Cn.unmodified.get=function(){return this._unmodified},kn.prototype.zoomScale=function(e){return Math.pow(2,e)},kn.prototype.scaleZoom=function(e){return Math.log(e)/Math.LN2},kn.prototype.project=function(t){var r=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(r)*this.worldSize)},kn.prototype.unproject=function(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},Cn.point.get=function(){return this.project(this.center)},kn.prototype.setLocationAtPoint=function(t,r){var n=this.pointCoordinate(r),o=this.pointCoordinate(this.centerPoint),i=this.locationCoordinate(t),a=new e.MercatorCoordinate(i.x-(n.x-o.x),i.y-(n.y-o.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},kn.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},kn.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},kn.prototype.locationCoordinate=function(t){return e.MercatorCoordinate.fromLngLat(t)},kn.prototype.coordinateLocation=function(e){return e.toLngLat()},kn.prototype.pointCoordinate=function(t){var r=[t.x,t.y,0,1],n=[t.x,t.y,1,1];e.transformMat4(r,r,this.pixelMatrixInverse),e.transformMat4(n,n,this.pixelMatrixInverse);var o=r[3],i=n[3],a=r[1]/o,s=n[1]/i,l=r[2]/o,c=n[2]/i,u=l===c?0:(0-l)/(c-l);return new e.MercatorCoordinate(e.number(r[0]/o,n[0]/i,u)/this.worldSize,e.number(a,s,u)/this.worldSize)},kn.prototype.coordinatePoint=function(t){var r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix),new e.Point(r[0]/r[3],r[1]/r[3])},kn.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},kn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},kn.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},kn.prototype.calculatePosMatrix=function(t,r){void 0===r&&(r=!1);var n=t.key,o=r?this._alignedPosMatrixCache:this._posMatrixCache;if(o[n])return o[n];var i=t.canonical,a=this.worldSize/this.zoomScale(i.z),s=i.x+Math.pow(2,i.z)*t.wrap,l=e.identity(new Float64Array(16));return e.translate(l,l,[s*a,i.y*a,0]),e.scale(l,l,[a/e.EXTENT,a/e.EXTENT,1]),e.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),o[n]=new Float32Array(l),o[n]},kn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},kn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,r,n,o,i=-90,a=90,s=-180,l=180,c=this.size,u=this._unmodified;if(this.latRange){var d=this.latRange;i=e.mercatorYfromLat(d[1])*this.worldSize,t=(a=e.mercatorYfromLat(d[0])*this.worldSize)-i<c.y?c.y/(a-i):0}if(this.lngRange){var h=this.lngRange;s=e.mercatorXfromLng(h[0])*this.worldSize,r=(l=e.mercatorXfromLng(h[1])*this.worldSize)-s<c.x?c.x/(l-s):0}var p=this.point,f=Math.max(r||0,t||0);if(f)return this.center=this.unproject(new e.Point(r?(l+s)/2:p.x,t?(a+i)/2:p.y)),this.zoom+=this.scaleZoom(f),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var m=p.y,g=c.y/2;m-g<i&&(o=i+g),m+g>a&&(o=a-g)}if(this.lngRange){var b=p.x,v=c.x/2;b-v<s&&(n=s+v),b+v>l&&(n=l-v)}void 0===n&&void 0===o||(this.center=this.unproject(new e.Point(void 0!==n?n:p.x,void 0!==o?o:p.y))),this._unmodified=u,this._constraining=!1}},kn.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=Math.PI/2+this._pitch,n=this._fov*(.5+t.y/this.height),o=Math.sin(n)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-r-n,.01,Math.PI-.01)),i=this.point,a=i.x,s=i.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance),c=this.height/50,u=new Float64Array(16);e.perspective(u,this._fov,this.width/this.height,c,l),u[8]=2*-t.x/this.width,u[9]=2*t.y/this.height,e.scale(u,u,[1,-1,1]),e.translate(u,u,[0,0,-this.cameraToCenterDistance]),e.rotateX(u,u,this._pitch),e.rotateZ(u,u,this.angle),e.translate(u,u,[-a,-s,0]),this.mercatorMatrix=e.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),e.scale(u,u,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u,this.invProjMatrix=e.invert([],this.projMatrix);var d=this.width%2/2,h=this.height%2/2,p=Math.cos(this.angle),f=Math.sin(this.angle),m=a-Math.round(a)+p*d+f*h,g=s-Math.round(s)+p*h+f*d,b=new Float64Array(u);if(e.translate(b,b,[m>.5?m-1:m,g>.5?g-1:g,0]),this.alignedProjMatrix=b,u=e.create(),e.scale(u,u,[this.width/2,-this.height/2,1]),e.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=e.create(),e.scale(u,u,[1,-1,1]),e.translate(u,u,[-1,-1,0]),e.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(u=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},kn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new e.Point(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},kn.prototype.getCameraPoint=function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))},kn.prototype.getCameraQueryGeometry=function(t){var r=this.getCameraPoint();if(1===t.length)return[t[0],r];for(var n=r.x,o=r.y,i=r.x,a=r.y,s=0,l=t;s<l.length;s+=1){var c=l[s];n=Math.min(n,c.x),o=Math.min(o,c.y),i=Math.max(i,c.x),a=Math.max(a,c.y)}return[new e.Point(n,o),new e.Point(i,o),new e.Point(i,a),new e.Point(n,a),new e.Point(n,o)]},Object.defineProperties(kn.prototype,Cn);var En=function(t){var r,n,o,i;this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(r=this._updateHashUnthrottled.bind(this),n=!1,o=null,i=function(){o=null,n&&(r(),o=setTimeout(i,300),n=!1)},function(){return n=!0,o||i(),o})};En.prototype.addTo=function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},En.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},En.prototype.getHashString=function(t){var r=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,o=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,o),a=Math.round(r.lng*i)/i,s=Math.round(r.lat*i)/i,l=this._map.getBearing(),c=this._map.getPitch(),u="";if(u+=t?"/"+a+"/"+s+"/"+n:n+"/"+s+"/"+a,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/"+Math.round(c)),this._hashName){var d=this._hashName,h=!1,p=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===d?(h=!0,t+"="+u):e})).filter((function(e){return e}));return h||p.push(d+"="+u),"#"+p.join("&")}return"#"+u},En.prototype._getCurrentHash=function(){var t,r=this,n=e.window.location.hash.replace("#","");return this._hashName?(n.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===r._hashName&&(t=e)})),(t&&t[1]||"").split("/")):n.split("/")},En.prototype._onHashChange=function(){var e=this._getCurrentHash();if(e.length>=3&&!e.some((function(e){return isNaN(e)}))){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},En.prototype._updateHashUnthrottled=function(){var t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());try{e.window.history.replaceState(e.window.history.state,null,t)}catch(e){}};var Sn={linearity:.3,easing:e.bezier(0,0,.3,1)},Tn=e.extend({deceleration:2500,maxSpeed:1400},Sn),An=e.extend({deceleration:20,maxSpeed:1400},Sn),Pn=e.extend({deceleration:1e3,maxSpeed:360},Sn),In=e.extend({deceleration:1e3,maxSpeed:90},Sn),On=function(e){this._map=e,this.clear()};function Mn(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Dn(t,r,n){var o=n.maxSpeed,i=n.linearity,a=n.deceleration,s=e.clamp(t*i/(r/1e3),-o,o),l=Math.abs(s)/(a*i);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}On.prototype.clear=function(){this._inertiaBuffer=[]},On.prototype.record=function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:t})},On.prototype._drainInertiaBuffer=function(){for(var t=this._inertiaBuffer,r=e.browser.now();t.length>0&&r-t[0].time>160;)t.shift()},On.prototype._onMoveEnd=function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var r={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},n=0,o=this._inertiaBuffer;n<o.length;n+=1){var i=o[n].settings;r.zoom+=i.zoomDelta||0,r.bearing+=i.bearingDelta||0,r.pitch+=i.pitchDelta||0,i.panDelta&&r.pan._add(i.panDelta),i.around&&(r.around=i.around),i.pinchAround&&(r.pinchAround=i.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(r.pan.mag()){var l=Dn(r.pan.mag(),a,e.extend({},Tn,t||{}));s.offset=r.pan.mult(l.amount/r.pan.mag()),s.center=this._map.transform.center,Mn(s,l)}if(r.zoom){var c=Dn(r.zoom,a,An);s.zoom=this._map.transform.zoom+c.amount,Mn(s,c)}if(r.bearing){var u=Dn(r.bearing,a,Pn);s.bearing=this._map.transform.bearing+e.clamp(u.amount,-179,179),Mn(s,u)}if(r.pitch){var d=Dn(r.pitch,a,In);s.pitch=this._map.transform.pitch+d.amount,Mn(s,d)}if(s.zoom||s.bearing){var h=void 0===r.pinchAround?r.around:r.pinchAround;s.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),e.extend(s,{noMoveStart:!0})}};var zn=function(t){function n(n,o,i,a){void 0===a&&(a={});var s=r.mousePos(o.getCanvasContainer(),i),l=o.unproject(s);t.call(this,n,e.extend({point:s,lngLat:l,originalEvent:i},a)),this._defaultPrevented=!1,this.target=o}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var o={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,o),n}(e.Event),jn=function(t){function n(n,o,i){var a="touchend"===n?i.changedTouches:i.touches,s=r.touchPos(o.getCanvasContainer(),a),l=s.map((function(e){return o.unproject(e)})),c=s.reduce((function(e,t,r,n){return e.add(t.div(n.length))}),new e.Point(0,0)),u=o.unproject(c);t.call(this,n,{points:s,point:c,lngLats:l,lngLat:u,originalEvent:i}),this._defaultPrevented=!1}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var o={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,o),n}(e.Event),Rn=function(e){function t(t,r,n){e.call(this,t,{originalEvent:n}),this._defaultPrevented=!1}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,r),t}(e.Event),Ln=function(e,t){this._map=e,this._clickTolerance=t.clickTolerance};Ln.prototype.reset=function(){delete this._mousedownPos},Ln.prototype.wheel=function(e){return this._firePreventable(new Rn(e.type,this._map,e))},Ln.prototype.mousedown=function(e,t){return this._mousedownPos=t,this._firePreventable(new zn(e.type,this._map,e))},Ln.prototype.mouseup=function(e){this._map.fire(new zn(e.type,this._map,e))},Ln.prototype.click=function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new zn(e.type,this._map,e))},Ln.prototype.dblclick=function(e){return this._firePreventable(new zn(e.type,this._map,e))},Ln.prototype.mouseover=function(e){this._map.fire(new zn(e.type,this._map,e))},Ln.prototype.mouseout=function(e){this._map.fire(new zn(e.type,this._map,e))},Ln.prototype.touchstart=function(e){return this._firePreventable(new jn(e.type,this._map,e))},Ln.prototype.touchmove=function(e){this._map.fire(new jn(e.type,this._map,e))},Ln.prototype.touchend=function(e){this._map.fire(new jn(e.type,this._map,e))},Ln.prototype.touchcancel=function(e){this._map.fire(new jn(e.type,this._map,e))},Ln.prototype._firePreventable=function(e){if(this._map.fire(e),e.defaultPrevented)return{}},Ln.prototype.isEnabled=function(){return!0},Ln.prototype.isActive=function(){return!1},Ln.prototype.enable=function(){},Ln.prototype.disable=function(){};var Nn=function(e){this._map=e};Nn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Nn.prototype.mousemove=function(e){this._map.fire(new zn(e.type,this._map,e))},Nn.prototype.mousedown=function(){this._delayContextMenu=!0},Nn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Nn.prototype.contextmenu=function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new zn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()},Nn.prototype.isEnabled=function(){return!0},Nn.prototype.isActive=function(){return!1},Nn.prototype.enable=function(){},Nn.prototype.disable=function(){};var Bn=function(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1};function Fn(e,t){for(var r={},n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}Bn.prototype.isEnabled=function(){return!!this._enabled},Bn.prototype.isActive=function(){return!!this._active},Bn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Bn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Bn.prototype.mousedown=function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(r.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)},Bn.prototype.mousemoveWindow=function(e,t){if(this._active){var n=t;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var o=this._startPos;this._lastPos=n,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var i=Math.min(o.x,n.x),a=Math.max(o.x,n.x),s=Math.min(o.y,n.y),l=Math.max(o.y,n.y);r.setTransform(this._box,"translate("+i+"px,"+s+"px)"),this._box.style.width=a-i+"px",this._box.style.height=l-s+"px"}}},Bn.prototype.mouseupWindow=function(t,n){var o=this;if(this._active&&0===t.button){var i=this._startPos,a=n;if(this.reset(),r.suppressClick(),i.x!==a.x||i.y!==a.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(i,a,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",t)}},Bn.prototype.keydown=function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))},Bn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},Bn.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))};var Vn=function(e){this.reset(),this.numTouches=e.numTouches};Vn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Vn.prototype.touchstart=function(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){for(var r=new e.Point(0,0),n=0,o=t;n<o.length;n+=1)r._add(o[n]);return r.div(t.length)}(r),this.touches=Fn(n,r)))},Vn.prototype.touchmove=function(e,t,r){if(!this.aborted&&this.centroid){var n=Fn(r,t);for(var o in this.touches){var i=n[o];(!i||i.dist(this.touches[o])>30)&&(this.aborted=!0)}}},Vn.prototype.touchend=function(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){var n=!this.aborted&&this.centroid;if(this.reset(),n)return n}};var Un=function(e){this.singleTap=new Vn(e),this.numTaps=e.numTaps,this.reset()};Un.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Un.prototype.touchstart=function(e,t,r){this.singleTap.touchstart(e,t,r)},Un.prototype.touchmove=function(e,t,r){this.singleTap.touchmove(e,t,r)},Un.prototype.touchend=function(e,t,r){var n=this.singleTap.touchend(e,t,r);if(n){var o=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(o&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}};var qn=function(){this._zoomIn=new Un({numTouches:1,numTaps:2}),this._zoomOut=new Un({numTouches:2,numTaps:1}),this.reset()};qn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},qn.prototype.touchstart=function(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)},qn.prototype.touchmove=function(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)},qn.prototype.touchend=function(e,t,r){var n=this,o=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r);return o?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(o)},{originalEvent:e})}}):i?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:e})}}):void 0},qn.prototype.touchcancel=function(){this.reset()},qn.prototype.enable=function(){this._enabled=!0},qn.prototype.disable=function(){this._enabled=!1,this.reset()},qn.prototype.isEnabled=function(){return this._enabled},qn.prototype.isActive=function(){return this._active};var Hn={0:1,2:2},Wn=function(e){this.reset(),this._clickTolerance=e.clickTolerance||1};Wn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Wn.prototype._correctButton=function(e,t){return!1},Wn.prototype._move=function(e,t){return{}},Wn.prototype.mousedown=function(e,t){if(!this._lastPoint){var n=r.mouseButton(e);this._correctButton(e,n)&&(this._lastPoint=t,this._eventButton=n)}},Wn.prototype.mousemoveWindow=function(e,t){var r=this._lastPoint;if(r)if(e.preventDefault(),function(e,t){var r=Hn[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(r,t)},Wn.prototype.mouseupWindow=function(e){this._lastPoint&&r.mouseButton(e)===this._eventButton&&(this._moved&&r.suppressClick(),this.reset())},Wn.prototype.enable=function(){this._enabled=!0},Wn.prototype.disable=function(){this._enabled=!1,this.reset()},Wn.prototype.isEnabled=function(){return this._enabled},Wn.prototype.isActive=function(){return this._active};var Gn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.mousedown=function(t,r){e.prototype.mousedown.call(this,t,r),this._lastPoint&&(this._active=!0)},t.prototype._correctButton=function(e,t){return 0===t&&!e.ctrlKey},t.prototype._move=function(e,t){return{around:t,panDelta:t.sub(e)}},t}(Wn),Zn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},t.prototype._move=function(e,t){var r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(Wn),Yn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},t.prototype._move=function(e,t){var r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(Wn),$n=function(e){this._minTouches=1,this._clickTolerance=e.clickTolerance||1,this.reset()};$n.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},$n.prototype.touchstart=function(e,t,r){return this._calculateTransform(e,t,r)},$n.prototype.touchmove=function(e,t,r){if(this._active&&!(r.length<this._minTouches))return e.preventDefault(),this._calculateTransform(e,t,r)},$n.prototype.touchend=function(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()},$n.prototype.touchcancel=function(){this.reset()},$n.prototype._calculateTransform=function(t,r,n){n.length>0&&(this._active=!0);var o=Fn(n,r),i=new e.Point(0,0),a=new e.Point(0,0),s=0;for(var l in o){var c=o[l],u=this._touches[l];u&&(i._add(c),a._add(c.sub(u)),s++,o[l]=c)}if(this._touches=o,!(s<this._minTouches)&&a.mag()){var d=a.div(s);if(this._sum._add(d),!(this._sum.mag()<this._clickTolerance))return{around:i.div(s),panDelta:d}}},$n.prototype.enable=function(){this._enabled=!0},$n.prototype.disable=function(){this._enabled=!1,this.reset()},$n.prototype.isEnabled=function(){return this._enabled},$n.prototype.isActive=function(){return this._active};var Kn=function(){this.reset()};function Xn(e,t,r){for(var n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Jn(e,t){return Math.log(e/t)/Math.LN2}Kn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Kn.prototype._start=function(e){},Kn.prototype._move=function(e,t,r){return{}},Kn.prototype.touchstart=function(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))},Kn.prototype.touchmove=function(e,t,r){if(this._firstTwoTouches){e.preventDefault();var n=this._firstTwoTouches,o=n[1],i=Xn(r,t,n[0]),a=Xn(r,t,o);if(i&&a){var s=this._aroundCenter?null:i.add(a).div(2);return this._move([i,a],s,e)}}},Kn.prototype.touchend=function(e,t,n){if(this._firstTwoTouches){var o=this._firstTwoTouches,i=o[1],a=Xn(n,t,o[0]),s=Xn(n,t,i);a&&s||(this._active&&r.suppressClick(),this.reset())}},Kn.prototype.touchcancel=function(){this.reset()},Kn.prototype.enable=function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around},Kn.prototype.disable=function(){this._enabled=!1,this.reset()},Kn.prototype.isEnabled=function(){return this._enabled},Kn.prototype.isActive=function(){return this._active};var Qn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),delete this._distance,delete this._startDistance},t.prototype._start=function(e){this._startDistance=this._distance=e[0].dist(e[1])},t.prototype._move=function(e,t){var r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Jn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jn(this._distance,r),pinchAround:t}},t}(Kn);function eo(e,t){return 180*e.angleWith(t)/Math.PI}var to=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},t.prototype._start=function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])},t.prototype._move=function(e,t){var r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:eo(this._vector,r),pinchAround:t}},t.prototype._isBelowThreshold=function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,r=eo(e,this._startVector);return Math.abs(r)<t},t}(Kn);function ro(e){return Math.abs(e.y)>Math.abs(e.x)}var no=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},t.prototype._start=function(e){this._lastPoints=e,ro(e[0].sub(e[1]))&&(this._valid=!1)},t.prototype._move=function(e,t,r){var n=e[0].sub(this._lastPoints[0]),o=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(n,o,r.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+o.y)/2*-.5}},t.prototype.gestureBeginsVertically=function(e,t,r){if(void 0!==this._valid)return this._valid;var n=e.mag()>=2,o=t.mag()>=2;if(n||o){if(!n||!o)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;var i=e.y>0==t.y>0;return ro(e)&&ro(t)&&i}},t}(Kn),oo={panStep:100,bearingStep:15,pitchStep:10},io=function(){var e=oo;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1};function ao(e){return e*(2-e)}io.prototype.reset=function(){this._active=!1},io.prototype.keydown=function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var r=0,n=0,o=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?o=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?o=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,o=0),{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:ao,zoom:r?Math.round(l)+r*(e.shiftKey?2:1):l,bearing:s.getBearing()+n*t._bearingStep,pitch:s.getPitch()+o*t._pitchStep,offset:[-i*t._panStep,-a*t._panStep],center:s.getCenter()},{originalEvent:e})}}}},io.prototype.enable=function(){this._enabled=!0},io.prototype.disable=function(){this._enabled=!1,this.reset()},io.prototype.isEnabled=function(){return this._enabled},io.prototype.isActive=function(){return this._active},io.prototype.disableRotation=function(){this._rotationDisabled=!0},io.prototype.enableRotation=function(){this._rotationDisabled=!1};var so=function(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onTimeout"],this)};so.prototype.setZoomRate=function(e){this._defaultZoomRate=e},so.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},so.prototype.isEnabled=function(){return!!this._enabled},so.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},so.prototype.isZooming=function(){return!!this._zooming},so.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},so.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},so.prototype.wheel=function(t){if(this.isEnabled()){var r=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,n=e.browser.now(),o=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(o*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}},so.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},so.prototype._start=function(t){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var n=r.mousePos(this._el,t);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},so.prototype.renderFrame=function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==o&&(o=1/o);var i="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(i*o))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:r.zoom,l=this._startZoom,c=this._easing,u=!1;if("wheel"===this._type&&l&&c){var d=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),h=c(d);a=e.number(l,s,h),d<1?this._frameId||(this._frameId=!0):u=!0}else a=s,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:a-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},so.prototype._smoothOutEasing=function(t){var r=e.ease;if(this._prevEase){var n=this._prevEase,o=(e.browser.now()-n.start)/n.duration,i=n.easing(o+.01)-n.easing(o),a=.27/Math.sqrt(i*i+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=e.bezier(a,s,.25,1)}return this._prevEase={start:e.browser.now(),duration:t,easing:r},r},so.prototype.reset=function(){this._active=!1};var lo=function(e,t){this._clickZoom=e,this._tapZoom=t};lo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},lo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},lo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},lo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var co=function(){this.reset()};co.prototype.reset=function(){this._active=!1},co.prototype.dblclick=function(e,t){return e.preventDefault(),{cameraAnimation:function(r){r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}},co.prototype.enable=function(){this._enabled=!0},co.prototype.disable=function(){this._enabled=!1,this.reset()},co.prototype.isEnabled=function(){return this._enabled},co.prototype.isActive=function(){return this._active};var uo=function(){this._tap=new Un({numTouches:1,numTaps:1}),this.reset()};uo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},uo.prototype.touchstart=function(e,t,r){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))},uo.prototype.touchmove=function(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;var n=t[0],o=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:o/128}}}else this._tap.touchmove(e,t,r)},uo.prototype.touchend=function(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)},uo.prototype.touchcancel=function(){this.reset()},uo.prototype.enable=function(){this._enabled=!0},uo.prototype.disable=function(){this._enabled=!1,this.reset()},uo.prototype.isEnabled=function(){return this._enabled},uo.prototype.isActive=function(){return this._active};var ho=function(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r};ho.prototype.enable=function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ho.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ho.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ho.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var po=function(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r};po.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},po.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},po.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},po.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var fo=function(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0};fo.prototype.enable=function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},fo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},fo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},fo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},fo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},fo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mo=function(e){return e.zoom||e.drag||e.pitch||e.rotate},go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(e.Event);function bo(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var vo=function(t,n){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new On(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),e.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[e.window,"blur",void 0]];for(var i=0,a=this._listeners;i<a.length;i+=1){var s=a[i],l=s[0];r.addEventListener(l,s[1],l===e.window.document?this.handleWindowEvent:this.handleEvent,s[2])}};vo.prototype.destroy=function(){for(var t=0,n=this._listeners;t<n.length;t+=1){var o=n[t],i=o[0];r.removeEventListener(i,o[1],i===e.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},vo.prototype._addDefaultHandlers=function(e){var t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new Ln(t,e));var n=t.boxZoom=new Bn(t,e);this._add("boxZoom",n);var o=new qn,i=new co;t.doubleClickZoom=new lo(i,o),this._add("tapZoom",o),this._add("clickZoom",i);var a=new uo;this._add("tapDragZoom",a);var s=t.touchPitch=new no;this._add("touchPitch",s);var l=new Zn(e),c=new Yn(e);t.dragRotate=new po(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);var u=new Gn(e),d=new $n(e);t.dragPan=new ho(r,u,d),this._add("mousePan",u),this._add("touchPan",d,["touchZoom","touchRotate"]);var h=new to,p=new Qn;t.touchZoomRotate=new fo(r,p,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var f=t.scrollZoom=new so(t,this);this._add("scrollZoom",f,["mousePan"]);var m=t.keyboard=new io;this._add("keyboard",m),this._add("blockableMapEvent",new Nn(t));for(var g=0,b=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<b.length;g+=1){var v=b[g];e.interactive&&e[v]&&t[v].enable(e[v])}},vo.prototype._add=function(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t},vo.prototype.stop=function(e){if(!this._updatingCamera){for(var t=0,r=this._handlers;t<r.length;t+=1)r[t].handler.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}},vo.prototype.isActive=function(){for(var e=0,t=this._handlers;e<t.length;e+=1)if(t[e].handler.isActive())return!0;return!1},vo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},vo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},vo.prototype.isMoving=function(){return Boolean(mo(this._eventsInProgress))||this.isZooming()},vo.prototype._blockedByActive=function(e,t,r){for(var n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1},vo.prototype.handleWindowEvent=function(e){this.handleEvent(e,e.type+"Window")},vo.prototype._getMapTouches=function(e){for(var t=[],r=0,n=e;r<n.length;r+=1){var o=n[r];this._el.contains(o.target)&&t.push(o)}return t},vo.prototype.handleEvent=function(e,t){if("blur"!==e.type){this._updatingCamera=!0;for(var n="renderFrame"===e.type?void 0:e,o={needsRenderFrame:!1},i={},a={},s=e.touches?this._getMapTouches(e.touches):void 0,l=s?r.touchPos(this._el,s):r.mousePos(this._el,e),c=0,u=this._handlers;c<u.length;c+=1){var d=u[c],h=d.handlerName,p=d.handler,f=d.allowed;if(p.isEnabled()){var m=void 0;this._blockedByActive(a,f,h)?p.reset():p[t||e.type]&&(m=p[t||e.type](e,l,s),this.mergeHandlerResult(o,i,m,h,n),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||p.isActive())&&(a[h]=p)}}var g={};for(var b in this._previousActiveHandlers)a[b]||(g[b]=n);this._previousActiveHandlers=a,(Object.keys(g).length||bo(o))&&(this._changes.push([o,i,g]),this._triggerRenderFrame()),(Object.keys(a).length||bo(o))&&this._map._stop(!0),this._updatingCamera=!1;var v=o.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],v(this._map))}else this.stop(!0)},vo.prototype.mergeHandlerResult=function(t,r,n,o,i){if(n){e.extend(t,n);var a={handlerName:o,originalEvent:n.originalEvent||i};void 0!==n.zoomDelta&&(r.zoom=a),void 0!==n.panDelta&&(r.drag=a),void 0!==n.pitchDelta&&(r.pitch=a),void 0!==n.bearingDelta&&(r.rotate=a)}},vo.prototype._applyChanges=function(){for(var t={},r={},n={},o=0,i=this._changes;o<i.length;o+=1){var a=i[o],s=a[0],l=a[1],c=a[2];s.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(t.around=s.around),void 0!==s.pinchAround&&(t.pinchAround=s.pinchAround),s.noInertia&&(t.noInertia=s.noInertia),e.extend(r,l),e.extend(n,c)}this._updateMapTransform(t,r,n),this._changes=[]},vo.prototype._updateMapTransform=function(e,t,r){var n=this._map,o=n.transform;if(!bo(e))return this._fireEvents(t,r,!0);var i=e.panDelta,a=e.zoomDelta,s=e.bearingDelta,l=e.pitchDelta,c=e.around,u=e.pinchAround;void 0!==u&&(c=u),n._stop(!0),c=c||n.transform.centerPoint;var d=o.pointLocation(i?c.sub(i):c);s&&(o.bearing+=s),l&&(o.pitch+=l),a&&(o.zoom+=a),o.setLocationAtPoint(d,c),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)},vo.prototype._fireEvents=function(t,r,n){var o=this,i=mo(this._eventsInProgress),a=mo(t),s={};for(var l in t)this._eventsInProgress[l]||(s[l+"start"]=t[l].originalEvent),this._eventsInProgress[l]=t[l];for(var c in!i&&a&&this._fireEvent("movestart",a.originalEvent),s)this._fireEvent(c,s[c]);for(var u in a&&this._fireEvent("move",a.originalEvent),t)this._fireEvent(u,t[u].originalEvent);var d,h={};for(var p in this._eventsInProgress){var f=this._eventsInProgress[p],m=f.handlerName,g=f.originalEvent;this._handlersById[m].isActive()||(delete this._eventsInProgress[p],h[p+"end"]=d=r[m]||g)}for(var b in h)this._fireEvent(b,h[b]);var v=mo(this._eventsInProgress);if(n&&(i||a)&&!v){this._updatingCamera=!0;var y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(e){return 0!==e&&-o._bearingSnap<e&&e<o._bearingSnap};y?(_(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:d})):(this._map.fire(new e.Event("moveend",{originalEvent:d})),_(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},vo.prototype._fireEvent=function(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))},vo.prototype._requestFrame=function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(t){delete e._frameId,e.handleEvent(new go("renderFrame",{timeStamp:t})),e._applyChanges()}))},vo.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var yo=function(t){function r(r,n){t.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},r.prototype.setCenter=function(e,t){return this.jumpTo({center:e},t)},r.prototype.panBy=function(t,r,n){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)},r.prototype.panTo=function(t,r,n){return this.easeTo(e.extend({center:t},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(e,t){return this.jumpTo({zoom:e},t),this},r.prototype.zoomTo=function(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)},r.prototype.zoomIn=function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this},r.prototype.zoomOut=function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(e,t){return this.jumpTo({bearing:e},t),this},r.prototype.getPadding=function(){return this.transform.padding},r.prototype.setPadding=function(e,t){return this.jumpTo({padding:e},t),this},r.prototype.rotateTo=function(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)},r.prototype.resetNorth=function(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this},r.prototype.resetNorthPitch=function(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this},r.prototype.snapToNorth=function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(e,t){return this.jumpTo({pitch:e},t),this},r.prototype.cameraForBounds=function(t,r){t=e.LngLatBounds.convert(t);var n=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,r)},r.prototype._cameraForBoxAndBearing=function(t,r,n,o){var i={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=e.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){var a=o.padding;o.padding={top:a,bottom:a,right:a,left:a}}o.padding=e.extend(i,o.padding);var s=this.transform,l=s.padding,c=s.project(e.LngLat.convert(t)),u=s.project(e.LngLat.convert(r)),d=c.rotate(-n*Math.PI/180),h=u.rotate(-n*Math.PI/180),p=new e.Point(Math.max(d.x,h.x),Math.max(d.y,h.y)),f=new e.Point(Math.min(d.x,h.x),Math.min(d.y,h.y)),m=p.sub(f),g=(s.width-(l.left+l.right+o.padding.left+o.padding.right))/m.x,b=(s.height-(l.top+l.bottom+o.padding.top+o.padding.bottom))/m.y;if(!(b<0||g<0)){var v=Math.min(s.scaleZoom(s.scale*Math.min(g,b)),o.maxZoom),y="number"==typeof o.offset.x?new e.Point(o.offset.x,o.offset.y):e.Point.convert(o.offset),_=new e.Point((o.padding.left-o.padding.right)/2,(o.padding.top-o.padding.bottom)/2).rotate(n*Math.PI/180),w=y.add(_).mult(s.scale/s.zoomScale(v));return{center:s.unproject(c.add(u).div(2).sub(w)),zoom:v,bearing:n}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},r.prototype.fitBounds=function(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)},r.prototype.fitScreenCoordinates=function(t,r,n,o,i){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)),this.transform.pointLocation(e.Point.convert(r)),n,o),o,i)},r.prototype._fitInternal=function(t,r,n){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this},r.prototype.jumpTo=function(t,r){this.stop();var n=this.transform,o=!1,i=!1,a=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(o=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(i=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(a=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),o&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),i&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),a&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))},r.prototype.easeTo=function(t,r){var n=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.browser.prefersReducedMotion)&&(t.duration=0);var o=this.transform,i=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="zoom"in t?+t.zoom:i,u="bearing"in t?this._normalizeBearing(t.bearing,a):a,d="pitch"in t?+t.pitch:s,h="padding"in t?t.padding:o.padding,p=e.Point.convert(t.offset),f=o.centerPoint.add(p),m=o.pointLocation(f),g=e.LngLat.convert(t.center||m);this._normalizeCenter(g);var b,v,y=o.project(m),_=o.project(g).sub(y),w=o.zoomScale(c-i);t.around&&(b=e.LngLat.convert(t.around),v=o.locationPoint(b));var x={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==i,this._rotating=this._rotating||a!==u,this._pitching=this._pitching||d!==s,this._padding=!o.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,x),this._ease((function(t){if(n._zooming&&(o.zoom=e.number(i,c,t)),n._rotating&&(o.bearing=e.number(a,u,t)),n._pitching&&(o.pitch=e.number(s,d,t)),n._padding&&(o.interpolatePadding(l,h,t),f=o.centerPoint.add(p)),b)o.setLocationAtPoint(b,v);else{var m=o.zoomScale(o.zoom-i),g=c>i?Math.min(2,w):Math.max(.5,w),x=Math.pow(g,1-t),k=o.unproject(y.add(_.mult(t*x)).mult(m));o.setLocationAtPoint(o.renderWorldCopies?k.wrap():k,f)}n._fireMoveEvents(r)}),(function(e){n._afterEase(r,e)}),t),this},r.prototype._prepareEase=function(t,r,n){void 0===n&&(n={}),this._moving=!0,r||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))},r.prototype._fireMoveEvents=function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))},r.prototype._afterEase=function(t,r){if(!this._easeId||!r||this._easeId!==r){delete this._easeId;var n=this._zooming,o=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),o&&this.fire(new e.Event("rotateend",t)),i&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}},r.prototype.flyTo=function(t,r){var n=this;if(!t.essential&&e.browser.prefersReducedMotion){var o=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var i=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="zoom"in t?e.clamp(+t.zoom,i.minZoom,i.maxZoom):a,d="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:l,p="padding"in t?t.padding:i.padding,f=i.zoomScale(u-a),m=e.Point.convert(t.offset),g=i.centerPoint.add(m),b=i.pointLocation(g),v=e.LngLat.convert(t.center||b);this._normalizeCenter(v);var y=i.project(b),_=i.project(v).sub(y),w=t.curve,x=Math.max(i.width,i.height),k=x/f,C=_.mag();if("minZoom"in t){var E=e.clamp(Math.min(t.minZoom,a,u),i.minZoom,i.maxZoom),S=x/i.zoomScale(E-a);w=Math.sqrt(S/C*2)}var T=w*w;function A(e){var t=(k*k-x*x+(e?-1:1)*T*T*C*C)/(2*(e?k:x)*T*C);return Math.log(Math.sqrt(t*t+1)-t)}function P(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}var O=A(0),M=function(e){return I(O)/I(O+w*e)},D=function(e){return x*((I(O)*(P(t=O+w*e)/I(t))-P(O))/T)/C;var t},z=(A(1)-O)/w;if(Math.abs(C)<1e-6||!isFinite(z)){if(Math.abs(x-k)<1e-6)return this.easeTo(t,r);var j=k<x?-1:1;z=Math.abs(Math.log(k/x))/w,D=function(){return 0},M=function(e){return Math.exp(j*w*e)}}return t.duration="duration"in t?+t.duration:1e3*z/("screenSpeed"in t?+t.screenSpeed/w:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==d,this._pitching=h!==l,this._padding=!i.isPaddingEqual(p),this._prepareEase(r,!1),this._ease((function(t){var o=t*z,f=1/M(o);i.zoom=1===t?u:a+i.scaleZoom(f),n._rotating&&(i.bearing=e.number(s,d,t)),n._pitching&&(i.pitch=e.number(l,h,t)),n._padding&&(i.interpolatePadding(c,p,t),g=i.centerPoint.add(m));var b=1===t?v:i.unproject(y.add(_.mult(D(o))).mult(f));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,g),n._fireMoveEvents(r)}),(function(){return n._afterEase(r)}),t),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){return this._stop()},r.prototype._stop=function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){var n=this.handlers;n&&n.stop(!1)}return this},r.prototype._ease=function(t,r,n){!1===n.animate||0===n.duration?(t(1),r()):(this._easeStart=e.browser.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var t=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(t,r){t=e.wrap(t,-180,180);var n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t},r.prototype._normalizeCenter=function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}},r}(e.Evented),_o=function(t){void 0===t&&(t={}),this.options=t,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_o.prototype.getDefaultPosition=function(){return"bottom-right"},_o.prototype.onAdd=function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=r.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_o.prototype.onRemove=function(){r.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_o.prototype._setElementTitle=function(e,t){var r=this._map._getUIString("AttributionControl."+t);e.title=r,e.setAttribute("aria-label",r)},_o.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_o.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var n=r.reduce((function(e,t,n){return t.value&&(e+=t.key+"="+t.value+(n<r.length-1?"&":"")),e}),"?");t.href=e.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}},_o.prototype._updateData=function(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())},_o.prototype._updateAttributions=function(){if(this._map.style){var e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((function(e){return"string"!=typeof e?"":e}))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var r=this._map.style.sourceCaches;for(var n in r){var o=r[n];if(o.used){var i=o.getSource();i.attribution&&e.indexOf(i.attribution)<0&&e.push(i.attribution)}}e.sort((function(e,t){return e.length-t.length}));var a=(e=e.filter((function(t,r){for(var n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,e.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_o.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var wo=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};wo.prototype.onAdd=function(e){this._map=e,this._container=r.create("div","mapboxgl-ctrl");var t=r.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},wo.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},wo.prototype.getDefaultPosition=function(){return"bottom-left"},wo.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},wo.prototype._logoRequired=function(){if(this._map.style){var e=this._map.style.sourceCaches;for(var t in e)if(e[t].getSource().mapbox_logo)return!0;return!1}},wo.prototype._updateCompact=function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}};var xo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xo.prototype.add=function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t},xo.prototype.remove=function(e){for(var t=this._currentlyRunning,r=0,n=t?this._queue.concat(t):this._queue;r<n.length;r+=1){var o=n[r];if(o.id===e)return void(o.cancelled=!0)}},xo.prototype.run=function(e){void 0===e&&(e=0);var t=this._currentlyRunning=this._queue;this._queue=[];for(var r=0,n=t;r<n.length;r+=1){var o=n[r];if(!o.cancelled&&(o.callback(e),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ko={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Co=e.window.HTMLImageElement,Eo=e.window.HTMLElement,So=e.window.ImageBitmap,To={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ao=function(n){function o(t){var r=this;if(null!=(t=e.extend({},To,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var o=new kn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(n.call(this,o,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new xo,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ko,t.locale),this._clickTolerance=t.clickTolerance,this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof Eo))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return r._update(!1)})),this.on("moveend",(function(){return r._update(!1)})),this.on("zoom",(function(){return r._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1),e.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new vo(this,t),this._hash=t.hash&&new En("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new _o({customAttribution:t.customAttribution})),this.addControl(new wo,t.logoPosition),this.on("style.load",(function(){r.transform.unmodified&&r.jumpTo(r.style.stylesheet)})),this.on("data",(function(t){r._update("style"===t.dataType),r.fire(new e.Event(t.dataType+"data",t))})),this.on("dataloading",(function(t){r.fire(new e.Event(t.dataType+"dataloading",t))}))}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(t,r){if(void 0===r&&(r=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=t.onAdd(this);this._controls.push(t);var o=this._controlPositions[r];return-1!==r.indexOf("bottom")?o.insertBefore(n,o.firstChild):o.appendChild(n),this},o.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(t);return r>-1&&this._controls.splice(r,1),t.onRemove(this),this},o.prototype.hasControl=function(e){return this._controls.indexOf(e)>-1},o.prototype.resize=function(t){var r=this._containerDimensions(),n=r[0],o=r[1];this._resizeCanvas(n,o),this.transform.resize(n,o),this.painter.resize(n,o);var i=!this._moving;return i&&(this.stop(),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),this.fire(new e.Event("resize",t)),i&&this.fire(new e.Event("moveend",t)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()},o.prototype.setMinZoom=function(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(e){if((e=null==e?60:e)>60)throw new Error("maxPitch must be less than or equal to 60");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},o.prototype.project=function(t){return this.transform.locationPoint(e.LngLat.convert(t))},o.prototype.unproject=function(t){return this.transform.pointLocation(e.Point.convert(t))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(e,t,r){var n,o=this;if("mouseenter"===e||"mouseover"===e){var i=!1;return{layer:t,listener:r,delegates:{mousemove:function(n){var a=o.getLayer(t)?o.queryRenderedFeatures(n.point,{layers:[t]}):[];a.length?i||(i=!0,r.call(o,new zn(e,o,n.originalEvent,{features:a}))):i=!1},mouseout:function(){i=!1}}}}if("mouseleave"===e||"mouseout"===e){var a=!1;return{layer:t,listener:r,delegates:{mousemove:function(n){(o.getLayer(t)?o.queryRenderedFeatures(n.point,{layers:[t]}):[]).length?a=!0:a&&(a=!1,r.call(o,new zn(e,o,n.originalEvent)))},mouseout:function(t){a&&(a=!1,r.call(o,new zn(e,o,t.originalEvent)))}}}}return{layer:t,listener:r,delegates:(n={},n[e]=function(e){var n=o.getLayer(t)?o.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,r.call(o,e),delete e.features)},n)}},o.prototype.on=function(e,t,r){if(void 0===r)return n.prototype.on.call(this,e,t);var o=this._createDelegatedListener(e,t,r);for(var i in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(o),o.delegates)this.on(i,o.delegates[i]);return this},o.prototype.once=function(e,t,r){if(void 0===r)return n.prototype.once.call(this,e,t);var o=this._createDelegatedListener(e,t,r);for(var i in o.delegates)this.once(i,o.delegates[i]);return this},o.prototype.off=function(e,t,r){var o=this;return void 0===r?n.prototype.off.call(this,e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&function(n){for(var i=n[e],a=0;a<i.length;a++){var s=i[a];if(s.layer===t&&s.listener===r){for(var l in s.delegates)o.off(l,s.delegates[l]);return i.splice(a,1),o}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(t,r){if(!this.style)return[];var n;if(void 0!==r||void 0===t||t instanceof e.Point||Array.isArray(t)||(r=t,t=void 0),r=r||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof t[0])n=[e.Point.convert(t)];else{var o=e.Point.convert(t[0]),i=e.Point.convert(t[1]);n=[o,new e.Point(i.x,o.y),i,new e.Point(o.x,i.y),o]}return this.style.queryRenderedFeatures(n,r,this.transform)},o.prototype.querySourceFeatures=function(e,t){return this.style.querySourceFeatures(e,t)},o.prototype.setStyle=function(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(t,r))},o.prototype._getUIString=function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '"+e+"'");return t},o.prototype._updateStyle=function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new qt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new qt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(t,r){var n=this;if("string"==typeof t){var o=this._requestManager.normalizeStyleURL(t),i=this._requestManager.transformRequest(o,e.ResourceType.Style);e.getJSON(i,(function(t,o){t?n.fire(new e.ErrorEvent(t)):o&&n._updateDiff(o,r)}))}else"object"==typeof t&&this._updateDiff(t,r)},o.prototype._updateDiff=function(t,r){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce("Unable to perform style diff: "+(n.message||n.error||n)+".  Rebuilding the style from scratch."),this._updateStyle(t,r)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)},o.prototype.isSourceLoaded=function(t){var r=this.style&&this.style.sourceCaches[t];if(void 0!==r)return r.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},o.prototype.areTilesLoaded=function(){var e=this.style&&this.style.sourceCaches;for(var t in e){var r=e[t]._tiles;for(var n in r){var o=r[n];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},o.prototype.addSourceType=function(e,t,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)},o.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},o.prototype.getSource=function(e){return this.style.getSource(e)},o.prototype.addImage=function(t,r,n){void 0===n&&(n={});var o=n.pixelRatio;void 0===o&&(o=1);var i=n.sdf;void 0===i&&(i=!1);var a=n.stretchX,s=n.stretchY,l=n.content;if(this._lazyInitEmptyStyle(),r instanceof Co||So&&r instanceof So){var c=e.browser.getImageData(r);this.style.addImage(t,{data:new e.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:o,stretchX:a,stretchY:s,content:l,sdf:i,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=r;this.style.addImage(t,{data:new e.RGBAImage({width:r.width,height:r.height},new Uint8Array(r.data)),pixelRatio:o,stretchX:a,stretchY:s,content:l,sdf:i,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}},o.prototype.updateImage=function(t,r){var n=this.style.getImage(t);if(!n)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var o=r instanceof Co||So&&r instanceof So?e.browser.getImageData(r):r,i=o.width,a=o.height,s=o.data;return void 0===i||void 0===a?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):i!==n.data.width||a!==n.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(n.data.replace(s,!(r instanceof Co||So&&r instanceof So)),void this.style.updateImage(t,n))},o.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(e){this.style.removeImage(e)},o.prototype.loadImage=function(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),r)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)},o.prototype.moveLayer=function(e,t){return this.style.moveLayer(e,t),this._update(!0)},o.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},o.prototype.getLayer=function(e){return this.style.getLayer(e)},o.prototype.setLayerZoomRange=function(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)},o.prototype.setFilter=function(e,t,r){return void 0===r&&(r={}),this.style.setFilter(e,t,r),this._update(!0)},o.prototype.getFilter=function(e){return this.style.getFilter(e)},o.prototype.setPaintProperty=function(e,t,r,n){return void 0===n&&(n={}),this.style.setPaintProperty(e,t,r,n),this._update(!0)},o.prototype.getPaintProperty=function(e,t){return this.style.getPaintProperty(e,t)},o.prototype.setLayoutProperty=function(e,t,r,n){return void 0===n&&(n={}),this.style.setLayoutProperty(e,t,r,n),this._update(!0)},o.prototype.getLayoutProperty=function(e,t){return this.style.getLayoutProperty(e,t)},o.prototype.setLight=function(e,t){return void 0===t&&(t={}),this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(e,t){return this.style.setFeatureState(e,t),this._update()},o.prototype.removeFeatureState=function(e,t){return this.style.removeFeatureState(e,t),this._update()},o.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]},o.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=r.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var o=this._controlContainer=r.create("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){i[e]=r.create("div","mapboxgl-ctrl-"+e,o)})),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(t,r){var n=e.browser.devicePixelRatio||1;this._canvas.width=n*t,this._canvas.height=n*r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px"},o.prototype._setupPainter=function(){var r=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?(this.painter=new yn(n,this.transform),e.webpSupported.testSupport(n)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))},o.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))},o.prototype._onMapScroll=function(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},o.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},o.prototype._render=function(t){var r,n=this,o=0,i=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,r),o=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=e.browser.now();this.style.zoomHistory.update(s,l);var c=new e.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=c.crossFadingFactor();1===u&&u===this._crossFadingFactor||(a=!0,this._crossFadingFactor=u),this.style.update(c)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var d=e.browser.now()-o;i.endQueryEXT(i.TIME_ELAPSED_EXT,r),setTimeout((function(){var t=i.getQueryObjectEXT(r,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r),n.fire(new e.Event("gpu-timing-frame",{cpuTime:d,gpuTime:t}))}),50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout((function(){var t=n.painter.queryGpuTimers(h);n.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}var p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,r=this._controls;t<r.length;t+=1)r[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),Po(this._canvasContainer),Po(this._controlContainer),Po(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},o.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=e.browser.frame((function(e){t._frame=null,t._render(e)})))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(e){this._trackResize&&this.resize({originalEvent:e})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(e){this._showPadding!==e&&(this._showPadding=e,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(e){this._vertices=e,this._update()},o.prototype._setCacheLimits=function(t,r){e.setCacheLimits(t,r)},i.version.get=function(){return e.version},Object.defineProperties(o.prototype,i),o}(yo);function Po(e){e.parentNode&&e.parentNode.removeChild(e)}var Io={showCompass:!0,showZoom:!0,visualizePitch:!1},Oo=function(t){var n=this;this.options=e.extend({},Io,t),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){return n._map.zoomIn({},{originalEvent:e})})),r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){return n._map.zoomOut({},{originalEvent:e})})),r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:e}):n._map.resetNorth({},{originalEvent:e})})),this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Oo.prototype._updateZoomButtons=function(){var e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},Oo.prototype._rotateCompassArrow=function(){var e=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=e},Oo.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mo(this._map,this._compass,this.options.visualizePitch)),this._container},Oo.prototype.onRemove=function(){r.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Oo.prototype._createButton=function(e,t){var n=r.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n},Oo.prototype._setButtonTitle=function(e,t){var r=this._map._getUIString("NavigationControl."+t);e.title=r,e.setAttribute("aria-label",r)};var Mo=function(t,n,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new Zn({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,o&&(this.mousePitch=new Yn({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener(n,"mousedown",this.mousedown),r.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),r.addEventListener(n,"touchmove",this.touchmove),r.addEventListener(n,"touchend",this.touchend),r.addEventListener(n,"touchcancel",this.reset)};function Do(t,r,n){if(t=new e.LngLat(t.lng,t.lat),r){var o=new e.LngLat(t.lng-360,t.lat),i=new e.LngLat(t.lng+360,t.lat),a=n.locationPoint(t).distSqr(r);n.locationPoint(o).distSqr(r)<a?t=o:n.locationPoint(i).distSqr(r)<a&&(t=i)}for(;Math.abs(t.lng-n.center.lng)>180;){var s=n.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=n.width&&s.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}Mo.prototype.down=function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),r.disableDrag()},Mo.prototype.move=function(e,t){var r=this.map,n=this.mouseRotate.mousemoveWindow(e,t);if(n&&n.bearingDelta&&r.setBearing(r.getBearing()+n.bearingDelta),this.mousePitch){var o=this.mousePitch.mousemoveWindow(e,t);o&&o.pitchDelta&&r.setPitch(r.getPitch()+o.pitchDelta)}},Mo.prototype.off=function(){var e=this.element;r.removeEventListener(e,"mousedown",this.mousedown),r.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),r.removeEventListener(e,"touchmove",this.touchmove),r.removeEventListener(e,"touchend",this.touchend),r.removeEventListener(e,"touchcancel",this.reset),this.offTemp()},Mo.prototype.offTemp=function(){r.enableDrag(),r.removeEventListener(e.window,"mousemove",this.mousemove),r.removeEventListener(e.window,"mouseup",this.mouseup)},Mo.prototype.mousedown=function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),r.mousePos(this.element,t)),r.addEventListener(e.window,"mousemove",this.mousemove),r.addEventListener(e.window,"mouseup",this.mouseup)},Mo.prototype.mousemove=function(e){this.move(e,r.mousePos(this.element,e))},Mo.prototype.mouseup=function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()},Mo.prototype.touchstart=function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))},Mo.prototype.touchmove=function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))},Mo.prototype.touchend=function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Mo.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var zo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function jo(e,t,r){var n=e.classList;for(var o in zo)n.remove("mapboxgl-"+r+"-anchor-"+o);n.add("mapboxgl-"+r+"-anchor-"+t)}var Ro,Lo=function(t){function n(n,o){if(t.call(this),(n instanceof e.window.HTMLElement||o)&&(n=e.extend({element:n},o)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&"auto"!==n.pitchAlignment?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=e.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div"),this._element.setAttribute("aria-label","Map marker");var i=r.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var l=r.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");for(var c=0,u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<u.length;c+=1){var d=u[c],h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",d.rx),h.setAttributeNS(null,"ry",d.ry),l.appendChild(h)}var p=r.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var f=r.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),p.appendChild(f);var m=r.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");var g=r.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(g);var b=r.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(6.0, 7.0)"),b.setAttributeNS(null,"fill","#FFFFFF");var v=r.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var y=r.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#000000"),y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),v.appendChild(y),v.appendChild(_),s.appendChild(l),s.appendChild(p),s.appendChild(m),s.appendChild(b),s.appendChild(v),i.appendChild(s),i.setAttributeNS(null,"height",41*this._scale+"px"),i.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(i),this._offset=e.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(e){e.preventDefault()})),this._element.addEventListener("mousedown",(function(e){e.preventDefault()})),jo(this._element,this._anchor,"marker"),this._popup=null}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},n.prototype.getElement=function(){return this._element},n.prototype.setPopup=function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},n.prototype._onKeyPress=function(e){var t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},n.prototype._onMapClick=function(e){var t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},n.prototype.getPopup=function(){return this._popup},n.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},n.prototype._update=function(e){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Do(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(t="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n="rotateX("+this._map.getPitch()+"deg)"),e&&"moveend"!==e.type||(this._pos=this._pos.round()),r.setTransform(this._element,zo[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+n+" "+t)}},n.prototype.getOffset=function(){return this._offset},n.prototype.setOffset=function(t){return this._offset=e.Point.convert(t),this._update(),this},n.prototype._onMove=function(t){if(!this._isDragging){var r=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag")))},n.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},n.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},n.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},n.prototype.isDraggable=function(){return this._draggable},n.prototype.setRotation=function(e){return this._rotation=e||0,this._update(),this},n.prototype.getRotation=function(){return this._rotation},n.prototype.setRotationAlignment=function(e){return this._rotationAlignment=e||"auto",this._update(),this},n.prototype.getRotationAlignment=function(){return this._rotationAlignment},n.prototype.setPitchAlignment=function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this},n.prototype.getPitchAlignment=function(){return this._pitchAlignment},n}(e.Evented),No={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Bo=0,Fo=!1,Vo=function(t){function n(r){t.call(this),this.options=e.extend({},No,r),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.onAdd=function(t){var n;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==Ro?n(Ro):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){n(Ro="denied"!==e.state)})):n(Ro=!!e.window.navigator.geolocation),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),r.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Bo=0,Fo=!1},n.prototype._isOutOfMapMaxBounds=function(e){var t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())},n.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},n.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}},n.prototype._updateCamera=function(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,o=this._map.getBearing(),i=e.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(n),i,{geolocateSource:!0})},n.prototype._updateMarker=function(t){if(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},n.prototype._updateCircleRadius=function(){var e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),r=this._map.unproject([1,e]),n=t.distanceTo(r),o=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=o+"px",this._circleElement.style.height=o+"px"},n.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},n.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Fo)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(t){var n=this;if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container),r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{var i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Lo(this._dotElement),this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==n._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new e.Event("trackuserlocationend")))}))},n.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Bo--,Fo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Bo>1?(t={maximumAge:6e5,timeout:0},Fo=!0):(t=this.options.positionOptions,Fo=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n}(e.Evented),Uo={maxWidth:100,unit:"metric"},qo=function(t){this.options=e.extend({},Uo,t),e.bindAll(["_onMove","setUnit"],this)};function Ho(e,t,r){var n=r&&r.maxWidth||100,o=e._container.clientHeight/2,i=e.unproject([0,o]),a=e.unproject([n,o]),s=i.distanceTo(a);if(r&&"imperial"===r.unit){var l=3.2808*s;l>5280?Wo(t,n,l/5280,e._getUIString("ScaleControl.Miles")):Wo(t,n,l,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Wo(t,n,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Wo(t,n,s/1e3,e._getUIString("ScaleControl.Kilometers")):Wo(t,n,s,e._getUIString("ScaleControl.Meters"))}function Wo(e,t,r,n){var o,i,a,s=(o=r,(i=Math.pow(10,(""+Math.floor(o)).length-1))*(a=(a=o/i)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(a)));e.style.width=t*(s/r)+"px",e.innerHTML=s+"&nbsp;"+n}qo.prototype.getDefaultPosition=function(){return"bottom-left"},qo.prototype._onMove=function(){Ho(this._map,this._container,this.options)},qo.prototype.onAdd=function(e){return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},qo.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},qo.prototype.setUnit=function(e){this.options.unit=e,Ho(this._map,this._container,this.options)};var Go=function(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Go.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Go.prototype.onRemove=function(){r.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Go.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Go.prototype._setupUI=function(){var t=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Go.prototype._updateTitle=function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},Go.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Go.prototype._isFullscreen=function(){return this._fullscreen},Go.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Go.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Zo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Yo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),$o=function(t){function n(r){t.call(this),this.options=e.extend(Object.create(Zo),r),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.addTo=function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},n.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},n.prototype.getElement=function(){return this._container},n.prototype.setText=function(t){return this.setDOMContent(e.window.document.createTextNode(t))},n.prototype.setHTML=function(t){var r,n=e.window.document.createDocumentFragment(),o=e.window.document.createElement("body");for(o.innerHTML=t;r=o.firstChild;)n.appendChild(r);return this.setDOMContent(n)},n.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},n.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},n.prototype.setDOMContent=function(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=r.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this},n.prototype.addClassName=function(e){this._container&&this._container.classList.add(e)},n.prototype.removeClassName=function(e){this._container&&this._container.classList.remove(e)},n.prototype.setOffset=function(e){return this.options.offset=e,this._update(),this},n.prototype.toggleClassName=function(e){if(this._container)return this._container.classList.toggle(e)},n.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},n.prototype._onMouseUp=function(e){this._update(e.point)},n.prototype._onMouseMove=function(e){this._update(e.point)},n.prototype._onDrag=function(e){this._update(e.point)},n.prototype._update=function(t){var n=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(e){return n._container.classList.add(e)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Do(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var o=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),i=this.options.anchor,a=function t(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new e.Point(0,0),top:new e.Point(0,r),"top-left":new e.Point(n,n),"top-right":new e.Point(-n,n),bottom:new e.Point(0,-r),"bottom-left":new e.Point(n,-n),"bottom-right":new e.Point(-n,-n),left:new e.Point(r,0),right:new e.Point(-r,0)}}if(r instanceof e.Point||Array.isArray(r)){var o=e.Point.convert(r);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:e.Point.convert(r.center||[0,0]),top:e.Point.convert(r.top||[0,0]),"top-left":e.Point.convert(r["top-left"]||[0,0]),"top-right":e.Point.convert(r["top-right"]||[0,0]),bottom:e.Point.convert(r.bottom||[0,0]),"bottom-left":e.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(r["bottom-right"]||[0,0]),left:e.Point.convert(r.left||[0,0]),right:e.Point.convert(r.right||[0,0])}}return t(new e.Point(0,0))}(this.options.offset);if(!i){var s,l=this._container.offsetWidth,c=this._container.offsetHeight;s=o.y+a.bottom.y<c?["top"]:o.y>this._map.transform.height-c?["bottom"]:[],o.x<l/2?s.push("left"):o.x>this._map.transform.width-l/2&&s.push("right"),i=0===s.length?"bottom":s.join("-")}var u=o.add(a[i]).round();r.setTransform(this._container,zo[i]+" translate("+u.x+"px,"+u.y+"px)"),jo(this._container,i,"popup")}},n.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var e=this._container.querySelector(Yo);e&&e.focus()}},n.prototype._onClose=function(){this.remove()},n}(e.Evented),Ko={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Ao,NavigationControl:Oo,GeolocateControl:Vo,AttributionControl:_o,ScaleControl:qo,FullscreenControl:Go,Popup:$o,Marker:Lo,Style:qt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){Ne().acquire(ze)},clearPrewarmedResources:function(){var e=Re;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(ze),Re=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return je.workerCount},set workerCount(e){je.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:""};return Ko})),r}()},function(e,t,r){var n=r(62),o=r(52),i=r(40),a=r(63);e.exports=function(e){return n(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(87),o=r(120),i=r(40),a=r(88);e.exports=function(e,t){return n(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=window.wp.data},function(e,t,r){e.exports=r(89)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return rt})),r.d(t,"b",(function(){return we}));var n=r(10),o=r(1),i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a={onResize:"resize",onDblClick:"dblclick",onClick:"click",onMouseMove:"mousemove",onMouseOut:"mouseout",onMoveStart:"movestart",onMove:"move",onMoveEnd:"moveend",onMouseUp:"mouseup",onMouseDown:"mousedown",onDragStart:"dragstart",onDrag:"drag",onDragEnd:"dragend",onZoomStart:"zoomstart",onZoom:"zoom",onZoomEnd:"zoomend",onPitch:"pitch",onPitchStart:"pitchstart",onPitchEnd:"pitchend",onWebGlContextLost:"webglcontextlost",onWebGlContextRestored:"webglcontextrestored",onRemove:"remove",onContextMenu:"contextmenu",onRender:"render",onError:"error",onSourceData:"sourcedata",onDataLoading:"dataloading",onStyleDataLoading:"styledataloading",onStyleImageMissing:"styleimagemissing",onTouchCancel:"touchcancel",onData:"data",onSourceDataLoading:"sourcedataloading",onTouchMove:"touchmove",onTouchEnd:"touchend",onTouchStart:"touchstart",onStyleData:"styledata",onBoxZoomStart:"boxzoomstart",onBoxZoomEnd:"boxzoomend",onBoxZoomCancel:"boxzoomcancel",onRotateStart:"rotatestart",onRotate:"rotate",onRotateEnd:"rotateend"},s=function(e,t,r){return Object.keys(e).reduce((function(n,o){var i=t[o];if(i){var a=function(e){i(r,e)};r.on(e[o],a),n[o]=a}return n}),{})},l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=o.createContext(void 0);function u(e){return function(t){return o.createElement(c.Consumer,null,(function(r){return o.createElement(e,l({map:r},t))}))}}var d,h=r(28),p=(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=r(51),g=[11],b=[-.2416815,51.5285582],v=function(e){var t,l=e.accessToken,u=e.apiUrl,d=e.minZoom,v=void 0===d?0:d,y=e.maxZoom,_=void 0===y?20:y,w=e.hash,x=void 0!==w&&w,k=e.preserveDrawingBuffer,C=void 0!==k&&k,E=e.scrollZoom,S=void 0===E||E,T=e.interactive,A=void 0===T||T,P=e.dragRotate,I=void 0===P||P,O=e.pitchWithRotate,M=void 0===O||O,D=e.attributionControl,z=void 0===D||D,j=e.customAttribution,R=e.logoPosition,L=void 0===R?"bottom-left":R,N=e.renderWorldCopies,B=void 0===N||N,F=e.trackResize,V=void 0===F||F,U=e.touchZoomRotate,q=void 0===U||U,H=e.doubleClickZoom,W=void 0===H||H,G=e.keyboard,Z=void 0===G||G,Y=e.dragPan,$=void 0===Y||Y,K=e.boxZoom,X=void 0===K||K,J=e.refreshExpiredTiles,Q=void 0===J||J,ee=e.failIfMajorPerformanceCaveat,te=void 0!==ee&&ee,re=e.bearingSnap,ne=void 0===re?7:re,oe=e.injectCSS,ie=void 0===oe||oe,ae=e.antialias,se=void 0!==ae&&ae,le=e.transformRequest;return ie&&r(116),(t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={map:void 0,ready:!1},t.listeners={},t._isMounted=!0,t.calcCenter=function(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]},t.setRef=function(e){t.container=e},t}return p(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,r=t.style,o=t.onStyleLoad,i=t.center,c=t.pitch,d=t.zoom,h=t.fitBounds,p=t.fitBoundsOptions,f=t.bearing,m=t.maxBounds;if(n.accessToken=l,u&&(n.config.API_URL=u),!Array.isArray(d))throw new Error("zoom need to be an array type of length 1 for reliable update");var g={preserveDrawingBuffer:C,hash:x,zoom:d[0],minZoom:v,maxZoom:_,maxBounds:m,container:this.container,center:h&&i===b?this.calcCenter(h):i,style:r,scrollZoom:S,attributionControl:z,customAttribution:j,interactive:A,dragRotate:I,pitchWithRotate:M,renderWorldCopies:B,trackResize:V,touchZoomRotate:q,doubleClickZoom:W,keyboard:Z,dragPan:$,boxZoom:X,refreshExpiredTiles:Q,logoPosition:L,bearingSnap:ne,failIfMajorPerformanceCaveat:te,antialias:se,transformRequest:le};if(f){if(!Array.isArray(f))throw new Error("bearing need to be an array type of length 1 for reliable update");g.bearing=f[0]}if(c){if(!Array.isArray(c))throw new Error("pitch need to be an array type of length 1 for reliable update");g.pitch=c[0]}var y=new n.Map(g);this.setState({map:y}),h&&y.fitBounds(h,p,{fitboundUpdate:!0}),y.on("load",(function(t){e._isMounted&&e.setState({ready:!0}),o&&o(y,t)})),this.listeners=s(a,this.props,y)},t.prototype.componentWillUnmount=function(){var e=this.state.map;this._isMounted=!1,e&&e.remove()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.state.map;if(!t)return null;this.listeners=function(e,t,r){Object.keys(a).filter((function(r){return e[r]&&t[r]!==e[r]})).forEach((function(t){r.off(a[t],e[t]),delete e[t]}));var n=Object.keys(a).filter((function(e){return"function"==typeof t[e]})).reduce((function(e,t){return e[t]=a[t],e}),{}),o=s(n,t,r);return i({},e,o)}(this.listeners,e,t);var r=t.getCenter(),n=t.getZoom(),o=t.getBearing(),l=t.getPitch(),c=this.props.zoom!==e.zoom&&(e.zoom&&e.zoom[0])!==n,u=this.props.center!==e.center&&((e.center&&e.center[0])!==r.lng||(e.center&&e.center[1])!==r.lat),d=this.props.bearing!==e.bearing&&(e.bearing&&e.bearing[0])!==o,h=this.props.pitch!==e.pitch&&(e.pitch&&e.pitch[0])!==l;e.maxBounds&&(this.props.maxBounds!==e.maxBounds&&t.setMaxBounds(e.maxBounds));if(e.fitBounds){var p=this.props.fitBounds;!(p!==e.fitBounds||e.fitBounds.length!==(p&&p.length)||!!p.filter((function(t,r){var n=e.fitBounds&&e.fitBounds[r];return t[0]!==(n&&n[0])||t[1]!==(n&&n[1])}))[0])&&m(this.props.fitBoundsOptions,e.fitBoundsOptions)||t.fitBounds(e.fitBounds,e.fitBoundsOptions,{fitboundUpdate:!0})}if(c||u||d||h){var g=e.movingMethod||"flyTo",b=e.flyToOptions,v=e.animationOptions;t[g](f({},v,b,{zoom:c&&e.zoom?e.zoom[0]:n,center:u?e.center:r,bearing:d?e.bearing:o,pitch:h?e.pitch:l}))}return m(this.props.style,e.style)||t.setStyle(e.style),null},t.prototype.render=function(){var e=this.props,t=e.containerStyle,r=e.className,n=e.children,i=e.renderChildrenInPortal,a=this.state,s=a.ready,l=a.map;if(i){var u=s&&l&&"function"==typeof l.getCanvasContainer?l.getCanvasContainer():void 0;return o.createElement(c.Provider,{value:l},o.createElement("div",{ref:this.setRef,className:r,style:f({},t)},s&&u&&Object(h.createPortal)(n,u)))}return o.createElement(c.Provider,{value:l},o.createElement("div",{ref:this.setRef,className:r,style:f({},t)},s&&n))},t}(o.Component)).defaultProps={onStyleLoad:function(e,t){return null},center:b,zoom:g,bearing:0,movingMethod:"flyTo",pitch:0,containerStyle:{textAlign:"left"}},t},y=function(e,t){var r={};return Array.from(new Set(Object.keys(e).concat(Object.keys(t)))).map((function(n){e[n]!==t[n]&&(r[n]=t[n])})),r},_=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),w=function(){return(w=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},x=r(51),k={touchstart:"onTouchStart",touchend:"onTouchEnd",touchcancel:"onTouchCancel",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousedown:"onMouseDown",mouseup:"onMouseUp",click:"onClick"},C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=w({type:"geojson"},t.props.geoJSONSourceOptions,{data:{type:"FeatureCollection",features:[]}}),t.geometry=function(e){switch(t.props.type){case"symbol":case"circle":return{type:"Point",coordinates:e};case"fill":return Array.isArray(e[0][0][0])?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e};case"line":return{type:"LineString",coordinates:e};default:return{type:"Point",coordinates:e}}},t.makeFeature=function(e,r){return{type:"Feature",geometry:t.geometry(e.coordinates),properties:w({},e.properties,{id:r})}},t.initialize=function(){var e=t.props,r=e.type,n=e.layout,o=e.paint,i=e.sourceId,a=e.before,s=e.images,l=e.id,c=e.metadata,u=e.sourceLayer,d=e.minZoom,h=e.maxZoom,p=e.filter,f=t.props.map,m={id:l,source:i||l,type:r,layout:n,paint:o,metadata:c};(u&&(m["source-layer"]=u),d&&(m.minzoom=d),h&&(m.maxzoom=h),p&&(m.filter=p),s)&&(Array.isArray(s[0])?s:[s]).filter((function(e){return!f.hasImage(e[0])})).forEach((function(e){f.addImage(e[0],e[1],e[2])}));i||f.getSource(l)||f.addSource(l,t.source),f.getLayer(l)||f.addLayer(m,a),Object.entries(k).forEach((function(e){var r=e[0],n=e[1],o=t.props[n];o&&f.on(r,l,o)}))},t.onStyleDataChange=function(){t.props.map.getLayer(t.props.id)||(t.initialize(),t.forceUpdate())},t.getChildren=function(){var e=t.props.children;return e?Array.isArray(e)?e.reduce((function(e,t){return e.concat(t)}),[]):[e]:[]},t}return _(t,e),t.prototype.UNSAFE_componentWillMount=function(){var e=this.props.map;this.initialize(),e.on("styledata",this.onStyleDataChange)},t.prototype.componentWillUnmount=function(){var e=this,t=this.props.map,r=this.props,n=r.images,o=r.id;t&&t.getStyle()&&(t.off("styledata",this.onStyleDataChange),Object.entries(k).forEach((function(r){var n=r[0],i=r[1],a=e.props[i];a&&t.off(n,o,a)})),t.getLayer(o)&&t.removeLayer(o),this.props.sourceId||t.removeSource(o),n&&(Array.isArray(n[0])?n:[n]).map((function(e){var t=e[0];e.slice(1);return t})).forEach(t.removeImage.bind(t)))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,r=this.props,n=r.paint,o=r.layout,i=r.before,a=r.filter,s=r.id,l=r.minZoom,c=r.maxZoom,u=this.props.map;if(!x(e.paint,n)){var d=y(n,e.paint);Object.keys(d).forEach((function(e){u.setPaintProperty(s,e,d[e])}))}if(!x(e.layout,o)){var h=y(o,e.layout);Object.keys(h).forEach((function(e){u.setLayoutProperty(s,e,h[e])}))}x(e.filter,a)||u.setFilter(s,e.filter),i!==e.before&&u.moveLayer(s,e.before),l===e.minZoom&&c===e.maxZoom||u.setLayerZoomRange(s,e.minZoom,e.maxZoom),Object.entries(k).forEach((function(r){var n=r[0],o=r[1],i=t.props[o],a=e[o];i!==a&&(i&&u.off(n,s,i),a&&u.on(n,s,a))}))},t.prototype.render=function(){var e=this,t=this.props.map,r=this.props,n=r.sourceId,o=r.draggedChildren,i=this.getChildren();if(o){var a=o.map((function(e){return e.key}));i=i.map((function(e){var t=a.indexOf(e.key);return-1!==t?o[t]:e}))}var s=i.map((function(t,r){var n=t.props;return e.makeFeature(n,r)})).filter(Boolean),l=t.getSource(n||this.props.id);return l&&!n&&l.setData&&l.setData({type:"FeatureCollection",features:s}),null},t.defaultProps={type:"symbol",layout:{},paint:{}},t}(o.Component),E=0,S=function(){return E+=1},T=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),A=function(){return(A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var P=function(e){return function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.hover=[],e.draggedChildren=void 0,e.id=e.props.id||"layer-"+S(),e.getChildren=function(){return[].concat(e.props.children).filter((function(e){return void 0!==e}))},e.getChildFromId=function(e,t){return e[t]},e.areFeaturesDraggable=function(t,r){return void 0===r&&(r=e.hover),!!r.map((function(r){return!!e.getChildFromId(t,r)&&e.getChildFromId(t,r).props.draggable})).filter(Boolean).length},e.onClick=function(t){var r=t.features,n=e.getChildren(),o=e.props.map;r&&r.forEach((function(r){var i=r.properties.id;if(n){var a=e.getChildFromId(n,i),s=a&&a.props.onClick;s&&s(A({},t,{feature:r,map:o}))}}))},e.onMouseEnter=function(t){var r=e.getChildren(),n=e.props.map;e.hover=[],t.features.forEach((function(o){var i=o.properties.id,a=e.getChildFromId(r,i);e.hover.push(i);var s=a&&a.props.onMouseEnter;s&&s(A({},t,{feature:o,map:n}))})),e.areFeaturesDraggable(r)&&n.dragPan.disable()},e.onMouseLeave=function(t){var r=e.getChildren(),n=e.props.map;e.areFeaturesDraggable(r)&&n.dragPan.enable(),e.hover.forEach((function(o){var i=e.getChildFromId(r,o),a=i&&i.props.onMouseLeave;a&&a(A({},t,{map:n}))})),e.draggedChildren||(e.hover=[])},e.onMouseDown=function(){e.hover.length&&e.onFeatureDown("mousedown")},e.onTouchStart=function(t){e.hover=t.features.map((function(e){return e.properties.id})),e.hover.length&&e.onFeatureDown("touchstart")},e.onFeatureDown=function(t){var r="mousedown"===t?"mousemove":"touchmove",n="mousedown"===t?"mouseup":"touchend",o=e.props.map;o.once(r,e.onFeatureDragStart),o.on(r,e.onFeatureDrag),o.once(n,(function(t){o.off(r,e.onFeatureDragStart),o.off(r,e.onFeatureDrag),e.onFeatureDragEnd(t)}))},e.onFeatureDragStart=function(t){var r=e.props.map,n=e.getChildren();e.hover.forEach((function(o){var i=e.getChildFromId(n,o);if(!i||i.props.draggable){var a=i&&i.props.onDragStart;a&&a(A({},t,{map:r}))}}))},e.onFeatureDrag=function(t){var r=e.getChildren(),n=e.props.map,i=t.lngLat,a=i.lng,s=i.lat;e.draggedChildren=[],e.hover.forEach((function(i){var l=e.getChildFromId(r,i),c=l&&l.props.onDrag;l&&l.props.draggable&&(e.draggedChildren.push(o.cloneElement(l,{coordinates:[a,s]})),c&&c(A({},t,{map:n})))})),e.forceUpdate()},e.onFeatureDragEnd=function(t){var r=e.props.map,n=e.getChildren();e.hover.forEach((function(o){var i=e.getChildFromId(n,o),a=i&&i.props.onDragEnd;a&&i.props.draggable&&e.draggedChildren&&a(A({},t,{map:r}))})),e.draggedChildren=void 0},e}return T(r,t),r.prototype.UNSAFE_componentWillMount=function(){var e=this.props.map;e.on("click",this.id,this.onClick),e.on("mouseenter",this.id,this.onMouseEnter),e.on("mouseleave",this.id,this.onMouseLeave),e.on("mousedown",this.id,this.onMouseDown),e.on("touchstart",this.id,this.onTouchStart)},r.prototype.componentWillUnmount=function(){var e=this.props.map;e.off("click",this.onClick),e.off("mouseenter",this.onMouseEnter),e.off("mouseleave",this.onMouseLeave),e.off("mousedown",this.onMouseDown),e.off("touchstart",this.onTouchStart)},r.prototype.render=function(){return o.createElement(e,A({},this.props,{id:this.id,map:this.props.map,draggedChildren:this.draggedChildren}))},r}(o.Component)},I=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),O=function(){return(O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},M=r(51),D=["symbol","line","fill","fill-extrusion","circle"],z=function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/[\s+]|-/g,"")},j={mousemove:"OnMouseMove",mouseenter:"OnMouseEnter",mouseleave:"OnMouseLeave",mousedown:"OnMouseDown",mouseup:"OnMouseUp",click:"OnClick"},R=(u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id=t.props.id||"geojson-"+S(),t.source=O({type:"geojson"},t.props.sourceOptions,{data:t.props.data}),t.layerIds=[],t.buildLayerId=function(e){return t.id+"-"+e},t.createLayer=function(e){var r=t.props,n=r.before,o=r.layerOptions,i=r.map,a=t.buildLayerId(e);t.layerIds.push(a);var s=t.props[z(e)+"Paint"]||{},l=Object.keys(s).length?"visible":"none",c=t.props[z(e)+"Layout"]||{visibility:l};i.addLayer(O({id:a,source:t.id,type:e,paint:s,layout:c},o),n),t.mapLayerMouseHandlers(e)},t.mapLayerMouseHandlers=function(e){var r=t.props.map,n=t.buildLayerId(e);Object.keys(j).forEach((function(o){var i=t.props[""+z(e)+j[o]]||null;i&&r.on(o,n,i)}))},t.onStyleDataChange=function(){t.props.map.getSource(t.id)||(t.unbind(),t.initialize(),t.forceUpdate())},t.isGeoJSONSource=function(e){return!!e&&"function"==typeof e.setData},t}return I(t,e),t.prototype.initialize=function(){this.props.map.addSource(this.id,this.source),this.createLayer("symbol"),this.createLayer("line"),this.createLayer("fill"),this.createLayer("fill-extrusion"),this.createLayer("circle")},t.prototype.unbind=function(){var e=this,t=this.props.map;if(t.getSource(this.id)){var r=t.getStyle().layers;r&&r.filter((function(t){return t.source===e.id})).forEach((function(e){return t.removeLayer(e.id)})),t.removeSource(this.id)}D.forEach((function(r){Object.keys(j).forEach((function(n){var o=z(r)+j[n];e.props[o]&&t.off(n,e.buildLayerId(r),e.props[o])}))})),this.layerIds.forEach((function(e){t.getLayer(e)&&t.removeLayer(e)}))},t.prototype.UNSAFE_componentWillMount=function(){var e=this.props.map;this.initialize(),e.on("styledata",this.onStyleDataChange)},t.prototype.componentWillUnmount=function(){var e=this.props.map;e&&e.getStyle()&&(e.off("styledata",this.onStyleDataChange),this.unbind())},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,r=this.props,n=r.data,o=r.before,i=r.layerOptions,a=r.map,s=a.getSource(this.id);if(this.isGeoJSONSource(s)){e.data!==n&&(s.setData(e.data),this.source=O({type:"geojson"},e.sourceOptions,{data:e.data}));var l=e.layerOptions&&i&&!M(e.layerOptions.filter,i.filter);D.forEach((function(r){var n=t.buildLayerId(r);e.layerOptions&&l&&a.setFilter(n,e.layerOptions.filter||[]);var i=z(r)+"Paint";if(!M(e[i],t.props[i])){var s=y(t.props[i],e[i]);Object.keys(s).forEach((function(e){a.setPaintProperty(n,e,s[e])}))}var c=z(r)+"Layout";if(!M(e[c],t.props[c])){var u=y(t.props[c],e[c]);Object.keys(u).forEach((function(e){a.setLayoutProperty(n,e,u[e])}))}Object.keys(j).forEach((function(o){var i=z(r)+j[o];e[i]!==t.props[i]&&(t.props[i]&&a.off(o,n,t.props[i]),e[i]&&a.on(o,n,e[i]))})),o!==e.before&&a.moveLayer(n,e.before)}))}},t.prototype.render=function(){return null},t}(o.Component)),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),L=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}R(t,e),t.prototype.render=function(){return null}}(o.Component),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),N=function(){return(N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B={position:"absolute",zIndex:10,display:"flex",flexDirection:"column",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)"},F={"top-right":{top:10,right:10,bottom:"auto",left:"auto"},"top-left":{top:10,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:10,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:10,left:10,top:"auto",right:"auto"}},V={backgroundColor:"#f9f9f9",opacity:.95,transition:"background-color 0.16s ease-out",cursor:"pointer",border:0,height:26,width:26,backgroundImage:"url('https://api.mapbox.com/mapbox.js/v2.4.0/images/icons-000000@2x.png')",backgroundPosition:"0px 0px",backgroundSize:"26px 260px",outline:0},U={backgroundColor:"#fff",opacity:1},q={borderBottom:"1px solid rgba(0, 0, 0, 0.1)",borderTopLeftRadius:2,borderTopRightRadius:2},H={backgroundPosition:"0px -26px",borderBottomLeftRadius:2,borderBottomRightRadius:2},W=[0,1],G=W[0],Z=W[1],Y=Object.keys(F),$=(u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hover:void 0},t.onMouseOut=function(){t.setState({hover:void 0})},t.plusOver=function(){G!==t.state.hover&&t.setState({hover:G})},t.minusOver=function(){Z!==t.state.hover&&t.setState({hover:Z})},t.onClickPlus=function(){t.props.onControlClick(t.props.map,t.props.zoomDiff)},t.onClickMinus=function(){t.props.onControlClick(t.props.map,-t.props.zoomDiff)},t}return L(t,e),t.prototype.render=function(){var e=this.props,t=e.position,r=e.style,n=e.className,i=e.tabIndex,a=this.state.hover,s=N({},V,q,a===G?U:{}),l=N({},V,H,a===Z?U:{});return o.createElement("div",{className:n,tabIndex:i,style:N({},B,F[t],r)},o.createElement("button",{id:"zoomIn",type:"button",style:s,"aria-label":"Zoom in",onMouseOver:this.plusOver,onMouseOut:this.onMouseOut,onClick:this.onClickPlus}),o.createElement("button",{id:"zoomOut",type:"button",style:l,"aria-label":"Zoom out",onMouseOver:this.minusOver,onMouseOut:this.onMouseOut,onClick:this.onClickMinus}))},t.defaultProps={position:Y[0],zoomDiff:.5,onControlClick:function(e,t){e.zoomTo(e.getZoom()+t)}},t}(o.Component)),["center","top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]),K={center:"translate(-50%, -50%)",top:"translate(-50%, 0)",left:"translate(0, -50%)",right:"translate(-100%, -50%)",bottom:"translate(-50%, -100%)","top-left":"translate(0, 0)","top-right":"translate(-100%, 0)","bottom-left":"translate(0, -100%)","bottom-right":"translate(-100%, -100%)"},X={offsetWidth:0,offsetHeight:0},J=[0,0],Q=function(e){if(!e)return Q(new n.Point(0,0));if("number"==typeof e){var t=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new n.Point(e,e),top:new n.Point(0,e),bottom:new n.Point(0,-e),left:new n.Point(e,0),right:new n.Point(-e,0),"top-left":new n.Point(t,t),"top-right":new n.Point(-t,t),"bottom-left":new n.Point(t,-t),"bottom-right":new n.Point(-t,-t)}}return e instanceof n.Point||Array.isArray(e)?$.reduce((function(t,r){return t[r]=n.Point.convert(e),t}),{}):$.reduce((function(t,r){return t[r]=n.Point.convert(e[r]||J),t}),{})},ee=function(e,t,r){var o=function(e,t){return e.project(n.LngLat.convert(t))}(t,e.coordinates),i=Q(e.offset),a=e.anchor||function(e,t,r,n){var o=void 0===n?X:n,i=o.offsetHeight,a=o.offsetWidth,s=[];return r.y+t.bottom.y-i<0?s=[$[1]]:r.y+t.top.y+i>e.transform.height&&(s=[$[2]]),r.x<a/2?s.push($[3]):r.x>e.transform.width-a/2&&s.push($[4]),0===s.length?$[2]:s.join("-")}(t,i,o,r);return{anchor:a,position:o,offset:i[a]}},te=function(e){return e?"translate("+e.x.toFixed(0)+"px, "+e.y.toFixed(0)+"px)":""},re=function(e){var t=e.anchor,r=e.position,n=e.offset,o=[];return r&&o.push(te(r)),n&&void 0!==n.x&&void 0!==n.y&&o.push(te(n)),t&&o.push(K[t]),o},ne=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),oe=function(){return(oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ie={zIndex:3},ae=u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=void 0,t.prevent=!1,t.state={},t.setContainer=function(e){e&&(t.container=e)},t.handleMapMove=function(){t.prevent||t.setState(ee(t.props,t.props.map,t.container))},t}return ne(t,e),t.prototype.componentDidMount=function(){this.props.map.on("move",this.handleMapMove),this.handleMapMove()},t.prototype.havePropsChanged=function(e,t){return e.coordinates[0]!==t.coordinates[0]||e.coordinates[1]!==t.coordinates[1]||e.offset!==t.offset||e.anchor!==t.anchor},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.havePropsChanged(this.props,e)&&this.setState(ee(e,this.props.map,this.container))},t.prototype.componentWillUnmount=function(){var e=this.props.map;this.prevent=!0,e.off("move",this.handleMapMove)},t.prototype.render=function(){var e=this.props,t=e.style,r=e.children,n=e.className,i=e.onClick,a=e.onDoubleClick,s=e.onMouseEnter,l=e.onMouseLeave,c=e.onScroll,u=e.onWheel,d=e.type,h=e.tabIndex,p=this.state.anchor,f=oe({},ie,t,{transform:re(this.state).join(" ")}),m=p&&"popup"===d?"mapboxgl-popup-anchor-"+p:"";return o.createElement("div",{className:n+" "+m,onClick:i,onDoubleClick:a,onMouseEnter:s,onMouseLeave:l,onScroll:c,onWheel:u,style:f,ref:this.setContainer,tabIndex:h},r)},t.defaultProps={offset:0,onClick:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}},t}(o.Component)),se=function(e,t){return t?t.split(" ").concat(e).join(" "):e.join(" ")},le=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ce=function(){return(ce=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ue=["mapboxgl-popup"],de=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}le(t,e),t.prototype.render=function(){var e=this.props,t=e.children,r=e.className,n=ce({},this.props,{children:void 0}),i=se(ue,r);return o.createElement(ae,ce({},n,{type:"popup",className:i}),o.createElement("div",{className:"mapboxgl-popup-tip"}),o.createElement("div",{className:"mapboxgl-popup-content"},t))}}(o.Component),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),he=function(){return(he=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},pe=[.01,.02,.05,.1,.2,.5,1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4],fe={"top-right":{top:10,right:10,bottom:"auto",left:"auto"},"top-left":{top:10,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:10,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:10,left:10,top:"auto",right:"auto"}},me={position:"absolute",zIndex:10,boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)",right:50,backgroundColor:"#fff",opacity:.85,display:"flex",flexDirection:"row",alignItems:"baseline",padding:"3px 7px"},ge={border:"2px solid #7e8490",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",borderTop:"none",height:7,borderBottomLeftRadius:1,borderBottomRightRadius:1},be=Object.keys(fe),ve=["km","mi"],ye=(u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={chosenScale:0,scaleWidth:60},t.setScale=function(){var e=t.props,r=e.measurement,n=e.map,o=n._canvas.clientWidth,i=n.getBounds(),a=i._ne,s=i._sw,l=t._getDistanceTwoPoints([s.lng,a.lat],[a.lng,a.lat],r),c=l/o*60,u=pe.reduce((function(e,t){return!e&&t>c?t:e}),0),d=u/l*o;t.setState({chosenScale:u,scaleWidth:d})},t}return de(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.setScale(),this.props.map.on("zoomend",this.setScale)},t.prototype.componentWillUnmount=function(){this.props.map&&this.props.map.off("zoomend",this.setScale)},t.prototype._getDistanceTwoPoints=function(e,t,r){void 0===r&&(r="km");var n=e[0],o=e[1],i=t[0],a=t[1],s="km"===r?6371:6371/1.60934,l=this._deg2rad(a-o),c=this._deg2rad(i-n),u=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this._deg2rad(o))*Math.cos(this._deg2rad(a))*Math.sin(c/2)*Math.sin(c/2);return s*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))},t.prototype._deg2rad=function(e){return e*(Math.PI/180)},t.prototype._displayMeasurement=function(e,t){return t>=1?t+" "+e:"mi"===e?Math.floor(5280*t)+" ft":Math.floor(1e3*t)+" m"},t.prototype.render=function(){var e=this.props,t=e.measurement,r=e.style,n=e.position,i=e.className,a=e.tabIndex,s=this.state,l=s.chosenScale,c=s.scaleWidth;return o.createElement("div",{tabIndex:a,style:he({},me,fe[n],r),className:i},o.createElement("div",{style:he({},ge,{width:c})}),o.createElement("div",{style:{paddingLeft:10}},this._displayMeasurement(t,l)))},t.defaultProps={measurement:ve[0],position:be[2]},t}(o.Component)),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),_e=function(){return(_e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},we=u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id=t.props.id,t.onStyleDataChange=function(){t.props.map.getLayer(t.id)||(t.initialize(),t.forceUpdate())},t.initialize=function(){var e=t.props.map,r=t.props,n=r.geoJsonSource,o=r.tileJsonSource,i=r.onSourceAdded;e.getSource(t.id)||!n&&!o||(n?e.addSource(t.id,n):o&&e.addSource(t.id,o),e.on("sourcedata",t.onData),i&&i(e.getSource(t.id)))},t.onData=function(){var e=t.props.map,r=e.getSource(t.props.id);if(r&&e.isSourceLoaded(t.props.id)){var n=t.props.onSourceLoaded;r&&n&&n(r),r&&t.props.geoJsonSource&&t.props.geoJsonSource.data&&r.setData(t.props.geoJsonSource.data),e.off("sourcedata",t.onData)}},t}return ye(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.props.map.on("styledata",this.onStyleDataChange),this.initialize()},t.prototype.removeSource=function(){var e=this,t=this.props.map;if(t.getSource(this.id)){var r=t.getStyle().layers,n=void 0===r?[]:r;return(n=n.map((function(e,t){var r=(n[t+1]||{id:void 0}).id;return _e({},e,{before:r})})).filter((function(t){return t.source===e.id}))).forEach((function(e){return t.removeLayer(e.id)})),t.removeSource(this.id),n.reverse()}return[]},t.prototype.componentWillUnmount=function(){var e=this.props.map;e&&e.getStyle()&&(e.off("styledata",this.onStyleDataChange),this.removeSource())},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,r=t.geoJsonSource,n=t.tileJsonSource,o=t.map;if(n&&e.tileJsonSource&&(n.url!==e.tileJsonSource.url||n.tiles!==e.tileJsonSource.tiles||n.minzoom!==e.tileJsonSource.minzoom||n.maxzoom!==e.tileJsonSource.maxzoom)){var i=this.removeSource();o.addSource(this.id,e.tileJsonSource),i.forEach((function(e){return o.addLayer(e,e.before)}))}r&&e.geoJsonSource&&e.geoJsonSource.data!==r.data&&e.geoJsonSource.data&&o.getSource(this.id)&&o.getSource(this.id).setData(e.geoJsonSource.data)},t.prototype.render=function(){return null},t}(o.Component));function xe(e,t,r,n,o,i){if(o-n<=r)return;const a=n+o>>1;!function e(t,r,n,o,i,a){for(;i>o;){if(i-o>600){const s=i-o+1,l=n-o+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1),h=Math.max(o,Math.floor(n-l*u/s+d)),p=Math.min(i,Math.floor(n+(s-l)*u/s+d));e(t,r,n,h,p,a)}const s=r[2*n+a];let l=o,c=i;for(ke(t,r,o,n),r[2*i+a]>s&&ke(t,r,o,i);l<c;){for(ke(t,r,l,c),l++,c--;r[2*l+a]<s;)l++;for(;r[2*c+a]>s;)c--}r[2*o+a]===s?ke(t,r,o,c):(c++,ke(t,r,c,i)),c<=n&&(o=c+1),n<=c&&(i=c-1)}}(e,t,a,n,o,i%2),xe(e,t,r,n,a-1,i+1),xe(e,t,r,a+1,o,i+1)}function ke(e,t,r,n){Ce(e,r,n),Ce(t,2*r,2*n),Ce(t,2*r+1,2*n+1)}function Ce(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Ee(e,t,r,n){const o=e-r,i=t-n;return o*o+i*i}const Se=e=>e[0],Te=e=>e[1];class Ae{constructor(e,t=Se,r=Te,n=64,o=Float64Array){this.nodeSize=n,this.points=e;const i=e.length<65536?Uint16Array:Uint32Array,a=this.ids=new i(e.length),s=this.coords=new o(2*e.length);for(let n=0;n<e.length;n++)a[n]=n,s[2*n]=t(e[n]),s[2*n+1]=r(e[n]);xe(a,s,n,0,a.length-1,0)}range(e,t,r,n){return function(e,t,r,n,o,i,a){const s=[0,e.length-1,0],l=[];let c,u;for(;s.length;){const d=s.pop(),h=s.pop(),p=s.pop();if(h-p<=a){for(let a=p;a<=h;a++)c=t[2*a],u=t[2*a+1],c>=r&&c<=o&&u>=n&&u<=i&&l.push(e[a]);continue}const f=Math.floor((p+h)/2);c=t[2*f],u=t[2*f+1],c>=r&&c<=o&&u>=n&&u<=i&&l.push(e[f]);const m=(d+1)%2;(0===d?r<=c:n<=u)&&(s.push(p),s.push(f-1),s.push(m)),(0===d?o>=c:i>=u)&&(s.push(f+1),s.push(h),s.push(m))}return l}(this.ids,this.coords,e,t,r,n,this.nodeSize)}within(e,t,r){return function(e,t,r,n,o,i){const a=[0,e.length-1,0],s=[],l=o*o;for(;a.length;){const c=a.pop(),u=a.pop(),d=a.pop();if(u-d<=i){for(let o=d;o<=u;o++)Ee(t[2*o],t[2*o+1],r,n)<=l&&s.push(e[o]);continue}const h=Math.floor((d+u)/2),p=t[2*h],f=t[2*h+1];Ee(p,f,r,n)<=l&&s.push(e[h]);const m=(c+1)%2;(0===c?r-o<=p:n-o<=f)&&(a.push(d),a.push(h-1),a.push(m)),(0===c?r+o>=p:n+o>=f)&&(a.push(h+1),a.push(u),a.push(m))}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}}const Pe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e};class Ie{constructor(e){this.options=Ne(Object.create(Pe),e),this.trees=new Array(this.options.maxZoom+1)}load(e){const{log:t,minZoom:r,maxZoom:n,nodeSize:o}=this.options;t&&console.time("total time");const i=`prepare ${e.length} points`;t&&console.time(i),this.points=e;let a=[];for(let t=0;t<e.length;t++)e[t].geometry&&a.push(Me(e[t],t));this.trees[n+1]=new Ae(a,Be,Fe,o,Float32Array),t&&console.timeEnd(i);for(let e=n;e>=r;e--){const r=+Date.now();a=this._cluster(a,e),this.trees[e]=new Ae(a,Be,Fe,o,Float32Array),t&&console.log("z%d: %d clusters in %dms",e,a.length,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let o=180===e[2]?180:((e[2]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,o=180;else if(r>o){const e=this.getClusters([r,n,180,i],t),a=this.getClusters([-180,n,o,i],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(je(r),Re(i),je(o),Re(n)),l=[];for(const e of s){const t=a.points[e];l.push(t.numPoints?De(t):this.points[t.index])}return l}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(n);const i=o.points[t];if(!i)throw new Error(n);const a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=o.within(i.x,i.y,a),l=[];for(const t of s){const r=o.points[t];r.parentId===e&&l.push(r.numPoints?De(r):this.points[r.index])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,r){t=t||10,r=r||0;const n=[];return this._appendLeaves(n,e,t,r,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:i,radius:a}=this.options,s=a/i,l=(r-s)/o,c=(r+1+s)/o,u={features:[]};return this._addTileFeatures(n.range((t-s)/o,l,(t+1+s)/o,c),n.points,t,r,o,u),0===t&&this._addTileFeatures(n.range(1-s/o,l,1,c),n.points,o,r,o,u),t===o-1&&this._addTileFeatures(n.range(0,l,s/o,c),n.points,-1,r,o,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,o){const i=this.getChildren(t);for(const t of i){const i=t.properties;if(i&&i.cluster?o+i.point_count<=n?o+=i.point_count:o=this._appendLeaves(e,i.cluster_id,r,n,o):o<n?o++:e.push(t),e.length===r)break}return o}_addTileFeatures(e,t,r,n,o,i){for(const a of e){const e=t[a],s=e.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(e.x*o-r)),Math.round(this.options.extent*(e.y*o-n))]],tags:s?ze(e):this.points[e.index].properties};let c;s?c=e.id:this.options.generateId?c=e.index:this.points[e.index].id&&(c=this.points[e.index].id),void 0!==c&&(l.id=c),i.features.push(l)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))}_cluster(e,t){const r=[],{radius:n,extent:o,reduce:i,minPoints:a}=this.options,s=n/(o*Math.pow(2,t));for(let n=0;n<e.length;n++){const o=e[n];if(o.zoom<=t)continue;o.zoom=t;const l=this.trees[t+1],c=l.within(o.x,o.y,s),u=o.numPoints||1;let d=u;for(const e of c){const r=l.points[e];r.zoom>t&&(d+=r.numPoints||1)}if(d>=a){let e=o.x*u,a=o.y*u,s=i&&u>1?this._map(o,!0):null;const h=(n<<5)+(t+1)+this.points.length;for(const r of c){const n=l.points[r];if(n.zoom<=t)continue;n.zoom=t;const c=n.numPoints||1;e+=n.x*c,a+=n.y*c,n.parentId=h,i&&(s||(s=this._map(o,!0)),i(s,this._map(n)))}o.parentId=h,r.push(Oe(e/d,a/d,h,d,s))}else if(r.push(o),d>1)for(const e of c){const n=l.points[e];n.zoom<=t||(n.zoom=t,r.push(n))}}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?Ne({},e.properties):e.properties;const r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?Ne({},n):n}}function Oe(e,t,r,n,o){return{x:e,y:t,zoom:1/0,id:r,parentId:-1,numPoints:n,properties:o}}function Me(e,t){const[r,n]=e.geometry.coordinates;return{x:je(r),y:Re(n),zoom:1/0,index:t,parentId:-1}}function De(e){return{type:"Feature",id:e.id,properties:ze(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),Le(e.y)]}};var t}function ze(e){const t=e.numPoints,r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return Ne(Ne({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function je(e){return e/360+.5}function Re(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Le(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function Ne(e,t){for(const r in t)e[r]=t[r];return e}function Be(e){return e.x}function Fe(e){return e.y}var Ve=r(56),Ue=r.n(Ve),qe=r(57),He=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),We=(u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={superC:new Ie({radius:t.props.radius,maxZoom:t.props.maxZoom,minZoom:t.props.minZoom,extent:t.props.extent,nodeSize:t.props.nodeSize,log:t.props.log}),clusterPoints:[]},t.featureClusterMap=new WeakMap,t.childrenChange=function(e){var r=t.state.superC;t.featureClusterMap=new WeakMap;var n=t.childrenToFeatures(e);r.load(n)},t.mapChange=function(e){void 0===e&&(e=!1);var r=t.props.map,n=t.state,o=n.superC,i=n.clusterPoints,a=r.getZoom(),s=r.getCanvas(),l=s.width,c=s.height,u=r.unproject([0,0]).toArray(),d=r.unproject([l,0]).toArray(),h=r.unproject([l,c]).toArray(),p=r.unproject([0,c]).toArray(),f=o.getClusters(Ue()(Object(qe.polygon)([[u,d,h,p,u]])),Math.round(a));(f.length!==i.length||e)&&t.setState({clusterPoints:f})},t.childrenToFeatures=function(e){return e.map((function(e){var r=t.feature(e&&e.props.coordinates);return t.featureClusterMap.set(r,e),r}))},t.getLeaves=function(e,r,n){return t.state.superC.getLeaves(e.properties&&e.properties.cluster_id,r||1/0,n).map((function(e){return t.featureClusterMap.get(e)}))},t.zoomToClusterBounds=function(e){var r=Array.prototype.slice.call(e.currentTarget.children),o=t.findMarkerElement(e.currentTarget,e.target),i=r.indexOf(o),a=t.state.clusterPoints[i];if(a.properties&&a.properties.cluster_id){var s=t.state.superC.getLeaves(a.properties&&a.properties.cluster_id,1/0),l=Ue()(Object(qe.featureCollection)(s));t.props.map.fitBounds(n.LngLatBounds.convert(l),{padding:t.props.zoomOnClickPadding})}},t}return He(t,e),t.prototype.UNSAFE_componentWillMount=function(){var e=this.props,t=e.children,r=e.map;t&&this.childrenChange(t),r.on("move",this.mapChange),r.on("zoom",this.mapChange),this.mapChange()},t.prototype.componentWillUnmount=function(){var e=this.props.map;e.off("move",this.mapChange),e.off("zoom",this.mapChange)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.children!==e.children&&e.children&&(this.childrenChange(e.children),this.mapChange(!0))},t.prototype.feature=function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{}}},t.prototype.findMarkerElement=function(e,t){return t.parentElement===e?t:this.findMarkerElement(e,t.parentElement)},t.prototype.render=function(){var e=this,t=this.props,r=t.ClusterMarkerFactory,n=t.style,i=t.className,a=t.tabIndex,s=this.state.clusterPoints;return o.createElement("div",{style:n,className:i,tabIndex:a,onClick:this.props.zoomOnClick?this.zoomToClusterBounds:void 0},s.map((function(t){return t.properties&&t.properties.cluster?r(t.geometry.coordinates,t.properties.point_count,e.getLeaves.bind(e,t)):e.featureClusterMap.get(t)})))},t.defaultProps={radius:60,minZoom:0,maxZoom:16,extent:512,nodeSize:64,log:!1,zoomOnClick:!1,zoomOnClickPadding:20},t}(o.Component)),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),Ge=function(){return(Ge=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ze={position:"absolute",zIndex:10,display:"flex",flexDirection:"column",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)"},Ye={"top-right":{top:62,right:10,bottom:"auto",left:"auto"},"top-left":{top:62,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:63,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:63,left:10,top:"auto",right:"auto"}},$e={backgroundColor:"#f9f9f9",opacity:.95,transition:"background-color 0.16s ease-out",cursor:"pointer",border:0,height:26,width:26,outline:0,padding:3},Ke={backgroundColor:"#fff",opacity:1},Xe={borderBottom:"1px solid rgba(0, 0, 0, 0.1)",borderTopLeftRadius:2,borderTopRightRadius:2,borderBottomLeftRadius:2,borderBottomRightRadius:2},Je=function(){return o.createElement("svg",{viewBox:"0 0 20 20"},o.createElement("polygon",{fill:"#333333",points:"6,9 10,1 14,9"}),o.createElement("polygon",{fill:"#CCCCCC",points:"6,11 10,19 14,11"}))},Qe={width:20,height:20,display:"inline-block"},et=Object.keys(Ye),tt=(u(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hover:void 0},t.compassIcon=null,t.onMouseOut=function(){t.state.hover||t.setState({hover:void 0})},t.onMouseIn=function(){0!==t.state.hover&&t.setState({hover:0})},t.onClickCompass=function(){t.props.map.resetNorth()},t.onMapRotate=function(){var e="rotate("+t.props.map.transform.angle*(180/Math.PI)+"deg)";t.compassIcon&&(t.compassIcon.style.transform=e)},t.assignRef=function(e){t.compassIcon=e},t}return We(t,e),t.prototype.componentDidMount=function(){this.props.map.on("rotate",this.onMapRotate)},t.prototype.componentWillUnmount=function(){this.props.map.off("rotate",this.onMapRotate)},t.prototype.render=function(){var e=this.props,t=e.position,r=e.style,n=e.className,i=e.tabIndex,a=this.state.hover,s=Ge({},$e,Xe,0===a?Ke:{});return o.createElement("div",{className:n,tabIndex:i,style:Ge({},Ze,Ye[t],r)},o.createElement("button",{style:s,onMouseOver:this.onMouseIn,onMouseOut:this.onMouseOut,onClick:this.onClickCompass},o.createElement("span",{ref:this.assignRef,style:Qe},o.createElement(Je,null))))},t.defaultProps={position:et[0]},t}(o.Component)),function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),rt=(u(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tt(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.loadImage(this.props)},t.prototype.componentWillUnmount=function(){t.removeImage(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var r=this.props.id;e.map!==this.props.map&&t.removeImage(this.props),e.map&&!e.map.hasImage(r)&&this.loadImage(e)},t.prototype.render=function(){return null},t.prototype.loadImage=function(e){var t=this,r=e.map,n=e.id,o=e.url,i=e.data,a=e.options,s=e.onError;i?(r.addImage(n,i,a),this.loaded()):o&&r.loadImage(o,(function(e,o){e?s&&s(e):(r.addImage(n,o,a),t.loaded())}))},t.removeImage=function(e){var t=e.id,r=e.map;r&&r.getStyle()&&r.removeImage(t)},t.prototype.loaded=function(){var e=this.props.onLoaded;e&&e()},t}(o.Component)),u(P(C)));t.c=v},,function(e,t,r){var n=r(69);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},,function(e,t,r){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),a=[];function s(e){for(var t=-1,r=0;r<a.length;r++)if(a[r].identifier===e){t=r;break}return t}function l(e,t){for(var r={},n=[],o=0;o<e.length;o++){var i=e[o],l=t.base?i[0]+t.base:i[0],c=r[l]||0,u="".concat(l," ").concat(c);r[l]=c+1;var d=s(u),h={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(a[d].references++,a[d].updater(h)):a.push({identifier:u,updater:g(h,t),references:1}),n.push(u)}return n}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var o=r.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,d=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function h(e,t,r,n){var o=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=d(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function p(e,t,r){var n=r.css,o=r.media,i=r.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var f=null,m=0;function g(e,t){var r,n,o;if(t.singleton){var i=m++;r=f||(f=c(t)),n=h.bind(null,r,i,!1),o=h.bind(null,r,i,!0)}else r=c(t),n=p.bind(null,r,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var r=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var o=s(r[n]);a[o].references--}for(var i=l(e,t),c=0;c<r.length;c++){var u=s(r[c]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}r=i}}}},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var o=(a=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[r].concat(i).concat([o]).join("\n")}var a,s,l;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&o[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t){function r(){return e.exports=r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(76).default,o=r(7);e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports.default=e.exports},,,function(e,t){e.exports=window.ReactDOM},function(e,t,r){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)&&n.length){var a=o.apply(null,n);a&&e.push(a)}else if("object"===i)for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(4),o=r(6),i=r(3);function a(e,t){Object(i.a)(1,arguments);var r=t||{},a=r.locale,s=a&&a.options&&a.options.weekStartsOn,l=null==s?0:Object(o.a)(s),c=null==r.weekStartsOn?l:Object(o.a)(r.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=Object(n.default)(e),d=u.getDay(),h=(d<c?7:0)+d-c;return u.setDate(u.getDate()-h),u.setHours(0,0,0,0),u}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(1,arguments);var r=t||{},a=r.locale,s=a&&a.options&&a.options.weekStartsOn,l=null==s?0:Object(n.a)(s),c=null==r.weekStartsOn?l:Object(n.a)(r.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=Object(o.default)(e),d=u.getUTCDay(),h=(d<c?7:0)+d-c;return u.setUTCDate(u.getUTCDate()-h),u.setUTCHours(0,0,0,0),u}},,function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";function n(e,t){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)}r.d(t,"a",(function(){return o}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r(8),o=r.n(n),i=r(2);r(0);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){var t=Object.fromEntries((e||[]).map((function(e){return[e.id,e]})));return function(e){return s(s({},e),{},{layer:t[e.id]})}},c={fixed:Object(i.__)("Fixed","jeo"),swappable:Object(i.__)("Swappable","jeo"),switchable:Object(i.__)("Switchable","jeo")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));function n(e){return e.getTime()%6e4}function o(e){var t=new Date(e.getTime()),r=Math.ceil(t.getTimezoneOffset());return t.setSeconds(0,0),6e4*r+(r>0?(6e4+n(t))%6e4:n(t))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=1,r=Object(n.default)(e),i=r.getUTCDay(),a=(i<t?7:0)+i-t;return r.setUTCDate(r.getUTCDate()-a),r.setUTCHours(0,0,0,0),r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s}));var n=["D","DD"],o=["YY","YYYY"];function i(e){return-1!==n.indexOf(e)}function a(e){return-1!==o.indexOf(e)}function s(e,t,r){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"))}},function(e,t,r){var n=r(33);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=window.lodash},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(18),o=window.jeo_settings.mapbox_key;t.b=Object(n.c)({accessToken:o})},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}r.d(t,"a",(function(){return n}))},,function(e,t,r){"use strict";e.exports=r(91)},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s}));var n=r(0),o=r(18),i=r(41);function a(e){var t=e.layer,r=e.instance,i=e.onSourceLoadedCallback;if(["swappable","switchable"].includes(r.use)&&!r.default)return null;var a=t.layer_type_options,s="layer_".concat(r.id),l="source_".concat(r.id);switch(t.type){case"mapbox":var c=a.access_token||window.mapboxgl.accessToken,u=a.style_id;return u&&(u=u.replace("mapbox://styles/","")),Object(n.createElement)(n.Fragment,null,Object(n.createElement)(o.b,{id:l,tileJsonSource:{type:"raster",tiles:["https://api.mapbox.com/styles/v1/".concat(u,"/tiles/512/{z}/{x}/{y}@2x?access_token=").concat(c)]},onSourceLoaded:function(){i&&i()}}),Object(n.createElement)(o.a,{id:s,type:"raster",sourceId:l}));case"mapbox-tileset-vector":case"mapbox-tileset-raster":var d=a.tileset_id;return d&&!d.includes("mapbox://")&&(d="mapbox://"+d),Object(n.createElement)(n.Fragment,null,Object(n.createElement)(o.b,{id:l,tileJsonSource:{type:a.style_source_type,url:"mapbox://".concat(a.tileset_id)},onSourceLoaded:function(){i&&i()}}),Object(n.createElement)(o.a,{id:s,type:a.type,sourceId:l,sourceLayer:a.source_layer}));case"mvt":return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(o.b,{id:l,tileJsonSource:{type:a.style_source_type,tiles:[a.url]},onSourceLoaded:function(){i&&i()}}),Object(n.createElement)(o.a,{id:s,type:a.type,source:l,sourceLayer:a.source_layer}));case"tilelayer":return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(o.b,{id:l,tileJsonSource:{type:"raster",tiles:[a.url],tileSize:256,scheme:a.scheme||"xyz"},onSourceLoaded:function(){i&&i()}}),Object(n.createElement)(o.a,{id:s,type:"raster",sourceId:l}));default:return null}}var s=Object(n.memo)(a,(function(e,t){return Object(i.isEqual)(e.layer.layer_type_options,t.layer.layer_type_options)}))},function(e,t){e.exports=window.wp.compose},,function(e,t,r){var n=Array.prototype.slice,o=r(114),i=r(115),a=e.exports=function(e,t,r){return r||(r={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?r.strict?e===t:e==t:function(e,t,r){var c,u;if(s(e)||s(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e))return!!i(t)&&(e=n.call(e),t=n.call(t),a(e,t,r));if(l(e)){if(!l(t))return!1;if(e.length!==t.length)return!1;for(c=0;c<e.length;c++)if(e[c]!==t[c])return!1;return!0}try{var d=o(e),h=o(t)}catch(e){return!1}if(d.length!=h.length)return!1;for(d.sort(),h.sort(),c=d.length-1;c>=0;c--)if(d[c]!=h[c])return!1;for(c=d.length-1;c>=0;c--)if(u=d[c],!a(e[u],t[u],r))return!1;return typeof e==typeof t}(e,t,r))};function s(e){return null==e}function l(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},,,,function(e,t,r){var n=r(118).coordEach;e.exports=function(e){var t=[1/0,1/0,-1/0,-1/0];return n(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}},function(e,t){function r(e,t,r,n){if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");if(r&&4!==r.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var o={type:"Feature"};return n&&(o.id=n),r&&(o.bbox=r),o.properties=t||{},o.geometry=e,o}function n(e,t,n,o){if(!e)throw new Error("No coordinates passed");if(void 0===e.length)throw new Error("Coordinates must be an array");if(e.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!f(e[0])||!f(e[1]))throw new Error("Coordinates must contain numbers");return r({type:"Point",coordinates:e},t,n,o)}function o(e,t,n,o){if(!e)throw new Error("No coordinates passed");for(var i=0;i<e.length;i++){var a=e[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++){if(0===i&&0===s&&!f(a[0][0])||!f(a[0][1]))throw new Error("Coordinates must contain numbers");if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}}return r({type:"Polygon",coordinates:e},t,n,o)}function i(e,t,n,o){if(!e)throw new Error("No coordinates passed");if(e.length<2)throw new Error("Coordinates must be an array of two or more positions");if(!f(e[0][1])||!f(e[0][1]))throw new Error("Coordinates must contain numbers");return r({type:"LineString",coordinates:e},t,n,o)}function a(e,t,n,o){if(!e)throw new Error("No coordinates passed");return r({type:"MultiLineString",coordinates:e},t,n,o)}function s(e,t,n,o){if(!e)throw new Error("No coordinates passed");return r({type:"MultiPoint",coordinates:e},t,n,o)}function l(e,t,n,o){if(!e)throw new Error("No coordinates passed");return r({type:"MultiPolygon",coordinates:e},t,n,o)}var c={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65},u={kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,centimetres:1e4,millimeter:1e6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function d(e,t){if(null==e)throw new Error("radians is required");var r=c[t||"kilometers"];if(!r)throw new Error("units is invalid");return e*r}function h(e,t){if(null==e)throw new Error("distance is required");var r=c[t||"kilometers"];if(!r)throw new Error("units is invalid");return e/r}function p(e){if(null==e)throw new Error("radians is required");return 180*(e%(2*Math.PI))/Math.PI}function f(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}e.exports={feature:r,geometry:function(e,t,r){if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(r&&4!==r.length)throw new Error("bbox must be an Array of 4 numbers");var c;switch(e){case"Point":c=n(t).geometry;break;case"LineString":c=i(t).geometry;break;case"Polygon":c=o(t).geometry;break;case"MultiPoint":c=s(t).geometry;break;case"MultiLineString":c=a(t).geometry;break;case"MultiPolygon":c=l(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(c.bbox=r),c},featureCollection:function(e,t,r){if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");if(t&&4!==t.length)throw new Error("bbox must be an Array of 4 numbers");if(r&&-1===["string","number"].indexOf(typeof r))throw new Error("id must be a number or a string");var n={type:"FeatureCollection"};return r&&(n.id=r),t&&(n.bbox=t),n.features=e,n},geometryCollection:function(e,t,n,o){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return r({type:"GeometryCollection",geometries:e},t,n,o)},point:n,multiPoint:s,lineString:i,multiLineString:a,polygon:o,multiPolygon:l,radiansToDistance:d,distanceToRadians:h,distanceToDegrees:function(e,t){return p(h(e,t))},radians2degrees:p,degrees2radians:function(e){if(null==e)throw new Error("degrees is required");return e%360*Math.PI/180},bearingToAngle:function(e){if(null==e)throw new Error("bearing is required");var t=e%360;return t<0&&(t+=360),t},convertDistance:function(e,t,r){if(null==e)throw new Error("distance is required");if(!(e>=0))throw new Error("distance must be a positive number");return d(h(e,t),r||"kilometers")},convertArea:function(e,t,r){if(null==e)throw new Error("area is required");if(!(e>=0))throw new Error("area must be a positive number");var n=u[t||"meters"];if(!n)throw new Error("invalid original units");var o=u[r||"kilometers"];if(!o)throw new Error("invalid final units");return e/n*o},round:function(e,t){if(null==e||isNaN(e))throw new Error("num is required");if(t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},isNumber:f}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e);return t.setHours(0,0,0,0),t}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return Eo})),r.d(t,"b",(function(){return ai})),r.d(t,"c",(function(){return ui}));var n=r(1),o=r.n(n),i=r(34),a=r(9),s=r(136),l=function(){return Math.random().toString(36).substring(7).split("").join(".")},c={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function u(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(d)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,i=t,a=[],l=a,h=!1;function p(){l===a&&(l=a.slice())}function f(){if(h)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function m(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(h)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return p(),l.push(e),function(){if(t){if(h)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,p();var r=l.indexOf(e);l.splice(r,1),a=null}}}function g(e){if(!u(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,i=o(i,e)}finally{h=!1}for(var t=a=l,r=0;r<t.length;r++){(0,t[r])()}return e}function b(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,g({type:c.REPLACE})}function v(){var e,t=m;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(f())}return r(),{unsubscribe:t(r)}}})[s.a]=function(){return this},e}return g({type:c.INIT}),(n={dispatch:g,subscribe:m,getState:f,replaceReducer:b})[s.a]=v,n}function h(e,t){return function(){return t(e.apply(this,arguments))}}function p(e,t){if("function"==typeof e)return h(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=h(o,t))}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}r(17);var v=o.a.createContext(null);var y=function(e){e()},_={notify:function(){}};function w(){var e=y,t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],r=t;r;)e.push(r),r=r.next;return e},subscribe:function(e){var n=!0,o=r={callback:e,next:null,prev:r};return o.prev?o.prev.next=o:t=o,function(){n&&null!==t&&(n=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var x=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=_,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=w())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=_)},e}(),k="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect;var C=function(e){var t=e.store,r=e.context,i=e.children,a=Object(n.useMemo)((function(){var e=new x(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),s=Object(n.useMemo)((function(){return t.getState()}),[t]);k((function(){var e=a.subscription;return e.trySubscribe(),s!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[a,s]);var l=r||v;return o.a.createElement(l.Provider,{value:a},i)},E=r(45),S=r(61),T=r.n(S),A=r(47),P=[],I=[null,null];function O(e,t){var r=e[1];return[t.payload,r+1]}function M(e,t,r){k((function(){return e.apply(void 0,t)}),r)}function D(e,t,r,n,o,i,a){e.current=n,t.current=o,r.current=!1,i.current&&(i.current=null,a())}function z(e,t,r,n,o,i,a,s,l,c){if(e){var u=!1,d=null,h=function(){if(!u){var e,r,h=t.getState();try{e=n(h,o.current)}catch(e){r=e,d=e}r||(d=null),e===i.current?a.current||l():(i.current=e,s.current=e,a.current=!0,c({type:"STORE_UPDATED",payload:{error:r}}))}};r.onStateChange=h,r.trySubscribe(),h();return function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,d)throw d}}}var j=function(){return[null,0]};function R(e,t){void 0===t&&(t={});var r=t,i=r.getDisplayName,s=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,l=r.methodName,c=void 0===l?"connectAdvanced":l,u=r.renderCountProp,d=void 0===u?void 0:u,h=r.shouldHandleStateChanges,p=void 0===h||h,f=r.storeKey,m=void 0===f?"store":f,g=(r.withRef,r.forwardRef),b=void 0!==g&&g,y=r.context,_=void 0===y?v:y,w=Object(E.a)(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),k=_;return function(t){var r=t.displayName||t.name||"Component",i=s(r),l=Object(a.a)({},w,{getDisplayName:s,methodName:c,renderCountProp:d,shouldHandleStateChanges:p,storeKey:m,displayName:i,wrappedComponentName:r,WrappedComponent:t}),u=w.pure;var h=u?n.useMemo:function(e){return e()};function f(r){var i=Object(n.useMemo)((function(){var e=r.reactReduxForwardedRef,t=Object(E.a)(r,["reactReduxForwardedRef"]);return[r.context,e,t]}),[r]),s=i[0],c=i[1],u=i[2],d=Object(n.useMemo)((function(){return s&&s.Consumer&&Object(A.isContextConsumer)(o.a.createElement(s.Consumer,null))?s:k}),[s,k]),f=Object(n.useContext)(d),m=Boolean(r.store)&&Boolean(r.store.getState)&&Boolean(r.store.dispatch);Boolean(f)&&Boolean(f.store);var g=m?r.store:f.store,b=Object(n.useMemo)((function(){return function(t){return e(t.dispatch,l)}(g)}),[g]),v=Object(n.useMemo)((function(){if(!p)return I;var e=new x(g,m?null:f.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[g,m,f]),y=v[0],_=v[1],w=Object(n.useMemo)((function(){return m?f:Object(a.a)({},f,{subscription:y})}),[m,f,y]),C=Object(n.useReducer)(O,P,j),S=C[0][0],T=C[1];if(S&&S.error)throw S.error;var R=Object(n.useRef)(),L=Object(n.useRef)(u),N=Object(n.useRef)(),B=Object(n.useRef)(!1),F=h((function(){return N.current&&u===L.current?N.current:b(g.getState(),u)}),[g,S,u]);M(D,[L,R,B,u,F,N,_]),M(z,[p,g,y,b,L,R,B,N,_,T],[g,y,b]);var V=Object(n.useMemo)((function(){return o.a.createElement(t,Object(a.a)({},F,{ref:c}))}),[c,t,F]);return Object(n.useMemo)((function(){return p?o.a.createElement(d.Provider,{value:w},V):V}),[d,V,w])}var g=u?o.a.memo(f):f;if(g.WrappedComponent=t,g.displayName=i,b){var v=o.a.forwardRef((function(e,t){return o.a.createElement(g,Object(a.a)({},e,{reactReduxForwardedRef:t}))}));return v.displayName=i,v.WrappedComponent=t,T()(v,t)}return T()(g,t)}}function L(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function N(e,t){if(L(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!Object.prototype.hasOwnProperty.call(t,r[o])||!L(e[r[o]],t[r[o]]))return!1;return!0}function B(e){return function(t,r){var n=e(t,r);function o(){return n}return o.dependsOnOwnProps=!1,o}}function F(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function V(e,t){return function(t,r){r.displayName;var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,r){n.mapToProps=e,n.dependsOnOwnProps=F(e);var o=n(t,r);return"function"==typeof o&&(n.mapToProps=o,n.dependsOnOwnProps=F(o),o=n(t,r)),o},n}}var U=[function(e){return"function"==typeof e?V(e):void 0},function(e){return e?void 0:B((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?B((function(t){return p(e,t)})):void 0}];var q=[function(e){return"function"==typeof e?V(e):void 0},function(e){return e?void 0:B((function(){return{}}))}];function H(e,t,r){return Object(a.a)({},r,e,t)}var W=[function(e){return"function"==typeof e?function(e){return function(t,r){r.displayName;var n,o=r.pure,i=r.areMergedPropsEqual,a=!1;return function(t,r,s){var l=e(t,r,s);return a?o&&i(l,n)||(n=l):(a=!0,n=l),n}}}(e):void 0},function(e){return e?void 0:function(){return H}}];function G(e,t,r,n){return function(o,i){return r(e(o,i),t(n,i),i)}}function Z(e,t,r,n,o){var i,a,s,l,c,u=o.areStatesEqual,d=o.areOwnPropsEqual,h=o.areStatePropsEqual,p=!1;function f(o,p){var f,m,g=!d(p,a),b=!u(o,i);return i=o,a=p,g&&b?(s=e(i,a),t.dependsOnOwnProps&&(l=t(n,a)),c=r(s,l,a)):g?(e.dependsOnOwnProps&&(s=e(i,a)),t.dependsOnOwnProps&&(l=t(n,a)),c=r(s,l,a)):b?(f=e(i,a),m=!h(f,s),s=f,m&&(c=r(s,l,a)),c):c}return function(o,u){return p?f(o,u):(s=e(i=o,a=u),l=t(n,a),c=r(s,l,a),p=!0,c)}}function Y(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,i=Object(E.a)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=r(e,i),s=n(e,i),l=o(e,i);return(i.pure?Z:G)(a,s,l,e,i)}function $(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(t,n){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function K(e,t){return e===t}function X(e){var t=void 0===e?{}:e,r=t.connectHOC,n=void 0===r?R:r,o=t.mapStateToPropsFactories,i=void 0===o?q:o,s=t.mapDispatchToPropsFactories,l=void 0===s?U:s,c=t.mergePropsFactories,u=void 0===c?W:c,d=t.selectorFactory,h=void 0===d?Y:d;return function(e,t,r,o){void 0===o&&(o={});var s=o,c=s.pure,d=void 0===c||c,p=s.areStatesEqual,f=void 0===p?K:p,m=s.areOwnPropsEqual,g=void 0===m?N:m,b=s.areStatePropsEqual,v=void 0===b?N:b,y=s.areMergedPropsEqual,_=void 0===y?N:y,w=Object(E.a)(s,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),x=$(e,i,"mapStateToProps"),k=$(t,l,"mapDispatchToProps"),C=$(r,u,"mergeProps");return n(h,Object(a.a)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:x,initMapDispatchToProps:k,initMergeProps:C,pure:d,areStatesEqual:f,areOwnPropsEqual:g,areStatePropsEqual:v,areMergedPropsEqual:_},w))}}var J=X();var Q,ee=r(28),te=r.n(ee);function re(e,t){var r=Object(n.useState)((function(){return{inputs:t,result:e()}}))[0],o=Object(n.useRef)(r),i=Boolean(t&&o.current.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,o.current.inputs))?o.current:{inputs:t,result:e()};return Object(n.useEffect)((function(){o.current=i}),[i]),i.result}Q=ee.unstable_batchedUpdates,y=Q;var ne=re,oe=function(e,t){return re((function(){return e}),t)};var ie=function(e,t){if(!e)throw new Error("Invariant failed")},ae=function(e){var t=e.top,r=e.right,n=e.bottom,o=e.left;return{top:t,right:r,bottom:n,left:o,width:r-o,height:n-t,x:o,y:t,center:{x:(r+o)/2,y:(n+t)/2}}},se=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},le=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},ce={top:0,right:0,bottom:0,left:0},ue=function(e){var t=e.borderBox,r=e.margin,n=void 0===r?ce:r,o=e.border,i=void 0===o?ce:o,a=e.padding,s=void 0===a?ce:a,l=ae(se(t,n)),c=ae(le(t,i)),u=ae(le(c,s));return{marginBox:l,borderBox:ae(t),paddingBox:c,contentBox:u,margin:n,border:i,padding:s}},de=function(e){var t=e.slice(0,-2);if("px"!==e.slice(-2))return 0;var r=Number(t);return isNaN(r)&&ie(!1),r},he=function(e,t){var r,n,o=e.borderBox,i=e.border,a=e.margin,s=e.padding,l=(n=t,{top:(r=o).top+n.y,left:r.left+n.x,bottom:r.bottom+n.y,right:r.right+n.x});return ue({borderBox:l,border:i,margin:a,padding:s})},pe=function(e,t){return void 0===t&&(t={x:window.pageXOffset,y:window.pageYOffset}),he(e,t)},fe=function(e,t){var r={top:de(t.marginTop),right:de(t.marginRight),bottom:de(t.marginBottom),left:de(t.marginLeft)},n={top:de(t.paddingTop),right:de(t.paddingRight),bottom:de(t.paddingBottom),left:de(t.paddingLeft)},o={top:de(t.borderTopWidth),right:de(t.borderRightWidth),bottom:de(t.borderBottomWidth),left:de(t.borderLeftWidth)};return ue({borderBox:e,margin:r,padding:n,border:o})},me=function(e){var t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return fe(t,r)};function ge(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var be=function(e,t){var r;void 0===t&&(t=ge);var n,o=[],i=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return i&&r===this&&t(a,o)||(n=e.apply(this,a),i=!0,r=this,o=a),n}},ve=function(e){var t=[],r=null,n=function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];t=o,r||(r=requestAnimationFrame((function(){r=null,e.apply(void 0,t)})))};return n.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},n};function ye(e,t){}ye.bind(null,"warn"),ye.bind(null,"error");function _e(){}function we(e,t,r){var n=t.map((function(t){var n,o,i=(n=r,o=t.options,Object(a.a)({},n,{},o));return e.addEventListener(t.eventName,t.fn,i),function(){e.removeEventListener(t.eventName,t.fn,i)}}));return function(){n.forEach((function(e){e()}))}}function xe(e){this.message=e}function ke(e,t){if(!e)throw new xe("Invariant failed")}xe.prototype.toString=function(){return this.message};var Ce=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).callbacks=null,t.unbind=_e,t.onWindowError=function(e){var r=t.getCallbacks();r.isDragging()&&r.tryAbort(),e.error instanceof xe&&e.preventDefault()},t.getCallbacks=function(){if(!t.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return t.callbacks},t.setCallbacks=function(e){t.callbacks=e},t}Object(i.a)(t,e);var r=t.prototype;return r.componentDidMount=function(){this.unbind=we(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(e){if(!(e instanceof xe))throw e;this.setState({})},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(o.a.Component),Ee=function(e){return e+1},Se=function(e,t){var r=e.droppableId===t.droppableId,n=Ee(e.index),o=Ee(t.index);return r?"\n      You have moved the item from position "+n+"\n      to position "+o+"\n    ":"\n    You have moved the item from position "+n+"\n    in list "+e.droppableId+"\n    to list "+t.droppableId+"\n    in position "+o+"\n  "},Te=function(e,t,r){return t.droppableId===r.droppableId?"\n      The item "+e+"\n      has been combined with "+r.draggableId:"\n      The item "+e+"\n      in list "+t.droppableId+"\n      has been combined with "+r.draggableId+"\n      in list "+r.droppableId+"\n    "},Ae=function(e){return"\n  The item has returned to its starting position\n  of "+Ee(e.index)+"\n"},Pe="\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n",Ie=function(e){return"\n  You have lifted an item in position "+Ee(e.source.index)+"\n"},Oe=function(e){var t=e.destination;if(t)return Se(e.source,t);var r=e.combine;return r?Te(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},Me=function(e){if("CANCEL"===e.reason)return"\n      Movement cancelled.\n      "+Ae(e.source)+"\n    ";var t=e.destination,r=e.combine;return t?"\n      You have dropped the item.\n      "+Se(e.source,t)+"\n    ":r?"\n      You have dropped the item.\n      "+Te(e.draggableId,e.source,r)+"\n    ":"\n    The item has been dropped while not over a drop area.\n    "+Ae(e.source)+"\n  "},De={x:0,y:0},ze=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},je=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},Re=function(e,t){return e.x===t.x&&e.y===t.y},Le=function(e){return{x:0!==e.x?-e.x:0,y:0!==e.y?-e.y:0}},Ne=function(e,t,r){var n;return void 0===r&&(r=0),(n={})[e]=t,n["x"===e?"y":"x"]=r,n},Be=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},Fe=function(e,t){return Math.min.apply(Math,t.map((function(t){return Be(e,t)})))},Ve=function(e){return function(t){return{x:e(t.x),y:e(t.y)}}},Ue=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}},qe=function(e){return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]},He=function(e,t){return t&&t.shouldClipSubject?function(e,t){var r=ae({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r}(t.pageMarginBox,e):ae(e)},We=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,o=e.frame,i=function(e,t,r){var n;return r&&r.increasedBy?Object(a.a)({},e,((n={})[t.end]=e[t.end]+r.increasedBy[t.line],n)):e}(function(e,t){return t?Ue(e,t.scroll.diff.displacement):e}(t.marginBox,o),n,r);return{page:t,withPlaceholder:r,active:He(i,o)}},Ge=function(e,t){e.frame||ke(!1);var r=e.frame,n=je(t,r.scroll.initial),o=Le(n),i=Object(a.a)({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:o},max:r.scroll.max}}),s=We({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i});return Object(a.a)({},e,{frame:i,subject:s})};function Ze(e){return Object.values?Object.values(e):Object.keys(e).map((function(t){return e[t]}))}function Ye(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function $e(e,t){if(e.find)return e.find(t);var r=Ye(e,t);return-1!==r?e[r]:void 0}function Ke(e){return Array.prototype.slice.call(e)}var Xe=be((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),Je=be((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),Qe=be((function(e){return Ze(e)})),et=be((function(e){return Ze(e)})),tt=be((function(e,t){return et(t).filter((function(t){return e===t.descriptor.droppableId})).sort((function(e,t){return e.descriptor.index-t.descriptor.index}))}));function rt(e){return e.at&&"REORDER"===e.at.type?e.at.destination:null}function nt(e){return e.at&&"COMBINE"===e.at.type?e.at.combine:null}var ot=be((function(e,t){return t.filter((function(t){return t.descriptor.id!==e.descriptor.id}))})),it=function(e,t){return e.descriptor.droppableId===t.descriptor.id},at={point:De,value:0},st={invisible:{},visible:{},all:[]},lt={displaced:st,displacedBy:at,at:null},ct=function(e,t){return function(r){return e<=r&&r<=t}},ut=function(e){var t=ct(e.top,e.bottom),r=ct(e.left,e.right);return function(n){if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;var o=t(n.top)||t(n.bottom),i=r(n.left)||r(n.right);if(o&&i)return!0;var a=n.top<e.top&&n.bottom>e.bottom,s=n.left<e.left&&n.right>e.right;return!(!a||!s)||(a&&i||s&&o)}},dt=function(e){var t=ct(e.top,e.bottom),r=ct(e.left,e.right);return function(e){return t(e.top)&&t(e.bottom)&&r(e.left)&&r(e.right)}},ht={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},pt={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},ft=function(e){var t=e.target,r=e.destination,n=e.viewport,o=e.withDroppableDisplacement,i=e.isVisibleThroughFrameFn,a=o?function(e,t){var r=t.frame?t.frame.scroll.diff.displacement:De;return Ue(e,r)}(t,r):t;return function(e,t,r){return!!t.subject.active&&r(t.subject.active)(e)}(a,r,i)&&function(e,t,r){return r(t)(e)}(a,n,i)},mt=function(e){return ft(Object(a.a)({},e,{isVisibleThroughFrameFn:ut}))},gt=function(e){return ft(Object(a.a)({},e,{isVisibleThroughFrameFn:dt}))};function bt(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,o=e.viewport,i=e.forceShouldAnimate,a=e.last;return t.reduce((function(e,t){var s=function(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return ae(se(r,n))}(t,n),l=t.descriptor.id;if(e.all.push(l),!mt({target:s,destination:r,viewport:o,withDroppableDisplacement:!0}))return e.invisible[t.descriptor.id]=!0,e;var c={draggableId:l,shouldAnimate:function(e,t,r){if("boolean"==typeof r)return r;if(!t)return!0;var n=t.invisible,o=t.visible;if(n[e])return!1;var i=o[e];return!i||i.shouldAnimate}(l,a,i)};return e.visible[l]=c,e}),{all:[],visible:{},invisible:{}})}function vt(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,o=e.destination,i=function(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}(t,{inHomeList:r});return{displaced:st,displacedBy:n,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:i}}}}function yt(e){var t=e.draggable,r=e.insideDestination,n=e.destination,o=e.viewport,i=e.displacedBy,a=e.last,s=e.index,l=e.forceShouldAnimate,c=it(t,n);if(null==s)return vt({insideDestination:r,inHomeList:c,displacedBy:i,destination:n});var u=$e(r,(function(e){return e.descriptor.index===s}));if(!u)return vt({insideDestination:r,inHomeList:c,displacedBy:i,destination:n});var d=ot(t,r),h=r.indexOf(u);return{displaced:bt({afterDragging:d.slice(h),destination:n,displacedBy:i,last:a,viewport:o.frame,forceShouldAnimate:l}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function _t(e,t){return Boolean(t.effected[e])}var wt=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,o=e.draggables,i=e.destination,a=e.insideDestination,s=e.previousImpact,l=e.viewport,c=e.afterCritical,u=s.at;if(u||ke(!1),"REORDER"===u.type){var d=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,o=e.location;if(!n.length)return null;var i=o.index,a=t?i+1:i-1,s=n[0].descriptor.index,l=n[n.length-1].descriptor.index;return a<s||a>(r?l:l+1)?null:a}({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:a});return null==d?null:yt({draggable:n,insideDestination:a,destination:i,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:d})}var h=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,o=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var a=o.draggableId,s=n[a].descriptor.index;return _t(a,i)?t?s:s-1:t?s+1:s}({isMovingForward:t,destination:i,displaced:s.displaced,draggables:o,combine:u.combine,afterCritical:c});return null==h?null:yt({draggable:n,insideDestination:a,destination:i,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:h})},xt=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,o=nt(r);o||ke(!1);var i=o.draggableId,a=n[i].page.borderBox.center,s=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,o=e.displacedBy,i=Boolean(t.visible[n]||t.invisible[n]);return _t(n,r)?i?De:Le(o.point):i?o.point:De}({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return ze(a,s)},kt=function(e,t){return t.margin[e.start]+t.borderBox[e.size]/2},Ct=function(e,t,r){return t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2},Et=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return Ne(t.line,r.marginBox[t.end]+kt(t,n),Ct(t,r.marginBox,n))},St=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return Ne(t.line,r.marginBox[t.start]-function(e,t){return t.margin[e.end]+t.borderBox[e.size]/2}(t,n),Ct(t,r.marginBox,n))},Tt=function(e){var t=e.impact,r=e.draggable,n=e.draggables,o=e.droppable,i=e.afterCritical,a=tt(o.descriptor.id,n),s=r.page,l=o.axis;if(!a.length)return function(e){var t=e.axis,r=e.moveInto,n=e.isMoving;return Ne(t.line,r.contentBox[t.start]+kt(t,n),Ct(t,r.contentBox,n))}({axis:l,moveInto:o.page,isMoving:s});var c=t.displaced,u=t.displacedBy,d=c.all[0];if(d){var h=n[d];if(_t(d,i))return St({axis:l,moveRelativeTo:h.page,isMoving:s});var p=he(h.page,u.point);return St({axis:l,moveRelativeTo:p,isMoving:s})}var f=a[a.length-1];if(f.descriptor.id===r.descriptor.id)return s.borderBox.center;if(_t(f.descriptor.id,i)){var m=he(f.page,Le(i.displacedBy.point));return Et({axis:l,moveRelativeTo:m,isMoving:s})}return Et({axis:l,moveRelativeTo:f.page,isMoving:s})},At=function(e,t){var r=e.frame;return r?ze(t,r.scroll.diff.displacement):t},Pt=function(e){var t=function(e){var t=e.impact,r=e.draggable,n=e.droppable,o=e.draggables,i=e.afterCritical,a=r.page.borderBox.center,s=t.at;return n&&s?"REORDER"===s.type?Tt({impact:t,draggable:r,draggables:o,droppable:n,afterCritical:i}):xt({impact:t,draggables:o,afterCritical:i}):a}(e),r=e.droppable;return r?At(r,t):t},It=function(e,t){var r=je(t,e.scroll.initial),n=Le(r);return{frame:ae({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function Ot(e,t){return e.map((function(e){return t[e]}))}var Mt=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=function(e,t){return ze(e.scroll.diff.displacement,t)}(e.viewport,t),o=je(n,r.page.borderBox.center);return ze(r.client.borderBox.center,o)},Dt=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,o=e.viewport,i=e.withDroppableDisplacement,s=e.onlyOnMainAxis,l=void 0!==s&&s,c=je(n,t.page.borderBox.center),u={target:Ue(t.page.borderBox,c),destination:r,withDroppableDisplacement:i,viewport:o};return l?function(e){return ft(Object(a.a)({},e,{isVisibleThroughFrameFn:(t=e.destination.axis,function(e){var r=ct(e.top,e.bottom),n=ct(e.left,e.right);return function(e){return t===ht?r(e.top)&&r(e.bottom):n(e.left)&&n(e.right)}})}));var t}(u):gt(u)},zt=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,o=e.draggables,i=e.previousImpact,s=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,u=e.afterCritical;if(!n.isEnabled)return null;var d=tt(n.descriptor.id,o),h=it(r,n),p=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,o=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;if(!rt(i))return null;function s(e){var t={type:"COMBINE",combine:{draggableId:e,droppableId:n.descriptor.id}};return Object(a.a)({},i,{at:t})}var l=i.displaced.all,c=l.length?l[0]:null;if(t)return c?s(c):null;var u=ot(r,o);if(!c)return u.length?s(u[u.length-1].descriptor.id):null;var d=Ye(u,(function(e){return e.descriptor.id===c}));-1===d&&ke(!1);var h=d-1;return h<0?null:s(u[h].descriptor.id)}({isMovingForward:t,draggable:r,destination:n,insideDestination:d,previousImpact:i})||wt({isMovingForward:t,isInHomeList:h,draggable:r,draggables:o,destination:n,insideDestination:d,previousImpact:i,viewport:s,afterCritical:u});if(!p)return null;var f=Pt({impact:p,draggable:r,droppable:n,draggables:o,afterCritical:u});if(Dt({draggable:r,destination:n,newPageBorderBoxCenter:f,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Mt({pageBorderBoxCenter:f,draggable:r,viewport:s}),impact:p,scrollJumpRequest:null};var m=je(f,l);return{clientSelection:c,impact:function(e){var t=e.impact,r=e.viewport,n=e.destination,o=e.draggables,i=e.maxScrollChange,s=It(r,ze(r.scroll.current,i)),l=n.frame?Ge(n,ze(n.frame.scroll.current,i)):n,c=t.displaced,u=bt({afterDragging:Ot(c.all,o),destination:n,displacedBy:t.displacedBy,viewport:s.frame,last:c,forceShouldAnimate:!1}),d=bt({afterDragging:Ot(c.all,o),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),h={},p={},f=[c,u,d];return c.all.forEach((function(e){var t=function(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}(e,f);t?p[e]=t:h[e]=!0})),Object(a.a)({},t,{displaced:{all:c.all,invisible:h,visible:p}})}({impact:p,viewport:s,destination:n,draggables:o,maxScrollChange:m}),scrollJumpRequest:m}},jt=function(e){var t=e.subject.active;return t||ke(!1),t},Rt=function(e,t){var r=e.page.borderBox.center;return _t(e.descriptor.id,t)?je(r,t.displacedBy.point):r},Lt=function(e,t){var r=e.page.borderBox;return _t(e.descriptor.id,t)?Ue(r,Le(t.displacedBy.point)):r},Nt=be((function(e,t){var r=t[e.line];return{value:r,point:Ne(e.line,r)}})),Bt=function(e,t){return Object(a.a)({},e,{scroll:Object(a.a)({},e.scroll,{max:t})})},Ft=function(e,t,r){var n=e.frame;it(t,e)&&ke(!1),e.subject.withPlaceholder&&ke(!1);var o=Nt(e.axis,t.displaceBy).point,i=function(e,t,r){var n=e.axis;if("virtual"===e.descriptor.mode)return Ne(n.line,t[n.line]);var o=e.subject.page.contentBox[n.size],i=tt(e.descriptor.id,r).reduce((function(e,t){return e+t.client.marginBox[n.size]}),0)+t[n.line]-o;return i<=0?null:Ne(n.line,i)}(e,o,r),s={placeholderSize:o,increasedBy:i,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){var l=We({page:e.subject.page,withPlaceholder:s,axis:e.axis,frame:e.frame});return Object(a.a)({},e,{subject:l})}var c=i?ze(n.scroll.max,i):n.scroll.max,u=Bt(n,c),d=We({page:e.subject.page,withPlaceholder:s,axis:e.axis,frame:u});return Object(a.a)({},e,{subject:d,frame:u})},Vt=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,o=e.isOver,i=e.draggables,a=e.droppables,s=e.viewport,l=e.afterCritical,c=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,o=e.droppables,i=e.viewport,a=n.subject.active;if(!a)return null;var s=n.axis,l=ct(a[s.start],a[s.end]),c=Qe(o).filter((function(e){return e!==n})).filter((function(e){return e.isEnabled})).filter((function(e){return Boolean(e.subject.active)})).filter((function(e){return ut(i.frame)(jt(e))})).filter((function(e){var r=jt(e);return t?a[s.crossAxisEnd]<r[s.crossAxisEnd]:r[s.crossAxisStart]<a[s.crossAxisStart]})).filter((function(e){var t=jt(e),r=ct(t[s.start],t[s.end]);return l(t[s.start])||l(t[s.end])||r(a[s.start])||r(a[s.end])})).sort((function(e,r){var n=jt(e)[s.crossAxisStart],o=jt(r)[s.crossAxisStart];return t?n-o:o-n})).filter((function(e,t,r){return jt(e)[s.crossAxisStart]===jt(r[0])[s.crossAxisStart]}));if(!c.length)return null;if(1===c.length)return c[0];var u=c.filter((function(e){return ct(jt(e)[s.start],jt(e)[s.end])(r[s.line])}));return 1===u.length?u[0]:u.length>1?u.sort((function(e,t){return jt(e)[s.start]-jt(t)[s.start]}))[0]:c.sort((function(e,t){var n=Fe(r,qe(jt(e))),o=Fe(r,qe(jt(t)));return n!==o?n-o:jt(e)[s.start]-jt(t)[s.start]}))[0]}({isMovingForward:t,pageBorderBoxCenter:r,source:o,droppables:a,viewport:s});if(!c)return null;var u=tt(c.descriptor.id,i),d=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,o=e.draggable,i=e.draggables,a=e.destination,s=e.viewport,l=e.afterCritical;if(!r){if(n.length)return null;var c={displaced:st,displacedBy:at,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},u=Pt({impact:c,draggable:o,droppable:a,draggables:i,afterCritical:l}),d=it(o,a)?a:Ft(a,o,i);return Dt({draggable:o,destination:d,newPageBorderBoxCenter:u,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?c:null}var h,p=Boolean(t[a.axis.line]<=r.page.borderBox.center[a.axis.line]),f=(h=r.descriptor.index,r.descriptor.id===o.descriptor.id||p?h:h+1),m=Nt(a.axis,o.displaceBy);return yt({draggable:o,insideDestination:n,destination:a,viewport:s,displacedBy:m,last:st,index:f})}({previousPageBorderBoxCenter:r,destination:c,draggable:n,draggables:i,moveRelativeTo:function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,o=e.insideDestination,i=e.afterCritical;return o.filter((function(e){return gt({target:Lt(e,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})})).sort((function(e,r){var o=Be(t,At(n,Rt(e,i))),a=Be(t,At(n,Rt(r,i)));return o<a?-1:a<o?1:e.descriptor.index-r.descriptor.index}))[0]||null}({pageBorderBoxCenter:r,viewport:s,destination:c,insideDestination:u,afterCritical:l}),insideDestination:u,viewport:s,afterCritical:l});if(!d)return null;var h=Pt({impact:d,draggable:n,droppable:c,draggables:i,afterCritical:l});return{clientSelection:Mt({pageBorderBoxCenter:h,draggable:n,viewport:s}),impact:d,scrollJumpRequest:null}},Ut=function(e){var t=e.at;return t?"REORDER"===t.type?t.destination.droppableId:t.combine.droppableId:null},qt=function(e){var t=e.state,r=e.type,n=function(e,t){var r=Ut(e);return r?t[r]:null}(t.impact,t.dimensions.droppables),o=Boolean(n),i=t.dimensions.droppables[t.critical.droppable.id],a=n||i,s=a.axis.direction,l="vertical"===s&&("MOVE_UP"===r||"MOVE_DOWN"===r)||"horizontal"===s&&("MOVE_LEFT"===r||"MOVE_RIGHT"===r);if(l&&!o)return null;var c="MOVE_DOWN"===r||"MOVE_RIGHT"===r,u=t.dimensions.draggables[t.critical.draggable.id],d=t.current.page.borderBoxCenter,h=t.dimensions,p=h.draggables,f=h.droppables;return l?zt({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,destination:a,draggables:p,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):Vt({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,isOver:a,draggables:p,droppables:f,viewport:t.viewport,afterCritical:t.afterCritical})};function Ht(e){return"DRAGGING"===e.phase||"COLLECTING"===e.phase}function Wt(e){var t=ct(e.top,e.bottom),r=ct(e.left,e.right);return function(e){return t(e.y)&&r(e.x)}}function Gt(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,o=Qe(n).filter((function(e){if(!e.isEnabled)return!1;var r,n,o=e.subject.active;if(!o)return!1;if(n=o,!((r=t).left<n.right&&r.right>n.left&&r.top<n.bottom&&r.bottom>n.top))return!1;if(Wt(o)(t.center))return!0;var i=e.axis,a=o.center[i.crossAxisLine],s=t[i.crossAxisStart],l=t[i.crossAxisEnd],c=ct(o[i.crossAxisStart],o[i.crossAxisEnd]),u=c(s),d=c(l);return!u&&!d||(u?s<a:l>a)}));return o.length?1===o.length?o[0].descriptor.id:function(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,o=r.page.borderBox.center,i=n.map((function(e){var r=e.axis,n=Ne(e.axis.line,t.center[r.line],e.page.borderBox.center[r.crossAxisLine]);return{id:e.descriptor.id,distance:Be(o,n)}})).sort((function(e,t){return t.distance-e.distance}));return i[0]?i[0].id:null}({pageBorderBox:t,draggable:r,candidates:o}):null}var Zt=function(e,t){return ae(Ue(e,t))};function Yt(e){var t=e.displaced,r=e.id;return Boolean(t.visible[r]||t.invisible[r])}var $t=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,o=e.droppables,i=e.previousImpact,a=e.viewport,s=e.afterCritical,l=Zt(r.page.borderBox,t),c=Gt({pageBorderBox:l,draggable:r,droppables:o});if(!c)return lt;var u,d,h=o[c],p=tt(h.descriptor.id,n),f=(u=l,(d=h.frame)?Zt(u,d.scroll.diff.value):u);return function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,o=e.destination,i=e.insideDestination,a=e.afterCritical;if(!o.isCombineEnabled)return null;var s=o.axis,l=Nt(o.axis,t.displaceBy),c=l.value,u=r[s.start],d=r[s.end],h=$e(ot(t,i),(function(e){var t=e.descriptor.id,r=e.page.borderBox,o=r[s.size]/4,i=_t(t,a),l=Yt({displaced:n.displaced,id:t});return i?l?d>r[s.start]+o&&d<r[s.end]-o:u>r[s.start]-c+o&&u<r[s.end]-c-o:l?d>r[s.start]+c+o&&d<r[s.end]+c-o:u>r[s.start]+o&&u<r[s.end]-o}));return h?{displacedBy:l,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:h.descriptor.id,droppableId:o.descriptor.id}}}:null}({pageBorderBoxWithDroppableScroll:f,draggable:r,previousImpact:i,destination:h,insideDestination:p,afterCritical:s})||function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,o=e.insideDestination,i=e.last,a=e.viewport,s=e.afterCritical,l=n.axis,c=Nt(n.axis,r.displaceBy),u=c.value,d=t[l.start],h=t[l.end],p=function(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}({draggable:r,closest:$e(ot(r,o),(function(e){var t=e.descriptor.id,r=e.page.borderBox.center[l.line],n=_t(t,s),o=Yt({displaced:i,id:t});return n?o?h<=r:d<r-u:o?h<=r+u:d<r})),inHomeList:it(r,n)});return yt({draggable:r,insideDestination:o,destination:n,viewport:a,last:i,displacedBy:c,index:p})}({pageBorderBoxWithDroppableScroll:f,draggable:r,destination:h,insideDestination:p,last:i.displaced,viewport:a,afterCritical:s})},Kt=function(e,t){var r;return Object(a.a)({},e,((r={})[t.descriptor.id]=t,r))},Xt=function(e){var t=e.previousImpact,r=e.impact,n=e.droppables,o=Ut(t),i=Ut(r);if(!o)return n;if(o===i)return n;var s=n[o];if(!s.subject.withPlaceholder)return n;var l=function(e){var t=e.subject.withPlaceholder;t||ke(!1);var r=e.frame;if(!r){var n=We({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return Object(a.a)({},e,{subject:n})}var o=t.oldFrameMaxScroll;o||ke(!1);var i=Bt(r,o),s=We({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null});return Object(a.a)({},e,{subject:s,frame:i})}(s);return Kt(n,l)},Jt=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,o=e.viewport,i=e.impact,s=e.scrollJumpRequest,l=o||t.viewport,c=n||t.dimensions,u=r||t.current.client.selection,d=je(u,t.initial.client.selection),h={offset:d,selection:u,borderBoxCenter:ze(t.initial.client.borderBoxCenter,d)},p={selection:ze(h.selection,l.scroll.current),borderBoxCenter:ze(h.borderBoxCenter,l.scroll.current),offset:ze(h.offset,l.scroll.diff.value)},f={client:h,page:p};if("COLLECTING"===t.phase)return Object(a.a)({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:f});var m=c.draggables[t.critical.draggable.id],g=i||$t({pageOffset:p.offset,draggable:m,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),b=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,o=e.previousImpact,i=e.impact,a=Xt({previousImpact:o,impact:i,droppables:n}),s=Ut(i);if(!s)return a;var l=n[s];if(it(t,l))return a;if(l.subject.withPlaceholder)return a;var c=Ft(l,t,r);return Kt(a,c)}({draggable:m,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables});return Object(a.a)({},t,{current:f,dimensions:{draggables:c.draggables,droppables:b},impact:g,viewport:l,scrollJumpRequest:s||null,forceShouldAnimate:!s&&null})};var Qt=function(e){var t=e.impact,r=e.viewport,n=e.draggables,o=e.destination,i=e.forceShouldAnimate,s=t.displaced,l=bt({afterDragging:function(e,t){return e.map((function(e){return t[e]}))}(s.all,n),destination:o,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:s});return Object(a.a)({},t,{displaced:l})},er=function(e){var t=e.impact,r=e.draggable,n=e.droppable,o=e.draggables,i=e.viewport,a=e.afterCritical,s=Pt({impact:t,draggable:r,draggables:o,droppable:n,afterCritical:a});return Mt({pageBorderBoxCenter:s,draggable:r,viewport:i})},tr=function(e){var t=e.state,r=e.dimensions,n=e.viewport;"SNAP"!==t.movementMode&&ke(!1);var o=t.impact,i=n||t.viewport,a=r||t.dimensions,s=a.draggables,l=a.droppables,c=s[t.critical.draggable.id],u=Ut(o);u||ke(!1);var d=l[u],h=Qt({impact:o,viewport:i,destination:d,draggables:s}),p=er({impact:h,draggable:c,droppable:d,draggables:s,viewport:i,afterCritical:t.afterCritical});return Jt({impact:h,clientSelection:p,state:t,dimensions:a,viewport:i})},rr=function(e){var t=e.draggable,r=e.home,n=e.draggables,o=e.viewport,i=Nt(r.axis,t.displaceBy),a=tt(r.descriptor.id,n),s=a.indexOf(t);-1===s&&ke(!1);var l,c=a.slice(s+1),u=c.reduce((function(e,t){return e[t.descriptor.id]=!0,e}),{}),d={inVirtualList:"virtual"===r.descriptor.mode,displacedBy:i,effected:u};return{impact:{displaced:bt({afterDragging:c,destination:r,displacedBy:i,last:null,viewport:o.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:(l=t.descriptor,{index:l.index,droppableId:l.droppableId})}},afterCritical:d}},nr=function(e){0},or=function(e){0},ir=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,o=n.scroll.diff.value;return t.map((function(e){var t=e.descriptor.droppableId,i=function(e){var t=e.frame;return t||ke(!1),t}(r[t]).scroll.diff.value;return function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,o=he(t.client,r),i=pe(o,n);return Object(a.a)({},t,{placeholder:Object(a.a)({},t.placeholder,{client:o}),client:o,page:i})}({draggable:e,offset:ze(o,i),initialWindowScroll:n.scroll.initial})}))},ar=function(e){return"SNAP"===e.movementMode},sr=function(e,t,r){var n=function(e,t){return{draggables:e.draggables,droppables:Kt(e.droppables,t)}}(e.dimensions,t);return!ar(e)||r?Jt({state:e,dimensions:n}):tr({state:e,dimensions:n})};function lr(e){return e.isDragging&&"SNAP"===e.movementMode?Object(a.a)({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var cr={phase:"IDLE",completed:null,shouldFlush:!1},ur=function(e,t){if(void 0===e&&(e=cr),"FLUSH"===t.type)return Object(a.a)({},cr,{shouldFlush:!0});if("INITIAL_PUBLISH"===t.type){"IDLE"!==e.phase&&ke(!1);var r=t.payload,n=r.critical,o=r.clientSelection,i=r.viewport,s=r.dimensions,l=r.movementMode,c=s.draggables[n.draggable.id],u=s.droppables[n.droppable.id],d={selection:o,borderBoxCenter:c.client.borderBox.center,offset:De},h={client:d,page:{selection:ze(d.selection,i.scroll.initial),borderBoxCenter:ze(d.selection,i.scroll.initial),offset:ze(d.selection,i.scroll.diff.value)}},p=Qe(s.droppables).every((function(e){return!e.isFixedOnPage})),f=rr({draggable:c,home:u,draggables:s.draggables,viewport:i}),m=f.impact;return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:s,initial:h,current:h,isWindowScrollAllowed:p,impact:m,afterCritical:f.afterCritical,onLiftImpact:m,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if("COLLECTION_STARTING"===t.type)return"COLLECTING"===e.phase||"DROP_PENDING"===e.phase?e:("DRAGGING"!==e.phase&&ke(!1),Object(a.a)({phase:"COLLECTING"},e,{phase:"COLLECTING"}));if("PUBLISH_WHILE_DRAGGING"===t.type)return"COLLECTING"!==e.phase&&"DROP_PENDING"!==e.phase&&ke(!1),function(e){var t=e.state,r=e.published;nr();var n=r.modified.map((function(e){var r=t.dimensions.droppables[e.droppableId];return Ge(r,e.scroll)})),o=Object(a.a)({},t.dimensions.droppables,{},Xe(n)),i=Je(ir({additions:r.additions,updatedDroppables:o,viewport:t.viewport})),s=Object(a.a)({},t.dimensions.draggables,{},i);r.removals.forEach((function(e){delete s[e]}));var l={droppables:o,draggables:s},c=Ut(t.impact),u=c?l.droppables[c]:null,d=l.draggables[t.critical.draggable.id],h=l.droppables[t.critical.droppable.id],p=rr({draggable:d,home:h,draggables:s,viewport:t.viewport}),f=p.impact,m=p.afterCritical,g=u&&u.isCombineEnabled?t.impact:f,b=$t({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:m});or();var v=Object(a.a)({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:b,onLiftImpact:f,dimensions:l,afterCritical:m,forceShouldAnimate:!1});return"COLLECTING"===t.phase?v:Object(a.a)({phase:"DROP_PENDING"},v,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1})}({state:e,published:t.payload});if("MOVE"===t.type){if("DROP_PENDING"===e.phase)return e;Ht(e)||ke(!1);var g=t.payload.client;return Re(g,e.current.client.selection)?e:Jt({state:e,clientSelection:g,impact:ar(e)?e.impact:null})}if("UPDATE_DROPPABLE_SCROLL"===t.type){if("DROP_PENDING"===e.phase)return lr(e);if("COLLECTING"===e.phase)return lr(e);Ht(e)||ke(!1);var b=t.payload,v=b.id,y=b.newScroll,_=e.dimensions.droppables[v];if(!_)return e;var w=Ge(_,y);return sr(e,w,!1)}if("UPDATE_DROPPABLE_IS_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;Ht(e)||ke(!1);var x=t.payload,k=x.id,C=x.isEnabled,E=e.dimensions.droppables[k];E||ke(!1),E.isEnabled===C&&ke(!1);var S=Object(a.a)({},E,{isEnabled:C});return sr(e,S,!0)}if("UPDATE_DROPPABLE_IS_COMBINE_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;Ht(e)||ke(!1);var T=t.payload,A=T.id,P=T.isCombineEnabled,I=e.dimensions.droppables[A];I||ke(!1),I.isCombineEnabled===P&&ke(!1);var O=Object(a.a)({},I,{isCombineEnabled:P});return sr(e,O,!0)}if("MOVE_BY_WINDOW_SCROLL"===t.type){if("DROP_PENDING"===e.phase||"DROP_ANIMATING"===e.phase)return e;Ht(e)||ke(!1),e.isWindowScrollAllowed||ke(!1);var M=t.payload.newScroll;if(Re(e.viewport.scroll.current,M))return lr(e);var D=It(e.viewport,M);return ar(e)?tr({state:e,viewport:D}):Jt({state:e,viewport:D})}if("UPDATE_VIEWPORT_MAX_SCROLL"===t.type){if(!Ht(e))return e;var z=t.payload.maxScroll;if(Re(z,e.viewport.scroll.max))return e;var j=Object(a.a)({},e.viewport,{scroll:Object(a.a)({},e.viewport.scroll,{max:z})});return Object(a.a)({phase:"DRAGGING"},e,{viewport:j})}if("MOVE_UP"===t.type||"MOVE_DOWN"===t.type||"MOVE_LEFT"===t.type||"MOVE_RIGHT"===t.type){if("COLLECTING"===e.phase||"DROP_PENDING"===e.phase)return e;"DRAGGING"!==e.phase&&ke(!1);var R=qt({state:e,type:t.type});return R?Jt({state:e,impact:R.impact,clientSelection:R.clientSelection,scrollJumpRequest:R.scrollJumpRequest}):e}if("DROP_PENDING"===t.type){var L=t.payload.reason;return"COLLECTING"!==e.phase&&ke(!1),Object(a.a)({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:L})}if("DROP_ANIMATE"===t.type){var N=t.payload,B=N.completed,F=N.dropDuration,V=N.newHomeClientOffset;return"DRAGGING"!==e.phase&&"DROP_PENDING"!==e.phase&&ke(!1),{phase:"DROP_ANIMATING",completed:B,dropDuration:F,newHomeClientOffset:V,dimensions:e.dimensions}}return"DROP_COMPLETE"===t.type?{phase:"IDLE",completed:t.payload.completed,shouldFlush:!1}:e},dr=function(e){return{type:"PUBLISH_WHILE_DRAGGING",payload:e}},hr=function(){return{type:"COLLECTION_STARTING",payload:null}},pr=function(e){return{type:"UPDATE_DROPPABLE_SCROLL",payload:e}},fr=function(e){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}},mr=function(e){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}},gr=function(e){return{type:"MOVE",payload:e}},br=function(){return{type:"MOVE_UP",payload:null}},vr=function(){return{type:"MOVE_DOWN",payload:null}},yr=function(){return{type:"MOVE_RIGHT",payload:null}},_r=function(){return{type:"MOVE_LEFT",payload:null}},wr=function(e){return{type:"DROP_COMPLETE",payload:e}},xr=function(e){return{type:"DROP",payload:e}},kr=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}};var Cr="cubic-bezier(.2,1,.1,1)",Er={drop:0,combining:.7},Sr={drop:.75},Tr=.2+"s "+"cubic-bezier(0.2, 0, 0, 1)",Ar={fluid:"opacity "+Tr,snap:"transform "+Tr+", opacity "+Tr,drop:function(e){var t=e+"s "+Cr;return"transform "+t+", opacity "+t},outOfTheWay:"transform "+Tr,placeholder:"height "+Tr+", width "+Tr+", margin "+Tr},Pr=function(e){return Re(e,De)?null:"translate("+e.x+"px, "+e.y+"px)"},Ir=Pr,Or=function(e,t){var r=Pr(e);return r?t?r+" scale("+Sr.drop+")":r:null},Mr=.33,Dr=.55,zr=Dr-Mr,jr=function(e){var t=e.getState,r=e.dispatch;return function(e){return function(n){if("DROP"===n.type){var o=t(),i=n.payload.reason;if("COLLECTING"!==o.phase){if("IDLE"!==o.phase){"DROP_PENDING"===o.phase&&o.isWaiting&&ke(!1),"DRAGGING"!==o.phase&&"DROP_PENDING"!==o.phase&&ke(!1);var s=o.critical,l=o.dimensions,c=l.draggables[o.critical.draggable.id],u=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,o=e.home,i=e.viewport,s=e.onLiftImpact;return n.at&&"DROP"===r?"REORDER"===n.at.type?{impact:n,didDropInsideDroppable:!0}:{impact:Object(a.a)({},n,{displaced:st}),didDropInsideDroppable:!0}:{impact:Qt({draggables:t,impact:s,destination:o,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}}({reason:i,lastImpact:o.impact,afterCritical:o.afterCritical,onLiftImpact:o.onLiftImpact,home:o.dimensions.droppables[o.critical.droppable.id],viewport:o.viewport,draggables:o.dimensions.draggables}),d=u.impact,h=u.didDropInsideDroppable,p=h?rt(d):null,f=h?nt(d):null,m={index:s.draggable.index,droppableId:s.droppable.id},g={draggableId:c.descriptor.id,type:c.descriptor.type,source:m,reason:i,mode:o.movementMode,destination:p,combine:f},b=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,o=e.viewport,i=e.afterCritical,a=n.draggables,s=n.droppables,l=Ut(t),c=l?s[l]:null,u=s[r.descriptor.droppableId],d=er({impact:t,draggable:r,draggables:a,afterCritical:i,droppable:c||u,viewport:o});return je(d,r.client.borderBox.center)}({impact:d,draggable:c,dimensions:l,viewport:o.viewport,afterCritical:o.afterCritical}),v={critical:o.critical,afterCritical:o.afterCritical,result:g,impact:d};if(!Re(o.current.client.offset,b)||Boolean(g.combine)){var y=function(e){var t=e.current,r=e.destination,n=e.reason,o=Be(t,r);if(o<=0)return Mr;if(o>=1500)return Dr;var i=Mr+zr*(o/1500);return Number(("CANCEL"===n?.6*i:i).toFixed(2))}({current:o.current.client.offset,destination:b,reason:i});r(function(e){return{type:"DROP_ANIMATE",payload:e}}({newHomeClientOffset:b,dropDuration:y,completed:v}))}else r(wr({completed:v}))}}else r(function(e){return{type:"DROP_PENDING",payload:e}}({reason:i}))}else e(n)}}},Rr=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function Lr(e){var t=e.onWindowScroll;var r,n=ve((function(){t(Rr())})),o=(r=n,{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(e){e.target!==window&&e.target!==window.document||r()}}),i=_e;function a(){return i!==_e}return{start:function(){a()&&ke(!1),i=we(window,[o])},stop:function(){a()||ke(!1),n.cancel(),i(),i=_e},isActive:a}}var Nr=function(e){var t=Lr({onWindowScroll:function(t){e.dispatch({type:"MOVE_BY_WINDOW_SCROLL",payload:{newScroll:t}})}});return function(e){return function(r){t.isActive()||"INITIAL_PUBLISH"!==r.type||t.start(),t.isActive()&&function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(r)&&t.stop(),e(r)}}},Br=function(){var e=[];return{add:function(t){var r=setTimeout((function(){return function(t){var r=Ye(e,(function(e){return e.timerId===t}));-1===r&&ke(!1),e.splice(r,1)[0].callback()}(r)})),n={timerId:r,callback:t};e.push(n)},flush:function(){if(e.length){var t=[].concat(e);e.length=0,t.forEach((function(e){clearTimeout(e.timerId),e.callback()}))}}}},Fr=function(e,t){nr(),t(),or()},Vr=function(e,t){return{draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t}},Ur=function(e,t,r,n){if(e){var o=function(e){var t=!1,r=!1,n=setTimeout((function(){r=!0})),o=function(o){t||r||(t=!0,e(o),clearTimeout(n))};return o.wasCalled=function(){return t},o}(r);e(t,{announce:o}),o.wasCalled()||r(n(t))}else r(n(t))},qr=function(e,t){var r=function(e,t){var r=Br(),n=null,o=function(r){n||ke(!1),n=null,Fr(0,(function(){return Ur(e().onDragEnd,r,t,Me)}))};return{beforeCapture:function(t,r){n&&ke(!1),Fr(0,(function(){var n=e().onBeforeCapture;n&&n({draggableId:t,mode:r})}))},beforeStart:function(t,r){n&&ke(!1),Fr(0,(function(){var n=e().onBeforeDragStart;n&&n(Vr(t,r))}))},start:function(o,i){n&&ke(!1);var a=Vr(o,i);n={mode:i,lastCritical:o,lastLocation:a.source,lastCombine:null},r.add((function(){Fr(0,(function(){return Ur(e().onDragStart,a,t,Ie)}))}))},update:function(o,i){var s=rt(i),l=nt(i);n||ke(!1);var c=!function(e,t){if(e===t)return!0;var r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n}(o,n.lastCritical);c&&(n.lastCritical=o);var u,d,h=(u=n.lastLocation,d=s,!(null==u&&null==d||null!=u&&null!=d&&u.droppableId===d.droppableId&&u.index===d.index));h&&(n.lastLocation=s);var p=!function(e,t){return null==e&&null==t||null!=e&&null!=t&&(e.draggableId===t.draggableId&&e.droppableId===t.droppableId)}(n.lastCombine,l);if(p&&(n.lastCombine=l),c||h||p){var f=Object(a.a)({},Vr(o,n.mode),{combine:l,destination:s});r.add((function(){Fr(0,(function(){return Ur(e().onDragUpdate,f,t,Oe)}))}))}},flush:function(){n||ke(!1),r.flush()},drop:o,abort:function(){if(n){var e=Object(a.a)({},Vr(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});o(e)}}}}(e,t);return function(e){return function(t){return function(n){if("BEFORE_INITIAL_CAPTURE"!==n.type){if("INITIAL_PUBLISH"===n.type){var o=n.payload.critical;return r.beforeStart(o,n.payload.movementMode),t(n),void r.start(o,n.payload.movementMode)}if("DROP_COMPLETE"===n.type){var i=n.payload.completed.result;return r.flush(),t(n),void r.drop(i)}if(t(n),"FLUSH"!==n.type){var a=e.getState();"DRAGGING"===a.phase&&r.update(a.critical,a.impact)}else r.abort()}else r.beforeCapture(n.payload.draggableId,n.payload.movementMode)}}}},Hr=function(e){return function(t){return function(r){if("DROP_ANIMATION_FINISHED"===r.type){var n=e.getState();"DROP_ANIMATING"!==n.phase&&ke(!1),e.dispatch(wr({completed:n.completed}))}else t(r)}}},Wr=function(e){var t=null,r=null;return function(n){return function(o){if("FLUSH"!==o.type&&"DROP_COMPLETE"!==o.type&&"DROP_ANIMATION_FINISHED"!==o.type||(r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)),n(o),"DROP_ANIMATE"===o.type){var i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){"DROP_ANIMATING"===e.getState().phase&&e.dispatch({type:"DROP_ANIMATION_FINISHED",payload:null})}};r=requestAnimationFrame((function(){r=null,t=we(window,[i])}))}}}},Gr=function(e){return function(t){return function(r){if(t(r),"PUBLISH_WHILE_DRAGGING"===r.type){var n=e.getState();"DROP_PENDING"===n.phase&&(n.isWaiting||e.dispatch(xr({reason:n.reason})))}}}},Zr=b,Yr=function(e){var t,r=e.dimensionMarshal,n=e.focusMarshal,o=e.styleMarshal,i=e.getResponders,a=e.announce,s=e.autoScroller;return d(ur,Zr(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return g({},r,{dispatch:n=b.apply(void 0,i)(r.dispatch)})}}}((t=o,function(){return function(e){return function(r){"INITIAL_PUBLISH"===r.type&&t.dragging(),"DROP_ANIMATE"===r.type&&t.dropping(r.payload.completed.result.reason),"FLUSH"!==r.type&&"DROP_COMPLETE"!==r.type||t.resting(),e(r)}}}),function(e){return function(){return function(t){return function(r){"DROP_COMPLETE"!==r.type&&"FLUSH"!==r.type&&"DROP_ANIMATE"!==r.type||e.stopPublishing(),t(r)}}}}(r),function(e){return function(t){var r=t.getState,n=t.dispatch;return function(t){return function(o){if("LIFT"===o.type){var i=o.payload,a=i.id,s=i.clientSelection,l=i.movementMode,c=r();"DROP_ANIMATING"===c.phase&&n(wr({completed:c.completed})),"IDLE"!==r().phase&&ke(!1),n({type:"FLUSH",payload:null}),n({type:"BEFORE_INITIAL_CAPTURE",payload:{draggableId:a,movementMode:l}});var u={draggableId:a,scrollOptions:{shouldPublishImmediately:"SNAP"===l}},d=e.startPublishing(u),h=d.critical,p=d.dimensions,f=d.viewport;n(function(e){return{type:"INITIAL_PUBLISH",payload:e}}({critical:h,dimensions:p,clientSelection:s,movementMode:l,viewport:f}))}else t(o)}}}}(r),jr,Hr,Wr,Gr,function(e){return function(t){return function(r){return function(n){if(function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(n))return e.stop(),void r(n);if("INITIAL_PUBLISH"===n.type){r(n);var o=t.getState();return"DRAGGING"!==o.phase&&ke(!1),void e.start(o)}r(n),e.scroll(t.getState())}}}}(s),Nr,function(e){var t=!1;return function(){return function(r){return function(n){if("INITIAL_PUBLISH"===n.type)return t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),void e.tryRestoreFocusRecorded();if(r(n),t){if("FLUSH"===n.type)return t=!1,void e.tryRestoreFocusRecorded();if("DROP_COMPLETE"===n.type){t=!1;var o=n.payload.completed.result;o.combine&&e.tryShiftRecord(o.draggableId,o.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}}(n),qr(i,a))))};var $r=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,o=e.width,i=je({x:r,y:t},{x:o,y:n});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},Kr=function(){var e=document.documentElement;return e||ke(!1),e},Xr=function(){var e=Kr();return $r({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},Jr=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry;nr();var o,i,a,s,l,c,u,d=(o=Rr(),i=Xr(),a=o.y,s=o.x,l=Kr(),c=l.clientWidth,u=l.clientHeight,{frame:ae({top:a,left:s,right:s+c,bottom:a+u}),scroll:{initial:o,current:o,max:i,diff:{value:De,displacement:De}}}),h=d.scroll.current,p=t.droppable,f=n.droppable.getAllByType(p.type).map((function(e){return e.callbacks.getDimensionAndWatchScroll(h,r)})),m=n.draggable.getAllByType(t.draggable.type).map((function(e){return e.getDimension(h)})),g={draggables:Je(m),droppables:Xe(f)};return or(),{dimensions:g,critical:t,viewport:d}};function Qr(e,t,r){return r.descriptor.id!==t.id&&(r.descriptor.type===t.type&&"virtual"===e.droppable.getById(r.descriptor.droppableId).descriptor.mode)}var en,tn,rn=function(e,t){var r=null,n=function(e){var t=e.registry,r=e.callbacks,n={additions:{},removals:{},modified:{}},o=null,i=function(){o||(r.collectionStarting(),o=requestAnimationFrame((function(){o=null,nr();var e=n,i=e.additions,a=e.removals,s=e.modified,l=Object.keys(i).map((function(e){return t.draggable.getById(e).getDimension(De)})).sort((function(e,t){return e.descriptor.index-t.descriptor.index})),c=Object.keys(s).map((function(e){return{droppableId:e,scroll:t.droppable.getById(e).callbacks.getScrollWhileDragging()}})),u={additions:l,removals:Object.keys(a),modified:c};n={additions:{},removals:{},modified:{}},or(),r.publish(u)})))};return{add:function(e){var t=e.descriptor.id;n.additions[t]=e,n.modified[e.descriptor.droppableId]=!0,n.removals[t]&&delete n.removals[t],i()},remove:function(e){var t=e.descriptor;n.removals[t.id]=!0,n.modified[t.droppableId]=!0,n.additions[t.id]&&delete n.additions[t.id],i()},stop:function(){o&&(cancelAnimationFrame(o),o=null,n={additions:{},removals:{},modified:{}})}}}({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),o=function(t){r||ke(!1);var o=r.critical.draggable;"ADDITION"===t.type&&Qr(e,o,t.value)&&n.add(t.value),"REMOVAL"===t.type&&Qr(e,o,t.value)&&n.remove(t.value)};return{updateDroppableIsEnabled:function(n,o){e.droppable.exists(n)||ke(!1),r&&t.updateDroppableIsEnabled({id:n,isEnabled:o})},updateDroppableIsCombineEnabled:function(n,o){r&&(e.droppable.exists(n)||ke(!1),t.updateDroppableIsCombineEnabled({id:n,isCombineEnabled:o}))},scrollDroppable:function(t,n){r&&e.droppable.getById(t).callbacks.scroll(n)},updateDroppableScroll:function(n,o){r&&(e.droppable.exists(n)||ke(!1),t.updateDroppableScroll({id:n,newScroll:o}))},startPublishing:function(t){r&&ke(!1);var n=e.draggable.getById(t.draggableId),i=e.droppable.getById(n.descriptor.droppableId),a={draggable:n.descriptor,droppable:i.descriptor},s=e.subscribe(o);return r={critical:a,unsubscribe:s},Jr({critical:a,registry:e,scrollOptions:t.scrollOptions})},stopPublishing:function(){if(r){n.stop();var t=r.critical.droppable;e.droppable.getAllByType(t.type).forEach((function(e){return e.callbacks.dragStopped()})),r.unsubscribe(),r=null}}}},nn=function(e,t){return"IDLE"===e.phase||"DROP_ANIMATING"===e.phase&&(e.completed.result.draggableId!==t&&"DROP"===e.completed.result.reason)},on=function(e){window.scrollBy(e.x,e.y)},an=be((function(e){return Qe(e).filter((function(e){return!!e.isEnabled&&!!e.frame}))})),sn=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var o=n[r];return o.frame?o:null}return function(e,t){return $e(an(t),(function(t){return t.frame||ke(!1),Wt(t.frame.pageMarginBox)(e)}))}(t,n)},ln=.25,cn=.05,un=28,dn=function(e){return Math.pow(e,2)},hn={stopDampeningAt:1200,accelerateAt:360},pn=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,o=r-t;return 0===o?0:(n-t)/o},fn=hn.accelerateAt,mn=hn.stopDampeningAt,gn=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,o=e.shouldUseTimeDampening,i=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return un;if(e===t.startScrollingFrom)return 1;var r=pn({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=un*dn(1-r);return Math.ceil(n)}(t,r);return 0===i?0:o?Math.max(function(e,t){var r=t,n=mn,o=Date.now()-r;if(o>=mn)return e;if(o<fn)return 1;var i=pn({startOfRange:fn,endOfRange:n,current:o}),a=e*dn(i);return Math.ceil(a)}(i,n),1):i},bn=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,o=e.axis,i=e.shouldUseTimeDampening,a=function(e,t){return{startScrollingFrom:e[t.size]*ln,maxScrollValueAt:e[t.size]*cn}}(t,o);return r[o.end]<r[o.start]?gn({distanceToEdge:r[o.end],thresholds:a,dragStartTime:n,shouldUseTimeDampening:i}):-1*gn({distanceToEdge:r[o.start],thresholds:a,dragStartTime:n,shouldUseTimeDampening:i})},vn=Ve((function(e){return 0===e?0:e})),yn=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,o=e.center,i=e.shouldUseTimeDampening,a={top:o.y-r.top,right:r.right-o.x,bottom:r.bottom-o.y,left:o.x-r.left},s=bn({container:r,distanceToEdges:a,dragStartTime:t,axis:ht,shouldUseTimeDampening:i}),l=bn({container:r,distanceToEdges:a,dragStartTime:t,axis:pt,shouldUseTimeDampening:i}),c=vn({x:l,y:s});if(Re(c,De))return null;var u=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,o=r.height>t.height,i=r.width>t.width;return i||o?i&&o?null:{x:i?0:n.x,y:o?0:n.y}:n}({container:r,subject:n,proposedScroll:c});return u?Re(u,De)?null:u:null},_n=Ve((function(e){return 0===e?0:e>0?1:-1})),wn=(en=function(e,t){return e<0?e:e>t?e-t:0},function(e){var t=e.current,r=e.max,n=e.change,o=ze(t,n),i={x:en(o.x,r.x),y:en(o.y,r.y)};return Re(i,De)?null:i}),xn=function(e){var t=e.max,r=e.current,n=e.change,o={x:Math.max(r.x,t.x),y:Math.max(r.y,t.y)},i=_n(n),a=wn({max:o,current:r,change:i});return!a||(0!==i.x&&0===a.x||0!==i.y&&0===a.y)},kn=function(e,t){return xn({current:e.scroll.current,max:e.scroll.max,change:t})},Cn=function(e,t){var r=e.frame;return!!r&&xn({current:r.scroll.current,max:r.scroll.max,change:t})},En=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,o=e.scrollWindow,i=e.scrollDroppable,a=t.current.page.borderBoxCenter,s=t.dimensions.draggables[t.critical.draggable.id].page.marginBox;if(t.isWindowScrollAllowed){var l=function(e){var t=e.viewport,r=e.subject,n=e.center,o=e.dragStartTime,i=e.shouldUseTimeDampening,a=yn({dragStartTime:o,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return a&&kn(t,a)?a:null}({dragStartTime:r,viewport:t.viewport,subject:s,center:a,shouldUseTimeDampening:n});if(l)return void o(l)}var c=sn({center:a,destination:Ut(t.impact),droppables:t.dimensions.droppables});if(c){var u=function(e){var t=e.droppable,r=e.subject,n=e.center,o=e.dragStartTime,i=e.shouldUseTimeDampening,a=t.frame;if(!a)return null;var s=yn({dragStartTime:o,container:a.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return s&&Cn(t,s)?s:null}({dragStartTime:r,droppable:c,subject:s,center:a,shouldUseTimeDampening:n});u&&i(c.descriptor.id,u)}},Sn=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,o=function(e,t){if(!Cn(e,t))return t;var n=function(e,t){var r=e.frame;return r&&Cn(e,t)?wn({current:r.scroll.current,max:r.scroll.max,change:t}):null}(e,t);if(!n)return r(e.descriptor.id,t),null;var o=je(t,n);return r(e.descriptor.id,o),je(t,o)},i=function(e,t,r){if(!e)return r;if(!kn(t,r))return r;var o=function(e,t){if(!kn(e,t))return null;var r=e.scroll.max,n=e.scroll.current;return wn({current:n,max:r,change:t})}(t,r);if(!o)return n(r),null;var i=je(r,o);return n(i),je(r,i)};return function(e){var r=e.scrollJumpRequest;if(r){var n=Ut(e.impact);n||ke(!1);var a=o(e.dimensions.droppables[n],r);if(a){var s=e.viewport,l=i(e.isWindowScrollAllowed,s,a);l&&function(e,r){var n=ze(e.current.client.selection,r);t({client:n})}(e,l)}}}},Tn=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,o=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=ve(t),o=ve(r),i=null,a=function(e){i||ke(!1);var t=i,r=t.shouldUseTimeDampening,a=t.dragStartTime;En({state:e,scrollWindow:n,scrollDroppable:o,dragStartTime:a,shouldUseTimeDampening:r})};return{start:function(e){nr(),i&&ke(!1);var t=Date.now(),r=!1,n=function(){r=!0};En({state:e,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:n,scrollDroppable:n}),i={dragStartTime:t,shouldUseTimeDampening:r},or(),r&&a(e)},stop:function(){i&&(n.cancel(),o.cancel(),i=null)},scroll:a}}({scrollWindow:r,scrollDroppable:t}),i=Sn({move:n,scrollWindow:r,scrollDroppable:t});return{scroll:function(e){"DRAGGING"===e.phase&&("FLUID"!==e.movementMode?e.scrollJumpRequest&&i(e):o.scroll(e))},start:o.start,stop:o.stop}},An={base:tn="data-rbd-drag-handle",draggableId:tn+"-draggable-id",contextId:tn+"-context-id"},Pn=function(){var e="data-rbd-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),In=function(){var e="data-rbd-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),On={contextId:"data-rbd-scroll-container-context-id"},Mn=function(e,t){return e.map((function(e){var r=e.styles[t];return r?e.selector+" { "+r+" }":""})).join(" ")},Dn="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect,zn=function(){var e=document.querySelector("head");return e||ke(!1),e},jn=function(e){var t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function Rn(e,t){var r=ne((function(){return function(e){var t,r,n,o=(t=e,function(e){return"["+e+'="'+t+'"]'}),i=(r="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ",{selector:o(An.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:r,dragging:"pointer-events: none;",dropAnimating:r}}),a=[(n="\n      transition: "+Ar.outOfTheWay+";\n    ",{selector:o(Pn.contextId),styles:{dragging:n,dropAnimating:n,userCancel:n}}),i,{selector:o(In.contextId),styles:{always:"overflow-anchor: none;"}},{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:Mn(a,"always"),resting:Mn(a,"resting"),dragging:Mn(a,"dragging"),dropAnimating:Mn(a,"dropAnimating"),userCancel:Mn(a,"userCancel")}}(e)}),[e]),o=Object(n.useRef)(null),i=Object(n.useRef)(null),a=oe(be((function(e){var t=i.current;t||ke(!1),t.textContent=e})),[]),s=oe((function(e){var t=o.current;t||ke(!1),t.textContent=e}),[]);Dn((function(){(o.current||i.current)&&ke(!1);var n=jn(t),l=jn(t);return o.current=n,i.current=l,n.setAttribute("data-rbd-always",e),l.setAttribute("data-rbd-dynamic",e),zn().appendChild(n),zn().appendChild(l),s(r.always),a(r.resting),function(){var e=function(e){var t=e.current;t||ke(!1),zn().removeChild(t),e.current=null};e(o),e(i)}}),[t,s,a,r.always,r.resting,e]);var l=oe((function(){return a(r.dragging)}),[a,r.dragging]),c=oe((function(e){a("DROP"!==e?r.userCancel:r.dropAnimating)}),[a,r.dropAnimating,r.userCancel]),u=oe((function(){i.current&&a(r.resting)}),[a,r.resting]);return ne((function(){return{dragging:l,dropping:c,resting:u}}),[l,c,u])}var Ln=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function Nn(e){return e instanceof Ln(e).HTMLElement}function Bn(e,t){var r="["+An.contextId+'="'+e+'"]',n=Ke(document.querySelectorAll(r));if(!n.length)return null;var o=$e(n,(function(e){return e.getAttribute(An.draggableId)===t}));return o&&Nn(o)?o:null}function Fn(){var e={draggables:{},droppables:{}},t=[];function r(e){t.length&&t.forEach((function(t){return t(e)}))}function n(t){return e.draggables[t]||null}function o(t){return e.droppables[t]||null}return{draggable:{register:function(t){e.draggables[t.descriptor.id]=t,r({type:"ADDITION",value:t})},update:function(t,r){var n=e.draggables[r.descriptor.id];n&&n.uniqueId===t.uniqueId&&(delete e.draggables[r.descriptor.id],e.draggables[t.descriptor.id]=t)},unregister:function(t){var o=t.descriptor.id,i=n(o);i&&t.uniqueId===i.uniqueId&&(delete e.draggables[o],r({type:"REMOVAL",value:t}))},getById:function(e){var t=n(e);return t||ke(!1),t},findById:n,exists:function(e){return Boolean(n(e))},getAllByType:function(t){return Ze(e.draggables).filter((function(e){return e.descriptor.type===t}))}},droppable:{register:function(t){e.droppables[t.descriptor.id]=t},unregister:function(t){var r=o(t.descriptor.id);r&&t.uniqueId===r.uniqueId&&delete e.droppables[t.descriptor.id]},getById:function(e){var t=o(e);return t||ke(!1),t},findById:o,exists:function(e){return Boolean(o(e))},getAllByType:function(t){return Ze(e.droppables).filter((function(e){return e.descriptor.type===t}))}},subscribe:function(e){return t.push(e),function(){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},clean:function(){e.draggables={},e.droppables={},t.length=0}}}var Vn=o.a.createContext(null),Un=function(){var e=document.body;return e||ke(!1),e},qn={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"};var Hn=0,Wn={separator:"::"};function Gn(e,t){return void 0===t&&(t=Wn),ne((function(){return""+e+t.separator+Hn++}),[t.separator,e])}var Zn=o.a.createContext(null);function Yn(e){0}function $n(e,t){Yn()}function Kn(){$n()}function Xn(e){var t=Object(n.useRef)(e);return Object(n.useEffect)((function(){t.current=e})),t}var Jn,Qn=((Jn={})[13]=!0,Jn[9]=!0,Jn),eo=function(e){Qn[e.keyCode]&&e.preventDefault()},to=function(){var e="visibilitychange";return"undefined"==typeof document?e:$e([e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],(function(e){return"on"+e in document}))||e}();var ro,no={type:"IDLE"};function oo(e){var t=e.cancel,r=e.completed,n=e.getPhase,o=e.setPhase;return[{eventName:"mousemove",fn:function(e){var t=e.button,r=e.clientX,i=e.clientY;if(0===t){var a={x:r,y:i},s=n();if("DRAGGING"===s.type)return e.preventDefault(),void s.actions.move(a);"PENDING"!==s.type&&ke(!1);var l=s.point;if(c=l,u=a,Math.abs(u.x-c.x)>=5||Math.abs(u.y-c.y)>=5){var c,u;e.preventDefault();var d=s.actions.fluidLift(a);o({type:"DRAGGING",actions:d})}}}},{eventName:"mouseup",fn:function(e){var o=n();"DRAGGING"===o.type?(e.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"mousedown",fn:function(e){"DRAGGING"===n().type&&e.preventDefault(),t()}},{eventName:"keydown",fn:function(e){if("PENDING"!==n().type)return 27===e.keyCode?(e.preventDefault(),void t()):void eo(e);t()}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){"PENDING"===n().type&&t()}},{eventName:"webkitmouseforcedown",fn:function(e){var r=n();"IDLE"===r.type&&ke(!1),r.actions.shouldRespectForcePress()?t():e.preventDefault()}},{eventName:to,fn:t}]}function io(){}var ao=((ro={})[34]=!0,ro[33]=!0,ro[36]=!0,ro[35]=!0,ro);function so(e,t){function r(){t(),e.cancel()}return[{eventName:"keydown",fn:function(n){return 27===n.keyCode?(n.preventDefault(),void r()):32===n.keyCode?(n.preventDefault(),t(),void e.drop()):40===n.keyCode?(n.preventDefault(),void e.moveDown()):38===n.keyCode?(n.preventDefault(),void e.moveUp()):39===n.keyCode?(n.preventDefault(),void e.moveRight()):37===n.keyCode?(n.preventDefault(),void e.moveLeft()):void(ao[n.keyCode]?n.preventDefault():eo(n))}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:to,fn:r}]}var lo={type:"IDLE"};var co={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function uo(e,t){var r=t.target;return!!Nn(r)&&function e(t,r){if(null==r)return!1;if(Boolean(co[r.tagName.toLowerCase()]))return!0;var n=r.getAttribute("contenteditable");return"true"===n||""===n||r!==t&&e(t,r.parentElement)}(e,r)}var ho=function(e){return ae(e.getBoundingClientRect()).center};var po="undefined"==typeof document?"matches":$e(["matches","msMatchesSelector","webkitMatchesSelector"],(function(e){return e in Element.prototype}))||"matches";function fo(e,t){return e.closest?e.closest(t):function e(t,r){return null==t?null:t[po](r)?t:e(t.parentElement,r)}(e,t)}function mo(e,t){var r,n=t.target;if(!((r=n)instanceof Ln(r).Element))return null;var o=fo(n,function(e){return"["+An.contextId+'="'+e+'"]'}(e));return o&&Nn(o)?o:null}function go(e){e.preventDefault()}function bo(e){var t=e.expected,r=e.phase,n=e.isLockActive;e.shouldWarn;return!!n()&&t===r}function vo(e){var t=e.lockAPI,r=e.store,n=e.registry,o=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(o);return!!i&&(!!i.options.isEnabled&&!!nn(r.getState(),o))}function yo(e){var t=e.lockAPI,r=e.contextId,n=e.store,o=e.registry,i=e.draggableId,s=e.forceSensorStop,l=e.sourceEvent;if(!vo({lockAPI:t,store:n,registry:o,draggableId:i}))return null;var c=o.draggable.getById(i),u=function(e,t){var r="["+Pn.contextId+'="'+e+'"]',n=$e(Ke(document.querySelectorAll(r)),(function(e){return e.getAttribute(Pn.id)===t}));return n&&Nn(n)?n:null}(r,c.descriptor.id);if(!u)return null;if(l&&!c.options.canDragInteractiveElements&&uo(u,l))return null;var d=t.claim(s||_e),h="PRE_DRAG";function p(){return c.options.shouldRespectForcePress}function f(){return t.isActive(d)}var m=function(e,t){bo({expected:e,phase:h,isLockActive:f,shouldWarn:!0})&&n.dispatch(t())}.bind(null,"DRAGGING");function g(e){function r(){t.release(),h="COMPLETED"}function o(t,o){if(void 0===o&&(o={shouldBlockNextClick:!1}),e.cleanup(),o.shouldBlockNextClick){var i=we(window,[{eventName:"click",fn:go,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(i)}r(),n.dispatch(xr({reason:t}))}return"PRE_DRAG"!==h&&(r(),"PRE_DRAG"!==h&&ke(!1)),n.dispatch(function(e){return{type:"LIFT",payload:e}}(e.liftActionArgs)),h="DRAGGING",Object(a.a)({isActive:function(){return bo({expected:"DRAGGING",phase:h,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,drop:function(e){return o("DROP",e)},cancel:function(e){return o("CANCEL",e)}},e.actions)}return{isActive:function(){return bo({expected:"PRE_DRAG",phase:h,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,fluidLift:function(e){var t=ve((function(e){m((function(){return gr({client:e})}))})),r=g({liftActionArgs:{id:i,clientSelection:e,movementMode:"FLUID"},cleanup:function(){return t.cancel()},actions:{move:t}});return Object(a.a)({},r,{move:t})},snapLift:function(){var e={moveUp:function(){return m(br)},moveRight:function(){return m(yr)},moveDown:function(){return m(vr)},moveLeft:function(){return m(_r)}};return g({liftActionArgs:{id:i,clientSelection:ho(u),movementMode:"SNAP"},cleanup:_e,actions:e})},abort:function(){bo({expected:"PRE_DRAG",phase:h,isLockActive:f,shouldWarn:!0})&&t.release()}}}var _o=[function(e){var t=Object(n.useRef)(no),r=Object(n.useRef)(_e),o=ne((function(){return{eventName:"mousedown",fn:function(t){if(!t.defaultPrevented&&0===t.button&&!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){var n=e.findClosestDraggableId(t);if(n){var o=e.tryGetLock(n,s,{sourceEvent:t});if(o){t.preventDefault();var i={x:t.clientX,y:t.clientY};r.current(),u(o,i)}}}}}}),[e]),i=ne((function(){return{eventName:"webkitmouseforcewillbegin",fn:function(t){if(!t.defaultPrevented){var r=e.findClosestDraggableId(t);if(r){var n=e.findOptionsForDraggable(r);n&&(n.shouldRespectForcePress||e.canGetLock(r)&&t.preventDefault())}}}}}),[e]),a=oe((function(){r.current=we(window,[i,o],{passive:!1,capture:!0})}),[i,o]),s=oe((function(){"IDLE"!==t.current.type&&(t.current=no,r.current(),a())}),[a]),l=oe((function(){var e=t.current;s(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[s]),c=oe((function(){var e=oo({cancel:l,completed:s,getPhase:function(){return t.current},setPhase:function(e){t.current=e}});r.current=we(window,e,{capture:!0,passive:!1})}),[l,s]),u=oe((function(e,r){"IDLE"!==t.current.type&&ke(!1),t.current={type:"PENDING",point:r,actions:e},c()}),[c]);Dn((function(){return a(),function(){r.current()}}),[a])},function(e){var t=Object(n.useRef)(io),r=ne((function(){return{eventName:"keydown",fn:function(r){if(!r.defaultPrevented&&32===r.keyCode){var n=e.findClosestDraggableId(r);if(n){var i=e.tryGetLock(n,l,{sourceEvent:r});if(i){r.preventDefault();var a=!0,s=i.snapLift();t.current(),t.current=we(window,so(s,l),{capture:!0,passive:!1})}}}function l(){a||ke(!1),a=!1,t.current(),o()}}}}),[e]),o=oe((function(){t.current=we(window,[r],{passive:!1,capture:!0})}),[r]);Dn((function(){return o(),function(){t.current()}}),[o])},function(e){var t=Object(n.useRef)(lo),r=Object(n.useRef)(_e),o=oe((function(){return t.current}),[]),i=oe((function(e){t.current=e}),[]),a=ne((function(){return{eventName:"touchstart",fn:function(t){if(!t.defaultPrevented){var n=e.findClosestDraggableId(t);if(n){var o=e.tryGetLock(n,l,{sourceEvent:t});if(o){var i=t.touches[0],a={x:i.clientX,y:i.clientY};r.current(),h(o,a)}}}}}}),[e]),s=oe((function(){r.current=we(window,[a],{capture:!0,passive:!1})}),[a]),l=oe((function(){var e=t.current;"IDLE"!==e.type&&("PENDING"===e.type&&clearTimeout(e.longPressTimerId),i(lo),r.current(),s())}),[s,i]),c=oe((function(){var e=t.current;l(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[l]),u=oe((function(){var e={capture:!0,passive:!1},t={cancel:c,completed:l,getPhase:o},n=we(window,function(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(e){var r=n();if("DRAGGING"===r.type){r.hasMoved=!0;var o=e.touches[0],i={x:o.clientX,y:o.clientY};e.preventDefault(),r.actions.move(i)}else t()}},{eventName:"touchend",fn:function(e){var o=n();"DRAGGING"===o.type?(e.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"touchcancel",fn:function(e){"DRAGGING"===n().type?(e.preventDefault(),t()):t()}},{eventName:"touchforcechange",fn:function(e){var r=n();"IDLE"===r.type&&ke(!1);var o=e.touches[0];if(o&&o.force>=.15){var i=r.actions.shouldRespectForcePress();if("PENDING"!==r.type)return i?r.hasMoved?void e.preventDefault():void t():void e.preventDefault();i&&t()}}},{eventName:to,fn:t}]}(t),e),i=we(window,function(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(e){e.preventDefault()}},{eventName:"keydown",fn:function(e){"DRAGGING"===r().type?(27===e.keyCode&&e.preventDefault(),t()):t()}},{eventName:to,fn:t}]}(t),e);r.current=function(){n(),i()}}),[c,o,l]),d=oe((function(){var e=o();"PENDING"!==e.type&&ke(!1);var t=e.actions.fluidLift(e.point);i({type:"DRAGGING",actions:t,hasMoved:!1})}),[o,i]),h=oe((function(e,t){"IDLE"!==o().type&&ke(!1);var r=setTimeout(d,120);i({type:"PENDING",point:t,actions:e,longPressTimerId:r}),u()}),[u,o,i,d]);Dn((function(){return s(),function(){r.current();var e=o();"PENDING"===e.type&&(clearTimeout(e.longPressTimerId),i(lo))}}),[o,s,i]),Dn((function(){return we(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}])}),[])}];function wo(e){var t=e.contextId,r=e.store,o=e.registry,i=e.customSensors,a=e.enableDefaultSensors,s=[].concat(a?_o:[],i||[]),l=Object(n.useState)((function(){return function(){var e=null;function t(){e||ke(!1),e=null}return{isClaimed:function(){return Boolean(e)},isActive:function(t){return t===e},claim:function(t){e&&ke(!1);var r={abandon:t};return e=r,r},release:t,tryAbandon:function(){e&&(e.abandon(),t())}}}()}))[0],c=oe((function(e,t){e.isDragging&&!t.isDragging&&l.tryAbandon()}),[l]);Dn((function(){var e=r.getState();return r.subscribe((function(){var t=r.getState();c(e,t),e=t}))}),[l,r,c]),Dn((function(){return l.tryAbandon}),[l.tryAbandon]);var u=oe((function(e){return vo({lockAPI:l,registry:o,store:r,draggableId:e})}),[l,o,r]),d=oe((function(e,n,i){return yo({lockAPI:l,registry:o,contextId:t,store:r,draggableId:e,forceSensorStop:n,sourceEvent:i&&i.sourceEvent?i.sourceEvent:null})}),[t,l,o,r]),h=oe((function(e){return function(e,t){var r=mo(e,t);return r?r.getAttribute(An.draggableId):null}(t,e)}),[t]),p=oe((function(e){var t=o.draggable.findById(e);return t?t.options:null}),[o.draggable]),f=oe((function(){l.isClaimed()&&(l.tryAbandon(),"IDLE"!==r.getState().phase&&r.dispatch({type:"FLUSH",payload:null}))}),[l,r]),m=oe(l.isClaimed,[l]),g=ne((function(){return{canGetLock:u,tryGetLock:d,findClosestDraggableId:h,findOptionsForDraggable:p,tryReleaseLock:f,isLockClaimed:m}}),[u,d,h,p,f,m]);Yn();for(var b=0;b<s.length;b++)s[b](g)}function xo(e){return e.current||ke(!1),e.current}function ko(e){var t=e.contextId,r=e.setCallbacks,i=e.sensors,s=e.nonce,l=e.dragHandleUsageInstructions,c=Object(n.useRef)(null);Kn();var u=Xn(e),d=oe((function(){return function(e){return{onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}}(u.current)}),[u]),h=function(e){var t=ne((function(){return function(e){return"rbd-announcement-"+e}(e)}),[e]),r=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=document.createElement("div");return r.current=e,e.id=t,e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),Object(a.a)(e.style,qn),Un().appendChild(e),function(){setTimeout((function(){var t=Un();t.contains(e)&&t.removeChild(e),e===r.current&&(r.current=null)}))}}),[t]),oe((function(e){var t=r.current;t&&(t.textContent=e)}),[])}(t),f=function(e){var t=e.contextId,r=e.text,o=Gn("hidden-text",{separator:"-"}),i=ne((function(){return"rbd-hidden-text-"+(e={contextId:t,uniqueId:o}).contextId+"-"+e.uniqueId;var e}),[o,t]);return Object(n.useEffect)((function(){var e=document.createElement("div");return e.id=i,e.textContent=r,e.style.display="none",Un().appendChild(e),function(){var t=Un();t.contains(e)&&t.removeChild(e)}}),[i,r]),i}({contextId:t,text:l}),m=Rn(t,s),g=oe((function(e){xo(c).dispatch(e)}),[]),b=ne((function(){return p({publishWhileDragging:dr,updateDroppableScroll:pr,updateDroppableIsEnabled:fr,updateDroppableIsCombineEnabled:mr,collectionStarting:hr},g)}),[g]),v=function(){var e=ne(Fn,[]);return Object(n.useEffect)((function(){return function(){requestAnimationFrame(e.clean)}}),[e]),e}(),y=ne((function(){return rn(v,b)}),[v,b]),_=ne((function(){return Tn(Object(a.a)({scrollWindow:on,scrollDroppable:y.scrollDroppable},p({move:gr},g)))}),[y.scrollDroppable,g]),w=function(e){var t=Object(n.useRef)({}),r=Object(n.useRef)(null),o=Object(n.useRef)(null),i=Object(n.useRef)(!1),a=oe((function(e,r){var n={id:e,focus:r};return t.current[e]=n,function(){var r=t.current;r[e]!==n&&delete r[e]}}),[]),s=oe((function(t){var r=Bn(e,t);r&&r!==document.activeElement&&r.focus()}),[e]),l=oe((function(e,t){r.current===e&&(r.current=t)}),[]),c=oe((function(){o.current||i.current&&(o.current=requestAnimationFrame((function(){o.current=null;var e=r.current;e&&s(e)})))}),[s]),u=oe((function(e){r.current=null;var t=document.activeElement;t&&t.getAttribute(An.draggableId)===e&&(r.current=e)}),[]);return Dn((function(){return i.current=!0,function(){i.current=!1;var e=o.current;e&&cancelAnimationFrame(e)}}),[]),ne((function(){return{register:a,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}}),[a,u,c,l])}(t),x=ne((function(){return Yr({announce:h,autoScroller:_,dimensionMarshal:y,focusMarshal:w,getResponders:d,styleMarshal:m})}),[h,_,y,w,d,m]);c.current=x;var k=oe((function(){var e=xo(c);"IDLE"!==e.getState().phase&&e.dispatch({type:"FLUSH",payload:null})}),[]),E=oe((function(){var e=xo(c).getState();return e.isDragging||"DROP_ANIMATING"===e.phase}),[]);r(ne((function(){return{isDragging:E,tryAbort:k}}),[E,k]));var S=oe((function(e){return nn(xo(c).getState(),e)}),[]),T=oe((function(){return Ht(xo(c).getState())}),[]),A=ne((function(){return{marshal:y,focus:w,contextId:t,canLift:S,isMovementAllowed:T,dragHandleUsageInstructionsId:f,registry:v}}),[t,y,f,w,S,T,v]);return wo({contextId:t,store:x,registry:v,customSensors:i,enableDefaultSensors:!1!==e.enableDefaultSensors}),Object(n.useEffect)((function(){return k}),[k]),o.a.createElement(Zn.Provider,{value:A},o.a.createElement(C,{context:Vn,store:x},e.children))}var Co=0;function Eo(e){var t=ne((function(){return""+Co++}),[]),r=e.dragHandleUsageInstructions||Pe;return o.a.createElement(Ce,null,(function(n){return o.a.createElement(ko,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)}))}var So=function(e){return function(t){return e===t}},To=So("scroll"),Ao=So("auto"),Po=(So("visible"),function(e,t){return t(e.overflowX)||t(e.overflowY)}),Io=function(e){var t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return Po(r,To)||Po(r,Ao)},Oo=function e(t){return null==t||t===document.body||t===document.documentElement?null:Io(t)?t:e(t.parentElement)},Mo=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Do=function(e){return{closestScrollable:Oo(e),isFixedOnPage:function e(t){return!!t&&("fixed"===window.getComputedStyle(t).position||e(t.parentElement))}(e)}},zo=function(e){var t=e.ref,r=e.descriptor,n=e.env,o=e.windowScroll,i=e.direction,a=e.isDropDisabled,s=e.isCombineEnabled,l=e.shouldClipSubject,c=n.closestScrollable,u=function(e,t){var r=me(e);if(!t)return r;if(e!==t)return r;var n=r.paddingBox.top-t.scrollTop,o=r.paddingBox.left-t.scrollLeft,i=n+t.scrollHeight,a=o+t.scrollWidth,s=se({top:n,right:a,bottom:i,left:o},r.border);return ue({borderBox:s,margin:r.margin,border:r.border,padding:r.padding})}(t,c),d=pe(u,o),h=function(){if(!c)return null;var e=me(c),t={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:e,page:pe(e,o),scroll:Mo(c),scrollSize:t,shouldClipSubject:l}}();return function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,o=e.isFixedOnPage,i=e.direction,a=e.client,s=e.page,l=e.closest,c=function(){if(!l)return null;var e=l.scrollSize,t=l.client,r=$r({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,height:t.paddingBox.height,width:t.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:t,scrollSize:e,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:r,diff:{value:De,displacement:De}}}}(),u="vertical"===i?ht:pt;return{descriptor:t,isCombineEnabled:n,isFixedOnPage:o,axis:u,isEnabled:r,client:a,page:s,frame:c,subject:We({page:s,withPlaceholder:null,axis:u,frame:c})}}({descriptor:r,isEnabled:!a,isCombineEnabled:s,isFixedOnPage:n.isFixedOnPage,direction:i,client:u,page:d,closest:h})},jo={passive:!1},Ro={passive:!0},Lo=function(e){return e.shouldPublishImmediately?jo:Ro};function No(e){var t=Object(n.useContext)(e);return t||ke(!1),t}var Bo=function(e){return e&&e.env.closestScrollable||null};function Fo(){}var Vo={width:0,height:0,margin:{top:0,right:0,bottom:0,left:0}},Uo=function(e){var t=e.isAnimatingOpenOnMount,r=e.placeholder,n=e.animate,o=function(e){var t=e.isAnimatingOpenOnMount,r=e.placeholder,n=e.animate;return t||"close"===n?Vo:{height:r.client.borderBox.height,width:r.client.borderBox.width,margin:r.client.margin}}({isAnimatingOpenOnMount:t,placeholder:r,animate:n});return{display:r.display,boxSizing:"border-box",width:o.width,height:o.height,marginTop:o.margin.top,marginRight:o.margin.right,marginBottom:o.margin.bottom,marginLeft:o.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:"none"!==n?Ar.placeholder:null}};var qo=o.a.memo((function(e){var t=Object(n.useRef)(null),r=oe((function(){t.current&&(clearTimeout(t.current),t.current=null)}),[]),i=e.animate,a=e.onTransitionEnd,s=e.onClose,l=e.contextId,c=Object(n.useState)("open"===e.animate),u=c[0],d=c[1];Object(n.useEffect)((function(){return u?"open"!==i?(r(),d(!1),Fo):t.current?Fo:(t.current=setTimeout((function(){t.current=null,d(!1)})),r):Fo}),[i,u,r]);var h=oe((function(e){"height"===e.propertyName&&(a(),"close"===i&&s())}),[i,s,a]),p=Uo({isAnimatingOpenOnMount:u,animate:e.animate,placeholder:e.placeholder});return o.a.createElement(e.placeholder.tagName,{style:p,"data-rbd-placeholder-context-id":l,onTransitionEnd:h,ref:e.innerRef})})),Ho=o.a.createContext(null);var Wo=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).state={isVisible:Boolean(t.props.on),data:t.props.on,animate:t.props.shouldAnimate&&t.props.on?"open":"none"},t.onClose=function(){"close"===t.state.animate&&t.setState({isVisible:!1})},t}return Object(i.a)(t,e),t.getDerivedStateFromProps=function(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:Boolean(e.on),data:e.on,animate:"none"}},t.prototype.render=function(){if(!this.state.isVisible)return null;var e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)},t}(o.a.PureComponent),Go=5e3,Zo=4500,Yo=function(e,t){return t?Ar.drop(t.duration):e?Ar.snap:Ar.fluid},$o=function(e,t){return e?t?Er.drop:Er.combining:null};function Ko(e){return"DRAGGING"===e.type?(n=(r=e).dimension.client,o=r.offset,i=r.combineWith,a=r.dropping,s=Boolean(i),l=function(e){return null!=e.forceShouldAnimate?e.forceShouldAnimate:"SNAP"===e.mode}(r),c=Boolean(a),u=c?Or(o,s):Ir(o),{position:"fixed",top:n.marginBox.top,left:n.marginBox.left,boxSizing:"border-box",width:n.borderBox.width,height:n.borderBox.height,transition:Yo(l,a),transform:u,opacity:$o(s,c),zIndex:c?Zo:Go,pointerEvents:"none"}):{transform:Ir((t=e).offset),transition:t.shouldAnimateDisplacement?null:"none"};var t,r,n,o,i,a,s,l,c,u}function Xo(e){var t=Gn("draggable"),r=e.descriptor,o=e.registry,i=e.getDraggableRef,a=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,c=ne((function(){return{canDragInteractiveElements:a,shouldRespectForcePress:s,isEnabled:l}}),[a,l,s]),u=oe((function(e){var t=i();return t||ke(!1),function(e,t,r){void 0===r&&(r=De);var n=window.getComputedStyle(t),o=t.getBoundingClientRect(),i=fe(o,n),a=pe(i,r);return{descriptor:e,placeholder:{client:i,tagName:t.tagName.toLowerCase(),display:n.display},displaceBy:{x:i.marginBox.width,y:i.marginBox.height},client:i,page:a}}(r,t,e)}),[r,i]),d=ne((function(){return{uniqueId:t,descriptor:r,options:c,getDimension:u}}),[r,u,c,t]),h=Object(n.useRef)(d),p=Object(n.useRef)(!0);Dn((function(){return o.draggable.register(h.current),function(){return o.draggable.unregister(h.current)}}),[o.draggable]),Dn((function(){if(p.current)p.current=!1;else{var e=h.current;h.current=d,o.draggable.update(d,e)}}),[d,o.draggable])}function Jo(e,t,r){$n()}function Qo(e){e.preventDefault()}var ei=function(e,t){return e===t},ti=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null};function ri(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var ni={mapped:{type:"SECONDARY",offset:De,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:ri(null)}};var oi=J((function(){var e,t,r,n=(e=be((function(e,t){return{x:e,y:t}})),t=be((function(e,t,r,n,o){return{isDragging:!0,isClone:t,isDropAnimating:Boolean(o),dropAnimation:o,mode:e,draggingOver:r,combineWith:n,combineTargetFor:null}})),r=be((function(e,r,n,o,i,a,s){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:i,combineWith:a,mode:r,offset:e,dimension:n,forceShouldAnimate:s,snapshot:t(r,o,i,a,null)}}})),function(n,o){if(n.isDragging){if(n.critical.draggable.id!==o.draggableId)return null;var i=n.current.client.offset,a=n.dimensions.draggables[o.draggableId],s=Ut(n.impact),l=(u=n.impact).at&&"COMBINE"===u.at.type?u.at.combine.draggableId:null,c=n.forceShouldAnimate;return r(e(i.x,i.y),n.movementMode,a,o.isClone,s,l,c)}var u;if("DROP_ANIMATING"===n.phase){var d=n.completed;if(d.result.draggableId!==o.draggableId)return null;var h=o.isClone,p=n.dimensions.draggables[o.draggableId],f=d.result,m=f.mode,g=ti(f),b=function(e){return e.combine?e.combine.draggableId:null}(f),v={duration:n.dropDuration,curve:Cr,moveTo:n.newHomeClientOffset,opacity:b?Er.drop:null,scale:b?Sr.drop:null};return{mapped:{type:"DRAGGING",offset:n.newHomeClientOffset,dimension:p,dropping:v,draggingOver:g,combineWith:b,mode:m,forceShouldAnimate:null,snapshot:t(m,h,g,b,v)}}}return null}),o=function(){var e=be((function(e,t){return{x:e,y:t}})),t=be(ri),r=be((function(e,r,n){return void 0===r&&(r=null),{mapped:{type:"SECONDARY",offset:e,combineTargetFor:r,shouldAnimateDisplacement:n,snapshot:t(r)}}})),n=function(e){return e?r(De,e,!0):null},o=function(t,o,i,a){var s=i.displaced.visible[t],l=Boolean(a.inVirtualList&&a.effected[t]),c=nt(i),u=c&&c.draggableId===t?o:null;if(!s){if(!l)return n(u);if(i.displaced.invisible[t])return null;var d=Le(a.displacedBy.point),h=e(d.x,d.y);return r(h,u,!0)}if(l)return n(u);var p=i.displacedBy.point,f=e(p.x,p.y);return r(f,u,s.shouldAnimate)};return function(e,t){if(e.isDragging)return e.critical.draggable.id===t.draggableId?null:o(t.draggableId,e.critical.draggable.id,e.impact,e.afterCritical);if("DROP_ANIMATING"===e.phase){var r=e.completed;return r.result.draggableId===t.draggableId?null:o(t.draggableId,r.result.draggableId,r.impact,r.afterCritical)}return null}}();return function(e,t){return n(e,t)||o(e,t)||ni}}),{dropAnimationFinished:kr},null,{context:Vn,pure:!0,areStatePropsEqual:ei})((function(e){var t=Object(n.useRef)(null),r=oe((function(e){t.current=e}),[]),o=oe((function(){return t.current}),[]),i=No(Zn),a=i.contextId,s=i.dragHandleUsageInstructionsId,l=i.registry,c=No(Ho),u=c.type,d=c.droppableId,h=ne((function(){return{id:e.draggableId,index:e.index,type:u,droppableId:d}}),[e.draggableId,e.index,u,d]),p=e.children,f=e.draggableId,m=e.isEnabled,g=e.shouldRespectForcePress,b=e.canDragInteractiveElements,v=e.isClone,y=e.mapped,_=e.dropAnimationFinished;Jo(),Yn(),v||Xo(ne((function(){return{descriptor:h,registry:l,getDraggableRef:o,canDragInteractiveElements:b,shouldRespectForcePress:g,isEnabled:m}}),[h,l,o,b,g,m]));var w=ne((function(){return m?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":f,"data-rbd-drag-handle-context-id":a,draggable:!1,onDragStart:Qo}:null}),[a,s,f,m]),x=oe((function(e){"DRAGGING"===y.type&&y.dropping&&"transform"===e.propertyName&&_()}),[_,y]),k=ne((function(){var e=Ko(y),t="DRAGGING"===y.type&&y.dropping?x:null;return{innerRef:r,draggableProps:{"data-rbd-draggable-context-id":a,"data-rbd-draggable-id":f,style:e,onTransitionEnd:t},dragHandleProps:w}}),[a,w,f,y,x,r]),C=ne((function(){return{draggableId:h.id,type:h.type,source:{index:h.index,droppableId:h.droppableId}}}),[h.droppableId,h.id,h.index,h.type]);return p(k,y.snapshot,C)}));function ii(e){return No(Ho).isUsingCloneFor!==e.draggableId||e.isClone?o.a.createElement(oi,e):null}function ai(e){var t="boolean"!=typeof e.isDragDisabled||!e.isDragDisabled,r=Boolean(e.disableInteractiveElementBlocking),n=Boolean(e.shouldRespectForcePress);return o.a.createElement(ii,Object(a.a)({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}var si=function(e,t){return e===t.droppable.type},li=function(e,t){return t.draggables[e.draggable.id]};var ci={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:function(){return document.body||ke(!1),document.body}},ui=J((function(){var e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t=Object(a.a)({},e,{shouldAnimatePlaceholder:!1}),r=be((function(e){return{draggableId:e.id,type:e.type,source:{index:e.index,droppableId:e.droppableId}}})),n=be((function(n,o,i,a,s,l){var c=s.descriptor.id;if(s.descriptor.droppableId===n){var u=l?{render:l,dragging:r(s.descriptor)}:null,d={isDraggingOver:i,draggingOverWith:i?c:null,draggingFromThisWith:c,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:d,useClone:u}}if(!o)return t;if(!a)return e;var h={isDraggingOver:i,draggingOverWith:c,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:h,useClone:null}}));return function(r,o){var i=o.droppableId,a=o.type,s=!o.isDropDisabled,l=o.renderClone;if(r.isDragging){var c=r.critical;if(!si(a,c))return t;var u=li(c,r.dimensions),d=Ut(r.impact)===i;return n(i,s,d,d,u,l)}if("DROP_ANIMATING"===r.phase){var h=r.completed;if(!si(a,h.critical))return t;var p=li(h.critical,r.dimensions);return n(i,s,ti(h.result)===i,Ut(h.impact)===i,p,l)}if("IDLE"===r.phase&&r.completed&&!r.shouldFlush){var f=r.completed;if(!si(a,f.critical))return t;var m=Ut(f.impact)===i,g=Boolean(f.impact.at&&"COMBINE"===f.impact.at.type),b=f.critical.droppable.id===i;return m?g?e:t:b?e:t}return t}}),{updateViewportMaxScroll:function(e){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}}},null,{context:Vn,pure:!0,areStatePropsEqual:ei})((function(e){var t=Object(n.useContext)(Zn);t||ke(!1);var r=t.contextId,i=t.isMovementAllowed,a=Object(n.useRef)(null),s=Object(n.useRef)(null),l=e.children,c=e.droppableId,u=e.type,d=e.mode,h=e.direction,p=e.ignoreContainerClipping,f=e.isDropDisabled,m=e.isCombineEnabled,g=e.snapshot,b=e.useClone,v=e.updateViewportMaxScroll,y=e.getContainerForClone,_=oe((function(){return a.current}),[]),w=oe((function(e){a.current=e}),[]),x=(oe((function(){return s.current}),[]),oe((function(e){s.current=e}),[]));$n();var k=oe((function(){i()&&v({maxScroll:Xr()})}),[i,v]);!function(e){var t=Object(n.useRef)(null),r=No(Zn),o=Gn("droppable"),i=r.registry,a=r.marshal,s=Xn(e),l=ne((function(){return{id:e.droppableId,type:e.type,mode:e.mode}}),[e.droppableId,e.mode,e.type]),c=Object(n.useRef)(l),u=ne((function(){return be((function(e,r){t.current||ke(!1);var n={x:e,y:r};a.updateDroppableScroll(l.id,n)}))}),[l.id,a]),d=oe((function(){var e=t.current;return e&&e.env.closestScrollable?Mo(e.env.closestScrollable):De}),[]),h=oe((function(){var e=d();u(e.x,e.y)}),[d,u]),p=ne((function(){return ve(h)}),[h]),f=oe((function(){var e=t.current,r=Bo(e);e&&r||ke(!1),e.scrollOptions.shouldPublishImmediately?h():p()}),[p,h]),m=oe((function(e,n){t.current&&ke(!1);var o=s.current,i=o.getDroppableRef();i||ke(!1);var a=Do(i),c={ref:i,descriptor:l,env:a,scrollOptions:n};t.current=c;var u=zo({ref:i,descriptor:l,env:a,windowScroll:e,direction:o.direction,isDropDisabled:o.isDropDisabled,isCombineEnabled:o.isCombineEnabled,shouldClipSubject:!o.ignoreContainerClipping}),d=a.closestScrollable;return d&&(d.setAttribute(On.contextId,r.contextId),d.addEventListener("scroll",f,Lo(c.scrollOptions))),u}),[r.contextId,l,f,s]),g=oe((function(){var e=t.current,r=Bo(e);return e&&r||ke(!1),Mo(r)}),[]),b=oe((function(){var e=t.current;e||ke(!1);var r=Bo(e);t.current=null,r&&(p.cancel(),r.removeAttribute(On.contextId),r.removeEventListener("scroll",f,Lo(e.scrollOptions)))}),[f,p]),v=oe((function(e){var r=t.current;r||ke(!1);var n=Bo(r);n||ke(!1),n.scrollTop+=e.y,n.scrollLeft+=e.x}),[]),y=ne((function(){return{getDimensionAndWatchScroll:m,getScrollWhileDragging:g,dragStopped:b,scroll:v}}),[b,m,g,v]),_=ne((function(){return{uniqueId:o,descriptor:l,callbacks:y}}),[y,l,o]);Dn((function(){return c.current=_.descriptor,i.droppable.register(_),function(){t.current&&b(),i.droppable.unregister(_)}}),[y,l,b,_,a,i.droppable]),Dn((function(){t.current&&a.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)}),[e.isDropDisabled,a]),Dn((function(){t.current&&a.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)}),[e.isCombineEnabled,a])}({droppableId:c,type:u,mode:d,direction:h,isDropDisabled:f,isCombineEnabled:m,ignoreContainerClipping:p,getDroppableRef:_});var C=o.a.createElement(Wo,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},(function(e){var t=e.onClose,n=e.data,i=e.animate;return o.a.createElement(qo,{placeholder:n,onClose:t,innerRef:x,animate:i,contextId:r,onTransitionEnd:k})})),E=ne((function(){return{innerRef:w,placeholder:C,droppableProps:{"data-rbd-droppable-id":c,"data-rbd-droppable-context-id":r}}}),[r,c,C,w]),S=b?b.dragging.draggableId:null,T=ne((function(){return{droppableId:c,type:u,isUsingCloneFor:S}}),[c,S,u]);return o.a.createElement(Ho.Provider,{value:T},l(E,g),function(){if(!b)return null;var e=b.dragging,t=b.render,r=o.a.createElement(ii,{draggableId:e.draggableId,index:e.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(function(r,n){return t(r,n,e)}));return te.a.createPortal(r,y())}())}));ui.defaultProps=ci},function(e,t,r){"use strict";var n=r(47),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?a:s[e.$$typeof]||o}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=a;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(f){var o=p(r);o&&o!==f&&e(t,o,n)}var a=u(r);d&&(a=a.concat(d(r)));for(var s=l(t),m=l(r),g=0;g<a.length;++g){var b=a[g];if(!(i[b]||n&&n[b]||m&&m[b]||s&&s[b])){var v=h(r,b);try{c(t,b,v)}catch(e){}}}}return t}},function(e,t,r){var n=r(33);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e).getTime(),a=Object(n.a)(t);return new Date(r+a)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(6),o=r(4),i=r(31),a=r(3);function s(e,t){Object(a.a)(1,arguments);var r=Object(o.default)(e,t),s=r.getUTCFullYear(),l=t||{},c=l.locale,u=c&&c.options&&c.options.firstWeekContainsDate,d=null==u?1:Object(n.a)(u),h=null==l.firstWeekContainsDate?d:Object(n.a)(l.firstWeekContainsDate);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(s+1,0,h),p.setUTCHours(0,0,0,0);var f=Object(i.a)(p,t),m=new Date(0);m.setUTCFullYear(s,0,h),m.setUTCHours(0,0,0,0);var g=Object(i.a)(m,t);return r.getTime()>=f.getTime()?s+1:r.getTime()>=g.getTime()?s:s-1}},function(e,t,r){var n=r(69);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(151));t.List=o.default;var i=r(102);t.arrayMove=i.arrayMove,t.arrayRemove=i.arrayRemove},function(e,t,r){"use strict";var n=r(285);e.exports=Function.prototype.bind||n},function(e,t,r){"use strict";var n=r(152),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,l=s&&function(){var e={};try{for(var t in s(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),c=function(e,t,r,n){var o;(!(t in e)||"function"==typeof(o=n)&&"[object Function]"===i.call(o)&&n())&&(l?s(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},u=function(e,t){var r=arguments.length>2?arguments[2]:{},i=n(t);o&&(i=a.call(i,Object.getOwnPropertySymbols(t)));for(var s=0;s<i.length;s+=1)c(e,i[s],t[i[s]],r[i[s]])};u.supportsDescriptors=!!l,e.exports=u},,,,function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);return isNaN(a)?new Date(NaN):a?(r.setDate(r.getDate()+a),r):r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);if(isNaN(a))return new Date(NaN);if(!a)return r;var s=r.getDate(),l=new Date(r.getTime());l.setMonth(r.getMonth()+a+1,0);var c=l.getDate();return s>=c?l:(r.setFullYear(l.getFullYear(),l.getMonth(),s),r)}},,,,,,,,,function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";var n=r(90);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,b=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case d:case h:case a:case l:case s:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case b:case g:case c:return e;default:return t}}case i:return t}}}function k(e){return x(e)===h}t.AsyncMode=d,t.ConcurrentMode=h,t.ContextConsumer=u,t.ContextProvider=c,t.Element=o,t.ForwardRef=p,t.Fragment=a,t.Lazy=b,t.Memo=g,t.Portal=i,t.Profiler=l,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return k(e)||x(e)===d},t.isConcurrentMode=k,t.isContextConsumer=function(e){return x(e)===u},t.isContextProvider=function(e){return x(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return x(e)===p},t.isFragment=function(e){return x(e)===a},t.isLazy=function(e){return x(e)===b},t.isMemo=function(e){return x(e)===g},t.isPortal=function(e){return x(e)===i},t.isProfiler=function(e){return x(e)===l},t.isStrictMode=function(e){return x(e)===s},t.isSuspense=function(e){return x(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===h||e===l||e===s||e===f||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===y||e.$$typeof===_||e.$$typeof===w||e.$$typeof===v)},t.typeOf=x},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(6),o=r(66),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.a)(e,-r)}},function(e,t,r){"use strict";function n(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}}function o(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}}var i={p:o,P:function(e,t){var r,i=e.match(/(P+)(p+)?/),a=i[1],s=i[2];if(!s)return n(e,t);switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;case"PPPP":default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",n(a,t)).replace("{{time}}",o(s,t))}};t.a=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(4),o=r(38),i=r(3);function a(e){Object(i.a)(1,arguments);var t=Object(n.default)(e),r=t.getUTCFullYear(),a=new Date(0);a.setUTCFullYear(r+1,0,4),a.setUTCHours(0,0,0,0);var s=Object(o.a)(a),l=new Date(0);l.setUTCFullYear(r,0,4),l.setUTCHours(0,0,0,0);var c=Object(o.a)(l);return t.getTime()>=s.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getMonth(),i=r-r%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},function(e,t,r){"use strict";var n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function o(e){return function(t){var r=t||{},n=r.width?String(r.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}var i={date:o({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:o({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:o({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function s(e){return function(t,r){var n,o=r||{};if("formatting"===(o.context?String(o.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,a=o.width?String(o.width):i;n=e.formattingValues[a]||e.formattingValues[i]}else{var s=e.defaultWidth,l=o.width?String(o.width):e.defaultWidth;n=e.values[l]||e.values[s]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function l(e){return function(t,r){var n=String(t),o=r||{},i=o.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=n.match(a);if(!s)return null;var l,c=s[0],u=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth];return l="[object Array]"===Object.prototype.toString.call(u)?function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}(u,(function(e){return e.test(c)})):function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}(u,(function(e){return e.test(c)})),l=e.valueCallback?e.valueCallback(l):l,{value:l=o.valueCallback?o.valueCallback(l):l,rest:n.slice(c.length)}}}var c,u={code:"en-US",formatDistance:function(e,t,r){var o;return r=r||{},o="string"==typeof n[e]?n[e]:1===t?n[e].one:n[e].other.replace("{{count}}",t),r.addSuffix?r.comparison>0?"in "+o:o+" ago":o},formatLong:i,formatRelative:function(e,t,r,n){return a[e]},localize:{ordinalNumber:function(e,t){var r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:s({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:s({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:s({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:s({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:s({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(c={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e,t){var r=String(e),n=t||{},o=r.match(c.matchPattern);if(!o)return null;var i=o[0],a=r.match(c.parsePattern);if(!a)return null;var s=c.valueCallback?c.valueCallback(a[0]):a[0];return{value:s=n.valueCallback?n.valueCallback(s):s,rest:r.slice(i.length)}}),era:l({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:l({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:l({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:l({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:l({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};t.a=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(4),o=r(31),i=r(6),a=r(67),s=r(3);function l(e,t){Object(s.a)(1,arguments);var r=t||{},n=r.locale,l=n&&n.options&&n.options.firstWeekContainsDate,c=null==l?1:Object(i.a)(l),u=null==r.firstWeekContainsDate?c:Object(i.a)(r.firstWeekContainsDate),d=Object(a.a)(e,t),h=new Date(0);h.setUTCFullYear(d,0,u),h.setUTCHours(0,0,0,0);var p=Object(o.a)(h,t);return p}function c(e,t){Object(s.a)(1,arguments);var r=Object(n.default)(e),i=Object(o.a)(r,t).getTime()-l(r,t).getTime();return Math.round(i/6048e5)+1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(4),o=r(38),i=r(96),a=r(3);function s(e){Object(a.a)(1,arguments);var t=Object(i.a)(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=Object(o.a)(r);return n}function l(e){Object(a.a)(1,arguments);var t=Object(n.default)(e),r=Object(o.a)(t).getTime()-s(t).getTime();return Math.round(r/6048e5)+1}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayMove=function(e,t,r){return(e=e.slice()).splice(r<0?e.length+r:r,0,e.splice(t,1)[0]),e},t.arrayRemove=function(e,t){return(e=e.slice()).splice(t,1),e},t.getTranslateOffset=function(e){var t=window.getComputedStyle(e);return Math.max(parseInt(t["margin-top"],10),parseInt(t["margin-bottom"],10))+e.getBoundingClientRect().height},t.isTouchEvent=function(e){return e.touches&&e.touches.length||e.changedTouches&&e.changedTouches.length},t.transformItem=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),e&&(null!==t&&null!==r?e.style.transform="translate("+r+"px, "+t+"px)":e.style.removeProperty("transform"))},t.isItemTransformed=function(e){return!!e.style.transform},t.setItemTransition=function(e,t,r){e&&(e.style.transition="transform "+t+"ms"+(r?" "+r:""))},t.binarySearch=function(e,t){for(var r,n=0,o=e.length-1;n<=o;){if(!e[(r=Math.floor((o+n)/2))+1]||e[r]<=t&&e[r+1]>=t)return r;e[r]<t&&e[r+1]<t?n=r+1:o=r-1}return-1},t.schd=function(e){var t=[],r=null;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t=n,r||(r=requestAnimationFrame((function(){r=null,e.apply(void 0,t)})))}},t.checkIfInteractive=function(e,t){for(var r=["input","textarea","select","option","optgroup","video","audio","button","a"],n=["button","link","checkbox","tab"];e!==t;){if(e.getAttribute("data-movable-handle"))return!1;if(r.includes(e.tagName.toLowerCase()))return!0;var o=e.getAttribute("role");if(o&&n.includes(o.toLowerCase()))return!0;if("label"===e.tagName.toLowerCase()&&e.hasAttribute("for"))return!0;e.tagName&&(e=e.parentElement)}return!1}},,,,,,,,,,,,function(e,t){function r(e){var t=[];for(var r in e)t.push(r);return t}(e.exports="function"==typeof Object.keys?Object.keys:r).shim=r},function(e,t){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=r?n:o).supported=n,t.unsupported=o},function(e,t,r){var n=r(22),o=r(117);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:-moz-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-moz-box-shadow:0 0 2px rgba(0,0,0,.1);-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;-moz-animation:mapboxgl-spin 2s infinite linear;-o-animation:mapboxgl-spin 2s infinite linear;-ms-animation:mapboxgl-spin 2s infinite linear;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@-moz-keyframes mapboxgl-spin{0%{-moz-transform:rotate(0deg)}to{-moz-transform:rotate(1turn)}}@-o-keyframes mapboxgl-spin{0%{-o-transform:rotate(0deg)}to{-o-transform:rotate(1turn)}}@-ms-keyframes mapboxgl-spin{0%{-ms-transform:rotate(0deg)}to{-ms-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;-moz-animation:mapboxgl-user-location-dot-pulse 2s infinite;-ms-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@-ms-keyframes mapboxgl-user-location-dot-pulse{0%{-ms-transform:scale(1);opacity:1}70%{-ms-transform:scale(3);opacity:0}to{-ms-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{transform:scale(1);opacity:1}70%{transform:scale(3);opacity:0}to{transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}",""]),e.exports=t},function(e,t,r){"use strict";function n(e,t,r){if(null!==e){var o,i,a,s,l,c,u,d,h,p,f=0,m=0,g=e.type,b="FeatureCollection"===g,v="Feature"===g,y=b?e.features.length:1;for(o=0;o<y;o++)for(u=(p=!!(h=b?e.features[o].geometry:v?e.geometry:e)&&"GeometryCollection"===h.type)?h.geometries.length:1,i=0;i<u;i++){var _=0;if(null!==(c=p?h.geometries[i]:h)){d=c.coordinates;var w=c.type;switch(f=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":t(d,m,o,_),m++,_++;break;case"LineString":case"MultiPoint":for(a=0;a<d.length;a++)t(d[a],m,o,_),m++,"MultiPoint"===w&&_++;"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(a=0;a<d.length;a++){for(s=0;s<d[a].length-f;s++)t(d[a][s],m,o,_),m++;"MultiLineString"===w&&_++}"Polygon"===w&&_++;break;case"MultiPolygon":for(a=0;a<d.length;a++){for(s=0;s<d[a].length;s++)for(l=0;l<d[a][s].length-f;l++)t(d[a][s][l],m,o,_),m++;_++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)n(c.geometries[a],t,r);break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t,r,o){var i=r;return n(e,(function(e,n,o,a){i=0===n&&void 0===r?e:t(i,e,n,o,a)}),o),i}function i(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++)t(e.features[r].properties,r);break;case"Feature":t(e.properties,0)}}function a(e,t,r){var n=r;return i(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n}function s(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)t(e.features[r],r)}function l(e,t,r){var n=r;return s(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n}function c(e){var t=[];return n(e,(function(e){t.push(e)})),t}function u(e,t){var r,n,o,i,a,s,l,c,u=0,d="FeatureCollection"===e.type,h="Feature"===e.type,p=d?e.features.length:1;for(r=0;r<p;r++){for(s=d?e.features[r].geometry:h?e.geometry:e,c=d?e.features[r].properties:h?e.properties:{},a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=l?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":t(i,u,c);break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)t(i.geometries[n],u,c);break;default:throw new Error("Unknown Geometry Type")}else t(null,u,c);u++}}function d(e,t,r){var n=r;return u(e,(function(e,o,i){n=0===o&&void 0===r?e:t(n,e,o,i)})),n}function h(e,t){u(e,(function(e,r,n){var o,i=null===e?null:e.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return void t(g(e,n),r,0)}switch(i){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}e.coordinates.forEach((function(e,i){t(g({type:o,coordinates:e},n),r,i)}))}))}function p(e,t,r){var n=r;return h(e,(function(e,o,i){n=0===o&&0===i&&void 0===r?e:t(n,e,o,i)})),n}function f(e,t){h(e,(function(e,r,n){var i=0;if(e.geometry){var a=e.geometry.type;"Point"!==a&&"MultiPoint"!==a&&o(e,(function(o,a){var s=b([o,a],e.properties);return t(s,r,n,i),i++,a}))}}))}function m(e,t,r){var n=r,o=!1;return f(e,(function(e,i,a,s){n=!1===o&&void 0===r?e:t(n,e,i,a,s),o=!0})),n}function g(e,t){if(void 0===e)throw new Error("No geometry passed");return{type:"Feature",properties:t||{},geometry:e}}function b(e,t){if(!e)throw new Error("No coordinates passed");if(e.length<2)throw new Error("Coordinates must be an array of two or more positions");return{type:"Feature",properties:t||{},geometry:{type:"LineString",coordinates:e}}}function v(e,t){if(!e)throw new Error("geojson is required");var r=e.geometry?e.geometry.type:e.type;if(!r)throw new Error("invalid geojson");if("FeatureCollection"===r)throw new Error("FeatureCollection is not supported");if("GeometryCollection"===r)throw new Error("GeometryCollection is not supported");var n=e.geometry?e.geometry.coordinates:e.coordinates;if(!n)throw new Error("geojson must contain coordinates");switch(r){case"LineString":return void t(n,0,0);case"Polygon":case"MultiLineString":for(var o=0,i=0;i<n.length;i++)"MultiLineString"===r&&(o=i),t(n[i],i,o);return;case"MultiPolygon":for(var a=0;a<n.length;a++)for(var s=0;s<n[a].length;s++)t(n[a][s],s,a);return;default:throw new Error(r+" geometry not supported")}}function y(e,t,r){var n=r;return v(e,(function(e,o,i){n=0===o&&void 0===r?e:t(n,e,o,i)})),n}r.r(t),r.d(t,"coordEach",(function(){return n})),r.d(t,"coordReduce",(function(){return o})),r.d(t,"propEach",(function(){return i})),r.d(t,"propReduce",(function(){return a})),r.d(t,"featureEach",(function(){return s})),r.d(t,"featureReduce",(function(){return l})),r.d(t,"coordAll",(function(){return c})),r.d(t,"geomEach",(function(){return u})),r.d(t,"geomReduce",(function(){return d})),r.d(t,"flattenEach",(function(){return h})),r.d(t,"flattenReduce",(function(){return p})),r.d(t,"segmentEach",(function(){return f})),r.d(t,"segmentReduce",(function(){return m})),r.d(t,"feature",(function(){return g})),r.d(t,"lineString",(function(){return b})),r.d(t,"lineEach",(function(){return v})),r.d(t,"lineReduce",(function(){return y}))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e===t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!0;var a={},s=void 0,l=void 0;for(s=0,l=r.length;s<l;s++)a[r[s]]=!0;for(s=0,l=o.length;s<l;s++){var c=o[s],u=e[c],d=t[c];if(u!==d){if(!a[c]||null===u||null===d||"object"!==(void 0===u?"undefined":n(u))||"object"!==(void 0===d?"undefined":n(d)))return!0;var h=Object.keys(u),p=Object.keys(d);if(h.length!==p.length)return!0;for(var f=0,m=h.length;f<m;f++){var g=h[f];if(u[g]!==d[g])return!0}}}return!1}},function(e,t,r){"use strict";(function(t){var n=t.Symbol,o=r(284);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}}).call(this,r(43))},,,,function(e,t){e.exports=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e);return!isNaN(t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(66),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.a)(e,6e4*r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(66),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.a)(e,36e5*r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(77),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t),a=7*r;return Object(o.default)(e,a)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(78),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,12*r)}},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var n=r(6),o=r(4),i=r(3);function a(e){Object(i.a)(1,arguments);var t=Object(o.default)(e),r=t.getFullYear(),n=t.getMonth(),a=new Date(0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function s(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),s=Object(n.a)(t),l=r.getFullYear(),c=r.getDate(),u=new Date(0);u.setFullYear(l,s,15),u.setHours(0,0,0,0);var d=a(u);return r.setMonth(s,Math.min(c,d)),r}},function(e,t,r){var n=r(126);e.exports=function(e,t){if(null==e)return{};var r,o,i=n(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";e.exports=r(217).default},function(e,t,r){"use strict";(function(e,n){var o,i=r(171);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(i.a)(o);t.a=a}).call(this,r(43),r(230)(e))},function(e,t,r){(function(e){!function(t,r,n,o,i,a,s,l,c,u,d,h,p,f,m,g,b,v,y,_,w,x,k,C,E,S,T,A,P,I,O,M,D,z,j,R,L,N,B,F,V,U,q,H,W,G,Z,Y,$,K,X,J,Q,ee,te,re,ne,oe,ie,ae,se,le){"use strict";function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e,t,r){return t&&de(e.prototype,t),r&&de(e,r),e}function pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _e(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?ye(e):t}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ve(e);if(t){var o=ve(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _e(this,r)}}function xe(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}}function ke(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}}r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,_=_&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,k=k&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k,C=C&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C,E=E&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E,S=S&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S,T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,A=A&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A,P=P&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P,I=I&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I,O=O&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O,M=M&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M,D=D&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D,z=z&&Object.prototype.hasOwnProperty.call(z,"default")?z.default:z,j=j&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j,R=R&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R,L=L&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L,N=N&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N,B=B&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B,F=F&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F,V=V&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V,U=U&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U,q=q&&Object.prototype.hasOwnProperty.call(q,"default")?q.default:q,H=H&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H,W=W&&Object.prototype.hasOwnProperty.call(W,"default")?W.default:W,G=G&&Object.prototype.hasOwnProperty.call(G,"default")?G.default:G,Z=Z&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z,Y=Y&&Object.prototype.hasOwnProperty.call(Y,"default")?Y.default:Y,$=$&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$,K=K&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K,X=X&&Object.prototype.hasOwnProperty.call(X,"default")?X.default:X,J=J&&Object.prototype.hasOwnProperty.call(J,"default")?J.default:J,Q=Q&&Object.prototype.hasOwnProperty.call(Q,"default")?Q.default:Q,ee=ee&&Object.prototype.hasOwnProperty.call(ee,"default")?ee.default:ee,te=te&&Object.prototype.hasOwnProperty.call(te,"default")?te.default:te,re=re&&Object.prototype.hasOwnProperty.call(re,"default")?re.default:re,ne=ne&&Object.prototype.hasOwnProperty.call(ne,"default")?ne.default:ne,oe=oe&&Object.prototype.hasOwnProperty.call(oe,"default")?oe.default:oe,ie=ie&&Object.prototype.hasOwnProperty.call(ie,"default")?ie.default:ie,ae=ae&&Object.prototype.hasOwnProperty.call(ae,"default")?ae.default:ae,se=se&&Object.prototype.hasOwnProperty.call(se,"default")?se.default:se;var Ce={p:ke,P:function(e,t){var r,n=e.match(/(P+)(p+)?/),o=n[1],i=n[2];if(!i)return xe(e,t);switch(o){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;case"PPPP":default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",xe(o,t)).replace("{{time}}",ke(i,t))}},Ee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;function Se(e){var t=e?"string"==typeof e||e instanceof String?ae(e):oe(e):new Date;return Ae(t)?t:null}function Te(e,t,r,n){var o=null,i=He(r)||qe(),a=!0;return Array.isArray(t)?(t.forEach((function(t){var r=ie(e,t,new Date,{locale:i});n&&(a=Ae(r)&&e===s(r,t,{awareOfUnicodeTokens:!0})),Ae(r)&&a&&(o=r)})),o):(o=ie(e,t,new Date,{locale:i}),n?a=Ae(o)&&e===s(o,t,{awareOfUnicodeTokens:!0}):Ae(o)||(t=t.match(Ee).map((function(e){var t=e[0];return"p"===t||"P"===t?i?(0,Ce[t])(e,i.formatLong):t:e})).join(""),e.length>0&&(o=ie(e,t.slice(0,e.length),new Date)),Ae(o)||(o=new Date(e))),Ae(o)&&a?o:null)}function Ae(e){return a(e)&&te(e,new Date("1/1/1000"))}function Pe(e,t,r){if("en"===r)return s(e,t,{awareOfUnicodeTokens:!0});var n=He(r);return r&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),!n&&qe()&&He(qe())&&(n=He(qe())),s(e,t,{locale:n||null,awareOfUnicodeTokens:!0})}function Ie(e,t){var r=t.hour,n=void 0===r?0:r,o=t.minute,i=void 0===o?0:o,a=t.second;return M(O(I(e,void 0===a?0:a),i),n)}function Oe(e,t){var r=t&&He(t)||qe()&&He(qe());return E(e,r?{locale:r}:null)}function Me(e,t){return Pe(e,"ddd",t)}function De(e){return U(e)}function ze(e,t){var r=He(t||qe());return q(e,{locale:r})}function je(e){return H(e)}function Re(e){return W(e)}function Le(e,t){return e&&t?Q(e,t):!e&&!t}function Ne(e,t){return e&&t?J(e,t):!e&&!t}function Be(e,t){return e&&t?ee(e,t):!e&&!t}function Fe(e,t){return e&&t?X(e,t):!e&&!t}function Ve(e,t){return e&&t?K(e,t):!e&&!t}function Ue(e,t,r){var n,o=U(t),i=Z(r);try{n=ne(e,{start:o,end:i})}catch(e){n=!1}return n}function qe(){return("undefined"!=typeof window?window:e).__localeId__}function He(t){if("string"==typeof t){var r="undefined"!=typeof window?window:e;return r.__localeData__?r.__localeData__[t]:null}return t}function We(e,t){return Pe(D(Se(),e),"LLLL",t)}function Ge(e,t){return Pe(D(Se(),e),"LLL",t)}function Ze(e,t){return Pe(z(Se(),e),"QQQ",t)}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate;return et(e,{minDate:r,maxDate:n})||o&&o.some((function(t){return Fe(e,t)}))||i&&!i.some((function(t){return Fe(e,t)}))||a&&!a(Se(e))||!1}function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excludeDates;return r&&r.some((function(t){return Fe(e,t)}))||!1}function Ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate;return et(e,{minDate:r,maxDate:n})||o&&o.some((function(t){return Ne(e,t)}))||i&&!i.some((function(t){return Ne(e,t)}))||a&&!a(Se(e))||!1}function Xe(e,t,r,n){var o=A(e),i=S(e),a=A(t),s=S(t),l=A(n);return o===a&&o===l?i<=r&&r<=s:o<a?l===o&&i<=r||l===a&&s>=r||l<a&&l>o:void 0}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate;return et(e,{minDate:r,maxDate:n})||o&&o.some((function(t){return Be(e,t)}))||i&&!i.some((function(t){return Be(e,t)}))||a&&!a(Se(e))||!1}function Qe(e,t,r,n){var o=A(e),i=T(e),a=A(t),s=T(t),l=A(n);return o===a&&o===l?i<=r&&r<=s:o<a?l===o&&i<=r||l===a&&s>=r||l<a&&l>o:void 0}function et(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.maxDate;return r&&N(e,r)<0||n&&N(e,n)>0}function tt(e,t){for(var r=t.length,n=0;n<r;n++)if(x(t[n])===x(e)&&w(t[n])===w(e))return!0;return!1}function rt(e,t){var r=t.minTime,n=t.maxTime;if(!r||!n)throw new Error("Both minTime and maxTime props required");var o,i=Se(),a=M(O(i,w(e)),x(e)),s=M(O(i,w(r)),x(r)),l=M(O(i,w(n)),x(n));try{o=!ne(a,{start:s,end:l})}catch(e){o=!1}return o}function nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.includeDates,o=v(e,1);return r&&B(r,o)>0||n&&n.every((function(e){return B(e,o)>0}))||!1}function ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.maxDate,n=t.includeDates,o=h(e,1);return r&&B(o,r)>0||n&&n.every((function(e){return B(o,e)>0}))||!1}function it(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.minDate,n=t.includeDates,o=y(e,1);return r&&V(r,o)>0||n&&n.every((function(e){return V(e,o)>0}))||!1}function at(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.maxDate,n=t.includeDates,o=p(e,1);return r&&V(o,r)>0||n&&n.every((function(e){return V(o,e)>0}))||!1}function st(e){var t=e.minDate,r=e.includeDates;if(r&&t){var n=r.filter((function(e){return N(e,t)>=0}));return R(n)}return r?R(r):t}function lt(e){var t=e.maxDate,r=e.includeDates;if(r&&t){var n=r.filter((function(e){return N(e,t)<=0}));return L(n)}return r?L(r):t}function ct(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"react-datepicker__day--highlighted",r=new Map,n=0,o=e.length;n<o;n++){var a=e[n];if(i(a)){var s=Pe(a,"MM.dd.yyyy"),l=r.get(s)||[];l.includes(t)||(l.push(t),r.set(s,l))}else if("object"===ce(a)){var c=Object.keys(a),u=c[0],d=a[c[0]];if("string"==typeof u&&d.constructor===Array)for(var h=0,p=d.length;h<p;h++){var f=Pe(d[h],"MM.dd.yyyy"),m=r.get(f)||[];m.includes(u)||(m.push(u),r.set(f,m))}}}return r}function ut(e,t,r,n,o){for(var i=o.length,a=[],s=0;s<i;s++){var u=l(c(e,x(o[s])),w(o[s])),d=l(e,(r+1)*n);te(u,t)&&re(u,d)&&a.push(o[s])}return a}function dt(e){return e<10?"0".concat(e):"".concat(e)}function ht(e,t,r,n){for(var o=[],i=0;i<2*t+1;i++){var a=e+t-i,s=!0;r&&(s=A(r)<=a),n&&s&&(s=A(n)>=a),s&&o.push(a)}return o}var pt=se(function(e){be(n,e);var t=we(n);function n(e){var o;ue(this,n),pe(ye(o=t.call(this,e)),"renderOptions",(function(){var e=o.props.year,t=o.state.yearsList.map((function(t){return r.createElement("div",{className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:o.onChange.bind(ye(o),t)},e===t?r.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",t)})),n=o.props.minDate?A(o.props.minDate):null,i=o.props.maxDate?A(o.props.maxDate):null;return i&&o.state.yearsList.find((function(e){return e===i}))||t.unshift(r.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:o.incrementYears},r.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),n&&o.state.yearsList.find((function(e){return e===n}))||t.push(r.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:o.decrementYears},r.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t})),pe(ye(o),"onChange",(function(e){o.props.onChange(e)})),pe(ye(o),"handleClickOutside",(function(){o.props.onCancel()})),pe(ye(o),"shiftYears",(function(e){var t=o.state.yearsList.map((function(t){return t+e}));o.setState({yearsList:t})})),pe(ye(o),"incrementYears",(function(){return o.shiftYears(1)})),pe(ye(o),"decrementYears",(function(){return o.shiftYears(-1)}));var i=e.yearDropdownItemNumber,a=e.scrollableYearDropdown,s=i||(a?10:5);return o.state={yearsList:ht(o.props.year,s,o.props.minDate,o.props.maxDate)},o}return he(n,[{key:"render",value:function(){var e=o({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return r.createElement("div",{className:e},this.renderOptions())}}]),n}(r.Component)),ft=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"state",{dropdownVisible:!1}),pe(ye(e),"renderSelectOptions",(function(){for(var t=e.props.minDate?A(e.props.minDate):1900,n=e.props.maxDate?A(e.props.maxDate):2100,o=[],i=t;i<=n;i++)o.push(r.createElement("option",{key:i,value:i},i));return o})),pe(ye(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),pe(ye(e),"renderSelectMode",(function(){return r.createElement("select",{value:e.props.year,className:"react-datepicker__year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),pe(ye(e),"renderReadView",(function(t){return r.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(t){return e.toggleDropdown(t)}},r.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},e.props.year))})),pe(ye(e),"renderDropdown",(function(){return r.createElement(pt,{key:"dropdown",year:e.props.year,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableYearDropdown:e.props.scrollableYearDropdown,yearDropdownItemNumber:e.props.yearDropdownItemNumber})})),pe(ye(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,r=[e.renderReadView(!t)];return t&&r.unshift(e.renderDropdown()),r})),pe(ye(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.year&&e.props.onChange(t)})),pe(ye(e),"toggleDropdown",(function(t){e.setState({dropdownVisible:!e.state.dropdownVisible},(function(){e.props.adjustDateOnChange&&e.handleYearChange(e.props.date,t)}))})),pe(ye(e),"handleYearChange",(function(t,r){e.onSelect(t,r),e.setOpen()})),pe(ye(e),"onSelect",(function(t,r){e.props.onSelect&&e.props.onSelect(t,r)})),pe(ye(e),"setOpen",(function(){e.props.setOpen&&e.props.setOpen(!0)})),e}return he(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return r.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(r.Component),mt=se(function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"renderOptions",(function(){return e.props.monthNames.map((function(t,n){return r.createElement("div",{className:e.props.month===n?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:t,onClick:e.onChange.bind(ye(e),n)},e.props.month===n?r.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",t)}))})),pe(ye(e),"onChange",(function(t){return e.props.onChange(t)})),pe(ye(e),"handleClickOutside",(function(){return e.props.onCancel()})),e}return he(n,[{key:"render",value:function(){return r.createElement("div",{className:"react-datepicker__month-dropdown"},this.renderOptions())}}]),n}(r.Component)),gt=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"state",{dropdownVisible:!1}),pe(ye(e),"renderSelectOptions",(function(e){return e.map((function(e,t){return r.createElement("option",{key:t,value:t},e)}))})),pe(ye(e),"renderSelectMode",(function(t){return r.createElement("select",{value:e.props.month,className:"react-datepicker__month-select",onChange:function(t){return e.onChange(t.target.value)}},e.renderSelectOptions(t))})),pe(ye(e),"renderReadView",(function(t,n){return r.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:e.toggleDropdown},r.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[e.props.month]))})),pe(ye(e),"renderDropdown",(function(t){return r.createElement(mt,{key:"dropdown",month:e.props.month,monthNames:t,onChange:e.onChange,onCancel:e.toggleDropdown})})),pe(ye(e),"renderScrollMode",(function(t){var r=e.state.dropdownVisible,n=[e.renderReadView(!r,t)];return r&&n.unshift(e.renderDropdown(t)),n})),pe(ye(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.month&&e.props.onChange(t)})),pe(ye(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return he(n,[{key:"render",value:function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return Ge(e,t.props.locale)}:function(e){return We(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return r.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(r.Component);function bt(e,t){for(var r=[],n=je(e),o=je(t);!te(n,o);)r.push(Se(n)),n=h(n,1);return r}var vt=se(function(e){be(n,e);var t=we(n);function n(e){var o;return ue(this,n),pe(ye(o=t.call(this,e)),"renderOptions",(function(){return o.state.monthYearsList.map((function(e){var t=P(e),n=Le(o.props.date,e)&&Ne(o.props.date,e);return r.createElement("div",{className:n?"react-datepicker__month-year-option --selected_month-year":"react-datepicker__month-year-option",key:t,onClick:o.onChange.bind(ye(o),t)},n?r.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",Pe(e,o.props.dateFormat))}))})),pe(ye(o),"onChange",(function(e){return o.props.onChange(e)})),pe(ye(o),"handleClickOutside",(function(){o.props.onCancel()})),o.state={monthYearsList:bt(o.props.minDate,o.props.maxDate)},o}return he(n,[{key:"render",value:function(){var e=o({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return r.createElement("div",{className:e},this.renderOptions())}}]),n}(r.Component)),yt=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"state",{dropdownVisible:!1}),pe(ye(e),"renderSelectOptions",(function(){for(var t=je(e.props.minDate),n=je(e.props.maxDate),o=[];!te(t,n);){var i=P(t);o.push(r.createElement("option",{key:i,value:i},Pe(t,e.props.dateFormat,e.props.locale))),t=h(t,1)}return o})),pe(ye(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),pe(ye(e),"renderSelectMode",(function(){return r.createElement("select",{value:P(je(e.props.date)),className:"react-datepicker__month-year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),pe(ye(e),"renderReadView",(function(t){var n=Pe(e.props.date,e.props.dateFormat,e.props.locale);return r.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:function(t){return e.toggleDropdown(t)}},r.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))})),pe(ye(e),"renderDropdown",(function(){return r.createElement(vt,{key:"dropdown",date:e.props.date,dateFormat:e.props.dateFormat,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableMonthYearDropdown:e.props.scrollableMonthYearDropdown})})),pe(ye(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,r=[e.renderReadView(!t)];return t&&r.unshift(e.renderDropdown()),r})),pe(ye(e),"onChange",(function(t){e.toggleDropdown();var r=Se(parseInt(t));Le(e.props.date,r)&&Ne(e.props.date,r)||e.props.onChange(r)})),pe(ye(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return he(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return r.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(r.Component),_t=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return pe(ye(e=t.call.apply(t,[this].concat(a))),"dayEl",r.createRef()),pe(ye(e),"handleClick",(function(t){!e.isDisabled()&&e.props.onClick&&e.props.onClick(t)})),pe(ye(e),"handleMouseEnter",(function(t){!e.isDisabled()&&e.props.onMouseEnter&&e.props.onMouseEnter(t)})),pe(ye(e),"handleOnKeyDown",(function(t){" "===t.key&&(t.preventDefault(),t.key="Enter"),e.props.handleOnKeyDown(t)})),pe(ye(e),"isSameDay",(function(t){return Fe(e.props.day,t)})),pe(ye(e),"isKeyboardSelected",(function(){return!e.props.disabledKeyboardNavigation&&!e.props.inline&&!e.isSameDay(e.props.selected)&&e.isSameDay(e.props.preSelection)})),pe(ye(e),"isDisabled",(function(){return Ye(e.props.day,e.props)})),pe(ye(e),"isExcluded",(function(){return $e(e.props.day,e.props)})),pe(ye(e),"getHighLightedClass",(function(t){var r=e.props,n=r.day,o=r.highlightDates;if(!o)return!1;var i=Pe(n,"MM.dd.yyyy");return o.get(i)})),pe(ye(e),"isInRange",(function(){var t=e.props,r=t.day,n=t.startDate,o=t.endDate;return!(!n||!o)&&Ue(r,n,o)})),pe(ye(e),"isInSelectingRange",(function(){var t=e.props,r=t.day,n=t.selectsStart,o=t.selectsEnd,i=t.selectingDate,a=t.startDate,s=t.endDate;return!(!n&&!o||!i||e.isDisabled())&&(n&&s&&(re(i,s)||Ve(i,s))?Ue(r,i,s):!(!o||!a||!te(i,a)&&!Ve(i,a))&&Ue(r,a,i))})),pe(ye(e),"isSelectingRangeStart",(function(){if(!e.isInSelectingRange())return!1;var t=e.props,r=t.day,n=t.selectingDate,o=t.startDate;return Fe(r,t.selectsStart?n:o)})),pe(ye(e),"isSelectingRangeEnd",(function(){if(!e.isInSelectingRange())return!1;var t=e.props,r=t.day,n=t.selectingDate,o=t.endDate;return Fe(r,t.selectsEnd?n:o)})),pe(ye(e),"isRangeStart",(function(){var t=e.props,r=t.day,n=t.startDate,o=t.endDate;return!(!n||!o)&&Fe(n,r)})),pe(ye(e),"isRangeEnd",(function(){var t=e.props,r=t.day,n=t.startDate,o=t.endDate;return!(!n||!o)&&Fe(o,r)})),pe(ye(e),"isWeekend",(function(){var t=k(e.props.day);return 0===t||6===t})),pe(ye(e),"isOutsideMonth",(function(){return void 0!==e.props.month&&e.props.month!==S(e.props.day)})),pe(ye(e),"getClassNames",(function(t){var r=e.props.dayClassName?e.props.dayClassName(t):void 0;return o("react-datepicker__day",r,"react-datepicker__day--"+Me(e.props.day),{"react-datepicker__day--disabled":e.isDisabled(),"react-datepicker__day--excluded":e.isExcluded(),"react-datepicker__day--selected":e.isSameDay(e.props.selected),"react-datepicker__day--keyboard-selected":e.isKeyboardSelected(),"react-datepicker__day--range-start":e.isRangeStart(),"react-datepicker__day--range-end":e.isRangeEnd(),"react-datepicker__day--in-range":e.isInRange(),"react-datepicker__day--in-selecting-range":e.isInSelectingRange(),"react-datepicker__day--selecting-range-start":e.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":e.isSelectingRangeEnd(),"react-datepicker__day--today":e.isSameDay(Se()),"react-datepicker__day--weekend":e.isWeekend(),"react-datepicker__day--outside-month":e.isOutsideMonth()},e.getHighLightedClass("react-datepicker__day--highlighted"))})),pe(ye(e),"getAriaLabel",(function(){var t=e.props,r=t.day,n=t.ariaLabelPrefixWhenEnabled,o=void 0===n?"Choose":n,i=t.ariaLabelPrefixWhenDisabled,a=void 0===i?"Not available":i,s=e.isDisabled()||e.isExcluded()?a:o;return"".concat(s," ").concat(Pe(r,"PPPP"))})),pe(ye(e),"getTabIndex",(function(t,r){var n=t||e.props.selected,o=r||e.props.preSelection;return e.isKeyboardSelected()||e.isSameDay(n)&&Fe(o,n)?0:-1})),pe(ye(e),"handleFocusDay",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!1;0===e.getTabIndex()&&!t.isInputFocused&&e.isSameDay(e.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(r=!0),e.props.containerRef&&e.props.containerRef.current&&e.props.containerRef.current.contains(document.activeElement)&&document.activeElement.classList.contains("react-datepicker__day")&&(r=!0)),r&&e.dayEl.current.focus()})),pe(ye(e),"render",(function(){return r.createElement("div",{ref:e.dayEl,className:e.getClassNames(e.props.day),onKeyDown:e.handleOnKeyDown,onClick:e.handleClick,onMouseEnter:e.handleMouseEnter,tabIndex:e.getTabIndex(),"aria-label":e.getAriaLabel(),role:"button","aria-disabled":e.isDisabled()},e.props.renderDayContents?e.props.renderDayContents(C(e.props.day),e.props.day):C(e.props.day))})),e}return he(n,[{key:"componentDidMount",value:function(){this.handleFocusDay()}},{key:"componentDidUpdate",value:function(e){this.handleFocusDay(e)}}]),n}(r.Component),wt=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return pe(ye(e=t.call.apply(t,[this].concat(o))),"handleClick",(function(t){e.props.onClick&&e.props.onClick(t)})),e}return he(n,[{key:"render",value:function(){var e=this.props,t=e.weekNumber,n=e.ariaLabelPrefix,i=void 0===n?"week ":n,a={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!e.onClick};return r.createElement("div",{className:o(a),"aria-label":"".concat(i," ").concat(this.props.weekNumber),onClick:this.handleClick},t)}}]),n}(r.Component),xt=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"handleDayClick",(function(t,r){e.props.onDayClick&&e.props.onDayClick(t,r)})),pe(ye(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),pe(ye(e),"handleWeekClick",(function(t,r,n){"function"==typeof e.props.onWeekSelect&&e.props.onWeekSelect(t,r,n),e.props.shouldCloseOnSelect&&e.props.setOpen(!1)})),pe(ye(e),"formatWeekNumber",(function(t){return e.props.formatWeekNumber?e.props.formatWeekNumber(t):Oe(t,e.props.locale)})),pe(ye(e),"renderDays",(function(){var t=ze(e.props.day,e.props.locale),n=[],o=e.formatWeekNumber(t);if(e.props.showWeekNumber){var i=e.props.onWeekSelect?e.handleWeekClick.bind(ye(e),t,o):void 0;n.push(r.createElement(wt,{key:"W",weekNumber:o,onClick:i,ariaLabelPrefix:e.props.ariaLabelPrefix}))}return n.concat([0,1,2,3,4,5,6].map((function(n){var o=u(t,n);return r.createElement(_t,{ariaLabelPrefixWhenEnabled:e.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:e.props.disabledDayAriaLabelPrefix,key:o.valueOf(),day:o,month:e.props.month,onClick:e.handleDayClick.bind(ye(e),o),onMouseEnter:e.handleDayMouseEnter.bind(ye(e),o),minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,includeDates:e.props.includeDates,inline:e.props.inline,highlightDates:e.props.highlightDates,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,renderDayContents:e.props.renderDayContents,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef})})))})),e}return he(n,[{key:"render",value:function(){return r.createElement("div",{className:"react-datepicker__week"},this.renderDays())}}],[{key:"defaultProps",get:function(){return{shouldCloseOnSelect:!0}}}]),n}(r.Component),kt=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return pe(ye(e=t.call.apply(t,[this].concat(a))),"handleDayClick",(function(t,r){e.props.onDayClick&&e.props.onDayClick(t,r,e.props.orderInDisplay)})),pe(ye(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),pe(ye(e),"handleMouseLeave",(function(){e.props.onMouseLeave&&e.props.onMouseLeave()})),pe(ye(e),"isRangeStartMonth",(function(t){var r=e.props,n=r.day,o=r.startDate,i=r.endDate;return!(!o||!i)&&Ne(D(n,t),o)})),pe(ye(e),"isRangeStartQuarter",(function(t){var r=e.props,n=r.day,o=r.startDate,i=r.endDate;return!(!o||!i)&&Be(z(n,t),o)})),pe(ye(e),"isRangeEndMonth",(function(t){var r=e.props,n=r.day,o=r.startDate,i=r.endDate;return!(!o||!i)&&Ne(D(n,t),i)})),pe(ye(e),"isRangeEndQuarter",(function(t){var r=e.props,n=r.day,o=r.startDate,i=r.endDate;return!(!o||!i)&&Be(z(n,t),i)})),pe(ye(e),"isWeekInMonth",(function(t){var r=e.props.day,n=u(t,6);return Ne(t,r)||Ne(n,r)})),pe(ye(e),"renderWeeks",(function(){for(var t=[],n=e.props.fixedHeight,o=ze(je(e.props.day),e.props.locale),i=0,a=!1;t.push(r.createElement(xt,{ariaLabelPrefix:e.props.weekAriaLabelPrefix,chooseDayAriaLabelPrefix:e.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:e.props.disabledDayAriaLabelPrefix,key:i,day:o,month:S(e.props.day),onDayClick:e.handleDayClick,onDayMouseEnter:e.handleDayMouseEnter,onWeekSelect:e.props.onWeekSelect,formatWeekNumber:e.props.formatWeekNumber,locale:e.props.locale,minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,includeDates:e.props.includeDates,inline:e.props.inline,highlightDates:e.props.highlightDates,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,showWeekNumber:e.props.showWeekNumbers,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,setOpen:e.props.setOpen,shouldCloseOnSelect:e.props.shouldCloseOnSelect,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,renderDayContents:e.props.renderDayContents,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef})),!a;){i++,o=d(o,1);var s=n&&i>=6,l=!n&&!e.isWeekInMonth(o);if(s||l){if(!e.props.peekNextMonth)break;a=!0}}return t})),pe(ye(e),"onMonthClick",(function(t,r){e.handleDayClick(je(D(e.props.day,r)),t)})),pe(ye(e),"onQuarterClick",(function(t,r){e.handleDayClick(Re(z(e.props.day,r)),t)})),pe(ye(e),"getMonthClassNames",(function(t){var r=e.props,n=r.day,i=r.startDate,a=r.endDate,s=r.selected,l=r.minDate,c=r.maxDate;return o("react-datepicker__month-text","react-datepicker__month-".concat(t),{"react-datepicker__month--disabled":(l||c)&&Ke(D(n,t),e.props),"react-datepicker__month--selected":S(n)===t&&A(n)===A(s),"react-datepicker__month--in-range":Xe(i,a,t,n),"react-datepicker__month--range-start":e.isRangeStartMonth(t),"react-datepicker__month--range-end":e.isRangeEndMonth(t)})})),pe(ye(e),"getQuarterClassNames",(function(t){var r=e.props,n=r.day,i=r.startDate,a=r.endDate,s=r.selected,l=r.minDate,c=r.maxDate;return o("react-datepicker__quarter-text","react-datepicker__quarter-".concat(t),{"react-datepicker__quarter--disabled":(l||c)&&Je(z(n,t),e.props),"react-datepicker__quarter--selected":T(n)===t&&A(n)===A(s),"react-datepicker__quarter--in-range":Qe(i,a,t,n),"react-datepicker__quarter--range-start":e.isRangeStartQuarter(t),"react-datepicker__quarter--range-end":e.isRangeEndQuarter(t)})})),pe(ye(e),"renderMonths",(function(){var t=e.props,n=t.showFullMonthYearPicker,o=t.locale;return[[0,1,2],[3,4,5],[6,7,8],[9,10,11]].map((function(t,i){return r.createElement("div",{className:"react-datepicker__month-wrapper",key:i},t.map((function(t,i){return r.createElement("div",{key:i,onClick:function(r){e.onMonthClick(r,t)},className:e.getMonthClassNames(t)},n?We(t,o):Ge(t,o))})))}))})),pe(ye(e),"renderQuarters",(function(){return r.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map((function(t,n){return r.createElement("div",{key:n,onClick:function(r){e.onQuarterClick(r,t)},className:e.getQuarterClassNames(t)},Ze(t,e.props.locale))})))})),pe(ye(e),"getClassNames",(function(){var t=e.props,r=t.selectingDate,n=t.selectsStart,i=t.selectsEnd,a=t.showMonthYearPicker,s=t.showQuarterYearPicker;return o("react-datepicker__month",{"react-datepicker__month--selecting-range":r&&(n||i)},{"react-datepicker__monthPicker":a},{"react-datepicker__quarterPicker":s})})),e}return he(n,[{key:"render",value:function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,o=e.day,i=e.ariaLabelPrefix,a=void 0===i?"month ":i;return r.createElement("div",{className:this.getClassNames(),onMouseLeave:this.handleMouseLeave,"aria-label":"".concat(a," ").concat(Pe(o,"yyyy-MM"))},t?this.renderMonths():n?this.renderQuarters():this.renderWeeks())}}]),n}(r.Component),Ct=function(e){be(n,e);var t=we(n);function n(){var e;ue(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pe(ye(e=t.call.apply(t,[this].concat(i))),"state",{height:null}),pe(ye(e),"handleClick",(function(t){(e.props.minTime||e.props.maxTime)&&rt(t,e.props)||e.props.excludeTimes&&tt(t,e.props.excludeTimes)||e.props.includeTimes&&!tt(t,e.props.includeTimes)||e.props.onChange(t)})),pe(ye(e),"liClasses",(function(t,r,n){var o=["react-datepicker__time-list-item",e.props.timeClassName?e.props.timeClassName(t,r,n):void 0];return e.props.selected&&r===x(t)&&n===w(t)&&o.push("react-datepicker__time-list-item--selected"),((e.props.minTime||e.props.maxTime)&&rt(t,e.props)||e.props.excludeTimes&&tt(t,e.props.excludeTimes)||e.props.includeTimes&&!tt(t,e.props.includeTimes))&&o.push("react-datepicker__time-list-item--disabled"),e.props.injectTimes&&(60*x(t)+w(t))%e.props.intervals!=0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")})),pe(ye(e),"renderTimes",(function(){for(var t=[],n=e.props.format?e.props.format:"p",o=e.props.intervals,i=e.props.selected||e.props.openToDate||Se(),a=x(i),s=w(i),c=De(Se()),u=1440/o,d=e.props.injectTimes&&e.props.injectTimes.sort((function(e,t){return e-t})),h=0;h<u;h++){var p=l(c,h*o);if(t.push(p),d){var f=ut(c,p,h,o,d);t=t.concat(f)}}return t.map((function(t,o){return r.createElement("li",{key:o,onClick:e.handleClick.bind(ye(e),t),className:e.liClasses(t,a,s),ref:function(r){a===x(t)&&s>=w(t)&&(e.centerLi=r)}},Pe(t,n,e.props.locale))}))})),e}return he(n,[{key:"componentDidMount",value:function(){this.list.scrollTop=n.calcCenterPosition(this.props.monthRef?this.props.monthRef.clientHeight-this.header.clientHeight:this.list.clientHeight,this.centerLi),this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})}},{key:"render",value:function(){var e=this,t=this.state.height;return r.createElement("div",{className:"react-datepicker__time-container ".concat(this.props.todayButton?"react-datepicker__time-container--with-today-button":"")},r.createElement("div",{className:"react-datepicker__header react-datepicker__header--time",ref:function(t){e.header=t}},r.createElement("div",{className:"react-datepicker-time__header"},this.props.timeCaption)),r.createElement("div",{className:"react-datepicker__time"},r.createElement("div",{className:"react-datepicker__time-box"},r.createElement("ul",{className:"react-datepicker__time-list",ref:function(t){e.list=t},style:t?{height:t}:{}},this.renderTimes()))))}}],[{key:"defaultProps",get:function(){return{intervals:30,onTimeChange:function(){},todayButton:null,timeCaption:"Time"}}}]),n}(r.Component);pe(Ct,"calcCenterPosition",(function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)}));var Et=function(e){be(n,e);var t=we(n);function n(e){var r;return ue(this,n),pe(ye(r=t.call(this,e)),"handleYearClick",(function(e,t){r.props.onDayClick&&r.props.onDayClick(e,t)})),pe(ye(r),"onYearClick",(function(e,t){var n;r.handleYearClick((n=j(r.props.date,t),G(n)),e)})),r}return he(n,[{key:"render",value:function(){for(var e=this,t=[],n=this.props.date,o=function(n,o){t.push(r.createElement("div",{onClick:function(t){e.onYearClick(t,n)},className:"react-datepicker__year-container-text",key:n},n))},i=A(n)-11,a=0;i<=A(n);i++,a++)o(i);return r.createElement("div",{className:"react-datepicker__year-container"},t)}}]),n}(r.Component),St=function(e){be(n,e);var t=we(n);function n(e){var o;return ue(this,n),pe(ye(o=t.call(this,e)),"onTimeChange",(function(e){o.setState({time:e});var t=new Date;t.setHours(e.split(":")[0]),t.setMinutes(e.split(":")[1]),o.props.onChange(t)})),pe(ye(o),"renderTimeInput",(function(){var e=o.state.time,t=o.props,n=t.timeString,i=t.customTimeInput;return i?r.cloneElement(i,{value:e,onChange:o.onTimeChange}):r.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",required:!0,value:e,onChange:function(e){o.onTimeChange(e.target.value||n)}})})),o.state={time:o.props.timeString},o}return he(n,[{key:"render",value:function(){return r.createElement("div",{className:"react-datepicker__input-time-container"},r.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),r.createElement("div",{className:"react-datepicker-time__input-container"},r.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))}}]),n}(r.Component);function Tt(e){var t=e.className,n=e.children,o=e.showPopperArrow,i=e.arrowProps,a=void 0===i?{}:i;return r.createElement("div",{className:t},o&&r.createElement("div",fe({className:"react-datepicker__triangle"},a)),n)}var At=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],Pt=function(e){be(n,e);var t=we(n);function n(e){var i;return ue(this,n),pe(ye(i=t.call(this,e)),"handleClickOutside",(function(e){i.props.onClickOutside(e)})),pe(ye(i),"setClickOutsideRef",(function(){return i.containerRef.current})),pe(ye(i),"handleDropdownFocus",(function(e){(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.className||"").split(/\s+/);return At.some((function(e){return t.indexOf(e)>=0}))})(e.target)&&i.props.onDropdownFocus()})),pe(ye(i),"getDateInView",(function(){var e=i.props,t=e.preSelection,r=e.selected,n=e.openToDate,o=st(i.props),a=lt(i.props),s=Se();return n||r||t||(o&&re(s,o)?o:a&&te(s,a)?a:s)})),pe(ye(i),"increaseMonth",(function(){i.setState((function(e){var t=e.date;return{date:h(t,1)}}),(function(){return i.handleMonthChange(i.state.date)}))})),pe(ye(i),"decreaseMonth",(function(){i.setState((function(e){var t=e.date;return{date:v(t,1)}}),(function(){return i.handleMonthChange(i.state.date)}))})),pe(ye(i),"handleDayClick",(function(e,t,r){return i.props.onSelect(e,t,r)})),pe(ye(i),"handleDayMouseEnter",(function(e){i.setState({selectingDate:e}),i.props.onDayMouseEnter&&i.props.onDayMouseEnter(e)})),pe(ye(i),"handleMonthMouseLeave",(function(){i.setState({selectingDate:null}),i.props.onMonthMouseLeave&&i.props.onMonthMouseLeave()})),pe(ye(i),"handleYearChange",(function(e){i.props.onYearChange&&i.props.onYearChange(e)})),pe(ye(i),"handleMonthChange",(function(e){i.props.onMonthChange&&i.props.onMonthChange(e),i.props.adjustDateOnChange&&(i.props.onSelect&&i.props.onSelect(e),i.props.setOpen&&i.props.setOpen(!0)),i.props.setPreSelection&&i.props.setPreSelection(e)})),pe(ye(i),"handleMonthYearChange",(function(e){i.handleYearChange(e),i.handleMonthChange(e)})),pe(ye(i),"changeYear",(function(e){i.setState((function(t){var r=t.date;return{date:j(r,e)}}),(function(){return i.handleYearChange(i.state.date)}))})),pe(ye(i),"changeMonth",(function(e){i.setState((function(t){var r=t.date;return{date:D(r,e)}}),(function(){return i.handleMonthChange(i.state.date)}))})),pe(ye(i),"changeMonthYear",(function(e){i.setState((function(t){var r=t.date;return{date:j(D(r,S(e)),A(e))}}),(function(){return i.handleMonthYearChange(i.state.date)}))})),pe(ye(i),"header",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.state.date,t=ze(e,i.props.locale),n=[];return i.props.showWeekNumbers&&n.push(r.createElement("div",{key:"W",className:"react-datepicker__day-name"},i.props.weekLabel||"#")),n.concat([0,1,2,3,4,5,6].map((function(e){var n=u(t,e),a=i.formatWeekday(n,i.props.locale),s=i.props.weekDayClassName?i.props.weekDayClassName(n):void 0;return r.createElement("div",{key:e,className:o("react-datepicker__day-name",s)},a)})))})),pe(ye(i),"formatWeekday",(function(e,t){return i.props.formatWeekDay?function(e,t,r){return t(Pe(e,"EEEE",r))}(e,i.props.formatWeekDay,t):i.props.useWeekdaysShort?function(e,t){return Pe(e,"EEE",t)}(e,t):function(e,t){return Pe(e,"EEEEEE",t)}(e,t)})),pe(ye(i),"decreaseYear",(function(){i.setState((function(e){var t=e.date;return{date:y(t,i.props.showYearPicker?11:1)}}),(function(){return i.handleYearChange(i.state.date)}))})),pe(ye(i),"renderPreviousButton",(function(){if(!i.props.renderCustomHeader){var e=i.props.showMonthYearPicker?it(i.state.date,i.props):nt(i.state.date,i.props);if((i.props.forceShowMonthNavigation||i.props.showDisabledMonthNavigation||!e)&&!i.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--previous"],n=i.decreaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(n=i.decreaseYear),e&&i.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--previous--disabled"),n=null);var o=i.props.showMonthYearPicker||i.props.showQuarterYearPicker,a=i.props,s=a.previousMonthAriaLabel,l=void 0===s?"Previous Month":s,c=a.previousYearAriaLabel,u=void 0===c?"Previous Year":c;return r.createElement("button",{type:"button",className:t.join(" "),onClick:n,"aria-label":o?u:l},o?i.props.previousYearButtonLabel:i.props.previousMonthButtonLabel)}}})),pe(ye(i),"increaseYear",(function(){i.setState((function(e){var t=e.date;return{date:p(t,i.props.showYearPicker?11:1)}}),(function(){return i.handleYearChange(i.state.date)}))})),pe(ye(i),"renderNextButton",(function(){if(!i.props.renderCustomHeader){var e=i.props.showMonthYearPicker?at(i.state.date,i.props):ot(i.state.date,i.props);if((i.props.forceShowMonthNavigation||i.props.showDisabledMonthNavigation||!e)&&!i.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--next"];i.props.showTimeSelect&&t.push("react-datepicker__navigation--next--with-time"),i.props.todayButton&&t.push("react-datepicker__navigation--next--with-today-button");var n=i.increaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(n=i.increaseYear),e&&i.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--next--disabled"),n=null);var o=i.props.showMonthYearPicker||i.props.showQuarterYearPicker,a=i.props,s=a.nextMonthAriaLabel,l=void 0===s?"Next Month":s,c=a.nextYearAriaLabel,u=void 0===c?"Next Year":c;return r.createElement("button",{type:"button",className:t.join(" "),onClick:n,"aria-label":o?u:l},o?i.props.nextYearButtonLabel:i.props.nextMonthButtonLabel)}}})),pe(ye(i),"renderCurrentMonth",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.state.date,t=["react-datepicker__current-month"];return i.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),i.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),i.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),r.createElement("div",{className:t.join(" ")},Pe(e,i.props.dateFormat,i.props.locale))})),pe(ye(i),"renderYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i.props.showYearDropdown&&!e)return r.createElement(ft,{adjustDateOnChange:i.props.adjustDateOnChange,date:i.state.date,onSelect:i.props.onSelect,setOpen:i.props.setOpen,dropdownMode:i.props.dropdownMode,onChange:i.changeYear,minDate:i.props.minDate,maxDate:i.props.maxDate,year:A(i.state.date),scrollableYearDropdown:i.props.scrollableYearDropdown,yearDropdownItemNumber:i.props.yearDropdownItemNumber})})),pe(ye(i),"renderMonthDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i.props.showMonthDropdown&&!e)return r.createElement(gt,{dropdownMode:i.props.dropdownMode,locale:i.props.locale,onChange:i.changeMonth,month:S(i.state.date),useShortMonthInDropdown:i.props.useShortMonthInDropdown})})),pe(ye(i),"renderMonthYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i.props.showMonthYearDropdown&&!e)return r.createElement(yt,{dropdownMode:i.props.dropdownMode,locale:i.props.locale,dateFormat:i.props.dateFormat,onChange:i.changeMonthYear,minDate:i.props.minDate,maxDate:i.props.maxDate,date:i.state.date,scrollableMonthYearDropdown:i.props.scrollableMonthYearDropdown})})),pe(ye(i),"renderTodayButton",(function(){if(i.props.todayButton&&!i.props.showTimeSelectOnly)return r.createElement("div",{className:"react-datepicker__today-button",onClick:function(e){return i.props.onSelect(U(Se()),e)}},i.props.todayButton)})),pe(ye(i),"renderDefaultHeader",(function(e){var t=e.monthDate,n=e.i;return r.createElement("div",{className:"react-datepicker__header"},i.renderCurrentMonth(t),r.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(i.props.dropdownMode),onFocus:i.handleDropdownFocus},i.renderMonthDropdown(0!==n),i.renderMonthYearDropdown(0!==n),i.renderYearDropdown(0!==n)),r.createElement("div",{className:"react-datepicker__day-names"},i.header(t)))})),pe(ye(i),"renderCustomHeader",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.monthDate,n=e.i;if(0!==n&&void 0!==n)return null;var o=nt(i.state.date,i.props),a=ot(i.state.date,i.props),s=it(i.state.date,i.props),l=at(i.state.date,i.props),c=!i.props.showMonthYearPicker&&!i.props.showQuarterYearPicker&&!i.props.showYearPicker;return r.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:i.props.onDropdownFocus},i.props.renderCustomHeader(ge(ge({},i.state),{},{changeMonth:i.changeMonth,changeYear:i.changeYear,decreaseMonth:i.decreaseMonth,increaseMonth:i.increaseMonth,decreaseYear:i.decreaseYear,increaseYear:i.increaseYear,prevMonthButtonDisabled:o,nextMonthButtonDisabled:a,prevYearButtonDisabled:s,nextYearButtonDisabled:l})),c&&r.createElement("div",{className:"react-datepicker__day-names"},i.header(t)))})),pe(ye(i),"renderYearHeader",(function(){return r.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},i.props.showYearPicker?"".concat(A(i.state.date)-11," - ").concat(A(i.state.date)):A(i.state.date))})),pe(ye(i),"renderHeader",(function(e){switch(!0){case void 0!==i.props.renderCustomHeader:return i.renderCustomHeader(e);case i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker:return i.renderYearHeader(e);default:return i.renderDefaultHeader(e)}})),pe(ye(i),"renderMonths",(function(){if(!i.props.showTimeSelectOnly&&!i.props.showYearPicker){for(var e=[],t=i.props.showPreviousMonths?i.props.monthsShown-1:0,n=v(i.state.date,t),o=0;o<i.props.monthsShown;++o){var a=o-i.props.monthSelectedIn,s=h(n,a),l="month-".concat(o);e.push(r.createElement("div",{key:l,ref:function(e){i.monthContainer=e},className:"react-datepicker__month-container"},i.renderHeader({monthDate:s,i:o}),r.createElement(kt,{chooseDayAriaLabelPrefix:i.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:i.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:i.props.weekAriaLabelPrefix,onChange:i.changeMonthYear,day:s,dayClassName:i.props.dayClassName,monthClassName:i.props.monthClassName,onDayClick:i.handleDayClick,handleOnKeyDown:i.props.handleOnKeyDown,onDayMouseEnter:i.handleDayMouseEnter,onMouseLeave:i.handleMonthMouseLeave,onWeekSelect:i.props.onWeekSelect,orderInDisplay:o,formatWeekNumber:i.props.formatWeekNumber,locale:i.props.locale,minDate:i.props.minDate,maxDate:i.props.maxDate,excludeDates:i.props.excludeDates,highlightDates:i.props.highlightDates,selectingDate:i.state.selectingDate,includeDates:i.props.includeDates,inline:i.props.inline,fixedHeight:i.props.fixedHeight,filterDate:i.props.filterDate,preSelection:i.props.preSelection,selected:i.props.selected,selectsStart:i.props.selectsStart,selectsEnd:i.props.selectsEnd,showWeekNumbers:i.props.showWeekNumbers,startDate:i.props.startDate,endDate:i.props.endDate,peekNextMonth:i.props.peekNextMonth,setOpen:i.props.setOpen,shouldCloseOnSelect:i.props.shouldCloseOnSelect,renderDayContents:i.props.renderDayContents,disabledKeyboardNavigation:i.props.disabledKeyboardNavigation,showMonthYearPicker:i.props.showMonthYearPicker,showFullMonthYearPicker:i.props.showFullMonthYearPicker,showYearPicker:i.props.showYearPicker,showQuarterYearPicker:i.props.showQuarterYearPicker,isInputFocused:i.props.isInputFocused,containerRef:i.containerRef})))}return e}})),pe(ye(i),"renderYears",(function(){if(!i.props.showTimeSelectOnly)return i.props.showYearPicker?r.createElement("div",{className:"react-datepicker__year"},i.renderHeader(),r.createElement(Et,{onDayClick:i.handleDayClick,date:i.state.date})):void 0})),pe(ye(i),"renderTimeSection",(function(){if(i.props.showTimeSelect&&(i.state.monthContainer||i.props.showTimeSelectOnly))return r.createElement(Ct,{selected:i.props.selected,openToDate:i.props.openToDate,onChange:i.props.onTimeChange,timeClassName:i.props.timeClassName,format:i.props.timeFormat,includeTimes:i.props.includeTimes,intervals:i.props.timeIntervals,minTime:i.props.minTime,maxTime:i.props.maxTime,excludeTimes:i.props.excludeTimes,timeCaption:i.props.timeCaption,todayButton:i.props.todayButton,showMonthDropdown:i.props.showMonthDropdown,showMonthYearDropdown:i.props.showMonthYearDropdown,showYearDropdown:i.props.showYearDropdown,withPortal:i.props.withPortal,monthRef:i.state.monthContainer,injectTimes:i.props.injectTimes,locale:i.props.locale})})),pe(ye(i),"renderInputTimeSection",(function(){var e=new Date(i.props.selected),t="".concat(dt(e.getHours()),":").concat(dt(e.getMinutes()));if(i.props.showTimeInput)return r.createElement(St,{timeString:t,timeInputLabel:i.props.timeInputLabel,onChange:i.props.onTimeChange,customTimeInput:i.props.customTimeInput})})),i.containerRef=r.createRef(),i.state={date:i.getDateInView(),selectingDate:null,monthContainer:null},i}return he(n,null,[{key:"defaultProps",get:function(){return{onDropdownFocus:function(){},monthsShown:1,monthSelectedIn:0,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",customTimeInput:null}}}]),he(n,[{key:"componentDidMount",value:function(){this.props.showTimeSelect&&(this.assignMonthContainer=void this.setState({monthContainer:this.monthContainer}))}},{key:"componentDidUpdate",value:function(e){this.props.preSelection&&!Fe(this.props.preSelection,e.preSelection)?this.setState({date:this.props.preSelection}):this.props.openToDate&&!Fe(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate})}},{key:"render",value:function(){var e=this.props.container||Tt;return r.createElement("div",{ref:this.containerRef},r.createElement(e,{className:o("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showPopperArrow:this.props.showPopperArrow},this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.props.children))}}]),n}(r.Component),It=function(e){return!e.disabled&&-1!==e.tabIndex},Ot=function(e){be(n,e);var t=we(n);function n(e){var o;return ue(this,n),pe(ye(o=t.call(this,e)),"getTabChildren",(function(){return Array.prototype.slice.call(o.tabLoopRef.current.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(It)})),pe(ye(o),"handleFocusStart",(function(e){var t=o.getTabChildren();t&&t.length>1&&t[t.length-1].focus()})),pe(ye(o),"handleFocusEnd",(function(e){var t=o.getTabChildren();t&&t.length>1&&t[0].focus()})),o.tabLoopRef=r.createRef(),o}return he(n,null,[{key:"defaultProps",get:function(){return{enableTabLoop:!0}}}]),he(n,[{key:"render",value:function(){return this.props.enableTabLoop?r.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},r.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:"0",onFocus:this.handleFocusStart}),this.props.children,r.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:"0",onFocus:this.handleFocusEnd})):this.props.children}}]),n}(r.Component),Mt=function(e){be(n,e);var t=we(n);function n(){return ue(this,n),t.apply(this,arguments)}return he(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,i=t.wrapperClassName,a=t.hidePopper,s=t.popperComponent,l=t.popperModifiers,c=t.popperPlacement,u=t.popperProps,d=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown;if(!a){var f=o("react-datepicker-popper",n);e=r.createElement(le.Popper,fe({modifiers:l,placement:c},u),(function(e){var t=e.ref,n=e.style,o=e.placement,i=e.arrowProps;return r.createElement(Ot,{enableTabLoop:h},r.createElement("div",fe({ref:t,style:n},{className:f,"data-placement":o,onKeyDown:p}),r.cloneElement(s,{arrowProps:i})))}))}this.props.popperContainer&&(e=r.createElement(this.props.popperContainer,{},e));var m=o("react-datepicker-wrapper",i);return r.createElement(le.Manager,{className:"react-datepicker-manager"},r.createElement(le.Reference,null,(function(e){var t=e.ref;return r.createElement("div",{ref:t,className:m},d)})),e)}}],[{key:"defaultProps",get:function(){return{hidePopper:!0,popperModifiers:{preventOverflow:{enabled:!0,escapeWithReference:!0,boundariesElement:"viewport"}},popperProps:{},popperPlacement:"bottom-start"}}}]),n}(r.Component),Dt=se(Pt),zt=function(e){be(n,e);var t=we(n);function n(e){var a;return ue(this,n),pe(ye(a=t.call(this,e)),"getPreSelection",(function(){return a.props.openToDate?a.props.openToDate:a.props.selectsEnd&&a.props.startDate?a.props.startDate:a.props.selectsStart&&a.props.endDate?a.props.endDate:Se()})),pe(ye(a),"calcInitialState",(function(){var e=a.getPreSelection(),t=st(a.props),r=lt(a.props),n=t&&re(e,t)?t:r&&te(e,r)?r:e;return{open:a.props.startOpen||!1,preventFocus:!1,preSelection:a.props.selected?a.props.selected:n,highlightDates:ct(a.props.highlightDates),focused:!1}})),pe(ye(a),"clearPreventFocusTimeout",(function(){a.preventFocusTimeout&&clearTimeout(a.preventFocusTimeout)})),pe(ye(a),"setFocus",(function(){a.input&&a.input.focus&&a.input.focus()})),pe(ye(a),"setBlur",(function(){a.input&&a.input.blur&&a.input.blur(),a.cancelFocusInput()})),pe(ye(a),"setOpen",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.setState({open:e,preSelection:e&&a.state.open?a.state.preSelection:a.calcInitialState().preSelection,lastPreSelectChange:Rt},(function(){e||a.setState((function(e){return{focused:!!t&&e.focused}}),(function(){!t&&a.setBlur(),a.setState({inputValue:null})}))}))})),pe(ye(a),"inputOk",(function(){return i(a.state.preSelection)})),pe(ye(a),"isCalendarOpen",(function(){return void 0===a.props.open?a.state.open&&!a.props.disabled&&!a.props.readOnly:a.props.open})),pe(ye(a),"handleFocus",(function(e){a.state.preventFocus||(a.props.onFocus(e),a.props.preventOpenOnFocus||a.props.readOnly||a.setOpen(!0)),a.setState({focused:!0})})),pe(ye(a),"cancelFocusInput",(function(){clearTimeout(a.inputFocusTimeout),a.inputFocusTimeout=null})),pe(ye(a),"deferFocusInput",(function(){a.cancelFocusInput(),a.inputFocusTimeout=setTimeout((function(){return a.setFocus()}),1)})),pe(ye(a),"handleDropdownFocus",(function(){a.cancelFocusInput()})),pe(ye(a),"handleBlur",(function(e){(!a.state.open||a.props.withPortal||a.props.showTimeInput)&&a.props.onBlur(e),a.setState({focused:!1})})),pe(ye(a),"handleCalendarClickOutside",(function(e){a.props.inline||a.setOpen(!1),a.props.onClickOutside(e),a.props.withPortal&&e.preventDefault()})),pe(ye(a),"handleChange",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0];if(!a.props.onChangeRaw||(a.props.onChangeRaw.apply(ye(a),t),"function"==typeof n.isDefaultPrevented&&!n.isDefaultPrevented())){a.setState({inputValue:n.target.value,lastPreSelectChange:jt});var o=Te(n.target.value,a.props.dateFormat,a.props.locale,a.props.strictParsing);!o&&n.target.value||a.setSelected(o,n,!0)}})),pe(ye(a),"handleSelect",(function(e,t,r){a.setState({preventFocus:!0},(function(){return a.preventFocusTimeout=setTimeout((function(){return a.setState({preventFocus:!1})}),50),a.preventFocusTimeout})),a.setSelected(e,t,!1,r),!a.props.shouldCloseOnSelect||a.props.showTimeSelect?a.setPreSelection(e):a.props.inline||a.setOpen(!1)})),pe(ye(a),"setSelected",(function(e,t,r,n){var o=e;null!==o&&Ye(o,a.props)||(Ve(a.props.selected,o)&&!a.props.allowSameDay||(null!==o&&(!a.props.selected||r&&(a.props.showTimeSelect||a.props.showTimeSelectOnly||a.props.showTimeInput)||(o=Ie(o,{hour:x(a.props.selected),minute:w(a.props.selected),second:_(a.props.selected)})),a.props.inline||a.setState({preSelection:o}),a.props.inline&&a.props.monthsShown>1&&!a.props.inlineFocusSelectedMonth&&a.setState({monthSelectedIn:n})),a.props.onChange(o,t)),a.props.onSelect(o,t),r||a.setState({inputValue:null}))})),pe(ye(a),"setPreSelection",(function(e){var t=void 0!==a.props.minDate,r=void 0!==a.props.maxDate,n=!0;e&&(t&&r?n=Ue(e,a.props.minDate,a.props.maxDate):t?n=te(e,a.props.minDate):r&&(n=re(e,a.props.maxDate))),n&&a.setState({preSelection:e})})),pe(ye(a),"handleTimeChange",(function(e){var t=Ie(a.props.selected?a.props.selected:a.getPreSelection(),{hour:x(e),minute:w(e)});a.setState({preSelection:t}),a.props.onChange(t),a.props.shouldCloseOnSelect&&a.setOpen(!1),a.props.showTimeInput&&a.setOpen(!0),a.setState({inputValue:null})})),pe(ye(a),"onInputClick",(function(){a.props.disabled||a.props.readOnly||a.setOpen(!0),a.props.onInputClick()})),pe(ye(a),"onInputKeyDown",(function(e){a.props.onKeyDown(e);var t=e.key;if(a.state.open||a.props.inline||a.props.preventOpenOnFocus){if(a.state.open){if("ArrowDown"===t||"ArrowUp"===t){e.preventDefault();var r=a.calendar.componentNode&&a.calendar.componentNode.querySelector('.react-datepicker__day[tabindex="0"]');return void(r&&r.focus())}var n=Se(a.state.preSelection);"Enter"===t?(e.preventDefault(),a.inputOk()&&a.state.lastPreSelectChange===Rt?(a.handleSelect(n,e),!a.props.shouldCloseOnSelect&&a.setPreSelection(n)):a.setOpen(!1)):"Escape"===t&&(e.preventDefault(),a.setOpen(!1)),a.inputOk()||a.props.onInputError({code:1,msg:"Date input not valid."})}}else"ArrowDown"!==t&&"ArrowUp"!==t&&"Enter"!==t||a.onInputClick()})),pe(ye(a),"onDayKeyDown",(function(e){a.props.onKeyDown(e);var t=e.key,r=Se(a.state.preSelection);if("Enter"===t)e.preventDefault(),a.handleSelect(r,e),!a.props.shouldCloseOnSelect&&a.setPreSelection(r);else if("Escape"===t)e.preventDefault(),a.setOpen(!1),a.inputOk()||a.props.onInputError({code:1,msg:"Date input not valid."});else if(!a.props.disabledKeyboardNavigation){var n;switch(t){case"ArrowLeft":n=g(r,1);break;case"ArrowRight":n=u(r,1);break;case"ArrowUp":n=b(r,1);break;case"ArrowDown":n=d(r,1);break;case"PageUp":n=v(r,1);break;case"PageDown":n=h(r,1);break;case"Home":n=y(r,1);break;case"End":n=p(r,1)}if(!n)return void(a.props.onInputError&&a.props.onInputError({code:1,msg:"Date input not valid."}));e.preventDefault(),a.setState({lastPreSelectChange:Rt}),a.props.adjustDateOnChange&&a.setSelected(n),a.setPreSelection(n)}})),pe(ye(a),"onPopperKeyDown",(function(e){"Escape"===e.key&&(e.preventDefault(),a.setState({preventFocus:!0},(function(){a.setOpen(!1),setTimeout((function(){a.setFocus(),a.setState({preventFocus:!1})}))})))})),pe(ye(a),"onClearClick",(function(e){e&&e.preventDefault&&e.preventDefault(),a.props.onChange(null,e),a.setState({inputValue:null})})),pe(ye(a),"clear",(function(){a.onClearClick()})),pe(ye(a),"renderCalendar",(function(){return a.props.inline||a.isCalendarOpen()?r.createElement(Dt,{ref:function(e){a.calendar=e},locale:a.props.locale,chooseDayAriaLabelPrefix:a.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:a.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:a.props.weekAriaLabelPrefix,adjustDateOnChange:a.props.adjustDateOnChange,setOpen:a.setOpen,shouldCloseOnSelect:a.props.shouldCloseOnSelect,dateFormat:a.props.dateFormatCalendar,useWeekdaysShort:a.props.useWeekdaysShort,formatWeekDay:a.props.formatWeekDay,dropdownMode:a.props.dropdownMode,selected:a.props.selected,preSelection:a.state.preSelection,onSelect:a.handleSelect,onWeekSelect:a.props.onWeekSelect,openToDate:a.props.openToDate,minDate:a.props.minDate,maxDate:a.props.maxDate,selectsStart:a.props.selectsStart,selectsEnd:a.props.selectsEnd,startDate:a.props.startDate,endDate:a.props.endDate,excludeDates:a.props.excludeDates,filterDate:a.props.filterDate,onClickOutside:a.handleCalendarClickOutside,formatWeekNumber:a.props.formatWeekNumber,highlightDates:a.state.highlightDates,includeDates:a.props.includeDates,includeTimes:a.props.includeTimes,injectTimes:a.props.injectTimes,inline:a.props.inline,peekNextMonth:a.props.peekNextMonth,showMonthDropdown:a.props.showMonthDropdown,showPreviousMonths:a.props.showPreviousMonths,useShortMonthInDropdown:a.props.useShortMonthInDropdown,showMonthYearDropdown:a.props.showMonthYearDropdown,showWeekNumbers:a.props.showWeekNumbers,showYearDropdown:a.props.showYearDropdown,withPortal:a.props.withPortal,forceShowMonthNavigation:a.props.forceShowMonthNavigation,showDisabledMonthNavigation:a.props.showDisabledMonthNavigation,scrollableYearDropdown:a.props.scrollableYearDropdown,scrollableMonthYearDropdown:a.props.scrollableMonthYearDropdown,todayButton:a.props.todayButton,weekLabel:a.props.weekLabel,outsideClickIgnoreClass:"react-datepicker-ignore-onclickoutside",fixedHeight:a.props.fixedHeight,monthsShown:a.props.monthsShown,monthSelectedIn:a.state.monthSelectedIn,onDropdownFocus:a.handleDropdownFocus,onMonthChange:a.props.onMonthChange,onYearChange:a.props.onYearChange,dayClassName:a.props.dayClassName,weekDayClassName:a.props.weekDayClassName,monthClassName:a.props.monthClassName,timeClassName:a.props.timeClassName,showTimeSelect:a.props.showTimeSelect,showTimeSelectOnly:a.props.showTimeSelectOnly,onTimeChange:a.handleTimeChange,timeFormat:a.props.timeFormat,timeIntervals:a.props.timeIntervals,minTime:a.props.minTime,maxTime:a.props.maxTime,excludeTimes:a.props.excludeTimes,timeCaption:a.props.timeCaption,className:a.props.calendarClassName,container:a.props.calendarContainer,yearDropdownItemNumber:a.props.yearDropdownItemNumber,previousMonthButtonLabel:a.props.previousMonthButtonLabel,nextMonthButtonLabel:a.props.nextMonthButtonLabel,previousYearButtonLabel:a.props.previousYearButtonLabel,nextYearButtonLabel:a.props.nextYearButtonLabel,timeInputLabel:a.props.timeInputLabel,disabledKeyboardNavigation:a.props.disabledKeyboardNavigation,renderCustomHeader:a.props.renderCustomHeader,popperProps:a.props.popperProps,renderDayContents:a.props.renderDayContents,onDayMouseEnter:a.props.onDayMouseEnter,onMonthMouseLeave:a.props.onMonthMouseLeave,showTimeInput:a.props.showTimeInput,showMonthYearPicker:a.props.showMonthYearPicker,showFullMonthYearPicker:a.props.showFullMonthYearPicker,showYearPicker:a.props.showYearPicker,showQuarterYearPicker:a.props.showQuarterYearPicker,showPopperArrow:a.props.showPopperArrow,excludeScrollbar:a.props.excludeScrollbar,handleOnKeyDown:a.onDayKeyDown,isInputFocused:a.state.focused,customTimeInput:a.props.customTimeInput,setPreSelection:a.setPreSelection},a.props.children):null})),pe(ye(a),"renderDateInput",(function(){var e,t,n,i,s,l=o(a.props.className,pe({},"react-datepicker-ignore-onclickoutside",a.state.open)),c=a.props.customInput||r.createElement("input",{type:"text"}),u=a.props.customInputRef||"ref",d="string"==typeof a.props.value?a.props.value:"string"==typeof a.state.inputValue?a.state.inputValue:(t=a.props.selected,i=(n=a.props).dateFormat,s=n.locale,t&&Pe(t,Array.isArray(i)?i[0]:i,s)||"");return r.cloneElement(c,(pe(e={},u,(function(e){a.input=e})),pe(e,"value",d),pe(e,"onBlur",a.handleBlur),pe(e,"onChange",a.handleChange),pe(e,"onClick",a.onInputClick),pe(e,"onFocus",a.handleFocus),pe(e,"onKeyDown",a.onInputKeyDown),pe(e,"id",a.props.id),pe(e,"name",a.props.name),pe(e,"autoFocus",a.props.autoFocus),pe(e,"placeholder",a.props.placeholderText),pe(e,"disabled",a.props.disabled),pe(e,"autoComplete",a.props.autoComplete),pe(e,"className",o(c.props.className,l)),pe(e,"title",a.props.title),pe(e,"readOnly",a.props.readOnly),pe(e,"required",a.props.required),pe(e,"tabIndex",a.props.tabIndex),pe(e,"aria-labelledby",a.props.ariaLabelledBy),e))})),pe(ye(a),"renderClearButton",(function(){var e=a.props,t=e.isClearable,n=e.selected,o=e.clearButtonTitle,i=e.ariaLabelClose,s=void 0===i?"Close":i;return t&&null!=n?r.createElement("button",{type:"button",className:"react-datepicker__close-icon","aria-label":s,onClick:a.onClearClick,title:o,tabIndex:-1}):null})),a.state=a.calcInitialState(),a}return he(n,null,[{key:"defaultProps",get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",onChange:function(){},disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",onFocus:function(){},onBlur:function(){},onKeyDown:function(){},onInputClick:function(){},onSelect:function(){},onClickOutside:function(){},onMonthChange:function(){},onCalendarOpen:function(){},onCalendarClose:function(){},preventOpenOnFocus:!1,onYearChange:function(){},onInputError:function(){},monthsShown:1,readOnly:!1,withPortal:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,strictParsing:!1,timeIntervals:30,timeCaption:"Time",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,renderDayContents:function(e){return e},inlineFocusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null}}}]),he(n,[{key:"componentDidUpdate",value:function(e,t){var r,n;e.inline&&(r=e.selected,n=this.props.selected,r&&n?S(r)!==S(n)||A(r)!==A(n):r!==n)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:ct(this.props.highlightDates)}),t.focused||Ve(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&this.props.onCalendarOpen(),!0===t.open&&!1===this.state.open&&this.props.onCalendarClose())}},{key:"componentWillUnmount",value:function(){this.clearPreventFocusTimeout()}},{key:"render",value:function(){var e=this.renderCalendar();return this.props.inline&&!this.props.withPortal?e:this.props.withPortal?r.createElement("div",null,this.props.inline?null:r.createElement("div",{className:"react-datepicker__input-container"},this.renderDateInput(),this.renderClearButton()),this.state.open||this.props.inline?r.createElement("div",{className:"react-datepicker__portal"},e):null):r.createElement(Mt,{className:this.props.popperClassName,wrapperClassName:this.props.wrapperClassName,hidePopper:!this.isCalendarOpen(),popperModifiers:this.props.popperModifiers,targetComponent:r.createElement("div",{className:"react-datepicker__input-container"},this.renderDateInput(),this.renderClearButton()),popperContainer:this.props.popperContainer,popperComponent:e,popperPlacement:this.props.popperPlacement,popperProps:this.props.popperProps,popperOnKeyDown:this.onPopperKeyDown,enableTabLoop:this.props.enableTabLoop})}}]),n}(r.Component),jt="input",Rt="navigate";t.CalendarContainer=Tt,t.default=zt,t.getDefaultLocale=qe,t.registerLocale=function(t,r){var n="undefined"!=typeof window?window:e;n.__localeData__||(n.__localeData__={}),n.__localeData__[t]=r},t.setDefaultLocale=function(t){("undefined"!=typeof window?window:e).__localeId__=t},Object.defineProperty(t,"__esModule",{value:!0})}(t,r(1),r(17),r(29),r(239),r(127),r(333),r(128),r(129),r(77),r(130),r(78),r(131),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(335),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(133),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(58),r(30),r(266),r(97),r(267),r(268),r(269),r(270),r(271),r(272),r(273),r(274),r(275),r(276),r(277),r(278),r(4),r(332),r(279),r(280),r(334))}).call(this,r(43))},function(e,t,r){"use strict";(function(e){
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var r="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,n=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(r&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();var o=r&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),n))}};function i(e){return e&&"[object Function]"==={}.toString.call(e)}function a(e,t){if(1!==e.nodeType)return[];var r=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?r[t]:r}function s(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=a(e),r=t.overflow,n=t.overflowX,o=t.overflowY;return/(auto|scroll|overlay)/.test(r+o+n)?e:l(s(e))}function c(e){return e&&e.referenceNode?e.referenceNode:e}var u=r&&!(!window.MSInputMethodContext||!document.documentMode),d=r&&/MSIE 10/.test(navigator.userAgent);function h(e){return 11===e?u:10===e?d:u||d}function p(e){if(!e)return document.documentElement;for(var t=h(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var n=r&&r.nodeName;return n&&"BODY"!==n&&"HTML"!==n?-1!==["TH","TD","TABLE"].indexOf(r.nodeName)&&"static"===a(r,"position")?p(r):r:e?e.ownerDocument.documentElement:document.documentElement}function f(e){return null!==e.parentNode?f(e.parentNode):e}function m(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=r?e:t,o=r?t:e,i=document.createRange();i.setStart(n,0),i.setEnd(o,0);var a,s,l=i.commonAncestorContainer;if(e!==l&&t!==l||n.contains(o))return"BODY"===(s=(a=l).nodeName)||"HTML"!==s&&p(a.firstElementChild)!==a?p(l):l;var c=f(e);return c.host?m(c.host,t):m(e,f(t).host)}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r="top"===t?"scrollTop":"scrollLeft",n=e.nodeName;if("BODY"===n||"HTML"===n){var o=e.ownerDocument.documentElement,i=e.ownerDocument.scrollingElement||o;return i[r]}return e[r]}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=g(t,"top"),o=g(t,"left"),i=r?-1:1;return e.top+=n*i,e.bottom+=n*i,e.left+=o*i,e.right+=o*i,e}function v(e,t){var r="x"===t?"Left":"Top",n="Left"===r?"Right":"Bottom";return parseFloat(e["border"+r+"Width"])+parseFloat(e["border"+n+"Width"])}function y(e,t,r,n){return Math.max(t["offset"+e],t["scroll"+e],r["client"+e],r["offset"+e],r["scroll"+e],h(10)?parseInt(r["offset"+e])+parseInt(n["margin"+("Height"===e?"Top":"Left")])+parseInt(n["margin"+("Height"===e?"Bottom":"Right")]):0)}function _(e){var t=e.body,r=e.documentElement,n=h(10)&&getComputedStyle(r);return{height:y("Height",t,r,n),width:y("Width",t,r,n)}}var w=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},x=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),k=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function E(e){return C({},e,{right:e.left+e.width,bottom:e.top+e.height})}function S(e){var t={};try{if(h(10)){t=e.getBoundingClientRect();var r=g(e,"top"),n=g(e,"left");t.top+=r,t.left+=n,t.bottom+=r,t.right+=n}else t=e.getBoundingClientRect()}catch(e){}var o={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},i="HTML"===e.nodeName?_(e.ownerDocument):{},s=i.width||e.clientWidth||o.width,l=i.height||e.clientHeight||o.height,c=e.offsetWidth-s,u=e.offsetHeight-l;if(c||u){var d=a(e);c-=v(d,"x"),u-=v(d,"y"),o.width-=c,o.height-=u}return E(o)}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=h(10),o="HTML"===t.nodeName,i=S(e),s=S(t),c=l(e),u=a(t),d=parseFloat(u.borderTopWidth),p=parseFloat(u.borderLeftWidth);r&&o&&(s.top=Math.max(s.top,0),s.left=Math.max(s.left,0));var f=E({top:i.top-s.top-d,left:i.left-s.left-p,width:i.width,height:i.height});if(f.marginTop=0,f.marginLeft=0,!n&&o){var m=parseFloat(u.marginTop),g=parseFloat(u.marginLeft);f.top-=d-m,f.bottom-=d-m,f.left-=p-g,f.right-=p-g,f.marginTop=m,f.marginLeft=g}return(n&&!r?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(f=b(f,t)),f}function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.ownerDocument.documentElement,n=T(e,r),o=Math.max(r.clientWidth,window.innerWidth||0),i=Math.max(r.clientHeight,window.innerHeight||0),a=t?0:g(r),s=t?0:g(r,"left"),l={top:a-n.top+n.marginTop,left:s-n.left+n.marginLeft,width:o,height:i};return E(l)}function P(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===a(e,"position"))return!0;var r=s(e);return!!r&&P(r)}function I(e){if(!e||!e.parentElement||h())return document.documentElement;for(var t=e.parentElement;t&&"none"===a(t,"transform");)t=t.parentElement;return t||document.documentElement}function O(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={top:0,left:0},a=o?I(e):m(e,c(t));if("viewport"===n)i=A(a,o);else{var u=void 0;"scrollParent"===n?"BODY"===(u=l(s(t))).nodeName&&(u=e.ownerDocument.documentElement):u="window"===n?e.ownerDocument.documentElement:n;var d=T(u,a,o);if("HTML"!==u.nodeName||P(a))i=d;else{var h=_(e.ownerDocument),p=h.height,f=h.width;i.top+=d.top-d.marginTop,i.bottom=p+d.top,i.left+=d.left-d.marginLeft,i.right=f+d.left}}var g="number"==typeof(r=r||0);return i.left+=g?r:r.left||0,i.top+=g?r:r.top||0,i.right-=g?r:r.right||0,i.bottom-=g?r:r.bottom||0,i}function M(e){return e.width*e.height}function D(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var a=O(r,n,i,o),s={top:{width:a.width,height:t.top-a.top},right:{width:a.right-t.right,height:a.height},bottom:{width:a.width,height:a.bottom-t.bottom},left:{width:t.left-a.left,height:a.height}},l=Object.keys(s).map((function(e){return C({key:e},s[e],{area:M(s[e])})})).sort((function(e,t){return t.area-e.area})),c=l.filter((function(e){var t=e.width,n=e.height;return t>=r.clientWidth&&n>=r.clientHeight})),u=c.length>0?c[0].key:l[0].key,d=e.split("-")[1];return u+(d?"-"+d:"")}function z(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=n?I(t):m(t,c(r));return T(r,o,n)}function j(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),r=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),n=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+n,height:e.offsetHeight+r}}function R(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function L(e,t,r){r=r.split("-")[0];var n=j(e),o={width:n.width,height:n.height},i=-1!==["right","left"].indexOf(r),a=i?"top":"left",s=i?"left":"top",l=i?"height":"width",c=i?"width":"height";return o[a]=t[a]+t[l]/2-n[l]/2,o[s]=r===s?t[s]-n[c]:t[R(s)],o}function N(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function B(e,t,r){return(void 0===r?e:e.slice(0,function(e,t,r){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===r}));var n=N(e,(function(e){return e[t]===r}));return e.indexOf(n)}(e,"name",r))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var r=e.function||e.fn;e.enabled&&i(r)&&(t.offsets.popper=E(t.offsets.popper),t.offsets.reference=E(t.offsets.reference),t=r(t,e))})),t}function F(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=z(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=D(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=L(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=B(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function V(e,t){return e.some((function(e){var r=e.name;return e.enabled&&r===t}))}function U(e){for(var t=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var o=t[n],i=o?""+o+r:e;if(void 0!==document.body.style[i])return i}return null}function q(){return this.state.isDestroyed=!0,V(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[U("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function H(e){var t=e.ownerDocument;return t?t.defaultView:window}function W(e,t,r,n){r.updateBound=n,H(e).addEventListener("resize",r.updateBound,{passive:!0});var o=l(e);return function e(t,r,n,o){var i="BODY"===t.nodeName,a=i?t.ownerDocument.defaultView:t;a.addEventListener(r,n,{passive:!0}),i||e(l(a.parentNode),r,n,o),o.push(a)}(o,"scroll",r.updateBound,r.scrollParents),r.scrollElement=o,r.eventsEnabled=!0,r}function G(){this.state.eventsEnabled||(this.state=W(this.reference,this.options,this.state,this.scheduleUpdate))}function Z(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,H(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function Y(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function $(e,t){Object.keys(t).forEach((function(r){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(r)&&Y(t[r])&&(n="px"),e.style[r]=t[r]+n}))}var K=r&&/Firefox/i.test(navigator.userAgent);function X(e,t,r){var n=N(e,(function(e){return e.name===t})),o=!!n&&e.some((function(e){return e.name===r&&e.enabled&&e.order<n.order}));if(!o){var i="`"+t+"`",a="`"+r+"`";console.warn(a+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return o}var J=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Q=J.slice(3);function ee(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Q.indexOf(e),n=Q.slice(r+1).concat(Q.slice(0,r));return t?n.reverse():n}var te="flip",re="clockwise",ne="counterclockwise";function oe(e,t,r,n){var o=[0,0],i=-1!==["right","left"].indexOf(n),a=e.split(/(\+|\-)/).map((function(e){return e.trim()})),s=a.indexOf(N(a,(function(e){return-1!==e.search(/,|\s/)})));a[s]&&-1===a[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==s?[a.slice(0,s).concat([a[s].split(l)[0]]),[a[s].split(l)[1]].concat(a.slice(s+1))]:[a];return(c=c.map((function(e,n){var o=(1===n?!i:i)?"height":"width",a=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,a=!0,e):a?(e[e.length-1]+=t,a=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,r,n){var o=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+o[1],a=o[2];if(!i)return e;if(0===a.indexOf("%")){var s=void 0;switch(a){case"%p":s=r;break;case"%":case"%r":default:s=n}return E(s)[t]/100*i}if("vh"===a||"vw"===a){return("vh"===a?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*i}return i}(e,o,t,r)}))}))).forEach((function(e,t){e.forEach((function(r,n){Y(r)&&(o[t]+=r*("-"===e[n-1]?-1:1))}))})),o}var ie={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,r=t.split("-")[0],n=t.split("-")[1];if(n){var o=e.offsets,i=o.reference,a=o.popper,s=-1!==["bottom","top"].indexOf(r),l=s?"left":"top",c=s?"width":"height",u={start:k({},l,i[l]),end:k({},l,i[l]+i[c]-a[c])};e.offsets.popper=C({},a,u[n])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var r=t.offset,n=e.placement,o=e.offsets,i=o.popper,a=o.reference,s=n.split("-")[0],l=void 0;return l=Y(+r)?[+r,0]:oe(r,i,a,s),"left"===s?(i.top+=l[0],i.left-=l[1]):"right"===s?(i.top+=l[0],i.left+=l[1]):"top"===s?(i.left+=l[0],i.top-=l[1]):"bottom"===s&&(i.left+=l[0],i.top+=l[1]),e.popper=i,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var r=t.boundariesElement||p(e.instance.popper);e.instance.reference===r&&(r=p(r));var n=U("transform"),o=e.instance.popper.style,i=o.top,a=o.left,s=o[n];o.top="",o.left="",o[n]="";var l=O(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);o.top=i,o.left=a,o[n]=s,t.boundaries=l;var c=t.priority,u=e.offsets.popper,d={primary:function(e){var r=u[e];return u[e]<l[e]&&!t.escapeWithReference&&(r=Math.max(u[e],l[e])),k({},e,r)},secondary:function(e){var r="right"===e?"left":"top",n=u[r];return u[e]>l[e]&&!t.escapeWithReference&&(n=Math.min(u[r],l[e]-("right"===e?u.width:u.height))),k({},r,n)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=C({},u,d[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,r=t.popper,n=t.reference,o=e.placement.split("-")[0],i=Math.floor,a=-1!==["top","bottom"].indexOf(o),s=a?"right":"bottom",l=a?"left":"top",c=a?"width":"height";return r[s]<i(n[l])&&(e.offsets.popper[l]=i(n[l])-r[c]),r[l]>i(n[s])&&(e.offsets.popper[l]=i(n[s])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var r;if(!X(e.instance.modifiers,"arrow","keepTogether"))return e;var n=t.element;if("string"==typeof n){if(!(n=e.instance.popper.querySelector(n)))return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var o=e.placement.split("-")[0],i=e.offsets,s=i.popper,l=i.reference,c=-1!==["left","right"].indexOf(o),u=c?"height":"width",d=c?"Top":"Left",h=d.toLowerCase(),p=c?"left":"top",f=c?"bottom":"right",m=j(n)[u];l[f]-m<s[h]&&(e.offsets.popper[h]-=s[h]-(l[f]-m)),l[h]+m>s[f]&&(e.offsets.popper[h]+=l[h]+m-s[f]),e.offsets.popper=E(e.offsets.popper);var g=l[h]+l[u]/2-m/2,b=a(e.instance.popper),v=parseFloat(b["margin"+d]),y=parseFloat(b["border"+d+"Width"]),_=g-e.offsets.popper[h]-v-y;return _=Math.max(Math.min(s[u]-m,_),0),e.arrowElement=n,e.offsets.arrow=(k(r={},h,Math.round(_)),k(r,p,""),r),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(V(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var r=O(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],o=R(n),i=e.placement.split("-")[1]||"",a=[];switch(t.behavior){case te:a=[n,o];break;case re:a=ee(n);break;case ne:a=ee(n,!0);break;default:a=t.behavior}return a.forEach((function(s,l){if(n!==s||a.length===l+1)return e;n=e.placement.split("-")[0],o=R(n);var c=e.offsets.popper,u=e.offsets.reference,d=Math.floor,h="left"===n&&d(c.right)>d(u.left)||"right"===n&&d(c.left)<d(u.right)||"top"===n&&d(c.bottom)>d(u.top)||"bottom"===n&&d(c.top)<d(u.bottom),p=d(c.left)<d(r.left),f=d(c.right)>d(r.right),m=d(c.top)<d(r.top),g=d(c.bottom)>d(r.bottom),b="left"===n&&p||"right"===n&&f||"top"===n&&m||"bottom"===n&&g,v=-1!==["top","bottom"].indexOf(n),y=!!t.flipVariations&&(v&&"start"===i&&p||v&&"end"===i&&f||!v&&"start"===i&&m||!v&&"end"===i&&g),_=!!t.flipVariationsByContent&&(v&&"start"===i&&f||v&&"end"===i&&p||!v&&"start"===i&&g||!v&&"end"===i&&m),w=y||_;(h||b||w)&&(e.flipped=!0,(h||b)&&(n=a[l+1]),w&&(i=function(e){return"end"===e?"start":"start"===e?"end":e}(i)),e.placement=n+(i?"-"+i:""),e.offsets.popper=C({},e.offsets.popper,L(e.instance.popper,e.offsets.reference,e.placement)),e=B(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,r=t.split("-")[0],n=e.offsets,o=n.popper,i=n.reference,a=-1!==["left","right"].indexOf(r),s=-1===["top","left"].indexOf(r);return o[a?"left":"top"]=i[r]-(s?o[a?"width":"height"]:0),e.placement=R(t),e.offsets.popper=E(o),e}},hide:{order:800,enabled:!0,fn:function(e){if(!X(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,r=N(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var r=t.x,n=t.y,o=e.offsets.popper,i=N(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==i&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var a=void 0!==i?i:t.gpuAcceleration,s=p(e.instance.popper),l=S(s),c={position:o.position},u=function(e,t){var r=e.offsets,n=r.popper,o=r.reference,i=Math.round,a=Math.floor,s=function(e){return e},l=i(o.width),c=i(n.width),u=-1!==["left","right"].indexOf(e.placement),d=-1!==e.placement.indexOf("-"),h=t?u||d||l%2==c%2?i:a:s,p=t?i:s;return{left:h(l%2==1&&c%2==1&&!d&&t?n.left-1:n.left),top:p(n.top),bottom:p(n.bottom),right:h(n.right)}}(e,window.devicePixelRatio<2||!K),d="bottom"===r?"top":"bottom",h="right"===n?"left":"right",f=U("transform"),m=void 0,g=void 0;if(g="bottom"===d?"HTML"===s.nodeName?-s.clientHeight+u.bottom:-l.height+u.bottom:u.top,m="right"===h?"HTML"===s.nodeName?-s.clientWidth+u.right:-l.width+u.right:u.left,a&&f)c[f]="translate3d("+m+"px, "+g+"px, 0)",c[d]=0,c[h]=0,c.willChange="transform";else{var b="bottom"===d?-1:1,v="right"===h?-1:1;c[d]=g*b,c[h]=m*v,c.willChange=d+", "+h}var y={"x-placement":e.placement};return e.attributes=C({},y,e.attributes),e.styles=C({},c,e.styles),e.arrowStyles=C({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,r;return $(e.instance.popper,e.styles),t=e.instance.popper,r=e.attributes,Object.keys(r).forEach((function(e){!1!==r[e]?t.setAttribute(e,r[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&$(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,r,n,o){var i=z(o,t,e,r.positionFixed),a=D(r.placement,i,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute("x-placement",a),$(t,{position:r.positionFixed?"fixed":"absolute"}),r},gpuAcceleration:void 0}}},ae=function(){function e(t,r){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};w(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=o(this.update.bind(this)),this.options=C({},e.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(C({},e.Defaults.modifiers,a.modifiers)).forEach((function(t){n.options.modifiers[t]=C({},e.Defaults.modifiers[t]||{},a.modifiers?a.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return C({name:e},n.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&i(e.onLoad)&&e.onLoad(n.reference,n.popper,n.options,e,n.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return x(e,[{key:"update",value:function(){return F.call(this)}},{key:"destroy",value:function(){return q.call(this)}},{key:"enableEventListeners",value:function(){return G.call(this)}},{key:"disableEventListeners",value:function(){return Z.call(this)}}]),e}();ae.Utils=("undefined"!=typeof window?window:e).PopperUtils,ae.placements=J,ae.Defaults=ie,t.a=ae}).call(this,r(43))},function(e,t,r){"use strict";t.__esModule=!0;var n=i(r(1)),o=i(r(295));function i(e){return e&&e.__esModule?e:{default:e}}t.default=n.default.createContext||o.default,e.exports=t.default},,,,,,,,,,,,function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(1)),l=a(r(28)),c=r(102),u=function(e){function t(t){var r=e.call(this,t)||this;return r.listRef=s.createRef(),r.ghostRef=s.createRef(),r.topOffsets=[],r.itemTranslateOffsets=[],r.initialYOffset=0,r.lastScroll=0,r.lastYOffset=0,r.lastListYOffset=0,r.needle=-1,r.afterIndex=-2,r.state={itemDragged:-1,itemDraggedOutOfBounds:-1,selectedItem:-1,initialX:0,initialY:0,targetX:0,targetY:0,targetHeight:0,targetWidth:0,liveText:"",scrollingSpeed:0,scrollWindow:!1},r.doScrolling=function(){var e=r.state,t=e.scrollingSpeed,n=e.scrollWindow,o=r.listRef.current;window.requestAnimationFrame((function(){n?window.scrollTo(window.pageXOffset,window.pageYOffset+1.5*t):o.scrollTop+=t,0!==t&&r.doScrolling()}))},r.getChildren=function(){return r.listRef&&r.listRef.current?Array.from(r.listRef.current.children):(console.warn("No items found in the List container. Did you forget to pass & spread the `props` param in renderList?"),[])},r.calculateOffsets=function(){r.topOffsets=r.getChildren().map((function(e){return e.getBoundingClientRect().top})),r.itemTranslateOffsets=r.getChildren().map((function(e){return c.getTranslateOffset(e)}))},r.getTargetIndex=function(e){return r.getChildren().findIndex((function(t){return t===e.target||t.contains(e.target)}))},r.onMouseOrTouchStart=function(e){r.dropTimeout&&r.state.itemDragged>-1&&(window.clearTimeout(r.dropTimeout),r.finishDrop());var t=c.isTouchEvent(e);if(t||0===e.button){var n=r.getTargetIndex(e);if(-1===n||r.props.values[n]&&r.props.values[n].disabled)-1!==r.state.selectedItem&&(r.setState({selectedItem:-1}),r.finishDrop());else{var o=r.getChildren()[n],i=o.querySelector("[data-movable-handle]");if((!i||i.contains(e.target))&&!c.checkIfInteractive(e.target,o)){if(e.preventDefault(),r.props.beforeDrag&&r.props.beforeDrag({elements:r.getChildren(),index:n}),t){var a={passive:!1};o.style.touchAction="none",document.addEventListener("touchend",r.schdOnEnd,a),document.addEventListener("touchmove",r.schdOnTouchMove,a),document.addEventListener("touchcancel",r.schdOnEnd,a)}else{document.addEventListener("mousemove",r.schdOnMouseMove),document.addEventListener("mouseup",r.schdOnEnd);var s=r.getChildren()[r.state.itemDragged];s&&s.style&&(s.style.touchAction="")}r.onStart(o,t?e.touches[0].clientX:e.clientX,t?e.touches[0].clientY:e.clientY,n)}}}},r.getYOffset=function(){var e=r.listRef.current?r.listRef.current.scrollTop:0;return window.pageYOffset+e},r.onStart=function(e,t,n,o){r.state.selectedItem>-1&&(r.setState({selectedItem:-1}),r.needle=-1);var i=e.getBoundingClientRect(),a=window.getComputedStyle(e);r.calculateOffsets(),r.initialYOffset=r.getYOffset(),r.lastYOffset=window.pageYOffset,r.lastListYOffset=r.listRef.current.scrollTop,r.setState({itemDragged:o,targetX:i.left-parseInt(a["margin-left"],10),targetY:i.top-parseInt(a["margin-top"],10),targetHeight:i.height,targetWidth:i.width,initialX:t,initialY:n})},r.onMouseMove=function(e){e.cancelable&&e.preventDefault(),r.onMove(e.clientX,e.clientY)},r.onTouchMove=function(e){e.cancelable&&e.preventDefault(),r.onMove(e.touches[0].clientX,e.touches[0].clientY)},r.onWheel=function(e){r.state.itemDragged<0||(r.lastScroll=r.listRef.current.scrollTop+=e.deltaY,r.moveOtherItems())},r.onMove=function(e,t){if(-1===r.state.itemDragged)return null;c.transformItem(r.ghostRef.current,t-r.state.initialY,r.props.lockVertically?0:e-r.state.initialX),r.autoScrolling(t),r.moveOtherItems()},r.moveOtherItems=function(){var e=r.ghostRef.current.getBoundingClientRect(),t=e.top+e.height/2,n=c.getTranslateOffset(r.getChildren()[r.state.itemDragged]),o=r.getYOffset();r.initialYOffset!==o&&(r.topOffsets=r.topOffsets.map((function(e){return e-(o-r.initialYOffset)})),r.initialYOffset=o),r.isDraggedItemOutOfBounds()&&r.props.removableByMove?r.afterIndex=r.topOffsets.length+1:r.afterIndex=c.binarySearch(r.topOffsets,t),r.animateItems(-1===r.afterIndex?0:r.afterIndex,r.state.itemDragged,n)},r.autoScrolling=function(e){var t=r.listRef.current.getBoundingClientRect(),n=t.top,o=t.bottom,i=t.height,a=window.innerHeight||document.documentElement.clientHeight;if(o>a&&a-e<200)r.setState({scrollingSpeed:Math.round((200-(a-e))/10),scrollWindow:!0});else if(n<0&&e<200)r.setState({scrollingSpeed:Math.round((200-e)/-10),scrollWindow:!0});else if(r.state.scrollWindow&&0!==r.state.scrollingSpeed&&r.setState({scrollingSpeed:0,scrollWindow:!1}),i+20<r.listRef.current.scrollHeight){var s=0;e-n<200?s=Math.round((200-(e-n))/-10):o-e<200&&(s=Math.round((200-(o-e))/10)),r.state.scrollingSpeed!==s&&r.setState({scrollingSpeed:s})}},r.animateItems=function(e,t,n,o){void 0===o&&(o=!1),r.getChildren().forEach((function(i,a){if(c.setItemTransition(i,r.props.transitionDuration),t===a&&o){if(t===e)return c.transformItem(i,null);c.transformItem(i,t<e?r.itemTranslateOffsets.slice(t+1,e+1).reduce((function(e,t){return e+t}),0):-1*r.itemTranslateOffsets.slice(e,t).reduce((function(e,t){return e+t}),0))}else t<e&&a>t&&a<=e?c.transformItem(i,-n):a<t&&t>e&&a>=e?c.transformItem(i,n):c.transformItem(i,null)}))},r.isDraggedItemOutOfBounds=function(){var e=r.getChildren()[r.state.itemDragged].getBoundingClientRect(),t=r.ghostRef.current.getBoundingClientRect();return Math.abs(e.left-t.left)>t.width?(-1===r.state.itemDraggedOutOfBounds&&r.setState({itemDraggedOutOfBounds:r.state.itemDragged}),!0):(r.state.itemDraggedOutOfBounds>-1&&r.setState({itemDraggedOutOfBounds:-1}),!1)},r.onEnd=function(e){e.cancelable&&e.preventDefault(),document.removeEventListener("mousemove",r.schdOnMouseMove),document.removeEventListener("touchmove",r.schdOnTouchMove),document.removeEventListener("mouseup",r.schdOnEnd),document.removeEventListener("touchup",r.schdOnEnd),document.removeEventListener("touchcancel",r.schdOnEnd);var t=r.props.removableByMove&&r.isDraggedItemOutOfBounds();!t&&r.props.transitionDuration>0&&-2!==r.afterIndex&&c.schd((function(){c.setItemTransition(r.ghostRef.current,r.props.transitionDuration,"cubic-bezier(.2,1,.1,1)"),r.afterIndex<1&&0===r.state.itemDragged?c.transformItem(r.ghostRef.current,0,0):c.transformItem(r.ghostRef.current,-(window.pageYOffset-r.lastYOffset)-(r.listRef.current.scrollTop-r.lastListYOffset)+(r.state.itemDragged<r.afterIndex?r.itemTranslateOffsets.slice(r.state.itemDragged+1,r.afterIndex+1).reduce((function(e,t){return e+t}),0):-1*r.itemTranslateOffsets.slice(r.afterIndex<0?0:r.afterIndex,r.state.itemDragged).reduce((function(e,t){return e+t}),0)),0)}))(),r.dropTimeout=window.setTimeout(r.finishDrop,t||-2===r.afterIndex?0:r.props.transitionDuration)},r.finishDrop=function(){var e=r.props.removableByMove&&r.isDraggedItemOutOfBounds();(e||r.afterIndex>-2&&r.state.itemDragged!==r.afterIndex)&&r.props.onChange({oldIndex:r.state.itemDragged,newIndex:e?-1:Math.max(r.afterIndex,0),targetRect:r.ghostRef.current.getBoundingClientRect()}),r.getChildren().forEach((function(e){c.setItemTransition(e,0),c.transformItem(e,null)})),r.setState({itemDragged:-1,scrollingSpeed:0}),r.afterIndex=-2,r.lastScroll>0&&(r.listRef.current.scrollTop=r.lastScroll,r.lastScroll=0)},r.onKeyDown=function(e){var t=r.state.selectedItem,n=r.getTargetIndex(e);if(!c.checkIfInteractive(e.target,e.currentTarget)&&-1!==n){if(" "===e.key&&(e.preventDefault(),t===n?(t!==r.needle&&(r.getChildren().forEach((function(e){c.setItemTransition(e,0),c.transformItem(e,null)})),r.props.onChange({oldIndex:t,newIndex:r.needle,targetRect:r.getChildren()[r.needle].getBoundingClientRect()}),r.getChildren()[r.needle].focus()),r.setState({selectedItem:-1,liveText:r.props.voiceover.dropped(t+1,r.needle+1)}),r.needle=-1):(r.setState({selectedItem:n,liveText:r.props.voiceover.lifted(n+1)}),r.needle=n,r.calculateOffsets())),("ArrowDown"===e.key||"j"===e.key)&&t>-1&&r.needle<r.props.values.length-1){e.preventDefault();var o=c.getTranslateOffset(r.getChildren()[t]);r.needle++,r.animateItems(r.needle,t,o,!0),r.setState({liveText:r.props.voiceover.moved(r.needle+1,!1)})}if(("ArrowUp"===e.key||"k"===e.key)&&t>-1&&r.needle>0){e.preventDefault();o=c.getTranslateOffset(r.getChildren()[t]);r.needle--,r.animateItems(r.needle,t,o,!0),r.setState({liveText:r.props.voiceover.moved(r.needle+1,!0)})}"Escape"===e.key&&t>-1&&(r.getChildren().forEach((function(e){c.setItemTransition(e,0),c.transformItem(e,null)})),r.setState({selectedItem:-1,liveText:r.props.voiceover.canceled(t+1)}),r.needle=-1),("Tab"===e.key||"Enter"===e.key)&&t>-1&&e.preventDefault()}},r.schdOnMouseMove=c.schd(r.onMouseMove),r.schdOnTouchMove=c.schd(r.onTouchMove),r.schdOnEnd=c.schd(r.onEnd),r}return o(t,e),t.prototype.componentDidMount=function(){this.calculateOffsets(),document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1,capture:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart)},t.prototype.componentDidUpdate=function(e,t){t.scrollingSpeed!==this.state.scrollingSpeed&&0===t.scrollingSpeed&&this.doScrolling()},t.prototype.componentWillUnmount=function(){document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mousedown",this.onMouseOrTouchStart)},t.prototype.render=function(){var e=this,t={userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",boxSizing:"border-box",position:"relative"},r=i(i({},t),{top:this.state.targetY,left:this.state.targetX,width:this.state.targetWidth,height:this.state.targetHeight,position:"fixed",marginTop:0});return s.createElement(s.Fragment,null,this.props.renderList({children:this.props.values.map((function(r,n){var o=n===e.state.itemDragged,a=n===e.state.selectedItem,s={key:n,tabIndex:e.props.values[n]&&e.props.values[n].disabled?-1:0,"aria-roledescription":e.props.voiceover.item(n+1),onKeyDown:e.onKeyDown,style:i(i({},t),{visibility:o?"hidden":void 0,zIndex:a?5e3:0})};return e.props.renderItem({value:r,props:s,index:n,isDragged:!1,isSelected:a,isOutOfBounds:!1})})),isDragged:this.state.itemDragged>-1,props:{ref:this.listRef}}),this.state.itemDragged>-1&&l.createPortal(this.props.renderItem({value:this.props.values[this.state.itemDragged],props:{ref:this.ghostRef,style:r,onWheel:this.onWheel},index:this.state.itemDragged,isDragged:!0,isSelected:!1,isOutOfBounds:this.state.itemDraggedOutOfBounds>-1}),this.props.container||document.body),s.createElement("div",{"aria-live":"assertive",role:"log","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0px",padding:"0px",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"}},this.state.liveText))},t.defaultProps={transitionDuration:300,lockVertically:!1,removableByMove:!1,voiceover:{item:function(e){return"You are currently at a draggable item at position "+e+". Press space bar to lift."},lifted:function(e){return"You have lifted item at position "+e+". Press j to move down, k to move up, space bar to drop and escape to cancel."},moved:function(e,t){return"You have moved the lifted item "+(t?"up":"down")+" to position "+e+". Press j to move down, k to move up, space bar to drop and escape to cancel."},dropped:function(e,t){return"You have dropped the item. It has moved from position "+e+" to "+t+"."},canceled:function(e){return"You have cancelled the movement. The item has returned to its starting position of "+e+"."}}},t}(s.Component);t.default=u},function(e,t,r){"use strict";var n=Array.prototype.slice,o=r(153),i=Object.keys,a=i?function(e){return i(e)}:r(281),s=Object.keys;a.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return o(e)?s(n.call(e)):s(e)}):Object.keys=a;return Object.keys||a},e.exports=a},function(e,t,r){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},function(e,t,r){"use strict";var n=SyntaxError,o=Function,i=TypeError,a=function(e){try{return Function('"use strict"; return ('+e+").constructor;")()}catch(e){}},s=Object.getOwnPropertyDescriptor;if(s)try{s({},"")}catch(e){s=null}var l=function(){throw new i},c=s?function(){try{return l}catch(e){try{return s(arguments,"callee").get}catch(e){return l}}}():l,u=r(122)(),d=Object.getPrototypeOf||function(e){return e.__proto__},h=a("async function* () {}"),p=h?h.prototype:void 0,f=p?p.prototype:void 0,m="undefined"==typeof Uint8Array?void 0:d(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":u?d([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":h,"%AsyncIteratorPrototype%":f?d(f):void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?d(d([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?d((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?d((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?d(""[Symbol.iterator]()):void 0,"%Symbol%":u?Symbol:void 0,"%SyntaxError%":n,"%ThrowTypeError%":c,"%TypedArray%":m,"%TypeError%":i,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(71),y=r(286),_=v.call(Function.call,Array.prototype.concat),w=v.call(Function.apply,Array.prototype.splice),x=v.call(Function.call,String.prototype.replace),k=v.call(Function.call,String.prototype.slice),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,S=function(e){var t=k(e,0,1),r=k(e,-1);if("%"===t&&"%"!==r)throw new n("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new n("invalid intrinsic syntax, expected opening `%`");var o=[];return x(e,C,(function(e,t,r,n){o[o.length]=r?x(n,E,"$1"):t||e})),o},T=function(e,t){var r,o=e;if(y(b,o)&&(o="%"+(r=b[o])[0]+"%"),y(g,o)){var a=g[o];if(void 0===a&&!t)throw new i("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:o,value:a}}throw new n("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new i("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new i('"allowMissing" argument must be a boolean');var r=S(e),o=r.length>0?r[0]:"",a=T("%"+o+"%",t),l=a.name,c=a.value,u=!1,d=a.alias;d&&(o=d[0],w(r,_([0,1],d)));for(var h=1,p=!0;h<r.length;h+=1){var f=r[h],m=k(f,0,1),b=k(f,-1);if(('"'===m||"'"===m||"`"===m||'"'===b||"'"===b||"`"===b)&&m!==b)throw new n("property names with quotes must have matching quotes");if("constructor"!==f&&p||(u=!0),y(g,l="%"+(o+="."+f)+"%"))c=g[l];else if(null!=c){if(!(f in c)){if(!t)throw new i("base intrinsic for "+e+" exists, but the property is not available.");return}if(s&&h+1>=r.length){var v=s(c,f);c=(p=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:c[f]}else p=y(c,f),c=c[f];p&&!u&&(g[l]=c)}}return c}},function(e,t,r){"use strict";var n=r(71),o=r(154),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||n.call(a,i),l=o("%Object.defineProperty%",!0);if(l)try{l({},"a",{value:1})}catch(e){l=null}e.exports=function(){return s(n,a,arguments)};var c=function(){return s(n,i,arguments)};l?l(e.exports,"apply",{value:c}):e.exports.apply=c},function(e,t,r){"use strict";var n=function(e){return e!=e};e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!n(e)||!n(t))}},function(e,t,r){"use strict";var n=r(156);e.exports=function(){return"function"==typeof Object.is?Object.is:n}},function(e,t,r){"use strict";var n=Object,o=TypeError;e.exports=function(){if(null!=this&&this!==n(this))throw new o("RegExp.prototype.flags getter called on non-object");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e}},function(e,t,r){"use strict";var n=r(158),o=r(72).supportsDescriptors,i=Object.getOwnPropertyDescriptor,a=TypeError;e.exports=function(){if(!o)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var e=i(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof/a/.dotAll)return e.get}return n}},,,,,,,,,,,function(e,t,r){var n=r(87),o=r(52),i=r(40),a=r(88);e.exports=function(e){return n(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n=r(0),o=r(5),i=r(2),a=r(36);r(233);t.a=function(e){var t=e.attributes,r=e.loadLayer,s=e.loadingLayers,l=e.openModal,c=e.renderPanel,u=t.layers||[];return Object(n.createElement)(c,{name:"map-layers",title:Object(i.__)("Map layers","jeo"),className:"jeo-layers-panel"},s?Object(n.createElement)("p",null,Object(i.__)("Loading layers data...","jeo")):Object(n.createElement)("ol",null,u.map((function(e){var t=r(e);return t.layer&&Object(n.createElement)("li",{className:"jeo-setting-layer",key:t.id},Object(n.createElement)("h2",null,t.layer.title.rendered.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)}))," -"," ",t.layer.meta.type),a.b[t.use],"fixed"!==t.use&&t.default&&" - "+Object(i.__)("Default","jeo"))}))),Object(n.createElement)(o.Button,{isPrimary:!0,isLarge:!0,onClick:l},Object(i.__)("Edit layers settings","jeo")))}},function(e,t,r){var n=r(152),o=r(282),i=r(287),a=r(289),s=r(290),l=r(294),c=Date.prototype.getTime;function u(e,t,r){var p=r||{};return!!(p.strict?i(e,t):e===t)||(!e||!t||"object"!=typeof e&&"object"!=typeof t?p.strict?i(e,t):e==t:function(e,t,r){var i,p;if(typeof e!=typeof t)return!1;if(d(e)||d(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e)!==o(t))return!1;var f=a(e),m=a(t);if(f!==m)return!1;if(f||m)return e.source===t.source&&s(e)===s(t);if(l(e)&&l(t))return c.call(e)===c.call(t);var g=h(e),b=h(t);if(g!==b)return!1;if(g||b){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}if(typeof e!=typeof t)return!1;try{var v=n(e),y=n(t)}catch(e){return!1}if(v.length!==y.length)return!1;for(v.sort(),y.sort(),i=v.length-1;i>=0;i--)if(v[i]!=y[i])return!1;for(i=v.length-1;i>=0;i--)if(p=v[i],!u(e[p],t[p],r))return!1;return!0}(e,t,p))}function d(e){return null==e}function h(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}e.exports=u},function(e,t,r){"use strict";var n=r(13),o=r.n(n),i=r(14),a=r.n(i),s=r(7),l=r.n(s),c=r(20),u=r.n(c),d=r(25),h=r.n(d),p=r(15),f=r.n(p),m=r(0),g=r(5),b=r(2),v=r(135),y=r.n(v);r(301);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h()(this,r)}}var x=function(e){u()(r,e);var t=w(r);function r(e){var n;return o()(this,r),(n=t.call(this,e)).state={suggestions:[],isLoading:!1},n.onChange=n.onChange.bind(l()(n)),n.onSuggestionsFetchRequested=n.onSuggestionsFetchRequested.bind(l()(n)),n.onSuggestionsClearRequested=n.onSuggestionsClearRequested.bind(l()(n)),n.getSuggestionValue=n.getSuggestionValue.bind(l()(n)),n.renderSuggestion=n.renderSuggestion.bind(l()(n)),n.onSuggestionSelected=n.onSuggestionSelected.bind(l()(n)),n.shouldRenderSuggestions=n.shouldRenderSuggestions.bind(l()(n)),n.debouncedLoadSuggestions=_.debounce(n.onSuggestionsFetchRequested,500),n}return a()(r,[{key:"onChange",value:function(e,t){var r=t.newValue;this.props.onChange(r)}},{key:"getSuggestionValue",value:function(e){return e.full_address}},{key:"onSuggestionSelected",value:function(e,t){var r=t.suggestion;t.suggestionValue,t.suggestionIndex,t.sectionIndex,t.method;this.props.onSelect(r)}},{key:"renderSuggestion",value:function(e){return Object(m.createElement)("div",{className:"jeo-geo-autocomplete"},e.full_address)}},{key:"onSuggestionsFetchRequested",value:function(e){var t=this,r=e.value;this.setState({isLoading:!0}),window.fetch(jeo.ajax_url+"?action=jeo_geocode&search="+r).then((function(e){return e.json()})).then((function(e){t.setState({suggestions:e,isLoading:!1})}))}},{key:"shouldRenderSuggestions",value:function(e){return e.trim().length>2}},{key:"onSuggestionsClearRequested",value:function(){this.setState({suggestions:[]})}},{key:"render",value:function(){var e=this.state.suggestions,t={placeholder:Object(b.__)("Search address","jeo"),value:this.props.value,onChange:this.onChange};return Object(m.createElement)("div",{className:this.props.className},Object(m.createElement)(y.a,{suggestions:e,onSuggestionsFetchRequested:this.debouncedLoadSuggestions,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:this.renderSuggestion,onSuggestionSelected:this.onSuggestionSelected,shouldRenderSuggestions:this.shouldRenderSuggestions,inputProps:t}),this.state.isLoading&&Object(m.createElement)(g.Spinner,null))}}]),r}(m.Component);t.a=x},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return z}));var n=r(0),o=r(5),i=r(2),a=r(24),s=r.n(a),l=r(11),c=r.n(l),u=r(170),d=r.n(u),h=r(12),p=r.n(h),f=r(8),m=r.n(f),g=r(49),b=r(16),v=r(29),y=r.n(v),_=r(70),w=r(60),x=r(134),k=r.n(x);function C(e){var t=e.checked,r=e.label,o=e.value,i=e.onChange;return Object(n.createElement)("div",{className:"components-radio-control__option"},Object(n.createElement)("label",null,Object(n.createElement)("input",{type:"radio",value:o,checked:t,onChange:i}),Object(n.createElement)("span",null,r)))}var E=r(36);r(228);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=[{label:E.b.fixed,value:"fixed"},{label:E.b.swappable,value:"swappable"},{label:E.b.switchable,value:"switchable"}],P=function(e,t){var r=e.index,a=e.isDragged,l=e.isOutOfBounds,c=e.isSelected,u=e.removeLayer,d=e.settings,h=e.switchUseStyle,f=e.swapDefault,m=e.switchShowLegend,g=e.updateStyleLayers,b=e.switchDefault,v=e.updateUse,_=e.widths,x=(k()(e,["index","isDragged","isOutOfBounds","isSelected","removeLayer","settings","switchUseStyle","swapDefault","switchShowLegend","updateStyleLayers","switchDefault","updateUse","widths"]),y()(["layer",{dragging:a},{selected:c},{isoutofbounds:l}])),E=Object(n.useState)(!1),S=p()(E,2),P=S[0],I=S[1],O=function(e){return a&&_.length?{width:_[e]}:{}};return Object(n.createElement)(w.b,{key:String(d.id),draggableId:String(d.id),index:r},(function(e){return d.layer?d.layer&&Object(n.createElement)("div",s()({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{className:x}),Object(n.createElement)("div",{className:"handle",style:O(0)},Object(n.createElement)(o.Dashicon,{className:"drag-handle",icon:"move","data-movable-handle":!0})),Object(n.createElement)("div",{className:"display",style:O(1)},Object(n.createElement)("span",{className:"layer-title"},d.layer.title.rendered.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})))," ","| ",d.layer.meta.type),Object(n.createElement)("div",{className:"use-control",style:O(2)},0===r?Object(n.createElement)("span",null,Object(i.__)("Base layer should be fixed","jeo")):Object(n.createElement)(o.SelectControl,{label:Object(i.__)("Type","jeo"),value:d.use,options:A,onChange:v})),Object(n.createElement)("div",{className:"default-control",style:O(3)},"switchable"===d.use&&Object(n.createElement)(o.CheckboxControl,{label:Object(i.__)("Should be displayed by default.","jeo"),checked:d.default,onChange:b}),"swappable"===d.use&&Object(n.createElement)(C,{label:Object(i.__)("Should be displayed by default.","jeo"),checked:d.default,onChange:f})),Object(n.createElement)("div",{className:"default-control",style:O(4)},"mapbox"===d.layer.meta.type&&Object(n.createElement)(C,{label:Object(i.__)("Load interactions","jeo"),checked:d.load_as_style,onChange:h})),Object(n.createElement)("div",{className:"default-control",style:O(5)},!d.layer.meta.use_legend&&Object(n.createElement)("p",null,Object(n.createElement)("em",null,"No Legend")),d.layer.meta.use_legend&&Object(n.createElement)(o.CheckboxControl,{label:Object(i.__)("Show legend","jeo"),checked:d.show_legend,onChange:m})),Object(n.createElement)("div",{className:"layer-actions",style:O(6)},d.load_as_style&&Object(n.createElement)("button",{onClick:function(){return I(!P)},className:"show-style-layers"},!P&&Object(n.createElement)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"chevron-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},Object(n.createElement)("path",{fill:"currentColor",d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"})),P&&Object(n.createElement)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"chevron-up",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},Object(n.createElement)("path",{fill:"currentColor",d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}))),Object(n.createElement)("a",{href:"/wp-admin/post.php?post=".concat(d.id,"&action=edit"),target:"_blank",rel:"noopener noreferrer"},Object(n.createElement)(o.Dashicon,{icon:"welcome-write-blog"})),Object(n.createElement)(o.Dashicon,{icon:"dismiss",onClick:u})),d.load_as_style&&P&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"informative-message"},Object(i.__)("If the layer is not visible inside Mapbox Studio we will not be able to control the displayment. ","jeo")),Object(n.createElement)("div",{className:"layers-selector"},d.style_layers&&d.style_layers.map((function(e){return Object(n.createElement)("div",{key:e.id,className:"style-layer"},Object(n.createElement)("button",{onClick:function(){return t=e.id,r=d.style_layers.map((function(e){if(e.id===t){var r=!e.show;return T(T({},e),{},{show:r})}return T({},e)})),void g(r);var t,r},className:e.show?"toggle-button active":"toggle-button"},e.show?Object(n.createElement)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"toggle-on",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},Object(n.createElement)("path",{fill:"currentColor",d:"M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"})):Object(n.createElement)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"toggle-off",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},Object(n.createElement)("path",{fill:"currentColor",d:"M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"})),Object(n.createElement)("span",{className:"style-layer-title"},e.id)))}))))):Object(n.createElement)(n.Fragment,null)}))};r(231);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=function(e){return e.some((function(e){return"swappable"===e.use&&e.default}))},D=Object(g.withInstanceId)((function(e){e.instanceId;var t=e.attributes,r=e.setAttributes,a=e.loadingLayers,l=e.loadedLayers,u=e.closeModal,h=function(e){return r(O(O({},t),{},{layers:e}))},f=Object(E.a)(l),m=[],g=Object(n.useState)([]),v=p()(g,2),y=v[0],x=v[1],k=Object(n.useState)([]),C=p()(k,2),S=C[0],T=C[1];Object(n.useEffect)((function(){var e=Object(b.select)("core").getEntityRecords("postType","map-layer",{per_page:-1,order:"asc",orderby:"menu_order"});x(e||[])})),y.sort((function(e,t){return e.title.rendered.toLowerCase()<t.title.rendered.toLowerCase()?-1:e.title.rendered.toLowerCase()>t.title.rendered.toLowerCase()?1:0}));var A=Object(n.useState)(null),I=p()(A,2),D=I[0],z=I[1],j=Object(n.useState)(null),R=p()(j,2),L=(R[0],R[1]),N=Object(n.useState)(""),B=p()(N,2),F=B[0],V=B[1];Object(n.useEffect)((function(){var e=d()(t.layers),r=e[0],n=e.slice(1);r&&"fixed"!==r.use&&h([O(O({},r),{},{use:"fixed",default:!1})].concat(c()(n)))}),[t,r]);function U(){var e=[];y.map((function(t){if((!D||D===t.meta.type)&&(!F||t.title.raw.toLowerCase().includes(F.toLowerCase())))return e.push(t)})),T(e)}return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"jeo-layers-library-controls"},Object(n.createElement)("div",{className:"left"},Object(n.createElement)("div",null,Object(n.createElement)("form",{onSubmit:U,action:"javascript:void(0);",style:{display:"flex"}},Object(n.createElement)(o.TextControl,{placeholder:"Enter keywords to search layers",value:F,onChange:function(e){V(e)}}),Object(n.createElement)(o.SelectControl,{className:"jeo-layers-library-filters",hideLabelFromVision:!0,label:Object(i.__)("Layer type","jeo"),options:[{label:"Select a layer type",value:""},{label:"Mapbox",value:"mapbox"},{label:"Mapbox-tileset-vector",value:"mapbox-tileset-vector"},{label:"Mapbox-tileset-raster",value:"mapbox-tileset-raster"},{label:"Tilelayer",value:"tilelayer"},{label:"MVT",value:"mvt"}],value:D,onChange:function(e){z(e)}}),Object(n.createElement)(o.Button,{className:"jeo-layers-library-filters-button-filter",isPrimary:!0,isLarge:!0,onClick:U},Object(i.__)("Filter","jeo")),Object(n.createElement)(o.Button,{className:"jeo-layers-library-filters-button-clear",isPrimary:!0,isLarge:!0,onClick:function(){T([]),z(""),L(""),V("")}},Object(i.__)("Clear","jeo"))))),Object(n.createElement)("div",{className:"right"},Object(n.createElement)(o.Button,{className:"create-layer-button",isPrimary:!0,isLarge:!0,href:"/wp-admin/post-new.php?post_type=map-layer",target:"_blank",rel:"noopener noreferrer"},Object(i.__)("New Layer","jeo")))),Object(n.createElement)("div",{name:"map-layers",className:"jeo-layers-panel"},Object(n.createElement)("ul",{className:"jeo-layers-list"},S.map((function(e,a){var s=!1;if(t.layers.map((function(t){e.id===t.id&&(s=!0)})),e.meta.type)return Object(n.createElement)(o.Card,{key:e.id,style:{background:a%2!=0?"white":"#f9f9f9"},size:"small",className:"layer-card"},Object(n.createElement)(o.CardBody,null,Object(n.createElement)("li",{className:"jeo-setting-layer all-layers-list"},Object(n.createElement)("div",{className:"layer-info"},Object(n.createElement)("p",{className:"layer-info__single-row"},Object(n.createElement)("a",{className:"all-layers-list-link",href:"/wp-admin/post.php?post=".concat(e.id,"&action=edit"),target:"_blank",rel:"noopener noreferrer"},Object(n.createElement)("strong",{className:"layer-title"},e.title.rendered.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})))," | ",e.meta.type)),Object(n.createElement)("div",{className:"layer-buttons"},!s&&Object(n.createElement)("p",{onClick:function(){var n;r(O(O({},t),{},{layers:[].concat(c()(t.layers),[(n=e.id,{id:n,use:"fixed",default:!0})])}))},className:"add-button"},"Add to map"),s&&Object(n.createElement)("p",{onClick:function(){if(confirm(Object(i.__)("Do you really want to delete this layer?","jeo")))return h(t.layers.filter((function(t){return t.id!==e.id})))},className:"remove-button"},"Remove from map"))))))})))),Object(n.createElement)("h2",{className:"selected-layers-title"},Object(i.__)("Selected layers","jeo")),a&&Object(n.createElement)(o.Spinner,null),!a&&!t.layers.length&&Object(n.createElement)("p",{className:"jeo-layers-list"},Object(i.__)("No layers have been added to this map.","jeo")),!a&&t.layers.length>0&&Object(n.createElement)(w.a,{onDragEnd:function(e){if(e.destination&&e.destination.index!==e.source.index){var r=Object(_.arrayMove)(t.layers,e.source.index,e.destination.index);r.length&&(r[0].use="fixed"),r.forEach((function(e){"fixed"===e.use&&(e.default=!0)})),h(r)}}},Object(n.createElement)(w.c,{droppableId:"list"},(function(e){return Object(n.createElement)("div",s()({className:"jeo-layers-list",ref:e.innerRef},e.droppableProps),t.layers.map((function(e,r){var o=f(e);return o.layer?Object(n.createElement)(P,{index:r,removeLayer:function(){if(confirm(Object(i.__)("Do you really want to delete this layer?","jeo")))return h(t.layers.filter((function(t){return t.id!==e.id})))},settings:o,switchUseStyle:function(r){t.layers.find((function(t){return t.id===e.id}));var n=l.find((function(t){return t.id===e.id})),o=window.JeoLayerTypes.getLayerType(n.meta.type);r&&(o._getStyleDefinition(O(O({},n.meta),{},{layer_id:n.id})).then((function(r){if(r){var n=r.layers;n=n.map((function(e){return e.layout&&void 0!==e.layout.visibility&&"none"===e.layout.visibility?{id:e.id,show:!1}:{id:e.id,show:!0}})),h(t.layers.map((function(t){return t.id===e.id?O(O({},t),{},{load_as_style:!0,style_layers:n}):O(O({},t),{},{load_as_style:!1,style_layers:[]})})))}})),h(t.layers.map((function(t){return t.id===e.id?O(O({},t),{},{load_as_style:!0,style_layers:[]}):O(O({},t),{},{load_as_style:!1,style_layers:[]})}))))},switchDefault:function(r){return h(t.layers.map((function(t){return t.id===e.id?O(O({},t),{},{default:r}):t})))},switchShowLegend:function(r){h(t.layers.map((function(t){return t.id===e.id?O(O({},t),{},{show_legend:r}):t})))},swapDefault:function(r){return r&&h(t.layers.map((function(t){return O(O({},t),{},{default:"swappable"===t.use?t.id===e.id:t.default})})))},updateUse:function(r){return h(t.layers.map((function(n){return n.id!==e.id?n:O(O({},n),{},{use:r,default:"swappable"===r?!M(t.layers):"fixed"===r||n.default})})))},widths:m,updateStyleLayers:function(r){h(t.layers.map((function(t){return t.id===e.id?O(O({},t),{},{style_layers:r}):t})))},key:r}):h(t.layers.filter((function(e){return e.id!==o.id})))})),e.placeholder)}))),Object(n.createElement)(o.Button,{className:"done-button",isPrimary:!0,isLarge:!0,target:"_blank",rel:"noopener noreferrer",onClick:u},Object(i.__)("Done","jeo")))}));function z(e){var t=e.attributes,r=e.setAttributes,a=e.closeModal,s=e.loadedLayers,l=e.loadingLayers;return Object(n.createElement)(o.Modal,{className:"jeo-layers-modal",title:Object(i.__)("Layers settings","jeo"),onRequestClose:a},Object(n.createElement)(D,{attributes:t,setAttributes:r,loadedLayers:s,loadingLayers:l,closeModal:a}))}},function(e,t,r){"use strict";var n=r(8),o=r.n(n),i=r(0),a=r(16),s=r(2),l=r(5),c=r(29),u=r.n(c),d=r(137),h=r.n(d);r(235),r(237);function p(e){var t=e.startDate,r=e.startLabel,n=e.endDate,o=e.endLabel,a=e.onStartChange,s=e.onEndChange,c=Object(i.useMemo)((function(){return t?new Date(t):null}),[t]),d=Object(i.useMemo)((function(){return n?new Date(n):null}),[n]);return Object(i.createElement)("div",{className:"jeo-interval-selector"},Object(i.createElement)(l.PanelRow,null,Object(i.createElement)("label",{className:u()([t||"empty-selector"])},r,Object(i.createElement)(h.a,{dateFormat:"yyyy-MM-dd",selected:c,selectsStart:!0,startDate:c,endDate:d,onChange:a}))),Object(i.createElement)(l.PanelRow,null,Object(i.createElement)("label",{className:u()([n||"empty-selector"])},o,Object(i.createElement)(h.a,{dateFormat:"yyyy-MM-dd",selected:d,selectsEnd:!0,startDate:c,endDate:d,onChange:s}))))}var f=r(11),m=r.n(f);r(297);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v="=,!=,>,>=,<,<=,LIKE,NOT LIKE,IN,NOT IN,BETWEEN,NOT BETWEEN,NOT EXISTS,REGEXP,NOT REGEXP,RLIKE".split(",").map((function(e){return{label:e,value:e}}));function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return[].concat(m()(e.slice(0,t)),m()(r),m()(e.slice(t+1)))}function _(e){var t=e.label,r=e.onChange,n=e.value||[];return Object(i.createElement)(l.PanelRow,{className:"jeo-meta-selector"},Object(i.createElement)("label",null,t),n.map((function(e,t){return Object(i.createElement)("fieldset",{key:t},Object(i.createElement)(l.PanelRow,null,Object(i.createElement)(l.TextControl,{label:Object(s.__)("Key","jeo"),value:e.key,onChange:function(e){r(y(n,t,[b(b({},n[t]),{},{key:e})]))}})),Object(i.createElement)(l.PanelRow,null,Object(i.createElement)(l.SelectControl,{label:Object(s.__)("Comparator","jeo"),options:v,value:e.compare,onChange:function(e){r(y(n,t,[b(b({},n[t]),{},{compare:e})]))}})),Object(i.createElement)(l.PanelRow,null,Object(i.createElement)(l.TextControl,{label:Object(s.__)("Value","jeo"),value:e.value,onChange:function(e){r(y(n,t,[b(b({},n[t]),{},{value:e})]))}})),Object(i.createElement)(l.Button,{isPrimary:!0,isDestructive:!0,onClick:function(){r(y(n,t))}},Object(s.__)("Remove","jeo")))})),Object(i.createElement)("div",null,Object(i.createElement)(l.Button,{isPrimary:!0,onClick:function(){r([].concat(m()(n),[{key:"",value:"",compare:"="}]))}},Object(s.__)("Add","jeo"))))}function w(e){var t=e.collection,r=e.label,n=e.loadingCollection,o=e.onChange,a=e.value,s=Object(i.useMemo)((function(){return n?[]:t.map((function(e){return e.name}))}),[t,n]),c=Object(i.useCallback)((function(e){var r=t.find((function(t){return t.id===e}));return r?r.name:e}),[t]),u=Object(i.useCallback)((function(e){var r=t.find((function(t){return t.name===e.trim()}));return String(r?r.id:e)}),[t]),d=Object(i.useCallback)((function(e){e=e.filter((function(e){return!isNaN(e)})),o(e.map(Number))}),[o]);return Object(i.createElement)(l.FormTokenField,{label:r,value:a,suggestions:s,displayTransform:c,saveTransform:u,onChange:d})}r(299);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.a=Object(a.withDispatch)((function(e){return{setPostMeta:function(t){e("core/editor").editPost({meta:t})}}}))(Object(a.withSelect)((function(e){return{loadedCategories:e("core").getEntityRecords("taxonomy","category"),loadingCategories:e("core/data").isResolving("core","getEntityRecords",["taxonomy","category"]),loadedTags:e("core").getEntityRecords("taxonomy","post_tag"),loadingTags:e("core/data").isResolving("core","getEntityRecords",["taxonomy","post_tag"]),postMeta:e("core/editor").getEditedPostAttribute("meta")}}))((function(e){var t=e.loadedCategories,r=e.loadingCategories,n=e.loadedTags,o=e.loadingTags,a=e.relatedPosts,c=e.setRelatedPosts,u=e.renderPanel,d=e.postMeta,h=e.setPostMeta;return Object(i.createElement)(u,{name:"related-posts",title:Object(s.__)("Related posts","jeo")},Object(i.createElement)(l.CheckboxControl,{className:"related-posts-checkbox",label:Object(s.__)("Use related posts","jeo"),checked:d.relate_posts,onChange:function(){h(k(k({},d),{},{relate_posts:!d.relate_posts}))}}),d.relate_posts&&Object(i.createElement)(i.Fragment,null,t&&Object(i.createElement)(w,{label:Object(s.__)("Categories","jeo"),collection:t,loadingCollection:r,value:a.categories,onChange:function(e){c(k(k({},a),{},{categories:e}))}}),n&&Object(i.createElement)(w,{label:Object(s.__)("Tags","jeo"),collection:n,loadingCollection:o,value:a.tags,onChange:function(e){c(k(k({},a),{},{tags:e}))}}),Object(i.createElement)(p,{startDate:a.after,endDate:a.before,startLabel:Object(s.__)("Start date","jeo"),endLabel:Object(s.__)("End date","jeo"),onStartChange:function(e){c(k(k({},a),{},{after:e?e.toISOString():void 0}))},onEndChange:function(e){c(k(k({},a),{},{before:e?e.toISOString():void 0}))}}),Object(i.createElement)(_,{label:Object(s.__)("Meta queries","jeo"),value:a.meta_query,onChange:function(e){c(k(k({},a),{},{meta_query:e}))}})))})))},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(0),o=r(2),i=r(8),a=r.n(i),s=r(5);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={initial_zoom:jeo_settings.map_defaults.zoom,center_lat:jeo_settings.map_defaults.lat,center_lon:jeo_settings.map_defaults.lng,min_zoom:0,max_zoom:20,disable_scroll_zoom:jeo_settings.map_defaults.disable_scroll_zoom,disable_drag_pan:jeo_settings.map_defaults.disable_drag_pan,disable_drag_rotate:jeo_settings.map_defaults.disable_drag_rotate,enable_fullscreen:jeo_settings.map_defaults.enable_fullscreen};function d(e){if(""===e)return"";var t=Number(e);return isNaN(t)?e:t}var h=function(e){var t,r,i,l,h=e.attributes,p=e.setAttributes,f=e.setPanLimitsFromMap,m=c(c({},u),h),g=m.center_lat,b=m.center_lon,v=m.initial_zoom,y=m.min_zoom,_=m.max_zoom,w=function(e){return function(t){p(c(c({},h),{},a()({},e,t)))}},x=Object(n.useRef)(!1);return window.initial_zoom=v,window.min_zoom=y,window.max_zoom=_,Object(n.createElement)(n.Fragment,null,Object(n.createElement)("form",{className:"jeo-map-settings"},Object(n.createElement)("section",{className:"center"},Object(n.createElement)("h3",null,Object(o.__)("Center","jeo")),Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("Latitude","jeo"),value:g,onChange:function(e){return x.current=!0,setTimeout((function(){return x.current=!1}),50),w("center_lat")(d(e))}}),Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("Longitude","jeo"),value:b,onChange:function(e){return x.current=!0,setTimeout((function(){return x.current=!1}),50),w("center_lon")(d(e))}})),Object(n.createElement)("section",{className:"zoom"},Object(n.createElement)("h3",null,Object(o.__)("Zoom","jeo")),Object(n.createElement)(s.RangeControl,{label:Object(o.__)("Initial zoom","jeo"),initialPosition:11,min:y,max:_,step:.1,value:v,onChange:function(e){var t=e;t||(t=y),window.initial_zoom=t,w("initial_zoom")(t)}}),Object(n.createElement)(s.RangeControl,{label:Object(o.__)("Min zoom","jeo"),initialPosition:0,min:0,max:v,step:.1,value:y,onChange:function(e){var t=e;t||(t=0),window.min_zoom=t,w("min_zoom")(t)}}),Object(n.createElement)(s.RangeControl,{label:Object(o.__)("Max zoom","jeo"),initialPosition:20,min:v,max:20,step:.1,value:_,onChange:function(e){var t=e;t||(t=v),window.max_zoom=t,w("max_zoom")(t)}}),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Scroll zoom on post","jeo"),checked:!h.disable_scroll_zoom,onChange:function(){w("disable_scroll_zoom")(!h.disable_scroll_zoom)}}),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Drag rotation on post","jeo"),checked:!h.disable_drag_rotate,onChange:function(){w("disable_drag_rotate")(!h.disable_drag_rotate)}}),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Map navigation on post","jeo"),checked:!h.disable_drag_pan,onChange:function(){w("disable_drag_pan")(!h.disable_drag_pan)}}),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Fullscreen button on post","jeo"),checked:h.enable_fullscreen,onChange:function(){w("enable_fullscreen")(!h.enable_fullscreen)}})),Object(n.createElement)("section",{className:"pan-limits"},Object(n.createElement)("h3",null,Object(o.__)("Pan limits","jeo")),Object(n.createElement)("p",null,Object(n.createElement)("div",{className:"pan-wrapper"},Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("North","jeo"),value:(null===(t=h.pan_limits)||void 0===t?void 0:t.north)||"__",onChange:function(e){return p(c(c({},h),{},{pan_limits:c(c({},h.pan_limits),{},{north:d(e)})}))}}),Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("East","jeo"),value:(null===(r=h.pan_limits)||void 0===r?void 0:r.east)||"__",onChange:function(e){return p(c(c({},h),{},{pan_limits:c(c({},h.pan_limits),{},{east:d(e)})}))}}),Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("South","jeo"),value:(null===(i=h.pan_limits)||void 0===i?void 0:i.south)||"__",onChange:function(e){return p(c(c({},h),{},{pan_limits:c(c({},h.pan_limits),{},{south:d(e)})}))}}),Object(n.createElement)(s.TextControl,{type:"number",label:Object(o.__)("West","jeo"),value:(null===(l=h.pan_limits)||void 0===l?void 0:l.west)||"__",onChange:function(e){return p(c(c({},h),{},{pan_limits:c(c({},h.pan_limits),{},{west:d(e)})}))}}))),Object(n.createElement)("p",null,Object(n.createElement)(s.Button,{isPrimary:!0,isLarge:!0,onClick:f},Object(o.__)("Set current as map settings","jeo")))),Object(n.createElement)("section",{className:"public-maps"},Object(n.createElement)("h3",null,Object(o.__)("For public maps only","jeo")),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Hide in discovery","jeo"),checked:h.hide_in_discovery,onChange:function(){w("hide_in_discovery")(!h.hide_in_discovery)}}),Object(n.createElement)(s.CheckboxControl,{label:Object(o.__)("Disable embed map","jeo"),checked:h.disable_embed,onChange:function(){w("disable_embed")(!h.disable_embed)}}))))},p={initial_zoom:jeo_settings.map_defaults.zoom,center_lat:jeo_settings.map_defaults.lat,center_lon:jeo_settings.map_defaults.lng,min_zoom:0,max_zoom:20};function f(e){var t=e.attributes,r=e.setAttributes,i=e.renderPanel,a=e.setPanLimitsFromMap;return Object(n.useEffect)((function(){["initial_zoom","center_lat","center_lon","min_zoom","max_zoom"].every((function(e){return!t[e]}))&&r(p)}),[]),Object(n.createElement)(i,{name:"map-settings",title:Object(o.__)("Map settings","jeo"),className:"jeo-map-panel"},Object(n.createElement)(h,{attributes:t,setAttributes:r,setPanLimitsFromMap:a}))}},function(e,t){e.exports=window.wp.blocks},,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){(function(e,n){var o;self,o=r=>(()=>{var o={703:(e,t,r)=>{"use strict";var n=r(414);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},697:(e,t,r)=>{e.exports=r(703)()},414:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},787:e=>{"use strict";e.exports=r}},i={};function a(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return o[e](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";a.r(s),a.d(s,{CKEditor:()=>ir,CKEditorContext:()=>nr});var r=a(787),o=a.n(r),i=a(697),l=a.n(i);const c=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},u="object"==typeof e&&e&&e.Object===Object&&e;var d="object"==typeof self&&self&&self.Object===Object&&self;const h=u||d||Function("return this")(),p=function(){return h.Date.now()};var f=/\s/,m=/^\s+/;const g=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&f.test(e.charAt(t)););return t}(e)+1).replace(m,""):e},b=h.Symbol;var v=Object.prototype,y=v.hasOwnProperty,_=v.toString,w=b?b.toStringTag:void 0,x=Object.prototype.toString,k=b?b.toStringTag:void 0;const C=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":k&&k in Object(e)?function(e){var t=y.call(e,w),r=e[w];try{e[w]=void 0;var n=!0}catch(e){}var o=_.call(e);return n&&(t?e[w]=r:delete e[w]),o}(e):function(e){return x.call(e)}(e)},E=function(e){return null!=e&&"object"==typeof e};var S=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,A=/^0o[0-7]+$/i,P=parseInt;const I=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||E(e)&&"[object Symbol]"==C(e)}(e))return NaN;if(c(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=c(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=g(e);var r=T.test(e);return r||A.test(e)?P(e.slice(2),r?2:8):S.test(e)?NaN:+e};var O=Math.max,M=Math.min;const D=function(e,t,r){var n=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return c(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),function(e,t,r){var n,o,i,a,s,l,u=0,d=!1,h=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=n,i=o;return n=o=void 0,u=t,a=e.apply(i,r)}function g(e){return u=e,s=setTimeout(v,t),d?m(e):a}function b(e){var r=e-l;return void 0===l||r>=t||r<0||h&&e-u>=i}function v(){var e=p();if(b(e))return y(e);s=setTimeout(v,function(e){var r=t-(e-l);return h?M(r,i-(e-u)):r}(e))}function y(e){return s=void 0,f&&n?m(e):(n=o=void 0,a)}function _(){var e=p(),r=b(e);if(n=arguments,o=this,l=e,r){if(void 0===s)return g(l);if(h)return clearTimeout(s),s=setTimeout(v,t),m(l)}return void 0===s&&(s=setTimeout(v,t)),a}return t=I(t)||0,c(r)&&(d=!!r.leading,i=(h="maxWait"in r)?O(I(r.maxWait)||0,t):i,f="trailing"in r?!!r.trailing:f),_.cancel=function(){void 0!==s&&clearTimeout(s),u=0,n=l=o=s=void 0},_.flush=function(){return void 0===s?a:y(p())},_}(e,t,{leading:n,maxWait:t,trailing:o})},z=function(e,t){return e===t||e!=e&&t!=t},j=function(e,t){for(var r=e.length;r--;)if(z(e[r][0],t))return r;return-1};var R=Array.prototype.splice;function L(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}L.prototype.clear=function(){this.__data__=[],this.size=0},L.prototype.delete=function(e){var t=this.__data__,r=j(t,e);return!(r<0||(r==t.length-1?t.pop():R.call(t,r,1),--this.size,0))},L.prototype.get=function(e){var t=this.__data__,r=j(t,e);return r<0?void 0:t[r][1]},L.prototype.has=function(e){return j(this.__data__,e)>-1},L.prototype.set=function(e,t){var r=this.__data__,n=j(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const N=L,B=function(e){if(!c(e))return!1;var t=C(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},F=h["__core-js_shared__"];var V=function(){var e=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),U=Function.prototype.toString;const q=function(e){if(null!=e){try{return U.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var H=/^\[object .+?Constructor\]$/,W=Function.prototype,G=Object.prototype,Z=W.toString,Y=G.hasOwnProperty,$=RegExp("^"+Z.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const K=function(e){return!(!c(e)||function(e){return!!V&&V in e}(e))&&(B(e)?$:H).test(q(e))},X=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return K(r)?r:void 0},J=X(h,"Map"),Q=X(Object,"create");var ee=Object.prototype.hasOwnProperty,te=Object.prototype.hasOwnProperty;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}re.prototype.clear=function(){this.__data__=Q?Q(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(Q){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return ee.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return Q?void 0!==t[e]:te.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Q&&void 0===t?"__lodash_hash_undefined__":t,this};const ne=re,oe=function(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map};function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ie.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(J||N),string:new ne}},ie.prototype.delete=function(e){var t=oe(this,e).delete(e);return this.size-=t?1:0,t},ie.prototype.get=function(e){return oe(this,e).get(e)},ie.prototype.has=function(e){return oe(this,e).has(e)},ie.prototype.set=function(e,t){var r=oe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};const ae=ie;function se(e){var t=this.__data__=new N(e);this.size=t.size}se.prototype.clear=function(){this.__data__=new N,this.size=0},se.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var r=this.__data__;if(r instanceof N){var n=r.__data__;if(!J||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ae(n)}return r.set(e,t),this.size=r.size,this};const le=se,ce=function(){try{var e=X(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ue=function(e,t,r){"__proto__"==t&&ce?ce(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var de=Object.prototype.hasOwnProperty;const he=function(e,t,r){var n=e[t];de.call(e,t)&&z(n,r)&&(void 0!==r||t in e)||ue(e,t,r)},pe=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),o?ue(r,s,l):he(r,s,l)}return r},fe=function(e){return E(e)&&"[object Arguments]"==C(e)};var me=Object.prototype,ge=me.hasOwnProperty,be=me.propertyIsEnumerable;const ve=fe(function(){return arguments}())?fe:function(e){return E(e)&&ge.call(e,"callee")&&!be.call(e,"callee")},ye=Array.isArray;var _e=t&&!t.nodeType&&t,we=_e&&"object"==typeof n&&n&&!n.nodeType&&n,xe=we&&we.exports===_e?h.Buffer:void 0;const ke=(xe?xe.isBuffer:void 0)||function(){return!1};var Ce=/^(?:0|[1-9]\d*)$/;const Ee=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ce.test(e))&&e>-1&&e%1==0&&e<t},Se=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Te={};Te["[object Float32Array]"]=Te["[object Float64Array]"]=Te["[object Int8Array]"]=Te["[object Int16Array]"]=Te["[object Int32Array]"]=Te["[object Uint8Array]"]=Te["[object Uint8ClampedArray]"]=Te["[object Uint16Array]"]=Te["[object Uint32Array]"]=!0,Te["[object Arguments]"]=Te["[object Array]"]=Te["[object ArrayBuffer]"]=Te["[object Boolean]"]=Te["[object DataView]"]=Te["[object Date]"]=Te["[object Error]"]=Te["[object Function]"]=Te["[object Map]"]=Te["[object Number]"]=Te["[object Object]"]=Te["[object RegExp]"]=Te["[object Set]"]=Te["[object String]"]=Te["[object WeakMap]"]=!1;const Ae=function(e){return function(t){return e(t)}};var Pe=t&&!t.nodeType&&t,Ie=Pe&&"object"==typeof n&&n&&!n.nodeType&&n,Oe=Ie&&Ie.exports===Pe&&u.process;const Me=function(){try{return Ie&&Ie.require&&Ie.require("util").types||Oe&&Oe.binding&&Oe.binding("util")}catch(e){}}();var De=Me&&Me.isTypedArray;const ze=De?Ae(De):function(e){return E(e)&&Se(e.length)&&!!Te[C(e)]};var je=Object.prototype.hasOwnProperty;const Re=function(e,t){var r=ye(e),n=!r&&ve(e),o=!r&&!n&&ke(e),i=!r&&!n&&!o&&ze(e),a=r||n||o||i,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)!t&&!je.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ee(c,l))||s.push(c);return s};var Le=Object.prototype;const Ne=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Le)},Be=function(e,t){return function(r){return e(t(r))}},Fe=Be(Object.keys,Object);var Ve=Object.prototype.hasOwnProperty;const Ue=function(e){return null!=e&&Se(e.length)&&!B(e)},qe=function(e){return Ue(e)?Re(e):function(e){if(!Ne(e))return Fe(e);var t=[];for(var r in Object(e))Ve.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)};var He=Object.prototype.hasOwnProperty;const We=function(e){if(!c(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Ne(e),r=[];for(var n in e)("constructor"!=n||!t&&He.call(e,n))&&r.push(n);return r},Ge=function(e){return Ue(e)?Re(e,!0):We(e)};var Ze=t&&!t.nodeType&&t,Ye=Ze&&"object"==typeof n&&n&&!n.nodeType&&n,$e=Ye&&Ye.exports===Ze?h.Buffer:void 0,Ke=$e?$e.allocUnsafe:void 0;const Xe=function(){return[]};var Je=Object.prototype.propertyIsEnumerable,Qe=Object.getOwnPropertySymbols;const et=Qe?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}(Qe(e),(function(t){return Je.call(e,t)})))}:Xe,tt=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},rt=Be(Object.getPrototypeOf,Object),nt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)tt(t,et(e)),e=rt(e);return t}:Xe,ot=function(e,t,r){var n=t(e);return ye(e)?n:tt(n,r(e))},it=function(e){return ot(e,qe,et)},at=function(e){return ot(e,Ge,nt)},st=X(h,"DataView"),lt=X(h,"Promise"),ct=X(h,"Set"),ut=X(h,"WeakMap");var dt="[object Map]",ht="[object Promise]",pt="[object Set]",ft="[object WeakMap]",mt="[object DataView]",gt=q(st),bt=q(J),vt=q(lt),yt=q(ct),_t=q(ut),wt=C;(st&&wt(new st(new ArrayBuffer(1)))!=mt||J&&wt(new J)!=dt||lt&&wt(lt.resolve())!=ht||ct&&wt(new ct)!=pt||ut&&wt(new ut)!=ft)&&(wt=function(e){var t=C(e),r="[object Object]"==t?e.constructor:void 0,n=r?q(r):"";if(n)switch(n){case gt:return mt;case bt:return dt;case vt:return ht;case yt:return pt;case _t:return ft}return t});const xt=wt;var kt=Object.prototype.hasOwnProperty;const Ct=h.Uint8Array,Et=function(e){var t=new e.constructor(e.byteLength);return new Ct(t).set(new Ct(e)),t};var St=/\w*$/,Tt=b?b.prototype:void 0,At=Tt?Tt.valueOf:void 0;const Pt=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Et(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return function(e,t){var r=t?Et(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?Et(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,St.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return At?Object(At.call(e)):{}}(e)}};var It=Object.create;const Ot=function(){function e(){}return function(t){if(!c(t))return{};if(It)return It(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Mt=Me&&Me.isMap;const Dt=Mt?Ae(Mt):function(e){return E(e)&&"[object Map]"==xt(e)};var zt=Me&&Me.isSet;const jt=zt?Ae(zt):function(e){return E(e)&&"[object Set]"==xt(e)};var Rt="[object Arguments]",Lt="[object Function]",Nt={};Nt[Rt]=Nt["[object Array]"]=Nt["[object ArrayBuffer]"]=Nt["[object DataView]"]=Nt["[object Boolean]"]=Nt["[object Date]"]=Nt["[object Float32Array]"]=Nt["[object Float64Array]"]=Nt["[object Int8Array]"]=Nt["[object Int16Array]"]=Nt["[object Int32Array]"]=Nt["[object Map]"]=Nt["[object Number]"]=Nt["[object Object]"]=Nt["[object RegExp]"]=Nt["[object Set]"]=Nt["[object String]"]=Nt["[object Symbol]"]=Nt["[object Uint8Array]"]=Nt["[object Uint8ClampedArray]"]=Nt["[object Uint16Array]"]=Nt["[object Uint32Array]"]=!0,Nt["[object Error]"]=Nt[Lt]=Nt["[object WeakMap]"]=!1;const Bt=function e(t,r,n,o,i,a){var s,l=1&r,u=2&r,d=4&r;if(n&&(s=i?n(t,o,i,a):n(t)),void 0!==s)return s;if(!c(t))return t;var h=ye(t);if(h){if(s=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&kt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!l)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(t,s)}else{var p=xt(t),f=p==Lt||"[object GeneratorFunction]"==p;if(ke(t))return function(e,t){if(t)return e.slice();var r=e.length,n=Ke?Ke(r):new e.constructor(r);return e.copy(n),n}(t,l);if("[object Object]"==p||p==Rt||f&&!i){if(s=u||f?{}:function(e){return"function"!=typeof e.constructor||Ne(e)?{}:Ot(rt(e))}(t),!l)return u?function(e,t){return pe(e,nt(e),t)}(t,function(e,t){return e&&pe(t,Ge(t),e)}(s,t)):function(e,t){return pe(e,et(e),t)}(t,function(e,t){return e&&pe(t,qe(t),e)}(s,t))}else{if(!Nt[p])return i?t:{};s=Pt(t,p,l)}}a||(a=new le);var m=a.get(t);if(m)return m;a.set(t,s),jt(t)?t.forEach((function(o){s.add(e(o,r,n,o,t,a))})):Dt(t)&&t.forEach((function(o,i){s.set(i,e(o,r,n,i,t,a))}));var g=h?void 0:(d?u?at:it:u?Ge:qe)(t);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););}(g||t,(function(o,i){g&&(o=t[i=o]),he(s,i,e(o,r,n,i,t,a))})),s};var Ft=Function.prototype,Vt=Object.prototype,Ut=Ft.toString,qt=Vt.hasOwnProperty,Ht=Ut.call(Object);const Wt=function(e){return E(e)&&1===e.nodeType&&!function(e){if(!E(e)||"[object Object]"!=C(e))return!1;var t=rt(e);if(null===t)return!0;var r=qt.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ut.call(r)==Ht}(e)};function Gt(e,t=new Set){const r=[e],n=new Set;let o=0;for(;r.length>o;){const i=r[o++];if(!(n.has(i)||Zt(i)||t.has(i)))if(n.add(i),i[Symbol.iterator])try{for(const e of i)r.push(e)}catch(e){}else for(const e in i)"defaultValue"!==e&&r.push(i[e])}return n}function Zt(e){const t=Object.prototype.toString.call(e),r=typeof e;return"number"===r||"boolean"===r||"string"===r||"symbol"===r||"function"===r||"[object Date]"===t||"[object RegExp]"===t||"[object Module]"===t||null==e||e instanceof EventTarget||e instanceof Event}function Yt(e,t,r=new Set){if(e===t&&"object"==typeof(n=e)&&null!==n)return!0;var n;const o=Gt(e,r),i=Gt(t,r);for(const e of o)if(i.has(e))return!0;return!1}class $t{constructor(e){if(this.crashes=[],this.state="initializing",this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._now=Date.now,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=e=>{const t=e.error||e.reason;t instanceof Error&&this._handleError(t,e)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(e=>e!==t)}_fire(e,...t){const r=this._listeners[e]||[];for(const e of r)e.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t.filename,lineno:t.lineno,colno:t.colno,date:this._now()});const r=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:r}),r?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&void 0!==e.context&&null!==e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){return this.crashes.length<=this._crashNumberLimit||(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}class Kt extends $t{constructor(e,t={}){super(t),this._editor=null,this._throttledSave=D(this._save.bind(this),"number"==typeof t.saveInterval?t.saveInterval:5e3),this._creator=(t,r)=>e.create(t,r),this._destructor=e=>e.destroy()}get editor(){return this._editor}get _item(){return this._editor}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{if("string"==typeof this._elementOrData)return this.create(this._data,this._config,this._config.context);{const e=Object.assign({},this._config,{initialData:this._data});return this.create(this._elementOrData,e,e.context)}}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,r){return Promise.resolve().then(()=>(super._startErrorHandling(),this._elementOrData=e,this._config=this._cloneEditorConfiguration(t)||{},this._config.context=r,this._creator(e,this._config))).then(e=>{this._editor=e,e.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=e.model.document.version,this._data=this._getData(),this.state="ready",this._fire("stateChange")})}destroy(){return Promise.resolve().then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.flush();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._lastDocumentVersion=e}catch(e){console.error(e,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e={};for(const t of this._editor.model.document.getRootNames())e[t]=this._editor.data.get({rootName:t});return e}_isErrorComingFromThisItem(e){return Yt(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return function(e,t){return Bt(e,5,t="function"==typeof t?t:void 0)}(e,(e,t)=>Wt(e)||"context"===t?e:void 0)}}const Xt=new Array(256).fill().map((e,t)=>("0"+t.toString(16)).slice(-2)),Jt=Symbol("MainQueueId");class Qt extends $t{constructor(e,t={}){super(t),this._watchdogs=new Map,this._watchdogConfig=t,this._context=null,this._contextProps=new Set,this._actionQueues=new er,this._creator=t=>e.create(t),this._destructor=e=>e.destroy(),this._actionQueues.onEmpty(()=>{"initializing"===this.state&&(this.state="ready",this._fire("stateChange"))})}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(Jt,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=tr(e);return Promise.all(t.map(e=>this._actionQueues.enqueue(e.id,()=>{if("destroyed"===this.state)throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let t;if(this._watchdogs.has(e.id))throw new Error(`Item with the given id is already added: '${e.id}'.`);if("editor"===e.type)return t=new Kt(this._watchdogConfig),t.setCreator(e.creator),t._setExcludedProperties(this._contextProps),e.destructor&&t.setDestructor(e.destructor),this._watchdogs.set(e.id,t),t.on("error",(r,{error:n,causesRestart:o})=>{this._fire("itemError",{itemId:e.id,error:n}),o&&this._actionQueues.enqueue(e.id,()=>new Promise(r=>{t.on("restart",function n(){t.off("restart",n),this._fire("itemRestart",{itemId:e.id}),r()}.bind(this))}))}),t.create(e.sourceElementOrData,e.config,this._context);throw new Error(`Not supported item type: '${e.type}'.`)})))}remove(e){const t=tr(e);return Promise.all(t.map(e=>this._actionQueues.enqueue(e,()=>{const t=this._getWatchdog(e);return this._watchdogs.delete(e),t.destroy()})))}destroy(){return this._actionQueues.enqueue(Jt,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(Jt,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=Gt(this._context),Promise.all(Array.from(this._watchdogs.values()).map(e=>(e._setExcludedProperties(this._contextProps),e.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(e=>e.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return Yt(this._context,e.context)}}class er{constructor(){this._onEmptyCallbacks=[],this._queues=new Map,this._actions=new WeakMap,this._lastActionId=0,this._activeActions=0}onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const r=e===Jt;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const n=(r?Promise.all(this._queues.values()):Promise.all([this._queues.get(Jt),this._queues.get(e)])).then(t),o=n.catch(()=>{});return this._queues.set(e,o),n.finally(()=>{this._activeActions--,this._queues.get(e)===o&&0===this._activeActions&&this._onEmptyCallbacks.forEach(e=>e())})}}function tr(e){return Array.isArray(e)?e:[e]}const rr=o().createContext("contextWatchdog");class nr extends o().Component{constructor(e,t){super(e,t),this.contextWatchdog=null,this.props.isLayoutReady&&this._initializeContextWatchdog(this.props.config)}async shouldComponentUpdate(e){return e.id!==this.props.id&&(this.contextWatchdog&&await this.contextWatchdog.destroy(),await this._initializeContextWatchdog(e.config)),e.isLayoutReady&&!this.contextWatchdog?(await this._initializeContextWatchdog(e.config),!0):this.props.children!==e.children}render(){return o().createElement(rr.Provider,{value:this.contextWatchdog},this.props.children)}async componentWillUnmount(){await this._destroyContext()}async _initializeContextWatchdog(e){this.contextWatchdog=new Qt(this.props.context),this.contextWatchdog.on("error",(e,t)=>{this.props.onError(t.error,{phase:"runtime",willContextRestart:t.causesRestart})}),this.contextWatchdog.on("stateChange",()=>{"ready"===this.contextWatchdog.state&&this.props.onReady&&this.props.onReady(this.contextWatchdog.context)}),await this.contextWatchdog.create(e).catch(e=>{this.props.onError(e,{phase:"initialization",willContextRestart:!1})})}async _destroyContext(){this.contextWatchdog&&(await this.contextWatchdog.destroy(),this.contextWatchdog=null)}}nr.defaultProps={isLayoutReady:!0,onError:(e,t)=>console.error(e,t)},nr.propTypes={id:l().string,isLayoutReady:l().bool,context:l().func,config:l().object,onReady:l().func,onError:l().func};const or="Lock from React integration (@ckeditor/ckeditor5-react)";class ir extends o().Component{constructor(e){super(e),this.domContainer=o().createRef(),this.watchdog=null;const{CKEDITOR_VERSION:t}=window;if(t){const[e]=t.split(".").map(Number);e<34&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 34 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}get editor(){return this.watchdog?this.watchdog.editor:null}shouldComponentUpdate(e){return!(!this.editor||e.id===this.props.id&&(this._shouldUpdateEditor(e)&&this.editor.setData(e.data),"disabled"in e&&(e.disabled?this.editor.enableReadOnlyMode(or):this.editor.disableReadOnlyMode(or)),1))}async componentDidMount(){await this._initializeEditor()}async componentDidUpdate(){await this._destroyEditor(),await this._initializeEditor()}async componentWillUnmount(){await this._destroyEditor()}render(){return o().createElement("div",{ref:this.domContainer})}async _initializeEditor(){this.watchdog||(this.context instanceof Qt?this.watchdog=new ar(this.context):this.watchdog=new ir._EditorWatchdog(this.props.editor),this.watchdog.setCreator((e,t)=>this._createEditor(e,t)),this.watchdog.on("error",(e,{error:t,causesRestart:r})=>{this.props.onError(t,{phase:"runtime",willEditorRestart:r})}),await this.watchdog.create(this.domContainer.current,this._getConfig()).catch(e=>this.props.onError(e,{phase:"initialization",willEditorRestart:!1})))}_createEditor(e,t){return this.props.editor.create(e,t).then(e=>{"disabled"in this.props&&this.props.disabled&&e.enableReadOnlyMode(or);const t=e.model.document,r=e.editing.view.document;return t.on("change:data",t=>{this.props.onChange&&this.props.onChange(t,e)}),r.on("focus",t=>{this.props.onFocus&&this.props.onFocus(t,e)}),r.on("blur",t=>{this.props.onBlur&&this.props.onBlur(t,e)}),setTimeout(()=>{this.props.onReady&&this.props.onReady(this.editor)}),e})}async _destroyEditor(){this.editor&&(await this.watchdog.destroy(),this.watchdog=null)}_shouldUpdateEditor(e){return this.props.data!==e.data&&this.editor.getData()!==e.data}_getConfig(){return this.props.data&&this.props.config.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `data` properties. The config property is over the data value and the first one will be used when specified both."),{...this.props.config,initialData:this.props.config.initialData||this.props.data||""}}}class ar{constructor(e){this._contextWatchdog=e,this._id=function(){const e=4294967296*Math.random()>>>0,t=4294967296*Math.random()>>>0,r=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return"e"+Xt[e>>0&255]+Xt[e>>8&255]+Xt[e>>16&255]+Xt[e>>24&255]+Xt[t>>0&255]+Xt[t>>8&255]+Xt[t>>16&255]+Xt[t>>24&255]+Xt[r>>0&255]+Xt[r>>8&255]+Xt[r>>16&255]+Xt[r>>24&255]+Xt[n>>0&255]+Xt[n>>8&255]+Xt[n>>16&255]+Xt[n>>24&255]}()}setCreator(e){this._creator=e}create(e,t){return this._contextWatchdog.add({sourceElementOrData:e,config:t,creator:this._creator,id:this._id,type:"editor"})}on(e,t){this._contextWatchdog.on("itemError",(e,{itemId:r,causesRestart:n,error:o})=>{r===this._id&&t(null,{error:o,causesRestart:n})})}destroy(){this._contextWatchdog.remove(this._id)}get editor(){return this._contextWatchdog.getItem(this._id)}}ir.contextType=rr,ir.propTypes={editor:l().func.isRequired,data:l().string,config:l().object,onChange:l().func,onReady:l().func,onFocus:l().func,onBlur:l().func,onError:l().func,disabled:l().bool,onInit:(e,t)=>{if(e[t])return new Error('The "onInit" property is not supported anymore by the CKEditor component. Use the "onReady" property instead.')}},ir.defaultProps={config:{},onError:(e,t)=>console.error(e,t)},ir._EditorWatchdog=Kt})(),s})(),n.exports=o(r(1))}).call(this,r(43),r(119)(e))},function(e,t,r){(function(e,r){self,r.exports=(()=>{"use strict";var n={8180:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content code{background-color:hsla(0,0%,78%,.3);padding:.15em;border-radius:2px}.ck.ck-editor__editable .ck-code_selected{background-color:hsla(0,0%,78%,.5)}",""]);const i=o},636:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}",""]);const i=o},9085:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content pre{padding:1em;color:#353535;background:hsla(0,0%,78%,.3);border:1px solid #c4c4c4;border-radius:2px;text-align:left;direction:ltr;tab-size:4;white-space:pre-wrap;font-style:normal;min-width:200px}.ck-content pre code{background:unset;padding:0;border-radius:0}.ck.ck-editor__editable pre{position:relative}.ck.ck-editor__editable pre[data-language]:after{content:attr(data-language);position:absolute}:root{--ck-color-code-block-label-background:#757575}.ck.ck-editor__editable pre[data-language]:after{top:-1px;right:10px;background:var(--ck-color-code-block-label-background);font-size:10px;font-family:var(--ck-font-face);line-height:16px;padding:var(--ck-spacing-tiny) var(--ck-spacing-medium);color:#fff;white-space:nowrap}.ck.ck-code-block-dropdown .ck-dropdown__panel{max-height:250px;overflow-y:auto;overflow-x:hidden}",""]);const i=o},3638:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-editor{position:relative}.ck.ck-editor .ck-editor__top .ck-sticky-panel .ck-toolbar{z-index:var(--ck-z-modal)}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-bottom-width:0}.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar{border-bottom-width:1px;border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:0}.ck.ck-editor__main>.ck-editor__editable{background:var(--ck-color-base-background);border-radius:0}.ck-rounded-corners .ck.ck-editor__main>.ck-editor__editable,.ck.ck-editor__main>.ck-editor__editable.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){border-color:var(--ck-color-base-border)}",""]);const i=o},8894:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}",""]);const i=o},2585:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-button.ck-color-table__remove-color{display:flex;align-items:center;width:100%}label.ck.ck-color-grid__label{font-weight:unset}.ck .ck-button.ck-color-table__remove-color{padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck .ck-button.ck-color-table__remove-color:not(:focus){border-bottom:1px solid var(--ck-color-base-border)}[dir=ltr] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-left:var(--ck-spacing-standard)}",""]);const i=o},6203:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .text-tiny{font-size:.7em}.ck-content .text-small{font-size:.85em}.ck-content .text-big{font-size:1.4em}.ck-content .text-huge{font-size:1.8em}",""]);const i=o},3230:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}",""]);const i=o},713:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-highlight-marker-yellow:#fdfd77;--ck-highlight-marker-green:#62f962;--ck-highlight-marker-pink:#fc7899;--ck-highlight-marker-blue:#72ccfd;--ck-highlight-pen-red:#e71313;--ck-highlight-pen-green:#128a00}.ck-content .marker-yellow{background-color:var(--ck-highlight-marker-yellow)}.ck-content .marker-green{background-color:var(--ck-highlight-marker-green)}.ck-content .marker-pink{background-color:var(--ck-highlight-marker-pink)}.ck-content .marker-blue{background-color:var(--ck-highlight-marker-blue)}.ck-content .pen-red{color:var(--ck-highlight-pen-red);background-color:transparent}.ck-content .pen-green{color:var(--ck-highlight-pen-green);background-color:transparent}",""]);const i=o},2536:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-editor__editable .ck-horizontal-line{display:flow-root}.ck-content hr{margin:15px 0;height:4px;background:#dedede;border:0}",""]);const i=o},3403:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-widget.raw-html-embed{margin:1em auto;position:relative;display:flow-root}.ck-widget.raw-html-embed:before{position:absolute;z-index:1}.ck-widget.raw-html-embed .raw-html-embed__buttons-wrapper{position:absolute;display:flex;flex-direction:column}.ck-widget.raw-html-embed .raw-html-embed__preview{position:relative;overflow:hidden;display:flex}.ck-widget.raw-html-embed .raw-html-embed__preview-content{width:100%;position:relative;margin:auto;display:table;border-collapse:separate;border-spacing:7px}.ck-widget.raw-html-embed .raw-html-embed__preview-placeholder{position:absolute;left:0;top:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center}.ck-content .raw-html-embed{margin:1em auto;min-width:15em;font-style:normal}:root{--ck-html-embed-content-width:calc(100% - var(--ck-icon-size)*1.5);--ck-html-embed-source-height:10em;--ck-html-embed-unfocused-outline-width:1px;--ck-html-embed-content-min-height:calc(var(--ck-icon-size) + var(--ck-spacing-standard));--ck-html-embed-source-disabled-background:var(--ck-color-base-foreground);--ck-html-embed-source-disabled-color:hsl(0deg 0% 45%)}.ck-widget.raw-html-embed{font-size:var(--ck-font-size-base);background-color:var(--ck-color-base-foreground)}.ck-widget.raw-html-embed:not(.ck-widget_selected):not(:hover){outline:var(--ck-html-embed-unfocused-outline-width) dashed var(--ck-color-widget-blurred-border)}.ck-widget.raw-html-embed[dir=ltr]{text-align:left}.ck-widget.raw-html-embed[dir=rtl]{text-align:right}.ck-widget.raw-html-embed:before{content:attr(data-html-embed-label);top:calc(var(--ck-html-embed-unfocused-outline-width)*-1);left:var(--ck-spacing-standard);background:hsl(0deg 0% 60%);transition:background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);padding:calc(var(--ck-spacing-tiny) + var(--ck-html-embed-unfocused-outline-width)) var(--ck-spacing-small) var(--ck-spacing-tiny);border-radius:0 0 var(--ck-border-radius) var(--ck-border-radius);color:var(--ck-color-base-background);font-size:var(--ck-font-size-tiny);font-family:var(--ck-font-face)}.ck-widget.raw-html-embed[dir=rtl]:before{left:auto;right:var(--ck-spacing-standard)}.ck-widget.raw-html-embed[dir=ltr] .ck-widget__type-around .ck-widget__type-around__button.ck-widget__type-around__button_before{margin-left:50px}.ck.ck-editor__editable.ck-blurred .ck-widget.raw-html-embed.ck-widget_selected:before{top:0;padding:var(--ck-spacing-tiny) var(--ck-spacing-small)}.ck.ck-editor__editable:not(.ck-blurred) .ck-widget.raw-html-embed.ck-widget_selected:before{top:0;padding:var(--ck-spacing-tiny) var(--ck-spacing-small);background:var(--ck-color-focus-border)}.ck.ck-editor__editable .ck-widget.raw-html-embed:not(.ck-widget_selected):hover:before{top:0;padding:var(--ck-spacing-tiny) var(--ck-spacing-small)}.ck-widget.raw-html-embed .raw-html-embed__content-wrapper{padding:var(--ck-spacing-standard)}.ck-widget.raw-html-embed .raw-html-embed__buttons-wrapper{top:var(--ck-spacing-standard);right:var(--ck-spacing-standard)}.ck-widget.raw-html-embed .raw-html-embed__buttons-wrapper .ck-button.raw-html-embed__save-button{color:var(--ck-color-button-save)}.ck-widget.raw-html-embed .raw-html-embed__buttons-wrapper .ck-button.raw-html-embed__cancel-button{color:var(--ck-color-button-cancel)}.ck-widget.raw-html-embed .raw-html-embed__buttons-wrapper .ck-button:not(:first-child){margin-top:var(--ck-spacing-small)}.ck-widget.raw-html-embed[dir=rtl] .raw-html-embed__buttons-wrapper{left:var(--ck-spacing-standard);right:auto}.ck-widget.raw-html-embed .raw-html-embed__source{box-sizing:border-box;height:var(--ck-html-embed-source-height);width:var(--ck-html-embed-content-width);resize:none;min-width:0;padding:var(--ck-spacing-standard);font-family:monospace;tab-size:4;white-space:pre-wrap;font-size:var(--ck-font-size-base);text-align:left;direction:ltr}.ck-widget.raw-html-embed .raw-html-embed__source[disabled]{background:var(--ck-html-embed-source-disabled-background);color:var(--ck-html-embed-source-disabled-color);-webkit-text-fill-color:var(--ck-html-embed-source-disabled-color);opacity:1}.ck-widget.raw-html-embed .raw-html-embed__preview{min-height:var(--ck-html-embed-content-min-height);width:var(--ck-html-embed-content-width)}.ck-editor__editable:not(.ck-read-only) .ck-widget.raw-html-embed .raw-html-embed__preview{pointer-events:none}.ck-widget.raw-html-embed .raw-html-embed__preview-content{box-sizing:border-box;text-align:center;background-color:var(--ck-color-base-foreground)}.ck-widget.raw-html-embed .raw-html-embed__preview-content>*{margin-left:auto;margin-right:auto}.ck-widget.raw-html-embed .raw-html-embed__preview-placeholder{color:var(--ck-html-embed-source-disabled-color)}",""]);const i=o},9048:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .image{display:table;clear:both;text-align:center;margin:1em auto}.ck-content .image img{display:block;margin:0 auto;max-width:100%;min-width:50px}",""]);const i=o},8662:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:#333;background-color:#f7f7f7;padding:.6em;font-size:.75em;outline-offset:-1px}",""]);const i=o},1043:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .image.image_resized{max-width:100%;display:block;box-sizing:border-box}.ck-content .image.image_resized img{width:100%}.ck-content .image.image_resized>figcaption{display:block}[dir=ltr] .ck.ck-button.ck-button_with-text.ck-resize-image-button .ck-button__icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-button.ck-button_with-text.ck-resize-image-button .ck-button__icon{margin-left:var(--ck-spacing-standard)}.ck.ck-dropdown .ck-button.ck-resize-image-button .ck-button__label{width:4em}",""]);const i=o},4622:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-image-style-spacing:1.5em}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing);max-width:50%}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}",""]);const i=o},9899:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}',""]);const i=o},9825:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}',""]);const i=o},5870:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-editor__editable .image{position:relative}.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}",""]);const i=o},6831:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-field-view{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}",""]);const i=o},399:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}.ck .ck-fake-link-selection{background:var(--ck-color-link-fake-selection)}.ck .ck-fake-link-selection_collapsed{height:100%;border-right:1px solid var(--ck-color-base-text);margin-right:-1px;outline:1px solid hsla(0,0%,100%,.5)}",""]);const i=o},9465:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview),[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}}",""]);const i=o},4827:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form_layout-vertical .ck-button.ck-button-cancel,.ck.ck-link-form_layout-vertical .ck-button.ck-button-save{margin-top:var(--ck-spacing-medium)}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button,[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin:var(--ck-spacing-standard) var(--ck-spacing-large)}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;padding:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}",""]);const i=o},5777:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .media{clear:both;margin:1em 0;display:block;min-width:15em}",""]);const i=o},952:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(var(--ck-spacing-standard)*3);background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c7,#b800b1,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}',""]);const i=o},3525:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-field-view{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}",""]);const i=o},7583:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-color-mention-background:rgba(153,0,48,0.1);--ck-color-mention-text:#990030}.ck-content .mention{background:var(--ck-color-mention-background);color:var(--ck-color-mention-text)}",""]);const i=o},6391:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-mention-list-max-height:300px}.ck.ck-mentions{max-height:var(--ck-mention-list-max-height);overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain}.ck.ck-mentions>.ck-list__item{overflow:hidden;flex-shrink:0}",""]);const i=o},6448:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck-content .page-break{position:relative;clear:both;padding:5px 0;display:flex;align-items:center;justify-content:center}.ck-content .page-break:after{content:"";position:absolute;border-bottom:2px dashed #c4c4c4;width:100%}.ck-content .page-break__label{position:relative;z-index:1;padding:.3em .6em;display:block;text-transform:uppercase;border:1px solid #c4c4c4;border-radius:2px;font-family:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;font-size:.75em;font-weight:700;color:#333;background:#fff;box-shadow:2px 2px 1px rgba(0,0,0,.15);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media print{.ck-content .page-break{padding:0}.ck-content .page-break:after{display:none}}',""]);const i=o},2353:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-color-restricted-editing-exception-background:rgba(255,169,77,0.2);--ck-color-restricted-editing-exception-hover-background:rgba(255,169,77,0.35);--ck-color-restricted-editing-exception-brackets:rgba(204,105,0,0.4);--ck-color-restricted-editing-selected-exception-background:rgba(255,169,77,0.5);--ck-color-restricted-editing-selected-exception-brackets:rgba(204,105,0,0.6)}.ck-editor__editable .restricted-editing-exception{transition:background .2s ease-in-out;background-color:var(--ck-color-restricted-editing-exception-background);border:1px solid;border-image:linear-gradient(90deg,var(--ck-color-restricted-editing-exception-brackets) 0,var(--ck-color-restricted-editing-exception-brackets) 5px,transparent 6px,transparent calc(100% - 6px),var(--ck-color-restricted-editing-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-exception-brackets)) 1}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_selected{background-color:var(--ck-color-restricted-editing-selected-exception-background);border-image:linear-gradient(90deg,var(--ck-color-restricted-editing-selected-exception-brackets) 0,var(--ck-color-restricted-editing-selected-exception-brackets) 5px,var(--ck-color-restricted-editing-selected-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-selected-exception-brackets)) 1}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_collapsed{padding-left:1ch}.ck-restricted-editing_mode_restricted,.ck-restricted-editing_mode_restricted *{cursor:default}.ck-restricted-editing_mode_restricted .restricted-editing-exception,.ck-restricted-editing_mode_restricted .restricted-editing-exception *{cursor:text}.ck-restricted-editing_mode_restricted .restricted-editing-exception:hover{background:var(--ck-color-restricted-editing-exception-hover-background)}",""]);const i=o},4046:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-character-grid{max-width:100%}.ck.ck-character-grid .ck-character-grid__tiles{display:grid}:root{--ck-character-grid-tile-size:24px}.ck.ck-character-grid{overflow-y:auto;overflow-x:hidden;width:350px;max-height:200px}.ck.ck-character-grid .ck-character-grid__tiles{grid-template-columns:repeat(auto-fit,minmax(var(--ck-character-grid-tile-size),1fr));margin:var(--ck-spacing-standard) var(--ck-spacing-large);grid-gap:var(--ck-spacing-standard)}.ck.ck-character-grid .ck-character-grid__tile{width:var(--ck-character-grid-tile-size);height:var(--ck-character-grid-tile-size);min-width:var(--ck-character-grid-tile-size);min-height:var(--ck-character-grid-tile-size);font-size:1.2em;padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-character-grid .ck-character-grid__tile:focus:not(.ck-disabled),.ck.ck-character-grid .ck-character-grid__tile:hover:not(.ck-disabled){border:0;box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-character-grid .ck-character-grid__tile .ck-button__label{line-height:var(--ck-character-grid-tile-size);width:100%;text-align:center}",""]);const i=o},4779:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-character-info{display:flex;justify-content:space-between;padding:var(--ck-spacing-small) var(--ck-spacing-large);border-top:1px solid var(--ck-color-base-border)}.ck.ck-character-info>*{text-transform:uppercase;font-size:var(--ck-font-size-small)}.ck.ck-character-info .ck-character-info__name{max-width:280px;text-overflow:ellipsis;overflow:hidden}.ck.ck-character-info .ck-character-info__code{opacity:.6}",""]);const i=o},8170:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-special-characters-navigation>.ck-label{max-width:160px;text-overflow:ellipsis;overflow:hidden}.ck.ck-special-characters-navigation>.ck-dropdown .ck-dropdown__panel{max-height:250px;overflow-y:auto;overflow-x:hidden}",""]);const i=o},4082:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-input-color{width:100%;display:flex;flex-direction:row-reverse}.ck.ck-input-color>input.ck.ck-input-text{min-width:auto;flex-grow:1}.ck.ck-input-color>div.ck.ck-dropdown{min-width:auto}.ck.ck-input-color>div.ck.ck-dropdown>.ck-input-color__button .ck-dropdown__arrow{display:none}.ck.ck-input-color .ck.ck-input-color__button .ck.ck-input-color__button__preview{position:relative;overflow:hidden}.ck.ck-input-color .ck.ck-input-color__button .ck.ck-input-color__button__preview>.ck.ck-input-color__button__preview__no-color-indicator{position:absolute;display:block}[dir=ltr] .ck.ck-input-color>.ck.ck-input-text{border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .ck.ck-input-color>.ck.ck-input-text{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button{padding:0}[dir=ltr] .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button{border-left-width:0;border-top-left-radius:0;border-bottom-left-radius:0}[dir=rtl] .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button.ck-disabled{background:var(--ck-color-input-disabled-background)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button>.ck.ck-input-color__button__preview{border-radius:0}.ck-rounded-corners .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button>.ck.ck-input-color__button__preview,.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button>.ck.ck-input-color__button__preview.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button>.ck.ck-input-color__button__preview{width:20px;height:20px;border:1px solid var(--ck-color-input-border)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-button.ck-input-color__button>.ck.ck-input-color__button__preview>.ck.ck-input-color__button__preview__no-color-indicator{top:-30%;left:50%;height:150%;width:8%;background:red;border-radius:2px;transform:rotate(45deg);transform-origin:50%}.ck.ck-input-color .ck.ck-input-color__remove-color{width:100%;border-bottom:1px solid var(--ck-color-input-border);padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}[dir=ltr] .ck.ck-input-color .ck.ck-input-color__remove-color{border-top-right-radius:0}[dir=rtl] .ck.ck-input-color .ck.ck-input-color__remove-color{border-top-left-radius:0}.ck.ck-input-color .ck.ck-input-color__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-input-color .ck.ck-input-color__remove-color .ck.ck-icon{margin-right:0;margin-left:var(--ck-spacing-standard)}",""]);const i=o},4880:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-form{padding:0 0 var(--ck-spacing-large)}.ck.ck-form:focus{outline:none}.ck.ck-form .ck.ck-input-text{min-width:100%;width:0}.ck.ck-form .ck.ck-dropdown{min-width:100%}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button:not(:focus){border:1px solid var(--ck-color-base-border)}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button .ck-button__label{width:100%}",""]);const i=o},9865:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-form__row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.ck.ck-form__row>:not(.ck-label){flex-grow:1}.ck.ck-form__row.ck-table-form__action-row .ck-button-cancel,.ck.ck-form__row.ck-table-form__action-row .ck-button-save{justify-content:center}.ck.ck-form__row{padding:var(--ck-spacing-standard) var(--ck-spacing-large) 0}[dir=ltr] .ck.ck-form__row>:not(.ck-label)+*{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-form__row>:not(.ck-label)+*{margin-right:var(--ck-spacing-large)}.ck.ck-form__row>.ck-label{width:100%;min-width:100%}.ck.ck-form__row.ck-table-form__action-row{margin-top:var(--ck-spacing-large)}.ck.ck-form__row.ck-table-form__action-row .ck-button .ck-button__label{color:var(--ck-color-text)}",""]);const i=o},8085:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}",""]);const i=o},4104:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border:1px solid #bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}.ck-content[dir=rtl] .table th{text-align:right}.ck-content[dir=ltr] .table th{text-align:left}",""]);const i=o},5737:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row{flex-wrap:wrap}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar:first-of-type{flex-grow:0.57}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar:last-of-type{flex-grow:0.43}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar .ck-button{flex-grow:1}.ck.ck-table-cell-properties-form{width:320px}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__padding-row{align-self:flex-end;padding:0;width:25%}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar{background:none;margin-top:var(--ck-spacing-standard)}",""]);const i=o},4777:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}",""]);const i=o},6706:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck.ck-table-form .ck-form__row.ck-table-form__background-row,.ck.ck-table-form .ck-form__row.ck-table-form__border-row{flex-wrap:wrap}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row{flex-wrap:wrap;align-items:center}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-labeled-field-view{display:flex;flex-direction:column-reverse;align-items:center}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-labeled-field-view .ck.ck-dropdown,.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimension-operator{flex-grow:0}.ck.ck-table-form .ck.ck-labeled-field-view{position:relative}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status{position:absolute;left:50%;bottom:calc(var(--ck-table-properties-error-arrow-size)*-1);transform:translate(-50%,100%);z-index:1}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status:after{content:"";position:absolute;top:calc(var(--ck-table-properties-error-arrow-size)*-1);left:50%;transform:translateX(-50%)}:root{--ck-table-properties-error-arrow-size:6px;--ck-table-properties-min-error-width:150px}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-labeled-field-view>.ck-label{font-size:var(--ck-font-size-tiny);text-align:center}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-style,.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-width{width:80px;min-width:80px;max-width:80px}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row{padding:0}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimensions-row__height,.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimensions-row__width{margin:0}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimension-operator{align-self:flex-end;display:inline-block;height:var(--ck-ui-component-min-height);line-height:var(--ck-ui-component-min-height);margin:0 var(--ck-spacing-small)}.ck.ck-table-form .ck.ck-labeled-field-view{padding-top:var(--ck-spacing-standard)}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status{border-radius:0}.ck-rounded-corners .ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status,.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status{background:var(--ck-color-base-error);color:var(--ck-color-base-background);padding:var(--ck-spacing-small) var(--ck-spacing-medium);min-width:var(--ck-table-properties-min-error-width);text-align:center}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status:after{border-left:var(--ck-table-properties-error-arrow-size) solid transparent;border-bottom:var(--ck-table-properties-error-arrow-size) solid var(--ck-color-base-error);border-right:var(--ck-table-properties-error-arrow-size) solid transparent;border-top:0 solid transparent}.ck.ck-table-form .ck.ck-labeled-field-view .ck.ck-labeled-field-view__status{animation:ck-table-form-labeled-view-status-appear .15s ease both}.ck.ck-table-form .ck.ck-labeled-field-view .ck-input.ck-error:not(:focus)+.ck.ck-labeled-field-view__status{display:none}@keyframes ck-table-form-labeled-view-status-appear{0%{opacity:0}to{opacity:1}}',""]);const i=o},9221:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row{flex-wrap:wrap;flex-basis:0;align-content:baseline}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar .ck-toolbar__items{flex-wrap:nowrap}.ck.ck-table-properties-form{width:320px}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row{align-self:flex-end;padding:0}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar{background:none;margin-top:var(--ck-spacing-standard)}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar .ck-toolbar__items>*{width:40px}",""]);const i=o},5593:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,':root{--ck-table-selected-cell-background:rgba(158,207,250,0.3)}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{position:relative;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected:after,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:after{content:"";pointer-events:none;background-color:var(--ck-table-selected-cell-background);position:absolute;top:0;left:0;right:0;bottom:0}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table td.ck-editor__editable_selected:focus,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:focus{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget_selected{outline:unset}',""]);const i=o},4499:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(var(--ck-spacing-small)*-1);margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(var(--ck-spacing-small)*-1);margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}",""]);const i=o},9681:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:calc(var(--ck-switch-button-toggle-width) - var(--ck-switch-button-toggle-inner-size) - var(--ck-switch-button-toggle-spacing)*2)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(var(--ck-spacing-large)*2)}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(var(--ck-spacing-large)*2)}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(var(--ck-border-radius)*0.5)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(var(--ck-switch-button-translation)*-1))}",""]);const i=o},4923:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-color-grid{display:grid}:root{--ck-color-grid-tile-size:24px;--ck-color-color-grid-check-icon:#000}.ck.ck-color-grid{grid-gap:5px;padding:8px}.ck.ck-color-grid__tile{width:var(--ck-color-grid-tile-size);height:var(--ck-color-grid-tile-size);min-width:var(--ck-color-grid-tile-size);min-height:var(--ck-color-grid-tile-size);padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-color-grid__tile.ck-disabled{cursor:unset;transition:unset}.ck.ck-color-grid__tile.ck-color-table__color-tile_bordered{box-shadow:0 0 0 1px var(--ck-color-base-border)}.ck.ck-color-grid__tile .ck.ck-icon{display:none;color:var(--ck-color-color-grid-check-icon)}.ck.ck-color-grid__tile.ck-on{box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-base-text)}.ck.ck-color-grid__tile.ck-on .ck.ck-icon{display:block}.ck.ck-color-grid__tile.ck-on,.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){border:0}.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-color-grid__label{padding:0 var(--ck-spacing-standard)}",""]);const i=o},3488:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-dropdown-max-width:75vw}.ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);max-width:var(--ck-dropdown-max-width);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s{left:50%;transform:translateX(-50%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw{left:75%;transform:translateX(-75%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme{left:25%;transform:translateX(-25%)}.ck.ck-toolbar .ck-dropdown__panel{z-index:calc(var(--ck-z-modal) + 1)}:root{--ck-dropdown-arrow-size:calc(var(--ck-icon-size)*0.5)}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-dropdown__button_label-width_auto .ck-button__label{width:auto}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active{box-shadow:none}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active:focus,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active:focus{box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}",""]);const i=o},6875:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}",""]);const i=o},66:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-splitbutton{font-size:inherit}.ck.ck-splitbutton .ck-splitbutton__action:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button .ck-tooltip{display:none}:root{--ck-color-split-button-hover-background:#ebebeb;--ck-color-split-button-hover-border:#b3b3b3}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__action{border-top-right-radius:unset;border-bottom-right-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__action{border-top-left-radius:unset;border-bottom-left-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow{min-width:unset}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-radius:0}.ck-rounded-corners [dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow,[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:unset;border-bottom-left-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-right-radius:unset;border-bottom-right-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow svg{width:var(--ck-dropdown-arrow-size)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover),.ck.ck-splitbutton:hover>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover){background:var(--ck-color-split-button-hover-background)}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled){border-left-color:var(--ck-color-split-button-hover-border)}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled){border-right-color:var(--ck-color-split-button-hover-border)}.ck.ck-splitbutton.ck-splitbutton_open{border-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__action{border-bottom-left-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__arrow{border-bottom-right-radius:0}",""]);const i=o},5075:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-toolbar-dropdown-max-width:60vw}.ck.ck-toolbar-dropdown>.ck-dropdown__panel{width:max-content;max-width:var(--ck-toolbar-dropdown-max-width)}.ck.ck-toolbar-dropdown>.ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}",""]);const i=o},4547:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-color-editable-blur-selection:#d9d9d9}.ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-editor__editable_inline.ck-blurred ::selection{background:var(--ck-color-editable-blur-selection)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}",""]);const i=o},5523:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-form__header{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:space-between}:root{--ck-form-header-height:38px}.ck.ck-form__header{padding:var(--ck-spacing-small) var(--ck-spacing-large);height:var(--ck-form-header-height);line-height:var(--ck-form-header-height);border-bottom:1px solid var(--ck-color-base-border)}.ck.ck-form__header .ck-form__header__label{font-weight:700}",""]);const i=o},1174:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}",""]);const i=o},7661:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .1s ease-in-out,border .1s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),0 0}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}",""]);const i=o},2751:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}",""]);const i=o},8111:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{display:flex;position:relative}.ck.ck-labeled-field-view .ck.ck-label{display:block;position:absolute}:root{--ck-labeled-field-view-transition:.1s cubic-bezier(0,0,0.24,0.95);--ck-labeled-field-empty-unfocused-max-width:100% - 2 * var(--ck-spacing-medium);--ck-color-labeled-field-label-background:var(--ck-color-base-background)}.ck.ck-labeled-field-view{border-radius:0}.ck-rounded-corners .ck.ck-labeled-field-view,.ck.ck-labeled-field-view.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{width:100%}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{top:0}[dir=ltr] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{left:0}[dir=rtl] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{right:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{pointer-events:none;transform-origin:0 0;transform:translate(var(--ck-spacing-medium),-6px) scale(.75);background:var(--ck-color-labeled-field-label-background);padding:0 calc(var(--ck-font-size-tiny)*0.5);line-height:normal;font-weight:400;text-overflow:ellipsis;overflow:hidden;max-width:100%;transition:transform var(--ck-labeled-field-view-transition),padding var(--ck-labeled-field-view-transition),background var(--ck-labeled-field-view-transition)}.ck.ck-labeled-field-view.ck-error .ck-input:not([readonly])+.ck.ck-label,.ck.ck-labeled-field-view.ck-error>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view .ck-labeled-field-view__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-field-view .ck-labeled-field-view__status.ck-labeled-field-view__status_error{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-input-disabled-text)}[dir=ltr] .ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=ltr] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(var(--ck-spacing-medium),calc(var(--ck-font-size-base)*0.6)) scale(1)}[dir=rtl] .ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=rtl] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(calc(var(--ck-spacing-medium)*-1),calc(var(--ck-font-size-base)*0.6)) scale(1)}.ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width));background:transparent;padding:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck.ck-button{background:transparent}.ck.ck-labeled-field-view.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck-button>.ck-button__label{opacity:0}.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown+.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width) - var(--ck-dropdown-arrow-size) - var(--ck-spacing-standard))}",""]);const i=o},1162:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(var(--ck-line-height-base)*0.2*var(--ck-font-size-base)) calc(var(--ck-line-height-base)*0.4*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(var(--ck-line-height-base)*1.2*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}",""]);const i=o},8245:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px;--ck-balloon-arrow-drop-shadow:0 2px 2px var(--ck-color-shadow-drop)}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border);filter:drop-shadow(var(--ck-balloon-arrow-drop-shadow))}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}',""]);const i=o},1757:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}",""]);const i=o},3553:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}",""]);const i=o},3609:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}",""]);const i=o},1590:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck-vertical-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}[dir=ltr] .ck.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-responsive-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-text-width)*0.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-large);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-responsive-form>.ck-button:last-child,[dir=ltr] .ck.ck-responsive-form>.ck-button:nth-last-child(2),[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2){margin-left:0}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after,[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child:last-of-type,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2):last-of-type{border-right:1px solid var(--ck-color-base-border)}}',""]);const i=o},5571:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar .ck-toolbar__line-break{flex-basis:100%}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;background:var(--ck-color-toolbar-border);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar .ck-toolbar__line-break{height:0}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break){margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break),.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}",""]);const i=o},9948:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s,.ck.ck-tooltip.ck-tooltip_se,.ck.ck-tooltip.ck-tooltip_sw{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{top:calc(var(--ck-tooltip-arrow-size)*-1 + 1px);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_sw{right:50%;left:auto}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text{left:auto;right:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{left:auto;right:0}.ck.ck-tooltip.ck-tooltip_se{left:50%;right:auto}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text{right:auto;left:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after{right:auto;left:0;transform:translateX(50%)}.ck.ck-tooltip.ck-tooltip_n{top:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_e{left:calc(100% + var(--ck-tooltip-arrow-size));top:50%}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text:after{left:calc(var(--ck-tooltip-arrow-size)*-1);top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:transparent;border-bottom-color:transparent;border-right-color:var(--ck-color-tooltip-background);border-top-color:transparent;border-left-width:0;border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_w{right:calc(100% + var(--ck-tooltip-arrow-size));left:auto;top:50%}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text:after{left:100%;top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:var(--ck-color-tooltip-background);border-bottom-color:transparent;border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:0;border-top-width:var(--ck-tooltip-arrow-size)}',""]);const i=o},6150:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999)}.ck-transitions-disabled,.ck-transitions-disabled *{transition:none!important}:root{--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border-coordinates:208,79%,51%;--ck-color-focus-border:hsl(var(--ck-color-focus-border-coordinates));--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#757575;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-color-link-fake-selection:rgba(31,177,255,0.3);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}",""]);const i=o},6507:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2;--ck-resizer-border-radius:var(--ck-border-radius);--ck-resizer-tooltip-offset:10px}.ck .ck-widget,.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:var(--ck-spacing-small)}.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck.ck-editor__editable.ck-read-only .ck-widget{transition:none}.ck.ck-editor__editable.ck-read-only .ck-widget:not(.ck-widget_selected){--ck-widget-outline-thickness:0px}.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle:hover,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}",""]);const i=o},2263:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,".ck .ck-widget_with-resizer{position:relative}.ck .ck-widget__resizer{display:none;position:absolute;pointer-events:none;left:0;top:0}.ck-focused .ck-widget_with-resizer.ck-widget_selected>.ck-widget__resizer{display:block}.ck .ck-widget__resizer__handle{position:absolute;pointer-events:all}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{cursor:nwse-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{cursor:nesw-resize}:root{--ck-resizer-size:10px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-border-width:1px}.ck .ck-widget__resizer{outline:1px solid var(--ck-color-resizer)}.ck .ck-widget__resizer__handle{width:var(--ck-resizer-size);height:var(--ck-resizer-size);background:var(--ck-color-focus-border);border:var(--ck-resizer-border-width) solid #fff;border-radius:var(--ck-resizer-border-radius)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{top:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{top:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right{bottom:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left{bottom:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}",""]);const i=o},5137:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(3645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,'.ck .ck-widget .ck-widget__type-around__button{display:block;position:absolute;overflow:hidden;z-index:var(--ck-z-default)}.ck .ck-widget .ck-widget__type-around__button svg{position:absolute;top:50%;left:50%;z-index:calc(var(--ck-z-default) + 2)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_before{top:calc(var(--ck-widget-outline-thickness)*-0.5);left:min(10%,30px);transform:translateY(-50%)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_after{bottom:calc(var(--ck-widget-outline-thickness)*-0.5);right:min(10%,30px);transform:translateY(50%)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{content:"";display:block;position:absolute;top:1px;left:1px;z-index:calc(var(--ck-z-default) + 1)}.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__fake-caret{display:none;position:absolute;left:0;right:0}.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__fake-caret{left:calc(var(--ck-widget-outline-thickness)*-1);right:calc(var(--ck-widget-outline-thickness)*-1)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__fake-caret{top:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__fake-caret{bottom:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck.ck-editor__editable.ck-read-only .ck-widget__type-around,.ck.ck-editor__editable.ck-restricted-editing_mode_restricted .ck-widget__type-around,.ck.ck-editor__editable.ck-widget__type-around_disabled .ck-widget__type-around{display:none}:root{--ck-widget-type-around-button-size:20px;--ck-color-widget-type-around-button-active:var(--ck-color-focus-border);--ck-color-widget-type-around-button-hover:var(--ck-color-widget-hover-border);--ck-color-widget-type-around-button-blurred-editable:var(--ck-color-widget-blurred-border);--ck-color-widget-type-around-button-radar-start-alpha:0;--ck-color-widget-type-around-button-radar-end-alpha:.3;--ck-color-widget-type-around-button-icon:var(--ck-color-base-background)}.ck .ck-widget .ck-widget__type-around__button{width:var(--ck-widget-type-around-button-size);height:var(--ck-widget-type-around-button-size);background:var(--ck-color-widget-type-around-button);border-radius:100px;transition:opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);opacity:0;pointer-events:none}.ck .ck-widget .ck-widget__type-around__button svg{width:10px;height:8px;transform:translate(-50%,-50%);transition:transform .5s ease;margin-top:1px}.ck .ck-widget .ck-widget__type-around__button svg *{stroke-dasharray:10;stroke-dashoffset:0;fill:none;stroke:var(--ck-color-widget-type-around-button-icon);stroke-width:1.5px;stroke-linecap:round;stroke-linejoin:round}.ck .ck-widget .ck-widget__type-around__button svg line{stroke-dasharray:7}.ck .ck-widget .ck-widget__type-around__button:hover{animation:ck-widget-type-around-button-sonar 1s ease infinite}.ck .ck-widget .ck-widget__type-around__button:hover svg polyline{animation:ck-widget-type-around-arrow-dash 2s linear}.ck .ck-widget .ck-widget__type-around__button:hover svg line{animation:ck-widget-type-around-arrow-tip-dash 2s linear}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:1;pointer-events:auto}.ck .ck-widget:not(.ck-widget_selected)>.ck-widget__type-around>.ck-widget__type-around__button{background:var(--ck-color-widget-type-around-button-hover)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover{background:var(--ck-color-widget-type-around-button-active)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{width:calc(var(--ck-widget-type-around-button-size) - 2px);height:calc(var(--ck-widget-type-around-button-size) - 2px);border-radius:100px;background:linear-gradient(135deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.3))}.ck .ck-widget.ck-widget_with-selection-handle>.ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:20px}.ck .ck-widget .ck-widget__type-around__fake-caret{pointer-events:none;height:1px;animation:ck-widget-type-around-fake-caret-pulse 1s linear infinite normal forwards;outline:1px solid hsla(0,0%,100%,.5);background:var(--ck-color-base-text)}.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_after,.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_before{outline-color:transparent}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected:hover,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle{opacity:0}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer{opacity:0}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:0;margin-right:20px}.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover){background:var(--ck-color-widget-type-around-button-blurred-editable)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover) svg *{stroke:#999}@keyframes ck-widget-type-around-arrow-dash{0%{stroke-dashoffset:10}20%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-arrow-tip-dash{0%,20%{stroke-dashoffset:7}40%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-button-sonar{0%{box-shadow:0 0 0 0 hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}50%{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-end-alpha))}to{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}}@keyframes ck-widget-type-around-fake-caret-pulse{0%{opacity:1}49%{opacity:1}50%{opacity:0}99%{opacity:0}to{opacity:1}}',""]);const i=o},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=e(t);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&o[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},3379:(e,t,r)=>{var n,o=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function a(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},n=[],o=0;o<e.length;o++){var s=e[o],l=t.base?s[0]+t.base:s[0],c=r[l]||0,u="".concat(l," ").concat(c);r[l]=c+1;var d=a(u),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(h)):i.push({identifier:u,updater:m(h,t),references:1}),n.push(u)}return n}function l(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=r.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,r,n){var o=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function h(e,t,r){var n=r.css,o=r.media,i=r.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var p=null,f=0;function m(e,t){var r,n,o;if(t.singleton){var i=f++;r=p||(p=l(t)),n=d.bind(null,r,i,!1),o=d.bind(null,r,i,!0)}else r=l(t),n=h.bind(null,r,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var o=a(r[n]);i[o].references--}for(var l=s(e,t),c=0;c<r.length;c++){var u=a(r[c]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}r=l}}}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,exports:{}};return n[e](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a={};return(()=>{i.d(a,{default:()=>vk});const n="object"==typeof e&&e&&e.Object===Object&&e;var o="object"==typeof self&&self&&self.Object===Object&&self;const s=n||o||Function("return this")(),l=s.Symbol;var c=Object.prototype,u=c.hasOwnProperty,d=c.toString,h=l?l.toStringTag:void 0,p=Object.prototype.toString,f=l?l.toStringTag:void 0;const m=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":f&&f in Object(e)?function(e){var t=u.call(e,h),r=e[h];try{e[h]=void 0;var n=!0}catch(e){}var o=d.call(e);return n&&(t?e[h]=r:delete e[h]),o}(e):function(e){return p.call(e)}(e)},g=function(e,t){return function(r){return e(t(r))}},b=g(Object.getPrototypeOf,Object),v=function(e){return null!=e&&"object"==typeof e};var y=Function.prototype,_=Object.prototype,w=y.toString,x=_.hasOwnProperty,k=w.call(Object);const C=function(e){if(!v(e)||"[object Object]"!=m(e))return!1;var t=b(e);if(null===t)return!0;var r=x.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&w.call(r)==k},E=function(e,t){return e===t||e!=e&&t!=t},S=function(e,t){for(var r=e.length;r--;)if(E(e[r][0],t))return r;return-1};var T=Array.prototype.splice;function A(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}A.prototype.clear=function(){this.__data__=[],this.size=0},A.prototype.delete=function(e){var t=this.__data__,r=S(t,e);return!(r<0||(r==t.length-1?t.pop():T.call(t,r,1),--this.size,0))},A.prototype.get=function(e){var t=this.__data__,r=S(t,e);return r<0?void 0:t[r][1]},A.prototype.has=function(e){return S(this.__data__,e)>-1},A.prototype.set=function(e,t){var r=this.__data__,n=S(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const P=A,I=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},O=function(e){if(!I(e))return!1;var t=m(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},M=s["__core-js_shared__"];var D=function(){var e=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),z=Function.prototype.toString;const j=function(e){if(null!=e){try{return z.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var R=/^\[object .+?Constructor\]$/,L=Function.prototype,N=Object.prototype,B=L.toString,F=N.hasOwnProperty,V=RegExp("^"+B.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const U=function(e){return!(!I(e)||function(e){return!!D&&D in e}(e))&&(O(e)?V:R).test(j(e))},q=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return U(r)?r:void 0},H=q(s,"Map"),W=q(Object,"create");var G=Object.prototype.hasOwnProperty,Z=Object.prototype.hasOwnProperty;function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.__data__=W?W(null):{},this.size=0},Y.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Y.prototype.get=function(e){var t=this.__data__;if(W){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return G.call(t,e)?t[e]:void 0},Y.prototype.has=function(e){var t=this.__data__;return W?void 0!==t[e]:Z.call(t,e)},Y.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=W&&void 0===t?"__lodash_hash_undefined__":t,this};const $=Y,K=function(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map};function X(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}X.prototype.clear=function(){this.size=0,this.__data__={hash:new $,map:new(H||P),string:new $}},X.prototype.delete=function(e){var t=K(this,e).delete(e);return this.size-=t?1:0,t},X.prototype.get=function(e){return K(this,e).get(e)},X.prototype.has=function(e){return K(this,e).has(e)},X.prototype.set=function(e,t){var r=K(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};const J=X;function Q(e){var t=this.__data__=new P(e);this.size=t.size}Q.prototype.clear=function(){this.__data__=new P,this.size=0},Q.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Q.prototype.get=function(e){return this.__data__.get(e)},Q.prototype.has=function(e){return this.__data__.has(e)},Q.prototype.set=function(e,t){var r=this.__data__;if(r instanceof P){var n=r.__data__;if(!H||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new J(n)}return r.set(e,t),this.size=r.size,this};const ee=Q,te=function(){try{var e=q(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),re=function(e,t,r){"__proto__"==t&&te?te(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var ne=Object.prototype.hasOwnProperty;const oe=function(e,t,r){var n=e[t];ne.call(e,t)&&E(n,r)&&(void 0!==r||t in e)||re(e,t,r)},ie=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),o?re(r,s,l):oe(r,s,l)}return r},ae=function(e){return v(e)&&"[object Arguments]"==m(e)};var se=Object.prototype,le=se.hasOwnProperty,ce=se.propertyIsEnumerable;const ue=ae(function(){return arguments}())?ae:function(e){return v(e)&&le.call(e,"callee")&&!ce.call(e,"callee")},de=Array.isArray;var he=t&&!t.nodeType&&t,pe=he&&"object"==typeof r&&r&&!r.nodeType&&r,fe=pe&&pe.exports===he?s.Buffer:void 0;const me=(fe?fe.isBuffer:void 0)||function(){return!1};var ge=/^(?:0|[1-9]\d*)$/;const be=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ge.test(e))&&e>-1&&e%1==0&&e<t},ve=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var ye={};ye["[object Float32Array]"]=ye["[object Float64Array]"]=ye["[object Int8Array]"]=ye["[object Int16Array]"]=ye["[object Int32Array]"]=ye["[object Uint8Array]"]=ye["[object Uint8ClampedArray]"]=ye["[object Uint16Array]"]=ye["[object Uint32Array]"]=!0,ye["[object Arguments]"]=ye["[object Array]"]=ye["[object ArrayBuffer]"]=ye["[object Boolean]"]=ye["[object DataView]"]=ye["[object Date]"]=ye["[object Error]"]=ye["[object Function]"]=ye["[object Map]"]=ye["[object Number]"]=ye["[object Object]"]=ye["[object RegExp]"]=ye["[object Set]"]=ye["[object String]"]=ye["[object WeakMap]"]=!1;const _e=function(e){return function(t){return e(t)}};var we=t&&!t.nodeType&&t,xe=we&&"object"==typeof r&&r&&!r.nodeType&&r,ke=xe&&xe.exports===we&&n.process;const Ce=function(){try{return xe&&xe.require&&xe.require("util").types||ke&&ke.binding&&ke.binding("util")}catch(e){}}();var Ee=Ce&&Ce.isTypedArray;const Se=Ee?_e(Ee):function(e){return v(e)&&ve(e.length)&&!!ye[m(e)]};var Te=Object.prototype.hasOwnProperty;const Ae=function(e,t){var r=de(e),n=!r&&ue(e),o=!r&&!n&&me(e),i=!r&&!n&&!o&&Se(e),a=r||n||o||i,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)!t&&!Te.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||be(c,l))||s.push(c);return s};var Pe=Object.prototype;const Ie=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Pe)},Oe=g(Object.keys,Object);var Me=Object.prototype.hasOwnProperty;const De=function(e){return null!=e&&ve(e.length)&&!O(e)},ze=function(e){return De(e)?Ae(e):function(e){if(!Ie(e))return Oe(e);var t=[];for(var r in Object(e))Me.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)};var je=Object.prototype.hasOwnProperty;const Re=function(e){if(!I(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Ie(e),r=[];for(var n in e)("constructor"!=n||!t&&je.call(e,n))&&r.push(n);return r},Le=function(e){return De(e)?Ae(e,!0):Re(e)};var Ne=t&&!t.nodeType&&t,Be=Ne&&"object"==typeof r&&r&&!r.nodeType&&r,Fe=Be&&Be.exports===Ne?s.Buffer:void 0,Ve=Fe?Fe.allocUnsafe:void 0;const Ue=function(e,t){if(t)return e.slice();var r=e.length,n=Ve?Ve(r):new e.constructor(r);return e.copy(n),n},qe=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},He=function(){return[]};var We=Object.prototype.propertyIsEnumerable,Ge=Object.getOwnPropertySymbols;const Ze=Ge?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}(Ge(e),(function(t){return We.call(e,t)})))}:He,Ye=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},$e=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ye(t,Ze(e)),e=b(e);return t}:He,Ke=function(e,t,r){var n=t(e);return de(e)?n:Ye(n,r(e))},Xe=function(e){return Ke(e,ze,Ze)},Je=function(e){return Ke(e,Le,$e)},Qe=q(s,"DataView"),et=q(s,"Promise"),tt=q(s,"Set"),rt=q(s,"WeakMap");var nt="[object Map]",ot="[object Promise]",it="[object Set]",at="[object WeakMap]",st="[object DataView]",lt=j(Qe),ct=j(H),ut=j(et),dt=j(tt),ht=j(rt),pt=m;(Qe&&pt(new Qe(new ArrayBuffer(1)))!=st||H&&pt(new H)!=nt||et&&pt(et.resolve())!=ot||tt&&pt(new tt)!=it||rt&&pt(new rt)!=at)&&(pt=function(e){var t=m(e),r="[object Object]"==t?e.constructor:void 0,n=r?j(r):"";if(n)switch(n){case lt:return st;case ct:return nt;case ut:return ot;case dt:return it;case ht:return at}return t});const ft=pt;var mt=Object.prototype.hasOwnProperty;const gt=s.Uint8Array,bt=function(e){var t=new e.constructor(e.byteLength);return new gt(t).set(new gt(e)),t};var vt=/\w*$/,yt=l?l.prototype:void 0,_t=yt?yt.valueOf:void 0;const wt=function(e,t){var r=t?bt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},xt=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return bt(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return function(e,t){var r=t?bt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return wt(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,vt.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Set]":return new n;case"[object Symbol]":return function(e){return _t?Object(_t.call(e)):{}}(e)}};var kt=Object.create;const Ct=function(){function e(){}return function(t){if(!I(t))return{};if(kt)return kt(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Et=function(e){return"function"!=typeof e.constructor||Ie(e)?{}:Ct(b(e))};var St=Ce&&Ce.isMap;const Tt=St?_e(St):function(e){return v(e)&&"[object Map]"==ft(e)};var At=Ce&&Ce.isSet;const Pt=At?_e(At):function(e){return v(e)&&"[object Set]"==ft(e)};var It="[object Arguments]",Ot="[object Function]",Mt={};Mt[It]=Mt["[object Array]"]=Mt["[object ArrayBuffer]"]=Mt["[object DataView]"]=Mt["[object Boolean]"]=Mt["[object Date]"]=Mt["[object Float32Array]"]=Mt["[object Float64Array]"]=Mt["[object Int8Array]"]=Mt["[object Int16Array]"]=Mt["[object Int32Array]"]=Mt["[object Map]"]=Mt["[object Number]"]=Mt["[object Object]"]=Mt["[object RegExp]"]=Mt["[object Set]"]=Mt["[object String]"]=Mt["[object Symbol]"]=Mt["[object Uint8Array]"]=Mt["[object Uint8ClampedArray]"]=Mt["[object Uint16Array]"]=Mt["[object Uint32Array]"]=!0,Mt["[object Error]"]=Mt[Ot]=Mt["[object WeakMap]"]=!1;const Dt=function e(t,r,n,o,i,a){var s,l=1&r,c=2&r,u=4&r;if(n&&(s=i?n(t,o,i,a):n(t)),void 0!==s)return s;if(!I(t))return t;var d=de(t);if(d){if(s=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&mt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!l)return qe(t,s)}else{var h=ft(t),p=h==Ot||"[object GeneratorFunction]"==h;if(me(t))return Ue(t,l);if("[object Object]"==h||h==It||p&&!i){if(s=c||p?{}:Et(t),!l)return c?function(e,t){return ie(e,$e(e),t)}(t,function(e,t){return e&&ie(t,Le(t),e)}(s,t)):function(e,t){return ie(e,Ze(e),t)}(t,function(e,t){return e&&ie(t,ze(t),e)}(s,t))}else{if(!Mt[h])return i?t:{};s=xt(t,h,l)}}a||(a=new ee);var f=a.get(t);if(f)return f;a.set(t,s),Pt(t)?t.forEach((function(o){s.add(e(o,r,n,o,t,a))})):Tt(t)&&t.forEach((function(o,i){s.set(i,e(o,r,n,i,t,a))}));var m=d?void 0:(u?c?Je:Xe:c?Le:ze)(t);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););}(m||t,(function(o,i){m&&(o=t[i=o]),oe(s,i,e(o,r,n,i,t,a))})),s},zt=function(e,t){return Dt(e,5,t="function"==typeof t?t:void 0)},jt=function(e){return v(e)&&1===e.nodeType&&!C(e)};class Rt{constructor(e,t){this._config={},t&&this.define(Lt(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,r,n=!1){if(C(t))return void this._setObjectToTarget(e,t,n);const o=t.split(".");t=o.pop();for(const t of o)C(e[t])||(e[t]={}),e=e[t];if(C(r))return C(e[t])||(e[t]={}),e=e[t],void this._setObjectToTarget(e,r,n);n&&void 0!==e[t]||(e[t]=r)}_getFromSource(e,t){const r=t.split(".");t=r.pop();for(const t of r){if(!C(e[t])){e=null;break}e=e[t]}return e?Lt(e[t]):void 0}_setObjectToTarget(e,t,r){Object.keys(t).forEach(n=>{this._setToTarget(e,n,t[n],r)})}}function Lt(e){return zt(e,Nt)}function Nt(e){return jt(e)?e:void 0}class Bt{constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=function e(){e.called=!0},this.off=function e(){e.called=!0}}}const Ft=new Array(256).fill().map((e,t)=>("0"+t.toString(16)).slice(-2));function Vt(){const e=4294967296*Math.random()>>>0,t=4294967296*Math.random()>>>0,r=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return"e"+Ft[e>>0&255]+Ft[e>>8&255]+Ft[e>>16&255]+Ft[e>>24&255]+Ft[t>>0&255]+Ft[t>>8&255]+Ft[t>>16&255]+Ft[t>>24&255]+Ft[r>>0&255]+Ft[r>>8&255]+Ft[r>>16&255]+Ft[r>>24&255]+Ft[n>>0&255]+Ft[n>>8&255]+Ft[n>>16&255]+Ft[n>>24&255]}const Ut={get(e){return"number"!=typeof e?this[e]||this.normal:e},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};class qt extends Error{constructor(e,t,r){super(`${e}${r?" "+JSON.stringify(r):""}${Gt(e)}`),this.name="CKEditorError",this.context=t,this.data=r}is(e){return"CKEditorError"===e}static rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;const r=new qt(e.message,t);throw r.stack=e.stack,r}}function Ht(e,t){console.warn(...Zt(e,t))}function Wt(e,t){console.error(...Zt(e,t))}function Gt(e){return"\nRead more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-"+e}function Zt(e,t){const r=Gt(e);return t?[e,t,r]:[e,r]}const Yt="object"==typeof window?window:i.g;if(Yt.CKEDITOR_VERSION)throw new qt("ckeditor-duplicated-modules",null);Yt.CKEDITOR_VERSION="25.0.0";const $t=Symbol("listeningTo"),Kt=Symbol("emitterId"),Xt={on(e,t,r={}){this.listenTo(this,e,t,r)},once(e,t,r){let n=!1;this.listenTo(this,e,(function(e,...r){n||(n=!0,e.off(),t.call(this,e,...r))}),r)},off(e,t){this.stopListening(this,e,t)},listenTo(e,t,r,n={}){let o,i;this[$t]||(this[$t]={});const a=this[$t];Qt(e)||Jt(e);const s=Qt(e);(o=a[s])||(o=a[s]={emitter:e,callbacks:{}}),(i=o.callbacks[t])||(i=o.callbacks[t]=[]),i.push(r),function(e,t){const r=er(e);if(r[t])return;let n=t,o=null;const i=[];for(;""!==n&&!r[n];)r[n]={callbacks:[],childEvents:[]},i.push(r[n]),o&&r[n].childEvents.push(o),o=n,n=n.substr(0,n.lastIndexOf(":"));if(""!==n){for(const e of i)e.callbacks=r[n].callbacks.slice();r[n].childEvents.push(o)}}(e,t);const l=tr(e,t),c=Ut.get(n.priority),u={callback:r,priority:c};for(const e of l){let t=!1;for(let r=0;r<e.length;r++)if(e[r].priority<c){e.splice(r,0,u),t=!0;break}t||e.push(u)}},stopListening(e,t,r){const n=this[$t];let o=e&&Qt(e);const i=n&&o&&n[o],a=i&&t&&i.callbacks[t];if(!(!n||e&&!i||t&&!a))if(r)nr(e,t,r),-1!==a.indexOf(r)&&(1===a.length?delete i.callbacks[t]:nr(e,t,r));else if(a){for(;r=a.pop();)nr(e,t,r);delete i.callbacks[t]}else if(i){for(t in i.callbacks)this.stopListening(e,t);delete n[o]}else{for(o in n)this.stopListening(n[o].emitter);delete this[$t]}},fire(e,...t){try{const r=e instanceof Bt?e:new Bt(this,e),n=r.name;let o=function e(t,r){let n;return t._events&&(n=t._events[r])&&n.callbacks.length?n.callbacks:r.indexOf(":")>-1?e(t,r.substr(0,r.lastIndexOf(":"))):null}(this,n);if(r.path.push(this),o){const e=[r,...t];o=Array.from(o);for(let t=0;t<o.length&&(o[t].callback.apply(this,e),r.off.called&&(delete r.off.called,nr(this,n,o[t].callback)),!r.stop.called);t++);}if(this._delegations){const e=this._delegations.get(n),o=this._delegations.get("*");e&&rr(e,r,t),o&&rr(o,r,t)}return r.return}catch(e){qt.rethrowUnexpectedError(e,this)}},delegate(...e){return{to:(t,r)=>{this._delegations||(this._delegations=new Map),e.forEach(e=>{const n=this._delegations.get(e);n?n.set(t,r):this._delegations.set(e,new Map([[t,r]]))})}}},stopDelegating(e,t){if(this._delegations)if(e)if(t){const r=this._delegations.get(e);r&&r.delete(t)}else this._delegations.delete(e);else this._delegations.clear()}};function Jt(e,t){e[Kt]||(e[Kt]=t||Vt())}function Qt(e){return e[Kt]}function er(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events}function tr(e,t){const r=er(e)[t];if(!r)return[];let n=[r.callbacks];for(let t=0;t<r.childEvents.length;t++){const o=tr(e,r.childEvents[t]);n=n.concat(o)}return n}function rr(e,t,r){for(let[n,o]of e){o?"function"==typeof o&&(o=o(t.name)):o=t.name;const e=new Bt(t.source,o);e.path=[...t.path],n.fire(e,...r)}}function nr(e,t,r){const n=tr(e,t);for(const e of n)for(let t=0;t<e.length;t++)e[t].callback==r&&(e.splice(t,1),t--)}function or(e){return!(!e||!e[Symbol.iterator])}function ir(e,...t){t.forEach(t=>{Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).forEach(r=>{if(r in e.prototype)return;const n=Object.getOwnPropertyDescriptor(t,r);n.enumerable=!1,Object.defineProperty(e.prototype,r,n)})})}class ar{constructor(e={},t={}){const r=or(e);if(r||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],r)for(const t of e)this._items.push(t),this._itemMap.set(this._getItemIdBeforeAdding(t),t)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(void 0===t)t=this._items.length;else if(t>this._items.length||t<0)throw new qt("collection-add-item-invalid-index",this);for(let r=0;r<e.length;r++){const n=e[r],o=this._getItemIdBeforeAdding(n),i=t+r;this._items.splice(i,0,n),this._itemMap.set(o,n),this.fire("add",n,i)}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if("string"==typeof e)t=this._itemMap.get(e);else{if("number"!=typeof e)throw new qt("collection-get-invalid-arg",this);t=this._items[e]}return t||null}has(e){if("string"==typeof e)return this._itemMap.has(e);{const t=e[this._idProperty];return this._itemMap.has(t)}}getIndex(e){let t;return t="string"==typeof e?this._itemMap.get(e):e,this._items.indexOf(t)}remove(e){const[t,r]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:r}),t}map(e,t){return this._items.map(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new qt("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:e=>{this._setUpBindToBinding(t=>new e(t))},using:e=>{"function"==typeof e?this._setUpBindToBinding(t=>e(t)):this._setUpBindToBinding(t=>t[e])}}}_setUpBindToBinding(e){const t=this._bindToCollection,r=(r,n,o)=>{const i=t._bindToCollection==this,a=t._bindToInternalToExternalMap.get(n);if(i&&a)this._bindToExternalToInternalMap.set(n,a),this._bindToInternalToExternalMap.set(a,n);else{const r=e(n);if(!r)return void this._skippedIndexesFromExternal.push(o);let i=o;for(const e of this._skippedIndexesFromExternal)o>e&&i--;for(const e of t._skippedIndexesFromExternal)i>=e&&i++;this._bindToExternalToInternalMap.set(n,r),this._bindToInternalToExternalMap.set(r,n),this.add(r,i);for(let e=0;e<t._skippedIndexesFromExternal.length;e++)i<=t._skippedIndexesFromExternal[e]&&t._skippedIndexesFromExternal[e]++}};for(const e of t)r(0,e,t.getIndex(e));this.listenTo(t,"add",r),this.listenTo(t,"remove",(e,t,r)=>{const n=this._bindToExternalToInternalMap.get(t);n&&this.remove(n),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((e,t)=>(r<t&&e.push(t-1),r>t&&e.push(t),e),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let r;if(t in e){if(r=e[t],"string"!=typeof r)throw new qt("collection-add-invalid-id",this);if(this.get(r))throw new qt("collection-add-item-already-exists",this)}else e[t]=r=Vt();return r}_remove(e){let t,r,n,o=!1;const i=this._idProperty;if("string"==typeof e?(r=e,n=this._itemMap.get(r),o=!n,n&&(t=this._items.indexOf(n))):"number"==typeof e?(t=e,n=this._items[t],o=!n,n&&(r=n[i])):(n=e,r=n[i],t=this._items.indexOf(n),o=-1==t||!this._itemMap.get(r)),o)throw new qt("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(r);const a=this._bindToInternalToExternalMap.get(n);return this._bindToInternalToExternalMap.delete(n),this._bindToExternalToInternalMap.delete(a),this.fire("remove",n,t),[n,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}ir(ar,Xt);class sr{constructor(e,t=[],r=[]){this._context=e,this._plugins=new Map,this._availablePlugins=new Map;for(const e of t)e.pluginName&&this._availablePlugins.set(e.pluginName,e);this._contextPlugins=new Map;for(const[e,t]of r)this._contextPlugins.set(e,t),this._contextPlugins.set(t,e),e.pluginName&&this._availablePlugins.set(e.pluginName,e)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let t=e;throw"function"==typeof e&&(t=e.pluginName||e.name),new qt("plugincollection-plugin-not-loaded",this._context,{plugin:t})}return t}has(e){return this._plugins.has(e)}init(e,t=[]){const r=this,n=this._context,o=new Set,i=[],a=d(e),s=d(t),l=function(e){const t=[];for(const r of e)u(r)||t.push(r);return t.length?t:null}(e);if(l){const e="plugincollection-plugin-not-found";return Wt(e,{plugins:l}),Promise.reject(new qt(e,n,{plugins:l}))}return Promise.all(a.map((function e(a){if(!s.includes(a)&&!r._plugins.has(a)&&!o.has(a))return function(a){return new Promise(s=>{o.add(a),a.requires&&a.requires.forEach(r=>{const o=u(r);if(a.isContextPlugin&&!o.isContextPlugin)throw new qt("plugincollection-context-required",null,{plugin:o.name,requiredBy:a.name});if(t.includes(o))throw new qt("plugincollection-required",n,{plugin:o.name,requiredBy:a.name});e(o)});const l=r._contextPlugins.get(a)||new a(n);r._add(a,l),i.push(l),s()})}(a).catch(e=>{throw Wt("plugincollection-load",{plugin:a}),e})}))).then(()=>c(i,"init")).then(()=>c(i,"afterInit")).then(()=>i);function c(e,t){return e.reduce((e,n)=>n[t]?r._contextPlugins.has(n)?e:e.then(n[t].bind(n)):e,Promise.resolve())}function u(e){return"function"==typeof e?e:r._availablePlugins.get(e)}function d(e){return e.map(e=>u(e)).filter(e=>!!e)}}destroy(){const e=[];for(const[,t]of this)"function"!=typeof t.destroy||this._contextPlugins.has(t)||e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const r=e.pluginName;if(r){if(this._plugins.has(r))throw new qt("plugincollection-plugin-name-conflict",null,{pluginName:r,plugin1:this._plugins.get(r).constructor,plugin2:e});this._plugins.set(r,t)}}}function lr(e){return Array.isArray(e)?e:[e]}ir(sr,Xt),window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});const cr=["ar","fa","he","ku","ug"];class ur{constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=dr(this.uiLanguage),this.contentLanguageDirection=dr(this.contentLanguage),this.t=(e,t)=>this._t(e,t)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=lr(t),"string"==typeof e&&(e={string:e});const r=e.plural?t[0]:1;return function(e,t){return e.replace(/%(\d+)/g,(e,r)=>r<t.length?t[r]:e)}(function(e,t,r=1){if("number"!=typeof r)throw new qt("translation-service-quantity-not-a-number",null,{quantity:r});const n=Object.keys(window.CKEDITOR_TRANSLATIONS).length;1===n&&(e=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const o=t.id||t.string;if(0===n||!function(e,t){return!!window.CKEDITOR_TRANSLATIONS[e]&&!!window.CKEDITOR_TRANSLATIONS[e].dictionary[t]}(e,o))return 1!==r?t.plural:t.string;const i=window.CKEDITOR_TRANSLATIONS[e].dictionary,a=window.CKEDITOR_TRANSLATIONS[e].getPluralForm||(e=>1===e?0:1);if("string"==typeof i[o])return i[o];const s=Number(a(r));return i[o][s]}(this.uiLanguage,e,r),t)}}function dr(e){return cr.includes(e)?"rtl":"ltr"}class hr{constructor(e){this.config=new Rt(e,this.constructor.defaultConfig);const t=this.constructor.builtinPlugins;this.config.define("plugins",t),this.plugins=new sr(this,t);const r=this.config.get("language")||{};this.locale=new ur({uiLanguage:"string"==typeof r?r:r.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new ar,this._contextOwner=null}initPlugins(){const e=this.config.get("plugins")||[];for(const t of e){if("function"!=typeof t)throw new qt("context-initplugins-constructor-only",null,{Plugin:t});if(!0!==t.isContextPlugin)throw new qt("context-initplugins-invalid-plugin",null,{Plugin:t})}return this.plugins.init(e)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new qt("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const r=new this(e);t(r.initPlugins().then(()=>r))})}}function pr(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++)if(e[n]!=t[n])return n;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}const fr=function(e){return Dt(e,4)};class mr{constructor(e){this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new qt("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let r=e.includeSelf?this:this.parent;for(;r;)t[e.parentFirst?"push":"unshift"](r),r=r.parent;return t}getCommonAncestor(e,t={}){const r=this.getAncestors(t),n=e.getAncestors(t);let o=0;for(;r[o]==n[o]&&r[o];)o++;return 0===o?null:r[o-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),r=e.getPath(),n=pr(t,r);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<r[n]}}isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire("change:"+e,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=fr(this);return delete e.parent,e}is(e){return"node"===e||"view:node"===e}}ir(mr,Xt);class gr extends mr{constructor(e,t){super(e),this._textData=t}is(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof gr&&(this===e||this.data===e.data)}_clone(){return new gr(this.document,this.data)}}class br{constructor(e,t,r){if(this.textNode=e,t<0||t>e.data.length)throw new qt("view-textproxy-wrong-offsetintext",this);if(r<0||t+r>e.data.length)throw new qt("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+r),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let r=e.includeSelf?this.textNode:this.parent;for(;null!==r;)t[e.parentFirst?"push":"unshift"](r),r=r.parent;return t}}function vr(e){return or(e)?new Map(e):function(e){const t=new Map;for(const r in e)t.set(r,e[r]);return t}(e)}class yr{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),t.classes&&("string"==typeof t.classes||t.classes instanceof RegExp)&&(t.classes=[t.classes]),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const r=_r(t,e);if(r)return{element:t,pattern:e,match:r}}return null}matchAll(...e){const t=[];for(const r of e)for(const e of this._patterns){const n=_r(r,e);n&&t.push({element:r,pattern:e,match:n})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}}function _r(e,t){if("function"==typeof t)return t(e);const r={};return t.name&&(r.name=function(e,t){return e instanceof RegExp?e.test(t):e===t}(t.name,e.name),!r.name)||t.attributes&&(r.attributes=function(e,t){const r=[];for(const n in e){const o=e[n];if(!t.hasAttribute(n))return null;{const e=t.getAttribute(n);if(!0===o)r.push(n);else if(o instanceof RegExp){if(!o.test(e))return null;r.push(n)}else{if(e!==o)return null;r.push(n)}}}return r}(t.attributes,e),!r.attributes)?null:!(t.classes&&(r.classes=function(e,t){const r=[];for(const n of e)if(n instanceof RegExp){const e=t.getClassNames();for(const t of e)n.test(t)&&r.push(t);if(0===r.length)return null}else{if(!t.hasClass(n))return null;r.push(n)}return r}(t.classes,e),!r.classes))&&!(t.styles&&(r.styles=function(e,t){const r=[];for(const n in e){const o=e[n];if(!t.hasStyle(n))return null;{const e=t.getStyle(n);if(o instanceof RegExp){if(!o.test(e))return null;r.push(n)}else{if(e!==o)return null;r.push(n)}}}return r}(t.styles,e),!r.styles))&&r}const wr=function(e){return"symbol"==typeof e||v(e)&&"[object Symbol]"==m(e)};var xr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kr=/^\w*$/;function Cr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Cr.Cache||J),r}Cr.Cache=J;const Er=Cr;var Sr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Tr=/\\(\\)?/g;const Ar=function(e){var t=Er((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Sr,(function(e,r,n,o){t.push(n?o.replace(Tr,"$1"):r||e)})),t}),(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}();var Pr=l?l.prototype:void 0,Ir=Pr?Pr.toString:void 0;const Or=function e(t){if("string"==typeof t)return t;if(de(t))return function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}(t,e)+"";if(wr(t))return Ir?Ir.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r},Mr=function(e){return null==e?"":Or(e)},Dr=function(e,t){return de(e)?e:function(e,t){if(de(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!wr(e))||kr.test(e)||!xr.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:Ar(Mr(e))},zr=function(e){if("string"==typeof e||wr(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},jr=function(e,t){for(var r=0,n=(t=Dr(t,e)).length;null!=e&&r<n;)e=e[zr(t[r++])];return r&&r==n?e:void 0},Rr=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i},Lr=function(e,t){return null==(e=function(e,t){return t.length<2?e:jr(e,Rr(t,0,-1))}(e,t=Dr(t,e)))||delete e[zr(function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}(t))]},Nr=function(e,t,r){var n=null==e?void 0:jr(e,t);return void 0===n?r:n},Br=function(e,t,r){(void 0!==r&&!E(e[t],r)||void 0===r&&!(t in e))&&re(e,t,r)},Fr=function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var s=i[++n];if(!1===t(o[s],s,o))break}return e},Vr=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Ur=function(e,t,r,n,o,i,a){var s=Vr(e,r),l=Vr(t,r),c=a.get(l);if(c)Br(e,r,c);else{var u=i?i(s,l,r+"",e,t,a):void 0,d=void 0===u;if(d){var h=de(l),p=!h&&me(l),f=!h&&!p&&Se(l);u=l,h||p||f?de(s)?u=s:function(e){return v(e)&&De(e)}(s)?u=qe(s):p?(d=!1,u=Ue(l,!0)):f?(d=!1,u=wt(l,!0)):u=[]:C(l)||ue(l)?(u=s,ue(s)?u=function(e){return ie(e,Le(e))}(s):I(s)&&!O(s)||(u=Et(l))):d=!1}d&&(a.set(l,u),o(u,l,n,i,a),a.delete(l)),Br(e,r,u)}},qr=function(e){return e},Hr=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var Wr=Math.max;const Gr=function(e){return function(){return e}},Zr=te?function(e,t){return te(e,"toString",{configurable:!0,enumerable:!1,value:Gr(t),writable:!0})}:qr;var Yr=Date.now;const $r=function(e){var t=0,r=0;return function(){var n=Yr(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Zr),Kr=function(e,t){return $r(function(e,t,r){return t=Wr(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=Wr(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),Hr(e,this,s)}}(e,t,qr),e+"")},Xr=function(e){return Kr((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,r){if(!I(r))return!1;var n=typeof t;return!!("number"==n?De(r)&&be(t,r.length):"string"==n&&t in r)&&E(r[t],e)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))},Jr=Xr((function(e,t,r){!function e(t,r,n,o,i){t!==r&&Fr(r,(function(a,s){if(i||(i=new ee),I(a))Ur(t,r,s,n,e,o,i);else{var l=o?o(Vr(t,s),a,s+"",t,r,i):void 0;void 0===l&&(l=a),Br(t,s,l)}}),Le)}(e,t,r)})),Qr=function(e,t,r){return null==e?e:function(e,t,r,n){if(!I(e))return e;for(var o=-1,i=(t=Dr(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var l=zr(t[o]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=a){var u=s[l];void 0===(c=n?n(u,l,s):void 0)&&(c=I(u)?u:be(t[o+1])?[]:{})}oe(s,l,c),s=s[l]}return e}(e,t,r)};class en{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles);return!Array.from(e).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=Array.from(function(e){let t=null,r=0,n=0,o=null;const i=new Map;if(""===e)return i;";"!=e.charAt(e.length-1)&&(e+=";");for(let a=0;a<e.length;a++){const s=e.charAt(a);if(null===t)switch(s){case":":o||(o=e.substr(r,a-r),n=a+1);break;case'"':case"'":t=s;break;case";":{const t=e.substr(n,a-n);o&&i.set(o.trim(),t.trim()),o=null,r=a+1;break}}else s===t&&(t=null)}return i}(e).entries());for(const[e,r]of t)this._styleProcessor.toNormalizedForm(e,r,this._styles)}has(e){if(this.isEmpty)return!1;const t=this._styleProcessor.getReducedForm(e,this._styles).find(([t])=>t===e);return Array.isArray(t)}set(e,t){if(I(e))for(const[t,r]of Object.entries(e))this._styleProcessor.toNormalizedForm(t,r,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=rn(e);(function(e,t){null==e||Lr(e,t)})(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!I(this._styles[e]))return this._styles[e];const t=this._styleProcessor.getReducedForm(e,this._styles).find(([t])=>t===e);return Array.isArray(t)?t[1]:void 0}getStyleNames(){return this.isEmpty?[]:this._getStylesEntries().map(([e])=>e)}clear(){this._styles={}}_getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const r of t)e.push(...this._styleProcessor.getReducedForm(r,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split(".");if(!(t.length>1))return;const r=t.splice(0,t.length-1).join("."),n=Nr(this._styles,r);n&&!Array.from(Object.keys(n)).length&&this.remove(r)}}class tn{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,r){if(I(t))nn(r,rn(e),t);else if(this._normalizers.has(e)){const n=this._normalizers.get(e),{path:o,value:i}=n(t);nn(r,o,i)}else nn(r,e,t)}getNormalized(e,t){if(!e)return Jr({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){const r=this._extractors.get(e);if("string"==typeof r)return Nr(t,r);const n=r(e,t);if(n)return n}return Nr(t,rn(e))}getReducedForm(e,t){const r=this.getNormalized(e,t);return void 0===r?[]:this._reducers.has(e)?this._reducers.get(e)(r):[[e,r]]}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const r of t)this._mapStyleNames(r,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function rn(e){return e.replace("-",".")}function nn(e,t,r){let n=r;I(r)&&(n=Jr({},Nr(e,t),r)),Qr(e,t,n)}class on extends mr{constructor(e,t,r,n){if(super(e),this.name=t,this._attrs=function(e){e=vr(e);for(const[t,r]of e)null===r?e.delete(t):"string"!=typeof r&&e.set(t,String(r));return e}(r),this._children=[],n&&this._insertChild(0,n),this._classes=new Set,this._attrs.has("class")){const e=this._attrs.get("class");an(this._classes,e),this._attrs.delete("class")}this._styles=new en(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(e,t=null){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if("class"==e)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==e){const e=this._styles.toString();return""==e?void 0:e}return this._attrs.get(e)}hasAttribute(e){return"class"==e?this._classes.size>0:"style"==e?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof on))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,r]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==r)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new yr(...e);let r=this.parent;for(;r;){if(t.match(r))return r;r=r.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),r=Array.from(this._attrs).map(e=>`${e[0]}="${e[1]}"`).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(t?` style="${t}"`:"")+(""==r?"":" "+r)}_clone(e=!1){const t=[];if(e)for(const r of this.getChildren())t.push(r._clone(e));const r=new this.constructor(this.document,this.name,this._attrs,t);return r._classes=new Set(this._classes),r._styles.set(this._styles.getNormalized()),r._customProperties=new Map(this._customProperties),r.getFillerOffset=this.getFillerOffset,r}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let r=0;const n=function(e,t){return"string"==typeof t?[new gr(e,t)]:(or(t)||(t=[t]),Array.from(t).map(t=>"string"==typeof t?new gr(e,t):t instanceof br?new gr(e,t.data):t))}(this.document,t);for(const t of n)null!==t.parent&&t._remove(),t.parent=this,t.document=this.document,this._children.splice(e,0,t),e++,r++;return r}_removeChildren(e,t=1){this._fireChange("children",this);for(let r=e;r<e+t;r++)this._children[r].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){t=String(t),this._fireChange("attributes",this),"class"==e?an(this._classes,t):"style"==e?this._styles.setTo(t):this._attrs.set(e,t)}_removeAttribute(e){return this._fireChange("attributes",this),"class"==e?this._classes.size>0&&(this._classes.clear(),!0):"style"==e?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of lr(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of lr(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of lr(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function an(e,t){const r=t.split(/\s+/);e.clear(),r.forEach(t=>e.add(t))}class sn extends on{constructor(e,t,r,n){super(e,t,r,n),this.getFillerOffset=ln}is(e,t=null){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}}function ln(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const t of e)if(!t.is("uiElement"))return null;return this.childCount}const cn=Xr((function(e,t){ie(t,Le(t),e)})),un=Symbol("observableProperties"),dn=Symbol("boundObservables"),hn=Symbol("boundProperties"),pn={set(e,t){if(I(e))return void Object.keys(e).forEach(t=>{this.set(t,e[t])},this);mn(this);const r=this[un];if(e in this&&!r.has(e))throw new qt("observable-set-cannot-override",this);Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>r.get(e),set(t){const n=r.get(e);let o=this.fire("set:"+e,e,t,n);void 0===o&&(o=t),n===o&&r.has(e)||(r.set(e,o),this.fire("change:"+e,e,o,n))}}),this[e]=t},bind(...e){if(!e.length||!vn(e))throw new qt("observable-bind-wrong-properties",this);if(new Set(e).size!==e.length)throw new qt("observable-bind-duplicate-properties",this);mn(this);const t=this[hn];e.forEach(e=>{if(t.has(e))throw new qt("observable-bind-rebind",this)});const r=new Map;return e.forEach(e=>{const n={property:e,to:[]};t.set(e,n),r.set(e,n)}),{to:gn,toMany:bn,_observable:this,_bindProperties:e,_to:[],_bindings:r}},unbind(...e){if(!this[un])return;const t=this[hn],r=this[dn];if(e.length){if(!vn(e))throw new qt("observable-unbind-wrong-properties",this);e.forEach(e=>{const n=t.get(e);if(!n)return;let o,i,a,s;n.to.forEach(e=>{o=e[0],i=e[1],a=r.get(o),s=a[i],s.delete(n),s.size||delete a[i],Object.keys(a).length||(r.delete(o),this.stopListening(o,"change"))}),t.delete(e)})}else r.forEach((e,t)=>{this.stopListening(t,"change")}),r.clear(),t.clear()},decorate(e){const t=this[e];if(!t)throw new qt("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:e});this.on(e,(e,r)=>{e.return=t.apply(this,r)}),this[e]=function(...t){return this.fire(e,t)}}};cn(pn,Xt);const fn=pn;function mn(e){e[un]||(Object.defineProperty(e,un,{value:new Map}),Object.defineProperty(e,dn,{value:new Map}),Object.defineProperty(e,hn,{value:new Map}))}function gn(...e){const t=function(...e){if(!e.length)throw new qt("observable-bind-to-parse-error",null);const t={to:[]};let r;return"function"==typeof e[e.length-1]&&(t.callback=e.pop()),e.forEach(e=>{if("string"==typeof e)r.properties.push(e);else{if("object"!=typeof e)throw new qt("observable-bind-to-parse-error",null);r={observable:e,properties:[]},t.to.push(r)}}),t}(...e),r=Array.from(this._bindings.keys()),n=r.length;if(!t.callback&&t.to.length>1)throw new qt("observable-bind-to-no-callback",this);if(n>1&&t.callback)throw new qt("observable-bind-to-extra-callback",this);var o;t.to.forEach(e=>{if(e.properties.length&&e.properties.length!==n)throw new qt("observable-bind-to-properties-length",this);e.properties.length||(e.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(r[0]).callback=t.callback),o=this._observable,this._to.forEach(e=>{const t=o[dn];let r;t.get(e.observable)||o.listenTo(e.observable,"change",(n,i)=>{r=t.get(e.observable)[i],r&&r.forEach(e=>{yn(o,e.property)})})}),function(e){let t;e._bindings.forEach((r,n)=>{e._to.forEach(o=>{t=o.properties[r.callback?0:e._bindProperties.indexOf(n)],r.to.push([o.observable,t]),function(e,t,r,n){const o=e[dn],i=o.get(r),a=i||{};a[n]||(a[n]=new Set),a[n].add(t),i||o.set(r,a)}(e._observable,r,o.observable,t)})})}(this),this._bindProperties.forEach(e=>{yn(this._observable,e)})}function bn(e,t,r){if(this._bindings.size>1)throw new qt("observable-bind-to-many-not-one-binding",this);this.to(...function(e,t){const r=e.map(e=>[e,t]);return Array.prototype.concat.apply([],r)}(e,t),r)}function vn(e){return e.every(e=>"string"==typeof e)}function yn(e,t){const r=e[hn].get(t);let n;r.callback?n=r.callback.apply(e,r.to.map(e=>e[0][e[1]])):(n=r.to[0],n=n[0][n[1]]),Object.prototype.hasOwnProperty.call(e,t)?e[t]=n:e.set(t,n)}class _n extends sn{constructor(e,t,r,n){super(e,t,r,n),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",t=>t&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}is(e,t=null){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}destroy(){this.stopListening()}}ir(_n,fn);const wn=Symbol("rootName");class xn extends _n{constructor(e,t){super(e,t),this.rootName="main"}is(e,t=null){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}get rootName(){return this.getCustomProperty(wn)}set rootName(e){this._setCustomProperty(wn,e)}set _name(e){this.name=e}}class kn{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new qt("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new qt("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=Cn._createAt(e.startPosition):this.position=Cn._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let t,r,n;do{n=this.position,({done:t,value:r}=this.next())}while(!t&&e(r));t||(this.position=n)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,r=e.parent;if(null===r.parent&&e.offset===r.childCount)return{done:!0};if(r===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let n;if(r instanceof gr){if(e.isAtEnd)return this.position=Cn._createAfter(r),this._next();n=r.data[e.offset]}else n=r.getChild(e.offset);if(n instanceof on)return this.shallow?e.offset++:e=new Cn(n,0),this.position=e,this._formatReturnValue("elementStart",n,t,e,1);if(n instanceof gr){if(this.singleCharacters)return e=new Cn(n,0),this.position=e,this._next();{let r,o=n.data.length;return n==this._boundaryEndParent?(o=this.boundaries.end.offset,r=new br(n,0,o),e=Cn._createAfter(r)):(r=new br(n,0,n.data.length),e.offset++),this.position=e,this._formatReturnValue("text",r,t,e,o)}}if("string"==typeof n){let n;n=this.singleCharacters?1:(r===this._boundaryEndParent?this.boundaries.end.offset:r.data.length)-e.offset;const o=new br(r,e.offset,n);return e.offset+=n,this.position=e,this._formatReturnValue("text",o,t,e,n)}return e=Cn._createAfter(r),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",r,t,e)}_previous(){let e=this.position.clone();const t=this.position,r=e.parent;if(null===r.parent&&0===e.offset)return{done:!0};if(r==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let n;if(r instanceof gr){if(e.isAtStart)return this.position=Cn._createBefore(r),this._previous();n=r.data[e.offset-1]}else n=r.getChild(e.offset-1);if(n instanceof on)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",n,t,e,1)):(e=new Cn(n,n.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,t,e));if(n instanceof gr){if(this.singleCharacters)return e=new Cn(n,n.data.length),this.position=e,this._previous();{let r,o=n.data.length;if(n==this._boundaryStartParent){const t=this.boundaries.start.offset;r=new br(n,t,n.data.length-t),o=r.data.length,e=Cn._createBefore(r)}else r=new br(n,0,n.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",r,t,e,o)}}if("string"==typeof n){let n;if(this.singleCharacters)n=1;else{const t=r===this._boundaryStartParent?this.boundaries.start.offset:0;n=e.offset-t}e.offset-=n;const o=new br(r,e.offset,n);return this.position=e,this._formatReturnValue("text",o,t,e,n)}return e=Cn._createBefore(r),this.position=e,this._formatReturnValue("elementStart",r,t,e,1)}_formatReturnValue(e,t,r,n,o){return t instanceof br&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?r=Cn._createAfter(t.textNode):(n=Cn._createAfter(t.textNode),this.position=n)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?r=Cn._createBefore(t.textNode):(n=Cn._createBefore(t.textNode),this.position=n))),{done:!1,value:{type:e,item:t,previousPosition:r,nextPosition:n,length:o}}}}class Cn{constructor(e,t){this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof _n);){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=Cn._createAt(this),r=t.offset+e;return t.offset=r<0?0:r,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const r=new kn(t);return r.skip(e),r.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),r=e.getAncestors();let n=0;for(;t[n]==r[n]&&t[n];)n++;return 0===n?null:t[n-1]}is(e){return"position"===e||"view:position"===e}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],r=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),r.push(e.offset);const n=pr(t,r);switch(n){case"prefix":return"before";case"extension":return"after";default:return t[n]<r[n]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new kn(e)}clone(){return new Cn(this.parent,this.offset)}static _createAt(e,t){if(e instanceof Cn)return new this(e.parent,e.offset);{const r=e;if("end"==t)t=r.is("$text")?r.data.length:r.childCount;else{if("before"==t)return this._createBefore(r);if("after"==t)return this._createAfter(r);if(0!==t&&!t)throw new qt("view-createpositionat-offset-required",r)}return new Cn(r,t)}}static _createAfter(e){if(e.is("$textProxy"))return new Cn(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new qt("view-position-after-root",e,{root:e});return new Cn(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Cn(e.textNode,e.offsetInText);if(!e.parent)throw new qt("view-position-before-root",e,{root:e});return new Cn(e.parent,e.index)}}class En{constructor(e,t=null){this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new kn({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Sn,{direction:"backward"}),t=this.end.getLastMatchingPosition(Sn);return e.parent.is("$text")&&e.isAtStart&&(e=Cn._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=Cn._createAfter(t.parent)),new En(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Sn);if(e.isAfter(this.end)||e.isEqual(this.end))return new En(e,e);let t=this.end.getLastMatchingPosition(Sn,{direction:"backward"});const r=e.nodeAfter,n=t.nodeBefore;return r&&r.is("$text")&&(e=new Cn(r,0)),n&&n.is("$text")&&(t=new Cn(n,n.data.length)),new En(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const r=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return r&&n}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new En(this.start,e.start)),this.containsPosition(e.end)&&t.push(new En(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,r=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(r=e.end),new En(t,r)}return null}getWalker(e={}){return e.boundaries=this,new kn(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new En(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new kn(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new kn(e);yield t.position;for(const e of t)yield e.nextPosition}is(e){return"range"===e||"view:range"===e}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,r,n){return new this(new Cn(e,t),new Cn(r,n))}static _createFromPositionAndShift(e,t){const r=e,n=e.getShiftedBy(t);return t>0?new this(r,n):new this(n,r)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Cn._createBefore(e),t)}}function Sn(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}function Tn(e){let t=0;for(const r of e)t++;return t}class An{constructor(e=null,t,r){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,t,r)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let r=!1;for(const n of e._ranges)if(t.isEqual(n)){r=!0;break}if(!r)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=Tn(this.getRanges());if(t!=Tn(e.getRanges()))return!1;if(0==t)return!0;for(let t of this.getRanges()){t=t.getTrimmed();let r=!1;for(let n of e.getRanges())if(n=n.getTrimmed(),t.start.isEqual(n.start)&&t.end.isEqual(n.end)){r=!0;break}if(!r)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(e,t,r){if(null===e)this._setRanges([]),this._setFakeOptions(t);else if(e instanceof An||e instanceof Pn)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof En)this._setRanges([e],t&&t.backward),this._setFakeOptions(t);else if(e instanceof Cn)this._setRanges([new En(e)]),this._setFakeOptions(t);else if(e instanceof mr){const n=!!r&&!!r.backward;let o;if(void 0===t)throw new qt("view-selection-setto-required-second-parameter",this);o="in"==t?En._createIn(e):"on"==t?En._createOn(e):new En(Cn._createAt(e,t)),this._setRanges([o],n),this._setFakeOptions(r)}else{if(!or(e))throw new qt("view-selection-setto-not-selectable",this);this._setRanges(e,t&&t.backward),this._setFakeOptions(t)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new qt("view-selection-setfocus-no-ranges",this);const r=Cn._createAt(e,t);if("same"==r.compareWith(this.focus))return;const n=this.anchor;this._ranges.pop(),"before"==r.compareWith(n)?this._addRange(new En(r,n),!0):this._addRange(new En(n,r)),this.fire("change")}is(e){return"selection"===e||"view:selection"===e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const t of e)this._addRange(t);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof En))throw new qt("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new qt("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new En(e.start,e.end))}}ir(An,Xt);class Pn{constructor(e=null,t,r){this._selection=new An,this._selection.delegate("change").to(this),this._selection.setTo(e,t,r)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e}_setTo(e,t,r){this._selection.setTo(e,t,r)}_setFocus(e,t){this._selection.setFocus(e,t)}}ir(Pn,Xt);class In{constructor(e){this.selection=new Pn,this.roots=new ar({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const r of this._postFixers)if(t=r(e),t)break}while(t)}}ir(In,fn);class On extends on{constructor(e,t,r,n){super(e,t,r,n),this.getFillerOffset=Mn,this._priority=10,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new qt("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(e,t=null){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}function Mn(){if(Dn(this))return null;let e=this.parent;for(;e&&e.is("attributeElement");){if(Dn(e)>1)return null;e=e.parent}return!e||Dn(e)>1?null:this.childCount}function Dn(e){return Array.from(e.getChildren()).filter(e=>!e.is("uiElement")).length}On.DEFAULT_PRIORITY=10;class zn extends on{constructor(e,t,r,n){super(e,t,r,n),this.getFillerOffset=jn}is(e,t=null){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof mr||Array.from(t).length>0))throw new qt("view-emptyelement-cannot-add",[this,t])}}function jn(){return null}const Rn=navigator.userAgent.toLowerCase(),Ln=function(e){return e.indexOf("macintosh")>-1}(Rn),Nn=function(e){return!!e.match(/gecko\/\d+/)}(Rn),Bn=function(e){return e.indexOf(" applewebkit/")>-1&&-1===e.indexOf("chrome")}(Rn),Fn=function(e){return e.indexOf("android")>-1}(Rn),Vn=(function(e){e.indexOf("chrome/")>-1&&e.indexOf("edge/")}(Rn),{isRegExpUnicodePropertySupported:function(){let e=!1;try{e=0==="".search(new RegExp("[\\p{L}]","u"))}catch(e){}return e}()}),Un={"":"ctrl","":"shift","":"alt"},qn={ctrl:"",shift:"",alt:""},Hn=function(){const e={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let t=65;t<=90;t++)e[String.fromCharCode(t).toLowerCase()]=t;for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return e}();function Wn(e){let t;if("string"==typeof e){if(t=Hn[e.toLowerCase()],!t)throw new qt("keyboard-unknown-key",null,{key:e})}else t=e.keyCode+(e.altKey?Hn.alt:0)+(e.ctrlKey?Hn.ctrl:0)+(e.shiftKey?Hn.shift:0);return t}function Gn(e){return"string"==typeof e&&(e=Xn(e)),e.map(e=>"string"==typeof e?Wn(e):e).reduce((e,t)=>t+e,0)}function Zn(e){return Ln?Xn(e).map(e=>qn[e.toLowerCase()]||e).reduce((e,t)=>e.slice(-1)in Un?e+t:e+"+"+t):e}function Yn(e){return e==Hn.arrowright||e==Hn.arrowleft||e==Hn.arrowup||e==Hn.arrowdown}function $n(e,t){const r="ltr"===t;switch(e){case Hn.arrowleft:return r?"left":"right";case Hn.arrowright:return r?"right":"left";case Hn.arrowup:return"up";case Hn.arrowdown:return"down"}}function Kn(e,t){const r=$n(e,t);return"down"===r||"right"===r}function Xn(e){return e.split(/\s*\+\s*/)}class Jn extends on{constructor(e,t,r,n){super(e,t,r,n),this.getFillerOffset=Qn}is(e,t=null){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof mr||Array.from(t).length>0))throw new qt("view-uielement-cannot-add",this)}render(e){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const e of this.getAttributeKeys())t.setAttribute(e,this.getAttribute(e));return t}}function Qn(){return null}class eo extends on{constructor(e,t,r,n){super(e,t,r,n),this.getFillerOffset=to}is(e,t=null){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof mr||Array.from(t).length>0))throw new qt("view-rawelement-cannot-add",[this,t])}}function to(){return null}class ro{constructor(e,t){this.document=e,this._children=[],t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"view:documentFragment"===e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let r=0;const n=function(e,t){return"string"==typeof t?[new gr(e,t)]:(or(t)||(t=[t]),Array.from(t).map(t=>"string"==typeof t?new gr(e,t):t instanceof br?new gr(e,t.data):t))}(this.document,t);for(const t of n)null!==t.parent&&t._remove(),t.parent=this,this._children.splice(e,0,t),e++,r++;return r}_removeChildren(e,t=1){this._fireChange("children",this);for(let r=e;r<e+t;r++)this._children[r].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}}ir(ro,Xt);class no{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,t,r){this.document.selection._setTo(e,t,r)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createText(e){return new gr(this.document,e)}createAttributeElement(e,t,r={}){const n=new On(this.document,e,t);return r.priority&&(n._priority=r.priority),r.id&&(n._id=r.id),n}createContainerElement(e,t){return new sn(this.document,e,t)}createEditableElement(e,t){const r=new _n(this.document,e,t);return r._document=this.document,r}createEmptyElement(e,t){return new zn(this.document,e,t)}createUIElement(e,t,r){const n=new Jn(this.document,e,t);return r&&(n.render=r),n}createRawElement(e,t,r){const n=new eo(this.document,e,t);return n.render=r||(()=>{}),n}setAttribute(e,t,r){r._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,r){C(e)&&void 0===r&&(r=t),r._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,r){r._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Cn?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new qt("view-writer-break-non-container-element",this.document);if(!t.parent)throw new qt("view-writer-break-root",this.document);if(e.isAtStart)return Cn._createBefore(t);if(!e.isAtEnd){const r=t._clone(!1);this.insert(Cn._createAfter(t),r);const n=new En(e,Cn._createAt(t,"end")),o=new Cn(r,0);this.move(n,o)}return Cn._createAfter(t)}mergeAttributes(e){const t=e.offset,r=e.parent;if(r.is("$text"))return e;if(r.is("attributeElement")&&0===r.childCount){const e=r.parent,t=r.index;return r._remove(),this._removeFromClonedElementsGroup(r),this.mergeAttributes(new Cn(e,t))}const n=r.getChild(t-1),o=r.getChild(t);if(!n||!o)return e;if(n.is("$text")&&o.is("$text"))return lo(n,o);if(n.is("attributeElement")&&o.is("attributeElement")&&n.isSimilar(o)){const e=n.childCount;return n._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new Cn(n,e))}return e}mergeContainers(e){const t=e.nodeBefore,r=e.nodeAfter;if(!(t&&r&&t.is("containerElement")&&r.is("containerElement")))throw new qt("view-writer-merge-containers-invalid-position",this.document);const n=t.getChild(t.childCount-1),o=n instanceof gr?Cn._createAt(n,"end"):Cn._createAt(t,"end");return this.move(En._createIn(r),Cn._createAt(t,"end")),this.remove(En._createOn(r)),o}insert(e,t){!function e(t,r){for(const n of t){if(!co.some(e=>n instanceof e))throw new qt("view-writer-insert-invalid-node-type",r);n.is("$text")||e(n.getChildren(),r)}}(t=or(t)?[...t]:[t],this.document);const r=oo(e);if(!r)throw new qt("view-writer-invalid-position-container",this.document);const n=this._breakAttributes(e,!0),o=r._insertChild(n.offset,t);for(const e of t)this._addToClonedElementsGroup(e);const i=n.getShiftedBy(o),a=this.mergeAttributes(n);if(0===o)return new En(a,a);{a.isEqual(n)||i.offset--;const e=this.mergeAttributes(i);return new En(a,e)}}remove(e){const t=e instanceof En?e:En._createOn(e);if(ho(t,this.document),t.isCollapsed)return new ro(this.document);const{start:r,end:n}=this._breakAttributesRange(t,!0),o=r.parent,i=n.offset-r.offset,a=o._removeChildren(r.offset,i);for(const e of a)this._removeFromClonedElementsGroup(e);const s=this.mergeAttributes(r);return t.start=s,t.end=s.clone(),new ro(this.document,a)}clear(e,t){ho(e,this.document);const r=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const n of r){const r=n.item;let o;if(r.is("element")&&t.isSimilar(r))o=En._createOn(r);else if(!n.nextPosition.isAfter(e.start)&&r.is("$textProxy")){const e=r.getAncestors().find(e=>e.is("element")&&t.isSimilar(e));e&&(o=En._createIn(e))}o&&(o.end.isAfter(e.end)&&(o.end=e.end),o.start.isBefore(e.start)&&(o.start=e.start),this.remove(o))}}move(e,t){let r;if(t.isAfter(e.end)){const n=(t=this._breakAttributes(t,!0)).parent,o=n.childCount;e=this._breakAttributesRange(e,!0),r=this.remove(e),t.offset+=n.childCount-o}else r=this.remove(e);return this.insert(t,r)}wrap(e,t){if(!(t instanceof On))throw new qt("view-writer-wrap-invalid-attribute",this.document);if(ho(e,this.document),e.isCollapsed){let n=e.start;n.parent.is("element")&&(r=n.parent,!Array.from(r.getChildren()).some(e=>!e.is("uiElement")))&&(n=n.getLastMatchingPosition(e=>e.item.is("uiElement"))),n=this._wrapPosition(n,t);const o=this.document.selection;return o.isCollapsed&&o.getFirstPosition().isEqual(e.start)&&this.setSelection(n),new En(n)}return this._wrapRange(e,t);var r}unwrap(e,t){if(!(t instanceof On))throw new qt("view-writer-unwrap-invalid-attribute",this.document);if(ho(e,this.document),e.isCollapsed)return e;const{start:r,end:n}=this._breakAttributesRange(e,!0),o=r.parent,i=this._unwrapChildren(o,r.offset,n.offset,t),a=this.mergeAttributes(i.start);a.isEqual(i.start)||i.end.offset--;const s=this.mergeAttributes(i.end);return new En(a,s)}rename(e,t){const r=new sn(this.document,e,t.getAttributes());return this.insert(Cn._createAfter(t),r),this.move(En._createIn(t),Cn._createAt(r,0)),this.remove(En._createOn(t)),r}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Cn._createAt(e,t)}createPositionAfter(e){return Cn._createAfter(e)}createPositionBefore(e){return Cn._createBefore(e)}createRange(e,t){return new En(e,t)}createRangeOn(e){return En._createOn(e)}createRangeIn(e){return En._createIn(e)}createSelection(e,t,r){return new An(e,t,r)}_wrapChildren(e,t,r,n){let o=t;const i=[];for(;o<r;){const t=e.getChild(o),r=t.is("$text"),a=t.is("attributeElement"),s=t.is("emptyElement"),l=t.is("uiElement"),c=t.is("rawElement");if(a&&this._wrapAttributeElement(n,t))i.push(new Cn(e,o));else if(r||s||l||c||a&&io(n,t)){const r=n._clone();t._remove(),r._appendChild(t),e._insertChild(o,r),this._addToClonedElementsGroup(r),i.push(new Cn(e,o))}else a&&this._wrapChildren(t,0,t.childCount,n);o++}let a=0;for(const e of i)e.offset-=a,e.offset!=t&&(this.mergeAttributes(e).isEqual(e)||(a++,r--));return En._createFromParentsAndOffsets(e,t,e,r)}_unwrapChildren(e,t,r,n){let o=t;const i=[];for(;o<r;){const t=e.getChild(o);if(t.is("attributeElement"))if(t.isSimilar(n)){const n=t.getChildren(),a=t.childCount;t._remove(),e._insertChild(o,n),this._removeFromClonedElementsGroup(t),i.push(new Cn(e,o),new Cn(e,o+a)),o+=a,r+=a-1}else this._unwrapAttributeElement(n,t)?(i.push(new Cn(e,o),new Cn(e,o+1)),o++):(this._unwrapChildren(t,0,t.childCount,n),o++);else o++}let a=0;for(const e of i)e.offset-=a,e.offset!=t&&e.offset!=r&&(this.mergeAttributes(e).isEqual(e)||(a++,r--));return En._createFromParentsAndOffsets(e,t,e,r)}_wrapRange(e,t){const{start:r,end:n}=this._breakAttributesRange(e,!0),o=r.parent,i=this._wrapChildren(o,r.offset,n.offset,t),a=this.mergeAttributes(i.start);a.isEqual(i.start)||i.end.offset--;const s=this.mergeAttributes(i.end);return new En(a,s)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return ao(e.clone());e.parent.is("$text")&&(e=so(e));const r=this.createAttributeElement();r._priority=Number.POSITIVE_INFINITY,r.isSimilar=()=>!1,e.parent._insertChild(e.offset,r);const n=new En(e,e.getShiftedBy(1));this.wrap(n,t);const o=new Cn(r.parent,r.index);r._remove();const i=o.nodeBefore,a=o.nodeAfter;return i instanceof gr&&a instanceof gr?lo(i,a):ao(o)}_wrapAttributeElement(e,t){if(!po(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const r of e.getAttributeKeys())if("class"!==r&&"style"!==r&&t.hasAttribute(r)&&t.getAttribute(r)!==e.getAttribute(r))return!1;for(const r of e.getStyleNames())if(t.hasStyle(r)&&t.getStyle(r)!==e.getStyle(r))return!1;for(const r of e.getAttributeKeys())"class"!==r&&"style"!==r&&(t.hasAttribute(r)||this.setAttribute(r,e.getAttribute(r),t));for(const r of e.getStyleNames())t.hasStyle(r)||this.setStyle(r,e.getStyle(r),t);for(const r of e.getClassNames())t.hasClass(r)||this.addClass(r,t);return!0}_unwrapAttributeElement(e,t){if(!po(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const r of e.getAttributeKeys())if("class"!==r&&"style"!==r&&(!t.hasAttribute(r)||t.getAttribute(r)!==e.getAttribute(r)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const r of e.getStyleNames())if(!t.hasStyle(r)||t.getStyle(r)!==e.getStyle(r))return!1;for(const r of e.getAttributeKeys())"class"!==r&&"style"!==r&&this.removeAttribute(r,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const r=e.start,n=e.end;if(ho(e,this.document),e.isCollapsed){const r=this._breakAttributes(e.start,t);return new En(r,r)}const o=this._breakAttributes(n,t),i=o.parent.childCount,a=this._breakAttributes(r,t);return o.offset+=o.parent.childCount-i,new En(a,o)}_breakAttributes(e,t=!1){const r=e.offset,n=e.parent;if(e.parent.is("emptyElement"))throw new qt("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new qt("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new qt("view-writer-cannot-break-raw-element",this.document);if(!t&&n.is("$text")&&uo(n.parent))return e.clone();if(uo(n))return e.clone();if(n.is("$text"))return this._breakAttributes(so(e),t);if(r==n.childCount){const e=new Cn(n.parent,n.index+1);return this._breakAttributes(e,t)}if(0===r){const e=new Cn(n.parent,n.index);return this._breakAttributes(e,t)}{const e=n.index+1,o=n._clone();n.parent._insertChild(e,o),this._addToClonedElementsGroup(o);const i=n.childCount-r,a=n._removeChildren(r,i);o._appendChild(a);const s=new Cn(n.parent,e);return this._breakAttributes(s,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const t of e.getChildren())this._addToClonedElementsGroup(t);const t=e.id;if(!t)return;let r=this._cloneGroups.get(t);r||(r=new Set,this._cloneGroups.set(t,r)),r.add(e),e._clonesGroup=r}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const t of e.getChildren())this._removeFromClonedElementsGroup(t);const t=e.id;if(!t)return;const r=this._cloneGroups.get(t);r&&r.delete(e)}}function oo(e){let t=e.parent;for(;!uo(t);){if(!t)return;t=t.parent}return t}function io(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function ao(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new Cn(t,t.data.length);const r=e.nodeAfter;return r&&r.is("$text")?new Cn(r,0):e}function so(e){if(e.offset==e.parent.data.length)return new Cn(e.parent.parent,e.parent.index+1);if(0===e.offset)return new Cn(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new gr(e.root.document,t)),new Cn(e.parent.parent,e.parent.index+1)}function lo(e,t){const r=e.data.length;return e._data+=t.data,t._remove(),new Cn(e,r)}const co=[gr,On,sn,zn,eo,Jn];function uo(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function ho(e,t){const r=oo(e.start),n=oo(e.end);if(!r||!n||r!==n)throw new qt("view-writer-invalid-range-container",t)}function po(e,t){return null===e.id&&null===t.id}function fo(e){return"[object Text]"==Object.prototype.toString.call(e)}const mo=e=>e.createTextNode(""),go=e=>{const t=e.createElement("br");return t.dataset.ckeFiller=!0,t},bo=(()=>{let e="";for(let t=0;t<7;t++)e+="";return e})();function vo(e){return fo(e)&&e.data.substr(0,7)===bo}function yo(e){return 7==e.data.length&&vo(e)}function _o(e){return vo(e)?e.data.slice(7):e.data}function wo(e,t){if(t.keyCode==Hn.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,r=e.getRangeAt(0).startOffset;vo(t)&&r<=7&&e.collapse(t,0)}}}function xo(e,t,r,n=!1){r=r||function(e,t){return e===t},Array.isArray(e)||(e=Array.prototype.slice.call(e)),Array.isArray(t)||(t=Array.prototype.slice.call(t));const o=function(e,t,r){const n=ko(e,t,r);if(-1===n)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const o=ko(Co(e,n),Co(t,n),r);return{firstIndex:n,lastIndexOld:e.length-o,lastIndexNew:t.length-o}}(e,t,r);return n?function(e,t){const{firstIndex:r,lastIndexOld:n,lastIndexNew:o}=e;if(-1===r)return Array(t).fill("equal");let i=[];return r>0&&(i=i.concat(Array(r).fill("equal"))),o-r>0&&(i=i.concat(Array(o-r).fill("insert"))),n-r>0&&(i=i.concat(Array(n-r).fill("delete"))),o<t&&(i=i.concat(Array(t-o).fill("equal"))),i}(o,t.length):function(e,t){const r=[],{firstIndex:n,lastIndexOld:o,lastIndexNew:i}=t;return i-n>0&&r.push({index:n,type:"insert",values:e.slice(n,i)}),o-n>0&&r.push({index:n+(i-n),type:"delete",howMany:o-n}),r}(t,o)}function ko(e,t,r){for(let n=0;n<Math.max(e.length,t.length);n++)if(void 0===e[n]||void 0===t[n]||!r(e[n],t[n]))return n;return-1}function Co(e,t){return e.slice(t).reverse()}function Eo(e,t,r){r=r||function(e,t){return e===t};const n=e.length,o=t.length;if(n>200||o>200||n+o>300)return Eo.fastDiff(e,t,r,!0);let i,a;if(o<n){const r=e;e=t,t=r,i="delete",a="insert"}else i="insert",a="delete";const s=e.length,l=t.length,c=l-s,u={},d={};function h(n){const o=(void 0!==d[n-1]?d[n-1]:-1)+1,c=void 0!==d[n+1]?d[n+1]:-1,h=o>c?-1:1;u[n+h]&&(u[n]=u[n+h].slice(0)),u[n]||(u[n]=[]),u[n].push(o>c?i:a);let p=Math.max(o,c),f=p-n;for(;f<s&&p<l&&r(e[f],t[p]);)f++,p++,u[n].push("equal");return p}let p,f=0;do{for(p=-f;p<c;p++)d[p]=h(p);for(p=c+f;p>c;p--)d[p]=h(p);d[c]=h(c),f++}while(d[c]!==l);return u[c].slice(1)}function So(e,t,r){e.insertBefore(r,e.childNodes[t]||null)}function To(e){const t=e.parentNode;t&&t.removeChild(e)}function Ao(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node}return!1}Eo.fastDiff=xo;class Po{constructor(e,t){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=t,this.isFocused=!1,this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new qt("view-renderer-unknown-type",this);this.markedChildren.add(t)}}}render(){let e;for(const e of this.markedChildren)this._updateChildrenMappings(e);this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent));for(const e of this.markedAttributes)this._updateAttrs(e);for(const t of this.markedChildren)this._updateChildren(t,{inlineFillerPosition:e});for(const t of this.markedTexts)!this.markedChildren.has(t.parent)&&this.domConverter.mapViewToDom(t.parent)&&this._updateText(t,{inlineFillerPosition:e});if(e){const t=this.domConverter.viewPositionToDom(e),r=t.parent.ownerDocument;vo(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=Io(r,t.parent,t.offset)}else this._inlineFiller=null;this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const r=this.domConverter.mapViewToDom(e).childNodes,n=Array.from(this.domConverter.viewChildrenToDom(e,t.ownerDocument,{withChildren:!1})),o=this._diffNodeLists(r,n),i=this._findReplaceActions(o,r,n);if(-1!==i.indexOf("replace")){const t={equal:0,insert:0,delete:0};for(const o of i)if("replace"===o){const o=t.equal+t.insert,i=t.equal+t.delete,a=e.getChild(o);!a||a.is("uiElement")||a.is("rawElement")||this._updateElementMappings(a,r[i]),To(n[o]),t.equal++}else t[o]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Cn._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&fo(t.parent)&&vo(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!vo(e))throw new qt("view-renderer-filler-was-lost",this);yo(e)?e.parentNode.removeChild(e):e.data=e.data.substr(7),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,r=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!function(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor(e=>e.hasAttribute("contenteditable"));return!t||"true"==t.getAttribute("contenteditable")}(t))return!1;if(r===t.getFillerOffset())return!1;const n=e.nodeBefore,o=e.nodeAfter;return!(n instanceof gr||o instanceof gr)}_updateText(e,t){const r=this.domConverter.findCorrespondingDomText(e),n=this.domConverter.viewToDom(e,r.ownerDocument),o=r.data;let i=n.data;const a=t.inlineFillerPosition;if(a&&a.parent==e.parent&&a.offset==e.index&&(i=bo+i),o!=i){const e=xo(o,i);for(const t of e)"insert"===t.type?r.insertData(t.index,t.values.join("")):r.deleteData(t.index,t.howMany)}}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const r=Array.from(t.attributes).map(e=>e.name),n=e.getAttributeKeys();for(const r of n)t.setAttribute(r,e.getAttribute(r));for(const n of r)e.hasAttribute(n)||t.removeAttribute(n)}_updateChildren(e,t){const r=this.domConverter.mapViewToDom(e);if(!r)return;const n=t.inlineFillerPosition,o=this.domConverter.mapViewToDom(e).childNodes,i=Array.from(this.domConverter.viewChildrenToDom(e,r.ownerDocument,{bind:!0,inlineFillerPosition:n}));n&&n.parent===e&&Io(r.ownerDocument,i,n.offset);const a=this._diffNodeLists(o,i);let s=0;const l=new Set;for(const e of a)"delete"===e?(l.add(o[s]),To(o[s])):"equal"===e&&s++;s=0;for(const e of a)"insert"===e?(So(r,s,i[s]),s++):"equal"===e&&(this._markDescendantTextToSync(this.domConverter.domToView(i[s])),s++);for(const e of l)e.parentNode||this.domConverter.unbindDomElement(e)}_diffNodeLists(e,t){return Eo(e=function(e,t){const r=Array.from(e);return 0!=r.length&&t?(r[r.length-1]==t&&r.pop(),r):r}(e,this._fakeSelectionContainer),t,Mo.bind(null,this.domConverter))}_findReplaceActions(e,t,r){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let n=[],o=[],i=[];const a={equal:0,insert:0,delete:0};for(const s of e)"insert"===s?i.push(r[a.equal+a.insert]):"delete"===s?o.push(t[a.equal+a.delete]):(n=n.concat(Eo(o,i,Oo).map(e=>"equal"===e?"replace":e)),n.push("equal"),o=[],i=[]),a[s]++;return n.concat(Eo(o,i,Oo).map(e=>"equal"===e?"replace":e))}_markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent="",t}(t));const r=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(r,this.selection),!this._fakeSelectionNeedsUpdate(e))return;r.parentElement&&r.parentElement==e||e.appendChild(r),r.textContent=this.selection.fakeSelectionLabel||"";const n=t.getSelection(),o=t.createRange();n.removeAllRanges(),o.selectNodeContents(r),n.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const r=this.domConverter.viewPositionToDom(this.selection.anchor),n=this.domConverter.viewPositionToDom(this.selection.focus);e.focus(),t.collapse(r.parent,r.offset),t.extend(n.parent,n.offset),Nn&&function(e,t){const r=e.parent;if(r.nodeType!=Node.ELEMENT_NODE||e.offset!=r.childNodes.length-1)return;const n=r.childNodes[e.offset];n&&"BR"==n.tagName&&t.addRange(t.getRangeAt(0))}(n,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,r=e.ownerDocument.getSelection();return!t||t.parentElement!==e||r.anchorNode!==t&&!t.contains(r.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments)if(e.getSelection().rangeCount){const t=e.activeElement,r=this.domConverter.mapDomToView(t);t&&r&&e.getSelection().removeAllRanges()}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function Io(e,t,r){const n=t instanceof Array?t:t.childNodes,o=n[r];if(fo(o))return o.data=bo+o.data,o;{const o=e.createTextNode(bo);return Array.isArray(t)?n.splice(r,0,o):So(t,r,o),o}}function Oo(e,t){return Ao(e)&&Ao(t)&&!fo(e)&&!fo(t)&&e.nodeType!==Node.COMMENT_NODE&&t.nodeType!==Node.COMMENT_NODE&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function Mo(e,t,r){return t===r||(fo(t)&&fo(r)?t.data===r.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(r)))}ir(Po,fn);const Do={window:window,document:document};function zo(e){let t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t}function jo(e){const t=[];for(;e&&e.nodeType!=Node.DOCUMENT_NODE;)t.unshift(e),e=e.parentNode;return t}const Ro=go(document);class Lo{constructor(e,t={}){this.document=e,this.blockFillerMode=t.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption","td","th"],this._blockFiller="br"==this.blockFillerMode?go:mo,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new yr,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new An(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of e.childNodes)this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}viewToDom(e,t,r={}){if(e.is("$text")){const r=this._processDataFromViewText(e);return t.createTextNode(r)}{if(this.mapViewToDom(e))return this.mapViewToDom(e);let n;if(e.is("documentFragment"))n=t.createDocumentFragment(),r.bind&&this.bindDocumentFragments(n,e);else{if(e.is("uiElement"))return n=e.render(t),r.bind&&this.bindElements(n,e),n;n=e.hasAttribute("xmlns")?t.createElementNS(e.getAttribute("xmlns"),e.name):t.createElement(e.name),e.is("rawElement")&&e.render(n),r.bind&&this.bindElements(n,e);for(const t of e.getAttributeKeys())n.setAttribute(t,e.getAttribute(t))}if(!1!==r.withChildren)for(const o of this.viewChildrenToDom(e,t,r))n.appendChild(o);return n}}*viewChildrenToDom(e,t,r={}){const n=e.getFillerOffset&&e.getFillerOffset();let o=0;for(const i of e.getChildren())n===o&&(yield this._blockFiller(t)),yield this.viewToDom(i,t,r),o++;n===o&&(yield this._blockFiller(t))}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),r=this.viewPositionToDom(e.end),n=document.createRange();return n.setStart(t.parent,t.offset),n.setEnd(r.parent,r.offset),n}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const r=this.findCorrespondingDomText(t);if(!r)return null;let n=e.offset;return vo(r)&&(n+=7),{parent:r,offset:n}}{let r,n,o;if(0===e.offset){if(r=this.mapViewToDom(t),!r)return null;o=r.childNodes[0]}else{const t=e.nodeBefore;if(n=t.is("$text")?this.findCorrespondingDomText(t):this.mapViewToDom(e.nodeBefore),!n)return null;r=n.parentNode,o=n.nextSibling}return fo(o)&&vo(o)?{parent:o,offset:7}:{parent:r,offset:n?zo(n)+1:0}}}domToView(e,t={}){if(this.isBlockFiller(e,this.blockFillerMode))return null;const r=this.getHostViewElement(e);if(r)return r;if(fo(e)){if(yo(e))return null;{const t=this._processDataFromDomText(e);return""===t?null:new gr(this.document,t)}}if(this.isComment(e))return null;{if(this.mapDomToView(e))return this.mapDomToView(e);let r;if(this.isDocumentFragment(e))r=new ro(this.document),t.bind&&this.bindDocumentFragments(e,r);else{const n=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();r=new on(this.document,n),t.bind&&this.bindElements(e,r);const o=e.attributes;for(let e=o.length-1;e>=0;e--)r._setAttribute(o[e].name,o[e].value);if(!1!==t.withChildren&&this._rawContentElementMatcher.match(r))return r._setCustomProperty("$rawContent",e.innerHTML),this._encounteredRawContentDomNodes.add(e),r}if(!1!==t.withChildren)for(const n of this.domChildrenToView(e,t))r._appendChild(n);return r}}*domChildrenToView(e,t={}){for(let r=0;r<e.childNodes.length;r++){const n=e.childNodes[r],o=this.domToView(n,t);null!==o&&(yield o)}}domSelectionToView(e){if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;fo(t)&&(t=t.parentNode);const r=this.fakeSelectionToView(t);if(r)return r}const t=this.isDomSelectionBackward(e),r=[];for(let t=0;t<e.rangeCount;t++){const n=e.getRangeAt(t),o=this.domRangeToView(n);o&&r.push(o)}return new An(r,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),r=this.domPositionToView(e.endContainer,e.endOffset);return t&&r?new En(t,r):null}domPositionToView(e,t){if(this.isBlockFiller(e,this.blockFillerMode))return this.domPositionToView(e.parentNode,zo(e));const r=this.mapDomToView(e);if(r&&(r.is("uiElement")||r.is("rawElement")))return Cn._createBefore(r);if(fo(e)){if(yo(e))return this.domPositionToView(e.parentNode,zo(e));const r=this.findCorrespondingViewText(e);let n=t;return r?(vo(e)&&(n-=7,n=n<0?0:n),new Cn(r,n)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new Cn(t,0)}else{const r=e.childNodes[t-1],n=fo(r)?this.findCorrespondingViewText(r):this.mapDomToView(r);if(n&&n.parent)return new Cn(n.parent,n.index+1)}return null}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(yo(e))return null;const t=this.getHostViewElement(e);if(t)return t;const r=e.previousSibling;if(r){if(!this.isElement(r))return null;const e=this.mapDomToView(r);if(e)return e.nextSibling instanceof gr?e.nextSibling:null}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof gr?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:e,scrollY:r}=Do.window,n=[];Bo(t,e=>{const{scrollLeft:t,scrollTop:r}=e;n.push([t,r])}),t.focus(),Bo(t,e=>{const[t,r]=n.shift();e.scrollLeft=t,e.scrollTop=r}),Do.window.scrollTo(e,r)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(Ro):!("BR"!==e.tagName||!Fo(e,this.blockElements)||1!==e.parentNode.childNodes.length)||function(e,t){return fo(e)&&""==e.data&&Fo(e,t)&&1===e.parentNode.childNodes.length}(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);const r=t.collapsed;return t.detach(),r}getHostViewElement(e){const t=jo(e);for(t.pop();t.length;){const e=t.pop(),r=this._domToViewMapping.get(e);if(r&&(r.is("uiElement")||r.is("rawElement")))return r}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}_isDomSelectionPositionCorrect(e,t){if(fo(e)&&vo(e)&&t<7)return!1;if(this.isElement(e)&&vo(e.childNodes[t]))return!1;const r=this.mapDomToView(e);return!r||!r.is("uiElement")&&!r.is("rawElement")}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some(e=>this.preElements.includes(e.name)))return t;if(" "==t.charAt(0)){const r=this._getTouchingViewTextNode(e,!1);(!r||!this._nodeEndsWithSpace(r))&&r||(t=""+t.substr(1))}if(" "==t.charAt(t.length-1)){const r=this._getTouchingViewTextNode(e,!0);" "!=t.charAt(t.length-2)&&r&&" "!=r.data.charAt(0)||(t=t.substr(0,t.length-1)+"")}return t.replace(/ {2}/g," ")}_nodeEndsWithSpace(e){if(e.getAncestors().some(e=>this.preElements.includes(e.name)))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_processDataFromDomText(e){let t=e.data;if(No(e,this.preElements))return _o(e);t=t.replace(/[ \n\t\r]{1,}/g," ");const r=this._getTouchingInlineDomNode(e,!1),n=this._getTouchingInlineDomNode(e,!0),o=this._checkShouldLeftTrimDomText(e,r),i=this._checkShouldRightTrimDomText(e,n);return o&&(t=t.replace(/^ /,"")),i&&(t=t.replace(/ $/,"")),t=_o(new Text(t)),t=t.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(t)||!n||n.data&&" "==n.data.charAt(0))&&(t=t.replace(/\u00A0$/," ")),o&&(t=t.replace(/^\u00A0/," ")),t}_checkShouldLeftTrimDomText(e,t){return!t||!!jt(t)||!this._encounteredRawContentDomNodes.has(e.previousSibling)&&/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1))}_checkShouldRightTrimDomText(e,t){return!t&&!vo(e)}_getTouchingViewTextNode(e,t){const r=new kn({startPosition:t?Cn._createAfter(e):Cn._createBefore(e),direction:t?"forward":"backward"});for(const e of r){if(e.item.is("containerElement"))return null;if(e.item.is("element","br"))return null;if(e.item.is("$textProxy"))return e.item}return null}_getTouchingInlineDomNode(e,t){if(!e.parentNode)return null;const r=t?"nextNode":"previousNode",n=e.ownerDocument,o=jo(e)[0],i=n.createTreeWalker(o,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:e=>fo(e)||"BR"==e.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});i.currentNode=e;const a=i[r]();if(null!==a){const t=function(e,t){const r=jo(e),n=jo(t);let o=0;for(;r[o]==n[o]&&r[o];)o++;return 0===o?null:r[o-1]}(e,a);if(t&&!No(e,this.blockElements,t)&&!No(a,this.blockElements,t))return a}return null}}function No(e,t,r){let n=jo(e);return r&&(n=n.slice(n.indexOf(r)+1)),n.some(e=>e.tagName&&t.includes(e.tagName.toLowerCase()))}function Bo(e,t){for(;e&&e!=Do.document;)t(e),e=e.parentNode}function Fo(e,t){const r=e.parentNode;return r&&r.tagName&&t.includes(r.tagName.toLowerCase())}function Vo(e){const t=Object.prototype.toString.apply(e);return"[object Window]"==t||"[object global]"==t}const Uo=cn({},Xt,{listenTo(e,...t){if(Ao(e)||Vo(e)){const r=this._getProxyEmitter(e)||new qo(e);r.attach(...t),e=r}Xt.listenTo.call(this,e,...t)},stopListening(e,t,r){if(Ao(e)||Vo(e)){const t=this._getProxyEmitter(e);if(!t)return;e=t}Xt.stopListening.call(this,e,t,r),e instanceof qo&&e.detach(t)},_getProxyEmitter(e){return t=this,r=Ho(e),t[$t]&&t[$t][r]?t[$t][r].emitter:null;var t,r}});class qo{constructor(e){Jt(this,Ho(e)),this._domNode=e}}function Ho(e){return e["data-ck-expando"]||(e["data-ck-expando"]=Vt())}cn(qo.prototype,Xt,{attach(e,t,r={}){if(this._domListeners&&this._domListeners[e])return;const n={capture:!!r.useCapture,passive:!!r.usePassive},o=this._createDomListener(e,n);this._domNode.addEventListener(e,o,n),this._domListeners||(this._domListeners={}),this._domListeners[e]=o},detach(e){let t;!this._domListeners[e]||(t=this._events[e])&&t.callbacks.length||this._domListeners[e].removeListener()},_createDomListener(e,t){const r=t=>{this.fire(e,t)};return r.removeListener=()=>{this._domNode.removeEventListener(e,r,t),delete this._domListeners[e]},r}});class Wo{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}function Go(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new J;++t<r;)this.add(e[t])}ir(Wo,Uo),Go.prototype.add=Go.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Go.prototype.has=function(e){return this.__data__.has(e)};const Zo=Go,Yo=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},$o=function(e,t){return e.has(t)},Ko=function(e,t,r,n,o,i){var a=1&r,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,p=2&r?new Zo:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var f=e[d],m=t[d];if(n)var g=a?n(m,f,d,t,e,i):n(f,m,d,e,t,i);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!Yo(t,(function(e,t){if(!$o(p,t)&&(f===e||o(f,e,r,n,i)))return p.push(t)}))){h=!1;break}}else if(f!==m&&!o(f,m,r,n,i)){h=!1;break}}return i.delete(e),i.delete(t),h},Xo=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r},Jo=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r};var Qo=l?l.prototype:void 0,ei=Qo?Qo.valueOf:void 0,ti=Object.prototype.hasOwnProperty,ri="[object Arguments]",ni="[object Array]",oi="[object Object]",ii=Object.prototype.hasOwnProperty;const ai=function(e,t,r,n,o,i){var a=de(e),s=de(t),l=a?ni:ft(e),c=s?ni:ft(t),u=(l=l==ri?oi:l)==oi,d=(c=c==ri?oi:c)==oi,h=l==c;if(h&&me(e)){if(!me(t))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new ee),a||Se(e)?Ko(e,t,r,n,o,i):function(e,t,r,n,o,i,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new gt(e),new gt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return E(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Xo;case"[object Set]":var l=1&n;if(s||(s=Jo),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=Ko(s(e),s(t),n,o,i,a);return a.delete(e),u;case"[object Symbol]":if(ei)return ei.call(e)==ei.call(t)}return!1}(e,t,l,r,n,o,i);if(!(1&r)){var p=u&&ii.call(e,"__wrapped__"),f=d&&ii.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return i||(i=new ee),o(m,g,r,n,i)}}return!!h&&(i||(i=new ee),function(e,t,r,n,o,i){var a=1&r,s=Xe(e),l=s.length;if(l!=Xe(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:ti.call(t,u)))return!1}var d=i.get(e),h=i.get(t);if(d&&h)return d==t&&h==e;var p=!0;i.set(e,t),i.set(t,e);for(var f=a;++c<l;){var m=e[u=s[c]],g=t[u];if(n)var b=a?n(g,m,u,t,e,i):n(m,g,u,e,t,i);if(!(void 0===b?m===g||o(m,g,r,n,i):b)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return i.delete(e),i.delete(t),p}(e,t,r,n,o,i))},si=function e(t,r,n,o,i){return t===r||(null==t||null==r||!v(t)&&!v(r)?t!=t&&r!=r:ai(t,r,n,o,e,i))},li=function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?si(e,t,void 0,r):!!n};class ci extends Wo{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,r=new Map,n=new Set;for(const r of e)if("childList"===r.type){const e=t.mapDomToView(r.target);if(e&&(e.is("uiElement")||e.is("rawElement")))continue;e&&!this._isBogusBrMutation(r)&&n.add(e)}for(const o of e){const e=t.mapDomToView(o.target);if((!e||!e.is("uiElement")&&!e.is("rawElement"))&&"characterData"===o.type){const e=t.findCorrespondingViewText(o.target);e&&!n.has(e.parent)?r.set(e,{type:"text",oldText:e.data,newText:_o(o.target),node:e}):!e&&vo(o.target)&&n.add(t.mapDomToView(o.target.parentNode))}}const o=[];for(const e of r.values())this.renderer.markToSync("text",e.node),o.push(e);for(const e of n){const r=t.mapViewToDom(e),n=Array.from(e.getChildren()),i=Array.from(t.domChildrenToView(r,{withChildren:!1}));li(n,i,s)||(this.renderer.markToSync("children",e),o.push({type:"children",oldChildren:n,newChildren:i,node:e}))}const i=e[0].target.ownerDocument.getSelection();let a=null;if(i&&i.anchorNode){const e=t.domPositionToView(i.anchorNode,i.anchorOffset),r=t.domPositionToView(i.focusNode,i.focusOffset);e&&r&&(a=new An(e),a.setFocus(r))}function s(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data}o.length&&(this.document.fire("mutations",o,a),this.view.forceRender())}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}class ui{constructor(e,t,r){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,cn(this,r)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class di extends Wo{constructor(e){super(e),this.useCapture=!1}observe(e){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(t=>{this.listenTo(e,t,(e,t)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(t.target)&&this.onDomEvent(t)},{useCapture:this.useCapture})})}fire(e,t,r){this.isEnabled&&this.document.fire(e,new ui(this.view,t,r))}}class hi extends di{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,shiftKey:e.shiftKey,get keystroke(){return Wn(this)}})}}const pi=function(){return s.Date.now()};var fi=/\s/,mi=/^\s+/;const gi=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&fi.test(e.charAt(t)););return t}(e)+1).replace(mi,""):e};var bi=/^[-+]0x[0-9a-f]+$/i,vi=/^0b[01]+$/i,yi=/^0o[0-7]+$/i,_i=parseInt;const wi=function(e){if("number"==typeof e)return e;if(wr(e))return NaN;if(I(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=I(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=gi(e);var r=vi.test(e);return r||yi.test(e)?_i(e.slice(2),r?2:8):bi.test(e)?NaN:+e};var xi=Math.max,ki=Math.min;const Ci=function(e,t,r){var n,o,i,a,s,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var r=n,i=o;return n=o=void 0,c=t,a=e.apply(i,r)}function f(e){return c=e,s=setTimeout(g,t),u?p(e):a}function m(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=i}function g(){var e=pi();if(m(e))return b(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?ki(r,i-(e-c)):r}(e))}function b(e){return s=void 0,h&&n?p(e):(n=o=void 0,a)}function v(){var e=pi(),r=m(e);if(n=arguments,o=this,l=e,r){if(void 0===s)return f(l);if(d)return clearTimeout(s),s=setTimeout(g,t),p(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=wi(t)||0,I(r)&&(u=!!r.leading,i=(d="maxWait"in r)?xi(wi(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=o=s=void 0},v.flush=function(){return void 0===s?a:b(pi())},v};class Ei extends Wo{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=Ci(e=>this.document.fire("selectionChangeDone",e),200)}observe(){const e=this.document;e.on("keydown",(t,r)=>{e.selection.isFake&&Yn(r.keyCode)&&this.isEnabled&&(r.preventDefault(),this._handleSelectionMove(r.keyCode))},{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,r=new An(t.getRanges(),{backward:t.isBackward,fake:!1});e!=Hn.arrowleft&&e!=Hn.arrowup||r.setTo(r.getFirstPosition()),e!=Hn.arrowright&&e!=Hn.arrowdown||r.setTo(r.getLastPosition());const n={oldSelection:t,newSelection:r,domSelection:null};this.document.fire("selectionChange",n),this._fireSelectionChangeDoneDebounced(n)}}class Si extends Wo{constructor(e){super(e),this.mutationObserver=e.getObserver(ci),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Ci(e=>this.document.fire("selectionChangeDone",e),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument;this._documents.has(t)||(this.listenTo(t,"selectionchange",(e,r)=>{this._handleSelectionChange(r,t)}),this._documents.add(t))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionChange(e,t){if(!this.isEnabled)return;const r=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(r.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(r);if(0!=n.rangeCount){if(this.view.hasDomSelection=!0,!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(r)||++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:n,domSelection:r};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}class Ti extends di{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",()=>{t.isFocused=!0,this._renderTimeoutId=setTimeout(()=>e.forceRender(),50)}),t.on("blur",(r,n)=>{const o=t.selection.editableElement;null!==o&&o!==n.target||(t.isFocused=!1,e.forceRender())})}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class Ai extends di{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0}),t.on("compositionend",()=>{t.isComposing=!1})}onDomEvent(e){this.fire(e.type,e)}}class Pi extends di{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}function Ii(e){return"[object Range]"==Object.prototype.toString.apply(e)}function Oi(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}const Mi=["top","right","bottom","left","width","height"];class Di{constructor(e){const t=Ii(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),jt(e)||t)if(t){const t=Di.getDomRangeRects(e);zi(this,Di.getBoundingRect(t))}else zi(this,e.getBoundingClientRect());else if(Vo(e)){const{innerWidth:t,innerHeight:r}=e;zi(this,{top:0,right:t,bottom:r,left:0,width:t,height:r})}else zi(this,e)}clone(){return new Di(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new Di(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(!ji(e)){let r=e.parentNode||e.commonAncestorContainer;for(;r&&!ji(r);){const e=new Di(r),n=t.getIntersection(e);if(!n)return null;n.getArea()<t.getArea()&&(t=n),r=r.parentNode}}return t}isEqual(e){for(const t of Mi)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,r,n;if(Vo(e))t=e.innerWidth-e.document.documentElement.clientWidth,r=e.innerHeight-e.document.documentElement.clientHeight,n=e.getComputedStyle(e.document.documentElement).direction;else{const o=Oi(this._source);t=e.offsetWidth-e.clientWidth-o.left-o.right,r=e.offsetHeight-e.clientHeight-o.top-o.bottom,n=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===n?this.right-=t:this.left+=t,this.height-=r,this.bottom-=r,this}static getDomRangeRects(e){const t=[],r=Array.from(e.getClientRects());if(r.length)for(const e of r)t.push(new Di(e));else{let r=e.startContainer;fo(r)&&(r=r.parentNode);const n=new Di(r.getBoundingClientRect());n.right=n.left,n.width=0,t.push(n)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let r=0;for(const n of e)r++,t.left=Math.min(t.left,n.left),t.top=Math.min(t.top,n.top),t.right=Math.max(t.right,n.right),t.bottom=Math.max(t.bottom,n.bottom);return 0==r?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new Di(t))}}function zi(e,t){for(const r of Mi)e[r]=t[r]}function ji(e){return!!jt(e)&&e===e.ownerDocument.body}function Ri({target:e,viewportOffset:t=0}){const r=qi(e);let n=r,o=null;for(;n;){let i;i=Hi(n==r?e:o),Ni(i,()=>Wi(e,n));const a=Wi(e,n);if(Li(n,a,t),n.parent!=n){if(o=n.frameElement,n=n.parent,!o)return}else n=null}}function Li(e,t,r){const n=t.clone().moveBy(0,r),o=t.clone().moveBy(0,-r),i=new Di(e).excludeScrollbarsAndBorders();if(![o,n].every(e=>i.contains(e))){let{scrollX:a,scrollY:s}=e;Fi(o,i)?s-=i.top-t.top+r:Bi(n,i)&&(s+=t.bottom-i.bottom+r),Vi(t,i)?a-=i.left-t.left+r:Ui(t,i)&&(a+=t.right-i.right+r),e.scrollTo(a,s)}}function Ni(e,t){const r=qi(e);let n,o;for(;e!=r.document.body;)o=t(),n=new Di(e).excludeScrollbarsAndBorders(),n.contains(o)||(Fi(o,n)?e.scrollTop-=n.top-o.top:Bi(o,n)&&(e.scrollTop+=o.bottom-n.bottom),Vi(o,n)?e.scrollLeft-=n.left-o.left:Ui(o,n)&&(e.scrollLeft+=o.right-n.right)),e=e.parentNode}function Bi(e,t){return e.bottom>t.bottom}function Fi(e,t){return e.top<t.top}function Vi(e,t){return e.left<t.left}function Ui(e,t){return e.right>t.right}function qi(e){return Ii(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function Hi(e){if(Ii(e)){let t=e.commonAncestorContainer;return fo(t)&&(t=t.parentNode),t}return e.parentNode}function Wi(e,t){const r=qi(e),n=new Di(e);if(r===t)return n;{let e=r;for(;e!=t;){const t=e.frameElement,r=new Di(t).excludeScrollbarsAndBorders();n.moveBy(r.left,r.top),e=e.parent}}return n}Object.assign({},{scrollViewportToShowTarget:Ri,scrollAncestorsToShowTarget:function(e){Ni(Hi(e),()=>new Di(e))}});class Gi{constructor(e){this.document=new In(e),this.domConverter=new Lo(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Po(this.domConverter,this.document.selection),this._renderer.bind("isFocused").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new no(this.document),this.addObserver(ci),this.addObserver(Si),this.addObserver(Ti),this.addObserver(hi),this.addObserver(Ei),this.addObserver(Ai),Fn&&this.addObserver(Pi),this.document.on("keydown",wo),function(e){e.document.on("keydown",(t,r)=>function(e,t,r){if(t.keyCode==Hn.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),n=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(n||t.shiftKey){const t=e.focusNode,o=e.focusOffset,i=r.domPositionToView(t,o);if(null===i)return;let a=!1;const s=i.getLastMatchingPosition(e=>(e.item.is("uiElement")&&(a=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement"))));if(a){const t=r.viewPositionToDom(s);n?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}(0,r,e.domConverter))}(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0})}attachDomRoot(e,t="main"){const r=this.document.getRoot(t);r._name=e.tagName.toLowerCase();const n={};for(const{name:t,value:o}of Array.from(e.attributes))n[t]=o,"class"===t?this._writer.addClass(o.split(" "),r):this._writer.setAttribute(t,o,r);this._initialDomRootAttributes.set(e,n);const o=()=>{this._writer.setAttribute("contenteditable",!r.isReadOnly,r),r.isReadOnly?this._writer.addClass("ck-read-only",r):this._writer.removeClass("ck-read-only",r)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,r),this._renderer.markToSync("children",r),this._renderer.markToSync("attributes",r),this._renderer.domDocuments.add(e.ownerDocument),r.on("change:children",(e,t)=>this._renderer.markToSync("children",t)),r.on("change:attributes",(e,t)=>this._renderer.markToSync("attributes",t)),r.on("change:text",(e,t)=>this._renderer.markToSync("text",t)),r.on("change:isReadOnly",()=>this.change(o)),r.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const r of this._observers.values())r.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:e})=>t.removeAttribute(e));const r=this._initialDomRootAttributes.get(t);for(const e in r)t.setAttribute(e,r[e]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[e,r]of this.domRoots)t.observe(r,e);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&Ri({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new qt("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(e){qt.rethrowUnexpectedError(e,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Cn._createAt(e,t)}createPositionAfter(e){return Cn._createAfter(e)}createPositionBefore(e){return Cn._createBefore(e)}createRange(e,t){return new En(e,t)}createRangeOn(e){return En._createOn(e)}createRangeIn(e){return En._createIn(e)}createSelection(e,t,r){return new An(e,t,r)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}ir(Gi,fn);class Zi{constructor(e){this.parent=null,this._attrs=vr(e)}get index(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildIndex(this)))throw new qt("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildStartOffset(this)))throw new qt("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let r=e.includeSelf?this:this.parent;for(;r;)t[e.parentFirst?"push":"unshift"](r),r=r.parent;return t}getCommonAncestor(e,t={}){const r=this.getAncestors(t),n=e.getAncestors(t);let o=0;for(;r[o]==n[o]&&r[o];)o++;return 0===o?null:r[o-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),r=e.getPath(),n=pr(t,r);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<r[n]}}isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((e,t)=>(e[t[0]]=t[1],e),{})),e}is(e){return"node"===e||"model:node"===e}_clone(){return new Zi(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=vr(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}class Yi extends Zi{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new Yi(this.data,this.getAttributes())}static fromJSON(e){return new Yi(e.data,e.attributes)}}class $i{constructor(e,t,r){if(this.textNode=e,t<0||t>e.offsetSize)throw new qt("model-textproxy-wrong-offsetintext",this);if(r<0||t+r>e.offsetSize)throw new qt("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+r),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let r=e.includeSelf?this:this.parent;for(;r;)t[e.parentFirst?"push":"unshift"](r),r=r.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class Ki{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((e,t)=>e+t.offsetSize,0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return-1==t?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return null===t?null:this._nodes.slice(0,t).reduce((e,t)=>e+t.offsetSize,0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new qt("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const r of this._nodes){if(e>=t&&e<t+r.offsetSize)return this.getNodeIndex(r);t+=r.offsetSize}if(t!=e)throw new qt("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const e of t)if(!(e instanceof Zi))throw new qt("model-nodelist-insertnodes-not-node",this);this._nodes.splice(e,0,...t)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map(e=>e.toJSON())}}class Xi extends Zi{constructor(e,t,r){super(t),this.name=e,this._children=new Ki,r&&this._insertChild(0,r)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(e,t=null){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const r of e)t=t.getChild(t.offsetToIndex(r));return t}findAncestor(e,t={includeSelf:!1}){let r=t.includeSelf?this:this.parent;for(;r;){if(r.name===e)return r;r=r.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map(e=>e._clone(!0)):null;return new Xi(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const r=function(e){return"string"==typeof e?[new Yi(e)]:(or(e)||(e=[e]),Array.from(e).map(e=>"string"==typeof e?new Yi(e):e instanceof $i?new Yi(e.data,e.getAttributes()):e))}(t);for(const e of r)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,r)}_removeChildren(e,t=1){const r=this._children._removeNodes(e,t);for(const e of r)e.parent=null;return r}static fromJSON(e){let t=null;if(e.children){t=[];for(const r of e.children)r.name?t.push(Xi.fromJSON(r)):t.push(Yi.fromJSON(r))}return new Xi(e.name,e.attributes,t)}}class Ji{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new qt("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new qt("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=ea._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let t,r,n,o;do{n=this.position,o=this._visitedParent,({done:t,value:r}=this.next())}while(!t&&e(r));t||(this.position=n,this._visitedParent=o)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),r=this._visitedParent;if(null===r.parent&&t.offset===r.maxOffset)return{done:!0};if(r===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};const n=t.parent,o=ta(t,n),i=o||ra(t,n,o);if(i instanceof Xi)return this.shallow?t.offset++:(t.path.push(0),this._visitedParent=i),this.position=t,Qi("elementStart",i,e,t,1);if(i instanceof Yi){let n;if(this.singleCharacters)n=1;else{let e=i.endOffset;this._boundaryEndParent==r&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),n=e-t.offset}const o=t.offset-i.startOffset,a=new $i(i,o,n);return t.offset+=n,this.position=t,Qi("text",a,e,t,n)}return t.path.pop(),t.offset++,this.position=t,this._visitedParent=r.parent,this.ignoreElementEnd?this._next():Qi("elementEnd",r,e,t)}_previous(){const e=this.position,t=this.position.clone(),r=this._visitedParent;if(null===r.parent&&0===t.offset)return{done:!0};if(r==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};const n=t.parent,o=ta(t,n),i=o||na(t,n,o);if(i instanceof Xi)return t.offset--,this.shallow?(this.position=t,Qi("elementStart",i,e,t,1)):(t.path.push(i.maxOffset),this.position=t,this._visitedParent=i,this.ignoreElementEnd?this._previous():Qi("elementEnd",i,e,t));if(i instanceof Yi){let n;if(this.singleCharacters)n=1;else{let e=i.startOffset;this._boundaryStartParent==r&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),n=t.offset-e}const o=t.offset-i.startOffset,a=new $i(i,o-n,n);return t.offset-=n,this.position=t,Qi("text",a,e,t,n)}return t.path.pop(),this.position=t,this._visitedParent=r.parent,Qi("elementStart",r,e,t,1)}}function Qi(e,t,r,n,o){return{done:!1,value:{type:e,item:t,previousPosition:r,nextPosition:n,length:o}}}class ea{constructor(e,t,r="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new qt("model-position-root-invalid",e);if(!(t instanceof Array)||0===t.length)throw new qt("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=r}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new qt("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new qt("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return ta(this,this.parent)}get nodeAfter(){const e=this.parent;return ra(this,e,ta(this,e))}get nodeBefore(){const e=this.parent;return na(this,e,ta(this,e))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=pr(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const r=new Ji(t);return r.skip(e),r.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=pr(this.path,e.path),r="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,r)}getCommonAncestor(e){const t=this.getAncestors(),r=e.getAncestors();let n=0;for(;t[n]==r[n]&&t[n];)n++;return 0===n?null:t[n-1]}getShiftedBy(e){const t=this.clone(),r=t.offset+e;return t.offset=r<0?0:r,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){let t=null,r=null;switch(this.compareWith(e)){case"same":return!0;case"before":t=ea._createAt(this),r=ea._createAt(e);break;case"after":t=ea._createAt(e),r=ea._createAt(this);break;default:return!1}let n=t.parent;for(;t.path.length+r.path.length;){if(t.isEqual(r))return!0;if(t.path.length>r.path.length){if(t.offset!==n.maxOffset)return!1;t.path=t.path.slice(0,-1),n=n.parent,t.offset++}else{if(0!==r.offset)return!1;r.path=r.path.slice(0,-1)}}}is(e){return"position"===e||"model:position"===e}hasSameParentAs(e){return this.root===e.root&&"same"==pr(this.getParentPath(),e.getParentPath())}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=ea._createAt(this)}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange;let r;return t.containsPosition(this)||t.start.isEqual(this)?(r=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(r=r._getTransformedByDeletion(e.deletionPosition,1))):r=this.isEqual(e.deletionPosition)?ea._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),r}_getTransformedByDeletion(e,t){const r=ea._createAt(this);if(this.root!=e.root)return r;if("same"==pr(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;r.offset-=t}}else if("prefix"==pr(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;if(e.offset<=this.path[n]){if(e.offset+t>this.path[n])return null;r.path[n]-=t}}return r}_getTransformedByInsertion(e,t){const r=ea._createAt(this);if(this.root!=e.root)return r;if("same"==pr(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(r.offset+=t);else if("prefix"==pr(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;e.offset<=this.path[n]&&(r.path[n]+=t)}return r}_getTransformedByMove(e,t,r){if(t=t._getTransformedByDeletion(e,r),e.isEqual(t))return ea._createAt(this);const n=this._getTransformedByDeletion(e,r);return null===n||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(r).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(e,t):n._getTransformedByInsertion(t,r)}_getCombined(e,t){const r=e.path.length-1,n=ea._createAt(t);return n.stickiness=this.stickiness,n.offset=n.offset+this.path[r]-e.offset,n.path=[...n.path,...this.path.slice(r+1)],n}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,r="toNone"){if(e instanceof ea)return new ea(e.root,e.path,e.stickiness);{const n=e;if("end"==t)t=n.maxOffset;else{if("before"==t)return this._createBefore(n,r);if("after"==t)return this._createAfter(n,r);if(0!==t&&!t)throw new qt("model-createpositionat-offset-required",[this,e])}if(!n.is("element")&&!n.is("documentFragment"))throw new qt("model-position-parent-incorrect",[this,e]);const o=n.getPath();return o.push(t),new this(n.root,o,r)}}static _createAfter(e,t){if(!e.parent)throw new qt("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new qt("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const r=new ea(t.graveyard,e.path);return r.stickiness=e.stickiness,r}if(!t.getRoot(e.root))throw new qt("model-position-fromjson-no-root",t,{rootName:e.root});return new ea(t.getRoot(e.root),e.path,e.stickiness)}}function ta(e,t){const r=t.getChild(t.offsetToIndex(e.offset));return r&&r.is("$text")&&r.startOffset<e.offset?r:null}function ra(e,t,r){return null!==r?null:t.getChild(t.offsetToIndex(e.offset))}function na(e,t,r){return null!==r?null:t.getChild(t.offsetToIndex(e.offset)-1)}class oa{constructor(e,t=null){this.start=ea._createAt(e),this.end=t?ea._createAt(t):ea._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Ji({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==pr(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const r=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return r&&n}containsItem(e){const t=ea._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}is(e){return"range"===e||"model:range"===e}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new oa(this.start,e.start)),this.containsPosition(e.end)&&t.push(new oa(e.end,this.end))):t.push(new oa(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,r=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(r=e.end),new oa(t,r)}return null}getJoined(e,t=!1){let r=this.isIntersecting(e);if(r||(r=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!r)return null;let n=this.start,o=this.end;return e.start.isBefore(n)&&(n=e.start),e.end.isAfter(o)&&(o=e.end),new oa(n,o)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,r=ea._createAt(this.start);let n=r.parent;for(;r.path.length>t+1;){const t=n.maxOffset-r.offset;0!==t&&e.push(new oa(r,r.getShiftedBy(t))),r.path=r.path.slice(0,-1),r.offset++,n=n.parent}for(;r.path.length<=this.end.path.length;){const t=this.end.path[r.path.length-1],n=t-r.offset;0!==n&&e.push(new oa(r,r.getShiftedBy(n))),r.offset=t,r.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Ji(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Ji(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new Ji(e);yield t.position;for(const e of t)yield e.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new oa(this.start,this.end)]}getTransformedByOperations(e){const t=[new oa(this.start,this.end)];for(const r of e)for(let e=0;e<t.length;e++){const n=t[e].getTransformedByOperation(r);t.splice(e,1,...n),e+=n.length-1}for(let e=0;e<t.length;e++){const r=t[e];for(let n=e+1;n<t.length;n++){const e=t[n];(r.containsRange(e)||e.containsRange(r)||r.isEqual(e))&&t.splice(n,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const r=e.sourcePosition,n=e.howMany,o=e.targetPosition;return this._getTransformedByMove(r,o,n,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let r=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(r=this.end.getShiftedBy(1)),t.root!=r.root&&(r=this.end.getShiftedBy(-1)),new oa(t,r)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new oa(this.start);let t=this.start._getTransformedByMergeOperation(e),r=this.end._getTransformedByMergeOperation(e);return t.root!=r.root&&(r=this.end.getShiftedBy(-1)),t.isAfter(r)?(e.sourcePosition.isBefore(e.targetPosition)?(t=ea._createAt(r),t.offset=0):(e.deletionPosition.isEqual(t)||(r=e.deletionPosition),t=e.targetPosition),new oa(t,r)):new oa(t,r)}_getTransformedByInsertion(e,t,r=!1){if(r&&this.containsPosition(e))return[new oa(this.start,e),new oa(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const r=new oa(this.start,this.end);return r.start=r.start._getTransformedByInsertion(e,t),r.end=r.end._getTransformedByInsertion(e,t),[r]}}_getTransformedByMove(e,t,r,n=!1){if(this.isCollapsed){const n=this.start._getTransformedByMove(e,t,r);return[new oa(n)]}const o=oa._createFromPositionAndShift(e,r),i=t._getTransformedByDeletion(e,r);if(this.containsPosition(t)&&!n&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const n=this.start._getTransformedByMove(e,t,r),o=this.end._getTransformedByMove(e,t,r);return[new oa(n,o)]}let a;const s=this.getDifference(o);let l=null;const c=this.getIntersection(o);if(1==s.length?l=new oa(s[0].start._getTransformedByDeletion(e,r),s[0].end._getTransformedByDeletion(e,r)):2==s.length&&(l=new oa(this.start,this.end._getTransformedByDeletion(e,r))),a=l?l._getTransformedByInsertion(i,r,null!==c||n):[],c){const e=new oa(c.start._getCombined(o.start,i),c.end._getCombined(o.start,i));2==a.length?a.splice(1,0,e):a.push(e)}return a}_getTransformedByDeletion(e,t){let r=this.start._getTransformedByDeletion(e,t),n=this.end._getTransformedByDeletion(e,t);return null==r&&null==n?null:(null==r&&(r=e),null==n&&(n=e),new oa(r,n))}static _createFromPositionAndShift(e,t){const r=e,n=e.getShiftedBy(t);return t>0?new this(r,n):new this(n,r)}static _createIn(e){return new this(ea._createAt(e,0),ea._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(ea._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new qt("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort((e,t)=>e.start.isAfter(t.start)?1:-1);const r=e.indexOf(t),n=new this(t.start,t.end);if(r>0)for(let t=r-1;e[t].end.isEqual(n.start);t++)n.start=ea._createAt(e[t].start);for(let t=r+1;t<e.length&&e[t].start.isEqual(n.end);t++)n.end=ea._createAt(e[t].end);return n}static fromJSON(e,t){return new this(ea.fromJSON(e.start,t),ea.fromJSON(e.end,t))}}class ia{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const r=this._modelToViewMapping.get(t.modelPosition.parent);t.viewPosition=this.findPositionIn(r,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const r=this.findMappedViewAncestor(t.viewPosition),n=this._viewToModelMapping.get(r),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,r);t.modelPosition=ea._createAt(n,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e){const t=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const t of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(t);this._modelToViewMapping.get(t)==e&&this._modelToViewMapping.delete(t)}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const r=this._markerNameToElements.get(t)||new Set;r.add(e);const n=this._elementToMarkerNames.get(e)||new Set;n.add(t),this._markerNameToElements.set(t,r),this._elementToMarkerNames.set(e,n)}unbindElementFromMarkerName(e,t){const r=this._markerNameToElements.get(t);r&&(r.delete(e),0==r.size&&this._markerNameToElements.delete(t));const n=this._elementToMarkerNames.get(e);n&&(n.delete(t),0==n.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new oa(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new En(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={isPhantom:!1}){const r={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",r),r.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const r=new Set;for(const e of t)if(e.is("attributeElement"))for(const t of e.getElementsWithSameId())r.add(t);else r.add(e);return r}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,r){if(r!=e)return this._toModelOffset(e.parent,e.index,r)+this._toModelOffset(e,t,e);if(e.is("$text"))return t;let n=0;for(let r=0;r<t;r++)n+=this.getModelLength(e.getChild(r));return n}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const r of e.getChildren())t+=this.getModelLength(r);return t}}findPositionIn(e,t){let r,n=0,o=0,i=0;if(e.is("$text"))return new Cn(e,t);for(;o<t;)r=e.getChild(i),n=this.getModelLength(r),o+=n,i++;return o==t?this._moveViewPositionToTextNode(new Cn(e,i)):this.findPositionIn(r,t-(o-n))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,r=e.nodeAfter;return t instanceof gr?new Cn(t,t.data.length):r instanceof gr?new Cn(r,0):e}}ir(ia,Xt);class aa{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=sa(t),e instanceof $i&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=sa(t),e instanceof $i&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=sa(t),e instanceof $i&&(e=this._getSymbolForTextProxy(e));const r=this._consumable.get(e);if(void 0===r)return null;const n=r.get(t);return void 0===n?null:n}revert(e,t){t=sa(t),e instanceof $i&&(e=this._getSymbolForTextProxy(e));const r=this.test(e,t);return!1===r?(this._consumable.get(e).set(t,!0),!0):!0!==r&&null}_getSymbolForTextProxy(e){let t=null;const r=this._textProxyRegistry.get(e.startOffset);if(r){const n=r.get(e.endOffset);n&&(t=n.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),t}_addSymbolForTextProxy(e,t,r){const n=Symbol("textProxySymbol");let o,i;return o=this._textProxyRegistry.get(e),o||(o=new Map,this._textProxyRegistry.set(e,o)),i=o.get(t),i||(i=new Map,o.set(t,i)),i.set(r,n),n}}function sa(e){const t=e.split(":");return t.length>1?t[0]+":"+t[1]:t[0]}class la{constructor(e){this.conversionApi=Object.assign({dispatcher:this},e),this._reconversionEventsMapping=new Map}convertChanges(e,t,r){for(const t of e.getMarkersToRemove())this.convertMarkerRemove(t.name,t.range,r);const n=this._mapChangesWithAutomaticReconversion(e);for(const e of n)"insert"===e.type?this.convertInsert(oa._createFromPositionAndShift(e.position,e.length),r):"remove"===e.type?this.convertRemove(e.position,e.length,e.name,r):"reconvert"===e.type?this.reconvertElement(e.element,r):this.convertAttribute(e.range,e.attributeKey,e.attributeOldValue,e.attributeNewValue,r);for(const e of this.conversionApi.mapper.flushUnboundMarkerNames()){const n=t.get(e).getRange();this.convertMarkerRemove(e,n,r),this.convertMarkerAdd(e,n,r)}for(const t of e.getMarkersToAdd())this.convertMarkerAdd(t.name,t.range,r)}convertInsert(e,t){this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(e);for(const t of Array.from(e).map(ua))this._convertInsertWithAttributes(t);this._clearConversionApi()}convertRemove(e,t,r,n){this.conversionApi.writer=n,this.fire("remove:"+r,{position:e,length:t},this.conversionApi),this._clearConversionApi()}convertAttribute(e,t,r,n,o){this.conversionApi.writer=o,this.conversionApi.consumable=this._createConsumableForRange(e,"attribute:"+t);for(const o of e){const e={item:o.item,range:oa._createFromPositionAndShift(o.previousPosition,o.length),attributeKey:t,attributeOldValue:r,attributeNewValue:n};this._testAndFire("attribute:"+t,e)}this._clearConversionApi()}reconvertElement(e,t){const r=oa._createOn(e);this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(r);const n=this.conversionApi.mapper,o=n.toViewElement(e);t.remove(o),this._convertInsertWithAttributes({item:e,range:r});const i=n.toViewElement(e);for(const r of oa._createIn(e)){const{item:e}=r,o=da(e,n);o?o.root!==i.root&&t.move(t.createRangeOn(o),n.toViewPosition(ea._createBefore(e))):this._convertInsertWithAttributes(ua(r))}n.unbindViewElement(o),this._clearConversionApi()}convertSelection(e,t,r){const n=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=r,this.conversionApi.consumable=this._createSelectionConsumable(e,n),this.fire("selection",{selection:e},this.conversionApi),e.isCollapsed){for(const t of n){const r=t.getRange();if(!ca(e.getFirstPosition(),t,this.conversionApi.mapper))continue;const n={item:e,markerName:t.name,markerRange:r};this.conversionApi.consumable.test(e,"addMarker:"+t.name)&&this.fire("addMarker:"+t.name,n,this.conversionApi)}for(const t of e.getAttributeKeys()){const r={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.conversionApi.consumable.test(e,"attribute:"+r.attributeKey)&&this.fire("attribute:"+r.attributeKey+":$text",r,this.conversionApi)}this._clearConversionApi()}}convertMarkerAdd(e,t,r){if(!t.root.document||"$graveyard"==t.root.rootName)return;this.conversionApi.writer=r;const n="addMarker:"+e,o=new aa;if(o.add(t,n),this.conversionApi.consumable=o,this.fire(n,{markerName:e,markerRange:t},this.conversionApi),o.test(t,n)){this.conversionApi.consumable=this._createConsumableForRange(t,n);for(const r of t.getItems()){if(!this.conversionApi.consumable.test(r,n))continue;const o={item:r,range:oa._createOn(r),markerName:e,markerRange:t};this.fire(n,o,this.conversionApi)}this._clearConversionApi()}}convertMarkerRemove(e,t,r){t.root.document&&"$graveyard"!=t.root.rootName&&(this.conversionApi.writer=r,this.fire("removeMarker:"+e,{markerName:e,markerRange:t},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(e,t){this._reconversionEventsMapping.set(t,e)}_createInsertConsumable(e){const t=new aa;for(const r of e){const e=r.item;t.add(e,"insert");for(const r of e.getAttributeKeys())t.add(e,"attribute:"+r)}return t}_createConsumableForRange(e,t){const r=new aa;for(const n of e.getItems())r.add(n,t);return r}_createSelectionConsumable(e,t){const r=new aa;r.add(e,"selection");for(const n of t)r.add(e,"addMarker:"+n.name);for(const t of e.getAttributeKeys())r.add(e,"attribute:"+t);return r}_testAndFire(e,t){this.conversionApi.consumable.test(t.item,e)&&this.fire(function(e,t){return`${e}:${t.item.name||"$text"}`}(e,t),t,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(e){this._testAndFire("insert",e);for(const t of e.item.getAttributeKeys())e.attributeKey=t,e.attributeOldValue=null,e.attributeNewValue=e.item.getAttribute(t),this._testAndFire("attribute:"+t,e)}_mapChangesWithAutomaticReconversion(e){const t=new Set,r=[];for(const n of e.getChanges()){const e=n.position||n.range.start,o=e.parent;if(ta(e,o)){r.push(n);continue}const i="attribute"===n.type?ra(e,o,null):o;if(i.is("$text")){r.push(n);continue}let a;if(a="attribute"===n.type?`attribute:${n.attributeKey}:${i.name}`:`${n.type}:${n.name}`,this._isReconvertTriggerEvent(a,i.name)){if(t.has(i))continue;t.add(i),r.push({type:"reconvert",element:i})}else r.push(n)}return r}_isReconvertTriggerEvent(e,t){return this._reconversionEventsMapping.get(e)===t}}function ca(e,t,r){const n=t.getRange(),o=Array.from(e.getAncestors());return o.shift(),o.reverse(),!o.some(e=>{if(n.containsItem(e))return!!r.toViewElement(e).getCustomProperty("addHighlight")})}function ua(e){return{item:e.item,range:oa._createFromPositionAndShift(e.previousPosition,e.length)}}function da(e,t){if(e.is("textProxy")){const r=t.toViewPosition(ea._createBefore(e)).parent;return r.is("$text")?r:null}return t.toViewElement(e)}ir(la,Xt);class ha{constructor(e,t,r){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,t,r)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let r=!1;for(const n of e._ranges)if(t.isEqual(n)){r=!0;break}if(!r)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new oa(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new oa(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new oa(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,t,r){if(null===e)this._setRanges([]);else if(e instanceof ha)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof oa)this._setRanges([e],!!t&&!!t.backward);else if(e instanceof ea)this._setRanges([new oa(e)]);else if(e instanceof Zi){const n=!!r&&!!r.backward;let o;if("in"==t)o=oa._createIn(e);else if("on"==t)o=oa._createOn(e);else{if(void 0===t)throw new qt("model-selection-setto-required-second-parameter",[this,e]);o=new oa(ea._createAt(e,t))}this._setRanges([o],n)}else{if(!or(e))throw new qt("model-selection-setto-not-selectable",[this,e]);this._setRanges(e,t&&!!t.backward)}}_setRanges(e,t=!1){const r=(e=Array.from(e)).some(t=>{if(!(t instanceof oa))throw new qt("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(e=>!e.isEqual(t))});if(e.length!==this._ranges.length||r){this._removeAllRanges();for(const t of e)this._pushRange(t);this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0})}}setFocus(e,t){if(null===this.anchor)throw new qt("model-selection-setfocus-no-ranges",[this,e]);const r=ea._createAt(e,t);if("same"==r.compareWith(this.focus))return;const n=this.anchor;this._ranges.length&&this._popRange(),"before"==r.compareWith(n)?(this._pushRange(new oa(r,n)),this._lastRangeBackward=!0):(this._pushRange(new oa(n,r)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(e){return"selection"===e||"model:selection"===e}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const r=ma(t.start,e);r&&ga(r,t)&&(yield r);for(const r of t.getWalker()){const n=r.item;"elementEnd"==r.type&&fa(n,e,t)&&(yield n)}const n=ma(t.end,e);n&&!t.end.isTouching(ea._createAt(n,0))&&ga(n,t)&&(yield n)}}containsEntireContent(e=this.anchor.root){const t=ea._createAt(e,0),r=ea._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&r.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new oa(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new qt("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function pa(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&e.parent)}function fa(e,t,r){return pa(e,t)&&ga(e,r)}function ma(e,t){const r=e.parent.root.document.model.schema,n=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const i=n.find(e=>!o&&(o=r.isLimit(e),!o&&pa(e,t)));return n.forEach(e=>t.add(e)),i}function ga(e,t){const r=function(e){const t=e.root.document.model.schema;let r=e.parent;for(;r;){if(t.isBlock(r))return r;r=r.parent}}(e);return!r||!t.containsRange(oa._createOn(r),!0)}ir(ha,Xt);class ba extends oa{constructor(e,t){super(e,t),va.call(this)}detach(){this.stopListening()}is(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e}toRange(){return new oa(this.start,this.end)}static fromRange(e){return new ba(e.start,e.end)}}function va(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&ya.call(this,r)},{priority:"low"})}function ya(e){const t=this.getTransformedByOperation(e),r=oa._createFromRanges(t),n=!r.isEqual(this),o=function(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(this,e);let i=null;if(n){"$graveyard"==r.root.rootName&&(i="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=r.start,this.end=r.end,this.fire("change:range",t,{deletionPosition:i})}else o&&this.fire("change:content",this.toRange(),{deletionPosition:i})}ir(ba,Xt);const _a="selection:";class wa{constructor(e){this._selection=new xa(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}is(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(e,t,r){this._selection.setTo(e,t,r)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return _a+e}static _isStoreAttributeKey(e){return e.startsWith(_a)}}ir(wa,Xt);class xa extends ha{constructor(e){super(),this.markers=new ar({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&"marker"!=r.type&&"rename"!=r.type&&"noop"!=r.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{for(const e of this.getRanges())if(!this._document._validateSelectionRange(e))throw new qt("document-selection-wrong-position",this,{range:e})}),this.listenTo(this._model.markers,"update",(e,t,r,n)=>{this._updateMarker(t,n)}),this.listenTo(this._document,"change",(e,t)=>{!function(e,t){const r=e.document.differ;for(const n of r.getChanges()){if("insert"!=n.type)continue;const r=n.position.parent;n.length===r.maxOffset&&e.enqueueChange(t,e=>{const t=Array.from(r.getAttributeKeys()).filter(e=>e.startsWith(_a));for(const n of t)e.removeAttribute(n,r)})}}(this._model,t)})}get isCollapsed(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,t,r){super.setTo(e,t,r),this._updateAttributes(!0),this._updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this._updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=Vt();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new qt("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=ba.fromRange(e);return t.on("change:range",(e,r,n)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=n.deletionPosition;const e=this._ranges.indexOf(t);this._ranges.splice(e,1),t.detach()}}),t}_updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const t of this._model.markers){const r=t.name.split(":",1)[0];if(!this._observedMarkers.has(r))continue;const n=t.getRange();for(const r of this.getRanges())n.containsRange(r,!r.isCollapsed)&&e.push(t)}const r=Array.from(this.markers);for(const r of e)this.markers.has(r)||(this.markers.add(r),t=!0);for(const r of Array.from(this.markers))e.includes(r)||(this.markers.remove(r),t=!0);t&&this.fire("change:marker",{oldMarkers:r,directChange:!1})}_updateMarker(e,t){const r=e.name.split(":",1)[0];if(!this._observedMarkers.has(r))return;let n=!1;const o=Array.from(this.markers),i=this.markers.has(e);if(t){let r=!1;for(const e of this.getRanges())if(t.containsRange(e,!e.isCollapsed)){r=!0;break}r&&!i?(this.markers.add(e),n=!0):!r&&i&&(this.markers.remove(e),n=!0)}else i&&(this.markers.remove(e),n=!0);n&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=vr(this._getSurroundingAttributes()),r=vr(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[e,t]of this._attributePriority)"low"==t&&(this._attrs.delete(e),this._attributePriority.delete(e));this._setAttributesTo(t);const n=[];for(const[e,t]of this.getAttributes())r.has(e)&&r.get(e)===t||n.push(e);for(const[e]of r)this.hasAttribute(e)||n.push(e);n.length>0&&this.fire("change:attribute",{attributeKeys:n,directChange:!1})}_setAttribute(e,t,r=!0){const n=r?"normal":"low";return("low"!=n||"normal"!=this._attributePriority.get(e))&&super.getAttribute(e)!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,n),!0)}_removeAttribute(e,t=!0){const r=t?"normal":"low";return!("low"==r&&"normal"==this._attributePriority.get(e)||(this._attributePriority.set(e,r),!super.hasAttribute(e)||(this._attrs.delete(e),0)))}_setAttributesTo(e){const t=new Set;for(const[t,r]of this.getAttributes())e.get(t)!==r&&this._removeAttribute(t,!1);for(const[r,n]of e)this._setAttribute(r,n,!1)&&t.add(r);return t}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(_a)){const r=t.substr(_a.length);yield[r,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;let r=null;if(this.isCollapsed){const n=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(r=ka(n)),r||(r=ka(o)),!this.isGravityOverridden&&!r){let e=n;for(;e&&!t.isInline(e)&&!r;)e=e.previousSibling,r=ka(e)}if(!r){let e=o;for(;e&&!t.isInline(e)&&!r;)e=e.nextSibling,r=ka(e)}r||(r=this._getStoredAttributes())}else{const e=this.getFirstRange();for(const n of e){if(n.item.is("element")&&t.isObject(n.item))break;if("text"==n.type){r=n.item.getAttributes();break}}}return r}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function ka(e){return e instanceof $i||e instanceof Yi?e.getAttributes():null}class Ca{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}const Ea=function(e){return Dt(e,5)};class Sa extends Ca{elementToElement(e){return this.add(function(e){return(e=Ea(e)).view=Pa(e.view,"container"),t=>{var r;if(t.on("insert:"+e.model,(r=e.view,(e,t,n)=>{const o=r(t.item,n);if(!o)return;if(!n.consumable.consume(t.item,"insert"))return;const i=n.mapper.toViewPosition(t.range.start);n.mapper.bindElements(t.item,o),n.writer.insert(i,o)}),{priority:e.converterPriority||"normal"}),e.triggerBy){if(e.triggerBy.attributes)for(const r of e.triggerBy.attributes)t._mapReconversionTriggerEvent(e.model,`attribute:${r}:${e.model}`);if(e.triggerBy.children)for(const r of e.triggerBy.children)t._mapReconversionTriggerEvent(e.model,"insert:"+r),t._mapReconversionTriggerEvent(e.model,"remove:"+r)}}}(e))}attributeToElement(e){return this.add(function(e){let t="attribute:"+((e=Ea(e)).model.key?e.model.key:e.model);if(e.model.name&&(t+=":"+e.model.name),e.model.values)for(const t of e.model.values)e.view[t]=Pa(e.view[t],"attribute");else e.view=Pa(e.view,"attribute");const r=Ia(e);return n=>{n.on(t,function(e){return(t,r,n)=>{const o=e(r.attributeOldValue,n),i=e(r.attributeNewValue,n);if(!o&&!i)return;if(!n.consumable.consume(r.item,t.name))return;const a=n.writer,s=a.document.selection;if(r.item instanceof ha||r.item instanceof wa)a.wrap(s.getFirstRange(),i);else{let e=n.mapper.toViewRange(r.range);null!==r.attributeOldValue&&o&&(e=a.unwrap(e,o)),null!==r.attributeNewValue&&i&&a.wrap(e,i)}}}(r),{priority:e.converterPriority||"normal"})}}(e))}attributeToAttribute(e){return this.add(function(e){let t="attribute:"+((e=Ea(e)).model.key?e.model.key:e.model);if(e.model.name&&(t+=":"+e.model.name),e.model.values)for(const t of e.model.values)e.view[t]=Oa(e.view[t]);else e.view=Oa(e.view);const r=Ia(e);return n=>{var o;n.on(t,(o=r,(e,t,r)=>{const n=o(t.attributeOldValue,r),i=o(t.attributeNewValue,r);if(!n&&!i)return;if(!r.consumable.consume(t.item,e.name))return;const a=r.mapper.toViewElement(t.item),s=r.writer;if(!a)throw new qt("conversion-attribute-to-attribute-on-text",[t,r]);if(null!==t.attributeOldValue&&n)if("class"==n.key){const e=lr(n.value);for(const t of e)s.removeClass(t,a)}else if("style"==n.key){const e=Object.keys(n.value);for(const t of e)s.removeStyle(t,a)}else s.removeAttribute(n.key,a);if(null!==t.attributeNewValue&&i)if("class"==i.key){const e=lr(i.value);for(const t of e)s.addClass(t,a)}else if("style"==i.key){const e=Object.keys(i.value);for(const t of e)s.setStyle(t,i.value[t],a)}else s.setAttribute(i.key,i.value,a)}),{priority:e.converterPriority||"normal"})}}(e))}markerToElement(e){return this.add(function(e){return(e=Ea(e)).view=Pa(e.view,"ui"),t=>{var r;t.on("addMarker:"+e.model,(r=e.view,(e,t,n)=>{t.isOpening=!0;const o=r(t,n);t.isOpening=!1;const i=r(t,n);if(!o||!i)return;const a=t.markerRange;if(a.isCollapsed&&!n.consumable.consume(a,e.name))return;for(const t of a)if(!n.consumable.consume(t.item,e.name))return;const s=n.mapper,l=n.writer;l.insert(s.toViewPosition(a.start),o),n.mapper.bindElementToMarker(o,t.markerName),a.isCollapsed||(l.insert(s.toViewPosition(a.end),i),n.mapper.bindElementToMarker(i,t.markerName)),e.stop()}),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,(e.view,(e,t,r)=>{const n=r.mapper.markerNameToElements(t.markerName);if(n){for(const e of n)r.mapper.unbindElementFromMarkerName(e,t.markerName),r.writer.clear(r.writer.createRangeOn(e),e);r.writer.clearClonedElementsGroup(t.markerName),e.stop()}}),{priority:e.converterPriority||"normal"})}}(e))}markerToHighlight(e){return this.add(function(e){return t=>{var r;t.on("addMarker:"+e.model,(r=e.view,(e,t,n)=>{if(!t.item)return;if(!(t.item instanceof ha||t.item instanceof wa||t.item.is("$textProxy")))return;const o=Ma(r,t,n);if(!o)return;if(!n.consumable.consume(t.item,e.name))return;const i=n.writer,a=Ta(i,o),s=i.document.selection;if(t.item instanceof ha||t.item instanceof wa)i.wrap(s.getFirstRange(),a,s);else{const e=n.mapper.toViewRange(t.range),r=i.wrap(e,a);for(const e of r.getItems())if(e.is("attributeElement")&&e.isSimilar(a)){n.mapper.bindElementToMarker(e,t.markerName);break}}}),{priority:e.converterPriority||"normal"}),t.on("addMarker:"+e.model,function(e){return(t,r,n)=>{if(!r.item)return;if(!(r.item instanceof Xi))return;const o=Ma(e,r,n);if(!o)return;if(!n.consumable.test(r.item,t.name))return;const i=n.mapper.toViewElement(r.item);if(i&&i.getCustomProperty("addHighlight")){n.consumable.consume(r.item,t.name);for(const e of oa._createIn(r.item))n.consumable.consume(e.item,t.name);i.getCustomProperty("addHighlight")(i,o,n.writer),n.mapper.bindElementToMarker(i,r.markerName)}}}(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,function(e){return(t,r,n)=>{if(r.markerRange.isCollapsed)return;const o=Ma(e,r,n);if(!o)return;const i=Ta(n.writer,o),a=n.mapper.markerNameToElements(r.markerName);if(a){for(const e of a)n.mapper.unbindElementFromMarkerName(e,r.markerName),e.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(e),i):e.getCustomProperty("removeHighlight")(e,o.id,n.writer);n.writer.clearClonedElementsGroup(r.markerName),t.stop()}}}(e.view),{priority:e.converterPriority||"normal"})}}(e))}markerToData(e){return this.add(function(e){const t=(e=Ea(e)).model;return e.view||(e.view=r=>({group:t,name:r.substr(e.model.length+1)})),r=>{var n;r.on("addMarker:"+t,(n=e.view,(e,t,r)=>{const o=n(t.markerName,r);if(!o)return;const i=t.markerRange;r.consumable.consume(i,e.name)&&(Aa(i,!1,r,t,o),Aa(i,!0,r,t,o),e.stop())}),{priority:e.converterPriority||"normal"}),r.on("removeMarker:"+t,function(e){return(t,r,n)=>{const o=e(r.markerName,n);if(!o)return;const i=n.mapper.markerNameToElements(r.markerName);if(i){for(const e of i)n.mapper.unbindElementFromMarkerName(e,r.markerName),e.is("containerElement")?(a(`data-${o.group}-start-before`,e),a(`data-${o.group}-start-after`,e),a(`data-${o.group}-end-before`,e),a(`data-${o.group}-end-after`,e)):n.writer.clear(n.writer.createRangeOn(e),e);n.writer.clearClonedElementsGroup(r.markerName),t.stop()}function a(e,t){if(t.hasAttribute(e)){const r=new Set(t.getAttribute(e).split(","));r.delete(o.name),0==r.size?n.writer.removeAttribute(e,t):n.writer.setAttribute(e,Array.from(r).join(","),t)}}}}(e.view),{priority:e.converterPriority||"normal"})}}(e))}}function Ta(e,t){const r=e.createAttributeElement("span",t.attributes);return t.classes&&r._addClass(t.classes),t.priority&&(r._priority=t.priority),r._id=t.id,r}function Aa(e,t,r,n,o){const i=t?e.start:e.end;if(r.schema.checkChild(i,"$text"))!function(e,t,r,n,o){const i=`${o.group}-${t?"start":"end"}`,a=o.name?{name:o.name}:null,s=r.writer.createUIElement(i,a);r.writer.insert(e,s),r.mapper.bindElementToMarker(s,n.markerName)}(r.mapper.toViewPosition(i),t,r,n,o);else{let e,a;t&&i.nodeAfter||!t&&!i.nodeBefore?(e=i.nodeAfter,a=!0):(e=i.nodeBefore,a=!1),function(e,t,r,n,o,i){const a=`data-${i.group}-${t?"start":"end"}-${r?"before":"after"}`,s=e.hasAttribute(a)?e.getAttribute(a).split(","):[];s.unshift(i.name),n.writer.setAttribute(a,s.join(","),e),n.mapper.bindElementToMarker(e,o.markerName)}(r.mapper.toViewElement(e),t,a,r,n,o)}}function Pa(e,t){return"function"==typeof e?e:(r,n)=>function(e,t,r){let n;"string"==typeof e&&(e={name:e});const o=t.writer,i=Object.assign({},e.attributes);if("container"==r)n=o.createContainerElement(e.name,i);else if("attribute"==r){const t={priority:e.priority||On.DEFAULT_PRIORITY};n=o.createAttributeElement(e.name,i,t)}else n=o.createUIElement(e.name,i);if(e.styles){const t=Object.keys(e.styles);for(const r of t)o.setStyle(r,e.styles[r],n)}if(e.classes){const t=e.classes;if("string"==typeof t)o.addClass(t,n);else for(const e of t)o.addClass(e,n)}return n}(e,n,t)}function Ia(e){return e.model.values?(t,r)=>{const n=e.view[t];return n?n(t,r):null}:e.view}function Oa(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Ma(e,t,r){const n="function"==typeof e?e(t,r):e;return n?(n.priority||(n.priority=10),n.id||(n.id=t.markerName),n):null}function Da(e){const{schema:t,document:r}=e.model;for(const n of r.getRootNames()){const o=r.getRoot(n);if(o.isEmpty&&!t.checkChild(o,"$text")&&t.checkChild(o,"paragraph"))return e.insertElement("paragraph",o),!0}return!1}function za(e,t,r){const n=r.createContext(e);return!!r.checkChild(n,"paragraph")&&!!r.checkChild(n.push("paragraph"),t)}function ja(e,t){const r=t.createElement("paragraph");return t.insert(r,e),t.createPositionAt(r,0)}class Ra extends Ca{elementToElement(e){return this.add(La(e))}elementToAttribute(e){return this.add(function(e){Fa(e=Ea(e));const t=Va(e,!1),r=Na(e.view),n=r?"element:"+r:"element";return r=>{r.on(n,t,{priority:e.converterPriority||"low"})}}(e))}attributeToAttribute(e){return this.add(function(e){let t=null;("string"==typeof(e=Ea(e)).view||e.view.key)&&(t=function(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key;let r;return r="class"==t||"style"==t?{["class"==t?"classes":"styles"]:e.view.value}:{attributes:{[t]:void 0===e.view.value?/[\s\S]*/:e.view.value}},e.view.name&&(r.name=e.view.name),e.view=r,t}(e)),Fa(e,t);const r=Va(e,!0);return t=>{t.on("element",r,{priority:e.converterPriority||"low"})}}(e))}elementToMarker(e){return Ht("upcast-helpers-element-to-marker-deprecated"),this.add(function(e){return function(e){const t=e.model;e.model=(e,r)=>{const n="string"==typeof t?t:t(e,r);return r.writer.createElement("$marker",{"data-name":n})}}(e=Ea(e)),La(e)}(e))}dataToMarker(e){return this.add(function(e){(e=Ea(e)).model||(e.model=t=>t?e.view+":"+t:e.view);const t=Ba(Ua(e,"start")),r=Ba(Ua(e,"end"));return n=>{n.on("element:"+e.view+"-start",t,{priority:e.converterPriority||"normal"}),n.on("element:"+e.view+"-end",r,{priority:e.converterPriority||"normal"});const o=Ut.get("low"),i=Ut.get("highest"),a=Ut.get(e.converterPriority)/i;n.on("element",function(e){return(t,r,n)=>{const o="data-"+e.view;function i(t,o){for(const i of o){const o=e.model(i,n),a=n.writer.createElement("$marker",{"data-name":o});n.writer.insert(a,t),r.modelCursor.isEqual(t)?r.modelCursor=r.modelCursor.getShiftedBy(1):r.modelCursor=r.modelCursor._getTransformedByInsertion(t,1),r.modelRange=r.modelRange._getTransformedByInsertion(t,1)[0]}}r.modelRange||(r=Object.assign(r,n.convertChildren(r.viewItem,r.modelCursor))),n.consumable.consume(r.viewItem,{attributes:o+"-end-after"})&&i(r.modelRange.end,r.viewItem.getAttribute(o+"-end-after").split(",")),n.consumable.consume(r.viewItem,{attributes:o+"-start-after"})&&i(r.modelRange.end,r.viewItem.getAttribute(o+"-start-after").split(",")),n.consumable.consume(r.viewItem,{attributes:o+"-end-before"})&&i(r.modelRange.start,r.viewItem.getAttribute(o+"-end-before").split(",")),n.consumable.consume(r.viewItem,{attributes:o+"-start-before"})&&i(r.modelRange.start,r.viewItem.getAttribute(o+"-start-before").split(","))}}(e),{priority:o+a})}}(e))}}function La(e){const t=Ba(e=Ea(e)),r=Na(e.view),n=r?"element:"+r:"element";return r=>{r.on(n,t,{priority:e.converterPriority||"normal"})}}function Na(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function Ba(e){const t=new yr(e.view);return(r,n,o)=>{const i=t.match(n.viewItem);if(!i)return;const a=i.match;if(a.name=!0,!o.consumable.test(n.viewItem,a))return;const s=function(e,t,r){return e instanceof Function?e(t,r):r.writer.createElement(e)}(e.model,n.viewItem,o);s&&o.safeInsert(s,n.modelCursor)&&(o.consumable.consume(n.viewItem,a),o.convertChildren(n.viewItem,s),o.updateConversionResult(s,n))}}function Fa(e,t=null){const r=null===t||(e=>e.getAttribute(t)),n="object"!=typeof e.model?e.model:e.model.key,o="object"!=typeof e.model||void 0===e.model.value?r:e.model.value;e.model={key:n,value:o}}function Va(e,t){const r=new yr(e.view);return(n,o,i)=>{const a=r.match(o.viewItem);if(!a)return;const s=e.model.key,l="function"==typeof e.model.value?e.model.value(o.viewItem,i):e.model.value;null!==l&&(function(e,t){const r="function"==typeof e?e(t):e;return!("object"==typeof r&&!Na(r)||r.classes||r.attributes||r.styles)}(e.view,o.viewItem)?a.match.name=!0:delete a.match.name,i.consumable.test(o.viewItem,a.match)&&(o.modelRange||(o=Object.assign(o,i.convertChildren(o.viewItem,o.modelCursor))),function(e,t,r,n){let o=!1;for(const i of Array.from(e.getItems({shallow:r})))n.schema.checkAttribute(i,t.key)&&(n.writer.setAttribute(t.key,t.value,i),o=!0);return o}(o.modelRange,{key:s,value:l},t,i)&&i.consumable.consume(o.viewItem,a.match)))}}function Ua(e,t){const r={};return r.view=e.view+"-"+t,r.model=(t,r)=>{const n=t.getAttribute("name"),o=e.model(n,r);return r.writer.createElement("$marker",{"data-name":o})},r}class qa{constructor(e,t){this.model=e,this.view=new Gi(t),this.mapper=new ia,this.downcastDispatcher=new la({mapper:this.mapper,schema:e.schema});const r=this.model.document,n=r.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(r,"change",()=>{this.view.change(e=>{this.downcastDispatcher.convertChanges(r.differ,o,e),this.downcastDispatcher.convertSelection(n,o,e)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(e,t){return(r,n)=>{const o=n.newSelection,i=[];for(const e of o.getRanges())i.push(t.toModelRange(e));const a=e.createSelection(i,{backward:o.isBackward});a.isEqual(e.document.selection)||e.change(e=>{e.setSelection(a)})}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",(e,t,r)=>{if(!r.consumable.consume(t.item,"insert"))return;const n=r.writer,o=r.mapper.toViewPosition(t.range.start),i=n.createText(t.item.data);n.insert(o,i)},{priority:"lowest"}),this.downcastDispatcher.on("remove",(e,t,r)=>{const n=r.mapper.toViewPosition(t.position),o=t.position.getShiftedBy(t.length),i=r.mapper.toViewPosition(o,{isPhantom:!0}),a=r.writer.createRange(n,i),s=r.writer.remove(a.getTrimmed());for(const e of r.writer.createRangeIn(s).getItems())r.mapper.unbindViewElement(e)},{priority:"low"}),this.downcastDispatcher.on("selection",(e,t,r)=>{const n=r.writer,o=n.document.selection;for(const e of o.getRanges())e.isCollapsed&&e.end.parent.isAttached()&&r.writer.mergeAttributes(e.start);n.setSelection(null)},{priority:"low"}),this.downcastDispatcher.on("selection",(e,t,r)=>{const n=t.selection;if(n.isCollapsed)return;if(!r.consumable.consume(n,"selection"))return;const o=[];for(const e of n.getRanges()){const t=r.mapper.toViewRange(e);o.push(t)}r.writer.setSelection(o,{backward:n.isBackward})},{priority:"low"}),this.downcastDispatcher.on("selection",(e,t,r)=>{const n=t.selection;if(!n.isCollapsed)return;if(!r.consumable.consume(n,"selection"))return;const o=r.writer,i=n.getFirstPosition(),a=r.mapper.toViewPosition(i),s=o.breakAttributes(a);o.setSelection(s)},{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(e=>{if("$graveyard"==e.rootName)return null;const t=new xn(this.view.document,e.name);return t.rootName=e.rootName,this.mapper.bindElements(e,t),t})}destroy(){this.view.destroy(),this.stopListening()}}ir(qa,fn);class Ha{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const r=this.get(e);if(!r)throw new qt("commandcollection-command-not-found",this,{commandName:e});return r.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}class Wa{constructor(){this._consumables=new Map}add(e,t){let r;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?r=this._consumables.get(e):(r=new Ga(e),this._consumables.set(e,r)),r.add(t))}test(e,t){const r=this._consumables.get(e);return void 0===r?null:e.is("$text")||e.is("documentFragment")?r:r.test(t)}consume(e,t){return!!this.test(e,t)&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0)}revert(e,t){const r=this._consumables.get(e);void 0!==r&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):r.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},r=e.getAttributeKeys();for(const e of r)"style"!=e&&"class"!=e&&t.attributes.push(e);const n=e.getClassNames();for(const e of n)t.classes.push(e);const o=e.getStyleNames();for(const e of o)t.styles.push(e);return t}static createFrom(e,t){if(t||(t=new Wa(e)),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,Wa.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const r of e.getChildren())t=Wa.createFrom(r,t);return t}}class Ga{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t in this._consumables)if(t in e){const r=this._test(t,e[t]);if(!0!==r)return r}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t in this._consumables)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._revert(t,e[t])}_add(e,t){const r=de(t)?t:[t],n=this._consumables[e];for(const t of r){if("attributes"===e&&("class"===t||"style"===t))throw new qt("viewconsumable-invalid-attribute",this);if(n.set(t,!0),"styles"===e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(t))n.set(e,!0)}}_test(e,t){const r=de(t)?t:[t],n=this._consumables[e];for(const t of r)if("attributes"!==e||"class"!==t&&"style"!==t){const e=n.get(t);if(void 0===e)return null;if(!e)return!1}else{const e="class"==t?"classes":"styles",r=this._test(e,[...this._consumables[e].keys()]);if(!0!==r)return r}return!0}_consume(e,t){const r=de(t)?t:[t],n=this._consumables[e];for(const t of r)if("attributes"!==e||"class"!==t&&"style"!==t){if(n.set(t,!1),"styles"==e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(t))n.set(e,!1)}else{const e="class"==t?"classes":"styles";this._consume(e,[...this._consumables[e].keys()])}}_revert(e,t){const r=de(t)?t:[t],n=this._consumables[e];for(const t of r)if("attributes"!==e||"class"!==t&&"style"!==t)!1===n.get(t)&&n.set(t,!0);else{const e="class"==t?"classes":"styles";this._revert(e,[...this._consumables[e].keys()])}}}class Za{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new Ya(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new Ya(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new qt("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new qt("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:e.is&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!(!t||!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}isSelectable(e){const t=this.getDefinition(e);return!(!t||!t.isSelectable&&!t.isObject)}isContent(e){const t=this.getDefinition(e);return!(!t||!t.isContent&&!t.isObject)}checkChild(e,t){return!!t&&this._checkContextMatch(t,e)}checkAttribute(e,t){const r=this.getDefinition(e.last);return!!r&&r.allowAttributes.includes(t)}checkMerge(e,t=null){if(e instanceof ea){const t=e.nodeBefore,r=e.nodeAfter;if(!(t instanceof Xi))throw new qt("schema-check-merge-no-element-before",this);if(!(r instanceof Xi))throw new qt("schema-check-merge-no-element-after",this);return this.checkMerge(t,r)}for(const r of t.getChildren())if(!this.checkChild(e,r))return!1;return!0}addChildCheck(e){this.on("checkChild",(t,[r,n])=>{if(!n)return;const o=e(r,n);"boolean"==typeof o&&(t.stop(),t.return=o)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(t,[r,n])=>{const o=e(r,n);"boolean"==typeof o&&(t.stop(),t.return=o)},{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;for(t=e instanceof ea?e.parent:(e instanceof oa?[e]:Array.from(e.getRanges())).reduce((e,t)=>{const r=t.getCommonAncestor();return e?e.getCommonAncestor(r,{includeSelf:!0}):r},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const r=[...e.getFirstPosition().getAncestors(),new Yi("",e.getAttributes())];return this.checkAttribute(r,t)}{const r=e.getRanges();for(const e of r)for(const r of e)if(this.checkAttribute(r.item,t))return!0}return!1}*getValidRanges(e,t){e=function*(e){for(const t of e)yield*t.getMinimalFlatRanges()}(e);for(const r of e)yield*this._getValidRangesForRange(r,t)}getNearestSelectionRange(e,t="both"){if(this.checkChild(e,"$text"))return new oa(e);let r,n;const o=e.getAncestors().reverse().find(e=>this.isLimit(e))||e.root;"both"!=t&&"backward"!=t||(r=new Ji({boundaries:oa._createIn(o),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(n=new Ji({boundaries:oa._createIn(o),startPosition:e}));for(const e of function*(e,t){let r=!1;for(;!r;){if(r=!0,e){const t=e.next();t.done||(r=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(r=!1,yield{walker:t,value:e.value})}}}(r,n)){const t=e.walker==r?"elementEnd":"elementStart",n=e.value;if(n.type==t&&this.isObject(n.item))return oa._createOn(n.item);if(this.checkChild(n.nextPosition,"$text"))return new oa(n.nextPosition)}return null}findAllowedParent(e,t){let r=e.parent;for(;r;){if(this.checkChild(r,t))return r;if(this.isLimit(r))return null;r=r.parent}return null}removeDisallowedAttributes(e,t){for(const r of e)if(r.is("$text"))is(this,r,t);else{const e=oa._createIn(r).getPositions();for(const r of e)is(this,r.nodeBefore||r.parent,t)}}createContext(e){return new Ya(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,r=Object.keys(t);for(const n of r)e[n]=$a(t[n],n);for(const t of r)Ka(e,t);for(const t of r)Xa(e,t);for(const t of r)Ja(e,t),Qa(e,t);for(const t of r)es(e,t),ts(e,t);this._compiledDefinitions=e}_checkContextMatch(e,t,r=t.length-1){const n=t.getItem(r);if(e.allowIn.includes(n.name)){if(0==r)return!0;{const e=this.getDefinition(n);return this._checkContextMatch(e,t,r-1)}}return!1}*_getValidRangesForRange(e,t){let r=e.start,n=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(oa._createIn(o),t)),this.checkAttribute(o,t)||(r.isEqual(n)||(yield new oa(r,n)),r=ea._createAfter(o)),n=ea._createAfter(o);r.isEqual(n)||(yield new oa(r,n))}}ir(Za,fn);class Ya{constructor(e){if(e instanceof Ya)return e;"string"==typeof e?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),e[0]&&"string"!=typeof e[0]&&e[0].is("documentFragment")&&e.shift(),this._items=e.map(os)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new Ya([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function $a(e,t){const r={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],inheritTypesFrom:[]};return function(e,t){for(const r of e){const e=Object.keys(r).filter(e=>e.startsWith("is"));for(const n of e)t[n]=r[n]}}(e,r),rs(e,r,"allowIn"),rs(e,r,"allowContentOf"),rs(e,r,"allowWhere"),rs(e,r,"allowAttributes"),rs(e,r,"allowAttributesOf"),rs(e,r,"inheritTypesFrom"),function(e,t){for(const r of e){const e=r.inheritAllFrom;e&&(t.allowContentOf.push(e),t.allowWhere.push(e),t.allowAttributesOf.push(e),t.inheritTypesFrom.push(e))}}(e,r),r}function Ka(e,t){for(const r of e[t].allowContentOf)e[r]&&ns(e,r).forEach(e=>{e.allowIn.push(t)});delete e[t].allowContentOf}function Xa(e,t){for(const r of e[t].allowWhere){const n=e[r];if(n){const r=n.allowIn;e[t].allowIn.push(...r)}}delete e[t].allowWhere}function Ja(e,t){for(const r of e[t].allowAttributesOf){const n=e[r];if(n){const r=n.allowAttributes;e[t].allowAttributes.push(...r)}}delete e[t].allowAttributesOf}function Qa(e,t){const r=e[t];for(const t of r.inheritTypesFrom){const n=e[t];if(n){const e=Object.keys(n).filter(e=>e.startsWith("is"));for(const t of e)t in r||(r[t]=n[t])}}delete r.inheritTypesFrom}function es(e,t){const r=e[t],n=r.allowIn.filter(t=>e[t]);r.allowIn=Array.from(new Set(n))}function ts(e,t){const r=e[t];r.allowAttributes=Array.from(new Set(r.allowAttributes))}function rs(e,t,r){for(const n of e)"string"==typeof n[r]?t[r].push(n[r]):Array.isArray(n[r])&&t[r].push(...n[r])}function ns(e,t){const r=e[t];return(n=e,Object.keys(n).map(e=>n[e])).filter(e=>e.allowIn.includes(r.name));var n}function os(e){return"string"==typeof e?{name:e,*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute:t=>e.getAttribute(t)}}function is(e,t,r){for(const n of t.getAttributeKeys())e.checkAttribute(t,n)||r.removeAttribute(n,t)}class as{constructor(e={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,t,r=["$root"]){this.fire("viewCleanup",e),this._modelCursor=function(e,t){let r;for(const n of new Ya(e)){const e={};for(const t of n.getAttributeKeys())e[t]=n.getAttribute(t);const o=t.createElement(n.name,e);r&&t.append(o,r),r=ea._createAt(o,0)}return r}(r,t),this.conversionApi.writer=t,this.conversionApi.consumable=Wa.createFrom(e),this.conversionApi.store={};const{modelRange:n}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(n){this._removeEmptyElements();for(const e of Array.from(this._modelCursor.parent.getChildren()))t.append(e,o);o.markers=function(e,t){const r=new Set,n=new Map,o=oa._createIn(e).getItems();for(const e of o)"$marker"==e.name&&r.add(e);for(const e of r){const r=e.getAttribute("data-name"),o=t.createPositionBefore(e);n.has(r)?n.get(r).end=o.clone():n.set(r,new oa(o.clone())),t.remove(e)}return n}(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const r=Object.assign({viewItem:e,modelCursor:t,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,r,this.conversionApi):e.is("$text")?this.fire("text",r,this.conversionApi):this.fire("documentFragment",r,this.conversionApi),r.modelRange&&!(r.modelRange instanceof oa))throw new qt("view-conversion-dispatcher-incorrect-result",this);return{modelRange:r.modelRange,modelCursor:r.modelCursor}}_convertChildren(e,t){let r=t.is("position")?t:ea._createAt(t,0);const n=new oa(r);for(const t of Array.from(e.getChildren())){const e=this._convertItem(t,r);e.modelRange instanceof oa&&(n.end=e.modelRange.end,r=e.modelCursor)}return{modelRange:n,modelCursor:r}}_safeInsert(e,t){const r=this._splitToAllowedParent(e,t);return!!r&&(this.conversionApi.writer.insert(e,r.position),!0)}_updateConversionResult(e,t){const r=this._getSplitParts(e),n=this.conversionApi.writer;t.modelRange||(t.modelRange=n.createRange(n.createPositionBefore(e),n.createPositionAfter(r[r.length-1])));const o=this._cursorParents.get(e);t.modelCursor=o?n.createPositionAt(o,0):t.modelRange.end}_splitToAllowedParent(e,t){const{schema:r,writer:n}=this.conversionApi;let o=r.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return za(t,e,r)?{position:ja(t,n)}:null;const i=this.conversionApi.writer.split(t,o),a=[];for(const e of i.range.getWalker())if("elementEnd"==e.type)a.push(e.item);else{const t=a.pop(),r=e.item;this._registerSplitPair(t,r)}const s=i.range.end.parent;return this._cursorParents.set(e,s),{position:i.position,cursorParent:s}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const r=this._splitParts.get(e);this._splitParts.set(t,r),r.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}ir(as,Xt);class ss{getHtml(e){const t=document.implementation.createHTMLDocument("").createElement("div");return t.appendChild(e),t.innerHTML}}class ls{constructor(e){this._domParser=new DOMParser,this._domConverter=new Lo(e,{blockFillerMode:"nbsp"}),this._htmlWriter=new ss}toData(e){const t=this._domConverter.viewToDom(e,document);return this._htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this._domConverter.domToView(t)}registerRawContentMatcher(e){this._domConverter.registerRawContentMatcher(e)}_toDom(e){const t=this._domParser.parseFromString(e,"text/html"),r=t.createDocumentFragment(),n=t.body.childNodes;for(;n.length>0;)r.appendChild(n[0]);return r}}class cs{constructor(e,t){this.model=e,this.mapper=new ia,this.downcastDispatcher=new la({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",(e,t,r)=>{if(!r.consumable.consume(t.item,"insert"))return;const n=r.writer,o=r.mapper.toViewPosition(t.range.start),i=n.createText(t.item.data);n.insert(o,i)},{priority:"lowest"}),this.upcastDispatcher=new as({schema:e.schema}),this.viewDocument=new In(t),this.stylesProcessor=t,this.htmlProcessor=new ls(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new no(this.viewDocument),this.upcastDispatcher.on("text",(e,t,{schema:r,consumable:n,writer:o})=>{let i=t.modelCursor;if(!n.test(t.viewItem))return;if(!r.checkChild(i,"$text")){if(!za(i,"$text",r))return;i=ja(i,o)}n.consume(t.viewItem);const a=o.createText(t.viewItem.data);o.insert(a,i),t.modelRange=o.createRange(i,i.getShiftedBy(a.offsetSize)),t.modelCursor=t.modelRange.end},{priority:"lowest"}),this.upcastDispatcher.on("element",(e,t,r)=>{if(!t.modelRange&&r.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:n}=r.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=n}},{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",(e,t,r)=>{if(!t.modelRange&&r.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:n}=r.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=n}},{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange("transparent",Da)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:r="empty"}=e;if(!this._checkIfRootsExists([t]))throw new qt("datacontroller-get-non-existent-root",this);const n=this.model.document.getRoot(t);return"empty"!==r||this.model.hasContent(n,{ignoreWhitespaces:!0})?this.stringify(n,e):""}stringify(e,t){const r=this.toView(e,t);return this.processor.toData(r)}toView(e,t){const r=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();const o=oa._createIn(e),i=new ro(r);if(this.mapper.bindElements(e,i),this.downcastDispatcher.conversionApi.options=t,this.downcastDispatcher.convertInsert(o,n),!e.is("documentFragment")){const t=function(e){const t=[],r=e.root.document;if(!r)return[];const n=oa._createIn(e);for(const e of r.model.markers){const r=n.getIntersection(e.getRange());r&&t.push([e.name,r])}return t}(e);for(const[e,r]of t)this.downcastDispatcher.convertMarkerAdd(e,r,n)}return delete this.downcastDispatcher.conversionApi.options,i}init(e){if(this.model.document.version)throw new qt("datacontroller-init-document-not-empty",this);let t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new qt("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",e=>{for(const r of Object.keys(t)){const n=this.model.document.getRoot(r);e.insert(this.parse(t[r],n),n,0)}}),Promise.resolve()}set(e){let t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new qt("datacontroller-set-non-existent-root",this);this.model.enqueueChange("transparent",e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const r of Object.keys(t)){const n=this.model.document.getRoot(r);e.remove(e.createRangeIn(n)),e.insert(this.parse(t[r],n),n,0)}})}parse(e,t="$root"){const r=this.processor.toView(e);return this.toModel(r,t)}toModel(e,t="$root"){return this.model.change(r=>this.upcastDispatcher.convert(e,r,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRootNames().includes(t))return!1;return!0}}ir(cs,fn);class us{constructor(e,t){this._helpers=new Map,this._downcast=lr(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=lr(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const r=this._downcast.includes(t);if(!this._upcast.includes(t)&&!r)throw new qt("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:r})}for(e){if(!this._helpers.has(e))throw new qt("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:r}of ds(e))this.for("upcast").elementToElement({model:t,view:r,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:r}of ds(e))this.for("upcast").elementToAttribute({view:r,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:r}of ds(e))this.for("upcast").attributeToAttribute({view:r,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:r}){if(this._helpers.has(e))throw new qt("conversion-group-exists",this);const n=r?new Sa(t):new Ra(t);this._helpers.set(e,n)}}function*ds(e){if(e.model.values)for(const t of e.model.values){const r={key:e.model.key,value:t},n=e.view[t],o=e.upcastAlso?e.upcastAlso[t]:void 0;yield*hs(r,n,o)}else yield*hs(e.model,e.view,e.upcastAlso)}function*hs(e,t,r){if(yield{model:e,view:t},r)for(const t of lr(r))yield{model:e,view:t}}class ps{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}class fs{constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}class ms{constructor(e){this.markers=new Map,this._children=new Ki,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"model:documentFragment"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const r of e)t=t.getChild(t.offsetToIndex(r));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const r of e)r.name?t.push(Xi.fromJSON(r)):t.push(Yi.fromJSON(r));return new ms(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const r=function(e){return"string"==typeof e?[new Yi(e)]:(or(e)||(e=[e]),Array.from(e).map(e=>"string"==typeof e?new Yi(e):e instanceof $i?new Yi(e.data,e.getAttributes()):e))}(t);for(const e of r)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,r)}_removeChildren(e,t=1){const r=this._children._removeNodes(e,t);for(const e of r)e.parent=null;return r}}function gs(e,t){const r=(t=ys(t)).reduce((e,t)=>e+t.offsetSize,0),n=e.parent;ws(e);const o=e.index;return n._insertChild(o,t),_s(n,o+t.length),_s(n,o),new oa(e,e.getShiftedBy(r))}function bs(e){if(!e.isFlat)throw new qt("operation-utils-remove-range-not-flat",this);const t=e.start.parent;ws(e.start),ws(e.end);const r=t._removeChildren(e.start.index,e.end.index-e.start.index);return _s(t,e.start.index),r}function vs(e,t){if(!e.isFlat)throw new qt("operation-utils-move-range-not-flat",this);const r=bs(e);return gs(t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),r)}function ys(e){const t=[];e instanceof Array||(e=[e]);for(let r=0;r<e.length;r++)if("string"==typeof e[r])t.push(new Yi(e[r]));else if(e[r]instanceof $i)t.push(new Yi(e[r].data,e[r].getAttributes()));else if(e[r]instanceof ms||e[r]instanceof Ki)for(const n of e[r])t.push(n);else e[r]instanceof Zi&&t.push(e[r]);for(let e=1;e<t.length;e++){const r=t[e],n=t[e-1];r instanceof Yi&&n instanceof Yi&&xs(r,n)&&(t.splice(e-1,2,new Yi(n.data+r.data,n.getAttributes())),e--)}return t}function _s(e,t){const r=e.getChild(t-1),n=e.getChild(t);if(r&&n&&r.is("$text")&&n.is("$text")&&xs(r,n)){const o=new Yi(r.data+n.data,r.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,o)}}function ws(e){const t=e.textNode,r=e.parent;if(t){const n=e.offset-t.startOffset,o=t.index;r._removeChildren(o,1);const i=new Yi(t.data.substr(0,n),t.getAttributes()),a=new Yi(t.data.substr(n),t.getAttributes());r._insertChild(o,[i,a])}}function xs(e,t){const r=e.getAttributes(),n=t.getAttributes();for(const e of r){if(e[1]!==t.getAttribute(e[0]))return!1;n.next()}return n.next().done}const ks=function(e,t){return si(e,t)};class Cs extends fs{constructor(e,t,r,n,o){super(o),this.range=e.clone(),this.key=t,this.oldValue=void 0===r?null:r,this.newValue=void 0===n?null:n}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new Cs(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Cs(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new qt("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!ks(e.getAttribute(this.key),this.oldValue))throw new qt("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new qt("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){ks(this.oldValue,this.newValue)||function(e,t,r){ws(e.start),ws(e.end);for(const n of e.getItems({shallow:!0})){const e=n.is("$textProxy")?n.textNode:n;null!==r?e._setAttribute(t,r):e._removeAttribute(t),_s(e.parent,e.index)}_s(e.end.parent,e.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new Cs(oa.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Es extends fs{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new qt("detach-operation-on-document-node",this)}_execute(){bs(oa._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Ss extends fs{constructor(e,t,r,n){super(n),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=r.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,r=this.sourcePosition.offset,n=this.targetPosition.offset;if(r+this.howMany>e.maxOffset)throw new qt("move-operation-nodes-do-not-exist",this);if(e===t&&r<n&&n<r+this.howMany)throw new qt("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==pr(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=r&&this.targetPosition.path[e]<r+this.howMany)throw new qt("move-operation-node-into-itself",this)}}_execute(){vs(oa._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const r=ea.fromJSON(e.sourcePosition,t),n=ea.fromJSON(e.targetPosition,t);return new this(r,e.howMany,n,e.baseVersion)}}class Ts extends fs{constructor(e,t,r){super(r),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Ki(ys(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new Ki([...this.nodes].map(e=>e._clone(!0))),t=new Ts(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new ea(e,[0]);return new Ss(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new qt("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Ki([...e].map(e=>e._clone(!0))),gs(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const r=[];for(const t of e.nodes)t.name?r.push(Xi.fromJSON(t)):r.push(Yi.fromJSON(t));const n=new Ts(ea.fromJSON(e.position,t),r,e.baseVersion);return n.shouldReceiveAttributes=e.shouldReceiveAttributes,n}}class As extends fs{constructor(e,t,r,n,o,i){super(i),this.name=e,this.oldRange=t?t.clone():null,this.newRange=r?r.clone():null,this.affectsData=o,this._markers=n}get type(){return"marker"}clone(){return new As(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new As(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new As(e.name,e.oldRange?oa.fromJSON(e.oldRange,t):null,e.newRange?oa.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}class Ps extends fs{constructor(e,t,r,n){super(n),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=r}get type(){return"rename"}clone(){return new Ps(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Ps(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof Xi))throw new qt("rename-operation-wrong-position",this);if(e.name!==this.oldName)throw new qt("rename-operation-wrong-name",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new Ps(ea.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}class Is extends fs{constructor(e,t,r,n,o){super(o),this.root=e,this.key=t,this.oldValue=r,this.newValue=n}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new Is(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Is(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new qt("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new qt("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new qt("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new qt("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Is(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Os extends fs{constructor(e,t,r,n,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=r.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=n.clone()}get type(){return"merge"}get deletionPosition(){return new ea(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new oa(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),r=new ea(this.sourcePosition.root,t)._getTransformedByMergeOperation(this),n=new Ms(e,this.howMany,this.graveyardPosition,this.baseVersion+1);return n.insertionPosition=r,n}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new qt("merge-operation-source-position-invalid",this);if(!t.parent)throw new qt("merge-operation-target-position-invalid",this);if(this.howMany!=e.maxOffset)throw new qt("merge-operation-how-many-invalid",this)}_execute(){const e=this.sourcePosition.parent;vs(oa._createIn(e),this.targetPosition),vs(oa._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const r=ea.fromJSON(e.sourcePosition,t),n=ea.fromJSON(e.targetPosition,t),o=ea.fromJSON(e.graveyardPosition,t);return new this(r,e.howMany,n,o,e.baseVersion)}}class Ms extends fs{constructor(e,t,r,n){super(n),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=Ms.getInsertionPosition(e),this.insertionPosition.stickiness="toNone",this.graveyardPosition=r?r.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new ea(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new oa(this.splitPosition,e)}clone(){const e=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return e.insertionPosition=this.insertionPosition,e}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new ea(e,[0]);return new Os(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new qt("split-operation-position-invalid",this);if(!e.parent)throw new qt("split-operation-split-in-root",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new qt("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new qt("split-operation-graveyard-position-invalid",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)vs(oa._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();gs(this.insertionPosition,t)}vs(new oa(ea._createAt(e,this.splitPosition.offset),ea._createAt(e,e.maxOffset)),this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new ea(e.root,t)}static fromJSON(e,t){const r=ea.fromJSON(e.splitPosition,t),n=ea.fromJSON(e.insertionPosition,t),o=e.graveyardPosition?ea.fromJSON(e.graveyardPosition,t):null,i=new this(r,e.howMany,o,e.baseVersion);return i.insertionPosition=n,i}}class Ds extends Xi{constructor(e,t,r="main"){super(t),this._document=e,this.rootName=r}get document(){return this._document}is(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e}toJSON(){return this.rootName}}class zs{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new Yi(e,t)}createElement(e,t){return new Xi(e,t)}createDocumentFragment(){return new ms}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,r=0){if(this._assertWriterUsedCorrectly(),e instanceof Yi&&""==e.data)return;const n=ea._createAt(t,r);if(e.parent){if(Bs(e.root,n.root))return void this.move(oa._createOn(e),n);if(e.root.document)throw new qt("model-writer-insert-forbidden-move",this);this.remove(e)}const o=n.root.document?n.root.document.version:null,i=new Ts(n,e,o);if(e instanceof Yi&&(i.shouldReceiveAttributes=!0),this.batch.addOperation(i),this.model.applyOperation(i),e instanceof ms)for(const[t,r]of e.markers){const e=ea._createAt(r.root,0),o={range:new oa(r.start._getCombined(e,n),r.end._getCombined(e,n)),usingOperation:!0,affectsData:!0};this.model.markers.has(t)?this.updateMarker(t,o):this.addMarker(t,o)}}insertText(e,t,r,n){t instanceof ms||t instanceof Xi||t instanceof ea?this.insert(this.createText(e),t,r):this.insert(this.createText(e,t),r,n)}insertElement(e,t,r,n){t instanceof ms||t instanceof Xi||t instanceof ea?this.insert(this.createElement(e),t,r):this.insert(this.createElement(e,t),r,n)}append(e,t){this.insert(e,t,"end")}appendText(e,t,r){t instanceof ms||t instanceof Xi?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),r,"end")}appendElement(e,t,r){t instanceof ms||t instanceof Xi?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),r,"end")}setAttribute(e,t,r){if(this._assertWriterUsedCorrectly(),r instanceof oa){const n=r.getMinimalFlatRanges();for(const r of n)js(this,e,t,r)}else Rs(this,e,t,r)}setAttributes(e,t){for(const[r,n]of vr(e))this.setAttribute(r,n,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof oa){const r=t.getMinimalFlatRanges();for(const t of r)js(this,e,null,t)}else Rs(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof oa)for(const r of e.getItems())t(r);else t(e)}move(e,t,r){if(this._assertWriterUsedCorrectly(),!(e instanceof oa))throw new qt("writer-move-invalid-range",this);if(!e.isFlat)throw new qt("writer-move-range-not-flat",this);const n=ea._createAt(t,r);if(n.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!Bs(e.root,n.root))throw new qt("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,i=new Ss(e.start,e.end.offset-e.start.offset,n,o);this.batch.addOperation(i),this.model.applyOperation(i)}remove(e){this._assertWriterUsedCorrectly();const t=(e instanceof oa?e:oa._createOn(e)).getMinimalFlatRanges().reverse();for(const e of t)this._addOperationForAffectedMarkers("move",e),Ns(e.start,e.end.offset-e.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,r=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Xi))throw new qt("writer-merge-no-element-before",this);if(!(r instanceof Xi))throw new qt("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,r){return this.model.createPositionFromPath(e,t,r)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,t,r){return this.model.createSelection(e,t,r)}_mergeDetached(e){const t=e.nodeBefore,r=e.nodeAfter;this.move(oa._createIn(r),ea._createAt(t,"end")),this.remove(r)}_merge(e){const t=ea._createAt(e.nodeBefore,"end"),r=ea._createAt(e.nodeAfter,0),n=e.root.document.graveyard,o=new ea(n,[0]),i=e.root.document.version,a=new Os(r,e.nodeAfter.maxOffset,t,o,i);this.batch.addOperation(a),this.model.applyOperation(a)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Xi))throw new qt("writer-rename-not-element-instance",this);const r=e.root.document?e.root.document.version:null,n=new Ps(ea._createBefore(e),e.name,t,r);this.batch.addOperation(n),this.model.applyOperation(n)}split(e,t){this._assertWriterUsedCorrectly();let r,n,o=e.parent;if(!o.parent)throw new qt("writer-split-element-no-parent",this);if(t||(t=o.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new qt("writer-split-invalid-limit-element",this);do{const t=o.root.document?o.root.document.version:null,i=o.maxOffset-e.offset,a=new Ms(e,i,null,t);this.batch.addOperation(a),this.model.applyOperation(a),r||n||(r=o,n=e.parent.nextSibling),o=(e=this.createPositionAfter(e.parent)).parent}while(o!==t);return{position:e,range:new oa(ea._createAt(r,"end"),ea._createAt(n,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new qt("writer-wrap-range-not-flat",this);const r=t instanceof Xi?t:new Xi(t);if(r.childCount>0)throw new qt("writer-wrap-element-not-empty",this);if(null!==r.parent)throw new qt("writer-wrap-element-attached",this);this.insert(r,e.start);const n=new oa(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(n,ea._createAt(r,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new qt("writer-unwrap-element-no-parent",this);this.move(oa._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new qt("writer-addmarker-no-usingoperation",this);const r=t.usingOperation,n=t.range,o=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new qt("writer-addmarker-marker-exists",this);if(!n)throw new qt("writer-addmarker-no-range",this);return r?(Ls(this,e,null,n,o),this.model.markers.get(e)):this.model.markers._set(e,n,r,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const r="string"==typeof e?e:e.name,n=this.model.markers.get(r);if(!n)throw new qt("writer-updatemarker-marker-not-exists",this);if(!t)return void this.model.markers._refresh(n);const o="boolean"==typeof t.usingOperation,i="boolean"==typeof t.affectsData,a=i?t.affectsData:n.affectsData;if(!o&&!t.range&&!i)throw new qt("writer-updatemarker-wrong-options",this);const s=n.getRange(),l=t.range?t.range:s;o&&t.usingOperation!==n.managedUsingOperations?t.usingOperation?Ls(this,r,null,l,a):(Ls(this,r,s,null,a),this.model.markers._set(r,l,void 0,a)):n.managedUsingOperations?Ls(this,r,s,l,a):this.model.markers._set(r,l,void 0,a)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new qt("writer-removemarker-no-marker",this);const r=this.model.markers.get(t);r.managedUsingOperations?Ls(this,t,r.getRange(),null,r.affectsData):this.model.markers._remove(t)}setSelection(e,t,r){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,t,r)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._setSelectionAttribute(e,t);else for(const[t,r]of vr(e))this._setSelectionAttribute(t,r)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const r=this.model.document.selection;if(r.isCollapsed&&r.anchor.parent.isEmpty){const n=wa._getStoreAttributeKey(e);this.setAttribute(n,t,r.anchor.parent)}r._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const r=wa._getStoreAttributeKey(e);this.removeAttribute(r,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new qt("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const r of this.model.markers){if(!r.managedUsingOperations)continue;const n=r.getRange();let o=!1;if("move"===e)o=t.containsPosition(n.start)||t.start.isEqual(n.start)||t.containsPosition(n.end)||t.end.isEqual(n.end);else{const e=t.nodeBefore,r=t.nodeAfter,i=n.start.parent==e&&n.start.isAtEnd,a=n.end.parent==r&&0==n.end.offset,s=n.end.nodeAfter==r,l=n.start.nodeAfter==r;o=i||a||s||l}o&&this.updateMarker(r.name,{range:n})}}}function js(e,t,r,n){const o=e.model,i=o.document;let a,s,l,c=n.start;for(const e of n.getWalker({shallow:!0}))l=e.item.getAttribute(t),a&&s!=l&&(s!=r&&u(),c=a),a=e.nextPosition,s=l;function u(){const n=new oa(c,a),l=n.root.document?i.version:null,u=new Cs(n,t,s,r,l);e.batch.addOperation(u),o.applyOperation(u)}a instanceof ea&&a!=c&&s!=r&&u()}function Rs(e,t,r,n){const o=e.model,i=o.document,a=n.getAttribute(t);let s,l;if(a!=r){if(n.root===n){const e=n.document?i.version:null;l=new Is(n,t,a,r,e)}else{s=new oa(ea._createBefore(n),e.createPositionAfter(n));const o=s.root.document?i.version:null;l=new Cs(s,t,a,r,o)}e.batch.addOperation(l),o.applyOperation(l)}}function Ls(e,t,r,n,o){const i=e.model,a=i.document,s=new As(t,r,n,i.markers,o,a.version);e.batch.addOperation(s),i.applyOperation(s)}function Ns(e,t,r,n){let o;if(e.root.document){const r=n.document,i=new ea(r.graveyard,[0]);o=new Ss(e,t,i,r.version)}else o=new Es(e,t);r.addOperation(o),n.applyOperation(o)}function Bs(e,t){return e===t||e instanceof Ds&&t instanceof Ds}class Fs{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const t=oa._createOn(e);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const t of e.range.getItems({shallow:!0}))this._isInInsertedElement(t.parent)||this._markAttribute(t);break;case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const t=this._isInInsertedElement(e.sourcePosition.parent),r=this._isInInsertedElement(e.targetPosition.parent);t||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),r||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const t=oa._createFromPositionAndShift(e.position,1);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}break}case"split":{const t=e.splitPosition.parent;this._isInInsertedElement(t)||this._markRemove(t,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const t=e.sourcePosition.parent;this._isInInsertedElement(t.parent)||this._markRemove(t.parent,t.startOffset,1);const r=e.graveyardPosition.parent;this._markInsert(r,e.graveyardPosition.offset,1);const n=e.targetPosition.parent;this._isInInsertedElement(n)||this._markInsert(n,e.targetPosition.offset,t.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,t,r,n){const o=this._changedMarkers.get(e);o?(o.newRange=r,o.affectsData=n,null==o.oldRange&&null==o.newRange&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:t,newRange:r,affectsData:n})}getMarkersToRemove(){const e=[];for(const[t,r]of this._changedMarkers)null!=r.oldRange&&e.push({name:t,range:r.oldRange});return e}getMarkersToAdd(){const e=[];for(const[t,r]of this._changedMarkers)null!=r.newRange&&e.push({name:t,range:r.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}}))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const e of this._changesInElement.keys()){const r=this._changesInElement.get(e).sort((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1),n=this._elementSnapshots.get(e),o=Vs(e.getChildren()),i=Us(n.length,r);let a=0,s=0;for(const r of i)if("i"===r)t.push(this._getInsertDiff(e,a,o[a].name)),a++;else if("r"===r)t.push(this._getRemoveDiff(e,a,n[s].name)),s++;else if("a"===r){const r=o[a].attributes,i=n[s].attributes;let l;if("$text"==o[a].name)l=new oa(ea._createAt(e,a),ea._createAt(e,a+1));else{const t=e.offsetToIndex(a);l=new oa(ea._createAt(e,a),ea._createAt(e.getChild(t),0))}t.push(...this._getAttributesDiff(l,i,r)),a++,s++}else a++,s++}t.sort((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1);for(let e=1,r=0;e<t.length;e++){const n=t[r],o=t[e],i="remove"==n.type&&"remove"==o.type&&"$text"==n.name&&"$text"==o.name&&n.position.isEqual(o.position),a="insert"==n.type&&"insert"==o.type&&"$text"==n.name&&"$text"==o.name&&n.position.parent==o.position.parent&&n.position.offset+n.length==o.position.offset,s="attribute"==n.type&&"attribute"==o.type&&n.position.parent==o.position.parent&&n.range.isFlat&&o.range.isFlat&&n.position.offset+n.length==o.position.offset&&n.attributeKey==o.attributeKey&&n.attributeOldValue==o.attributeOldValue&&n.attributeNewValue==o.attributeNewValue;i||a||s?(n.length++,s&&(n.range.end=n.range.end.getShiftedBy(1)),t[e]=null):r=e}t=t.filter(e=>e);for(const e of t)delete e.changeCount,"attribute"==e.type&&(delete e.position,delete e.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t.slice(),this._cachedChanges=t.filter(qs),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,t,r){const n={type:"insert",offset:t,howMany:r,count:this._changeCount++};this._markChange(e,n)}_markRemove(e,t,r){const n={type:"remove",offset:t,howMany:r,count:this._changeCount++};this._markChange(e,n),this._removeAllNestedChanges(e,t,r)}_markAttribute(e){const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const r=this._getChangesForElement(e);this._handleChange(t,r),r.push(t);for(let e=0;e<r.length;e++)r[e].howMany<1&&(r.splice(e,1),e--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,Vs(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const r of t){const n=e.offset+e.howMany,o=r.offset+r.howMany;if("insert"==e.type&&("insert"==r.type&&(e.offset<=r.offset?r.offset+=e.howMany:e.offset<o&&(r.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==r.type&&e.offset<r.offset&&(r.offset+=e.howMany),"attribute"==r.type))if(e.offset<=r.offset)r.offset+=e.howMany;else if(e.offset<o){const o=r.howMany;r.howMany=e.offset-r.offset,t.unshift({type:"attribute",offset:n,howMany:o-r.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==r.type)if(n<=r.offset)r.offset-=e.howMany;else if(n<=o)if(e.offset<r.offset){const t=n-r.offset;r.offset=e.offset,r.howMany-=t,e.nodesToHandle-=t}else r.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=r.offset)e.nodesToHandle-=r.howMany,r.howMany=0;else if(e.offset<o){const t=o-e.offset;r.howMany-=t,e.nodesToHandle-=t}if("remove"==r.type&&(n<=r.offset?r.offset-=e.howMany:e.offset<r.offset&&(e.nodesToHandle+=r.howMany,r.howMany=0)),"attribute"==r.type)if(n<=r.offset)r.offset-=e.howMany;else if(e.offset<r.offset){const t=n-r.offset;r.offset=e.offset,r.howMany-=t}else if(e.offset<o)if(n<=o){const n=r.howMany;r.howMany=e.offset-r.offset;const o=n-r.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:o,count:this._changeCount++})}else r.howMany-=o-e.offset}if("attribute"==e.type){if("insert"==r.type)if(e.offset<r.offset&&n>r.offset){if(n>o){const e={type:"attribute",offset:o,howMany:n-o,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=r.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=r.offset&&e.offset<o&&(n>o?(e.nodesToHandle=n-o,e.offset=o):e.nodesToHandle=0);if("remove"==r.type&&e.offset<r.offset&&n>r.offset){const o={type:"attribute",offset:r.offset,howMany:n-r.offset,count:this._changeCount++};this._handleChange(o,t),t.push(o),e.nodesToHandle=r.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==r.type&&(e.offset>=r.offset&&n<=o?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=r.offset&&n>=o&&(r.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,r){return{type:"insert",position:ea._createAt(e,t),name:r,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,r){return{type:"remove",position:ea._createAt(e,t),name:r,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,r){const n=[];r=new Map(r);for(const[o,i]of t){const t=r.has(o)?r.get(o):null;t!==i&&n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:i,attributeNewValue:t,changeCount:this._changeCount++}),r.delete(o)}for(const[t,o]of r)n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:t,attributeOldValue:null,attributeNewValue:o,changeCount:this._changeCount++});return n}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const r=this._changesInElement.get(t),n=e.startOffset;if(r)for(const e of r)if("insert"==e.type&&n>=e.offset&&n<e.offset+e.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,r){const n=new oa(ea._createAt(e,t),ea._createAt(e,t+r));for(const e of n.getItems({shallow:!0}))e.is("element")&&(this._elementSnapshots.delete(e),this._changesInElement.delete(e),this._removeAllNestedChanges(e,0,e.maxOffset))}}function Vs(e){const t=[];for(const r of e)if(r.is("$text"))for(let e=0;e<r.data.length;e++)t.push({name:"$text",attributes:new Map(r.getAttributes())});else t.push({name:r.name,attributes:new Map(r.getAttributes())});return t}function Us(e,t){const r=[];let n=0,o=0;for(const e of t){if(e.offset>n){for(let t=0;t<e.offset-n;t++)r.push("e");o+=e.offset-n}if("insert"==e.type){for(let t=0;t<e.howMany;t++)r.push("i");n=e.offset+e.howMany}else if("remove"==e.type){for(let t=0;t<e.howMany;t++)r.push("r");n=e.offset,o+=e.howMany}else r.push(..."a".repeat(e.howMany).split("")),n=e.offset+e.howMany,o+=e.howMany}if(o<e)for(let t=0;t<e-o-n;t++)r.push("e");return r}function qs(e){const t=e.position&&"$graveyard"==e.position.root.rootName,r=e.range&&"$graveyard"==e.range.root.rootName;return!t&&!r}class Hs{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY){const r=[];for(const n of this._operations)n.baseVersion>=e&&n.baseVersion<t&&r.push(n);return r}getOperation(e){for(const t of this._operations)if(t.baseVersion==e)return t}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}function Ws(e,t){return!!(r=e.charAt(t-1))&&1==r.length&&/[\ud800-\udbff]/.test(r)&&function(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}(e.charAt(t));var r}function Gs(e,t){return!!(r=e.charAt(t))&&1==r.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(r);var r}const Zs="$graveyard";class Ys{constructor(e){this.model=e,this.version=0,this.history=new Hs(this),this.selection=new wa(this),this.roots=new ar({idProperty:"rootName"}),this.differ=new Fs(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",Zs),this.listenTo(e,"applyOperation",(e,t)=>{const r=t[0];if(r.isDocumentOperation&&r.baseVersion!==this.version)throw new qt("model-document-applyoperation-wrong-version",this,{operation:r})},{priority:"highest"}),this.listenTo(e,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&this.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(e,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&(this.version++,this.history.addOperation(r))},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(e,t,r,n)=>{this.differ.bufferMarkerChange(t.name,r,n,t.affectsData),null===r&&t.on("change",(e,r)=>{this.differ.bufferMarkerChange(t.name,r,t.getRange(),t.affectsData)})})}get graveyard(){return this.getRoot(Zs)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new qt("model-document-createroot-name-exists",this,{name:t});const r=new Ds(this,e,t);return this.roots.add(r),r}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,e=>e.rootName).filter(e=>e!=Zs)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=fr(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,r=t.schema,n=t.createPositionFromPath(e,[0]);return r.getNearestSelectionRange(n)||t.createRange(n)}_validateSelectionRange(e){return $s(e.start)&&$s(e.end)}_callPostFixers(e){let t=!1;do{for(const r of this._postFixers)if(this.selection.refresh(),t=r(e),t)break}while(t)}}function $s(e){const t=e.textNode;if(t){const r=t.data,n=e.offset-t.startOffset;return!Ws(r,n)&&!Gs(r,n)}return!0}ir(Ys,Xt);class Ks{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){return this._markers.has(e)}get(e){return this._markers.get(e)||null}_set(e,t,r=!1,n=!1){const o=e instanceof Xs?e.name:e;if(o.includes(","))throw new qt("markercollection-incorrect-marker-name",this);const i=this._markers.get(o);if(i){const e=i.getRange();let a=!1;return e.isEqual(t)||(i._attachLiveRange(ba.fromRange(t)),a=!0),r!=i.managedUsingOperations&&(i._managedUsingOperations=r,a=!0),"boolean"==typeof n&&n!=i.affectsData&&(i._affectsData=n,a=!0),a&&this.fire("update:"+o,i,e,t),i}const a=ba.fromRange(t),s=new Xs(o,a,r,n);return this._markers.set(o,s),this.fire("update:"+o,s,null,t),s}_remove(e){const t=e instanceof Xs?e.name:e,r=this._markers.get(t);return!!r&&(this._markers.delete(t),this.fire("update:"+t,r,r.getRange(),null),this._destroyMarker(r),!0)}_refresh(e){const t=e instanceof Xs?e.name:e,r=this._markers.get(t);if(!r)throw new qt("markercollection-refresh-marker-not-exists",this);const n=r.getRange();this.fire("update:"+t,r,n,n,r.managedUsingOperations,r.affectsData)}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}ir(Ks,Xt);class Xs{constructor(e,t,r,n){this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=r,this._affectsData=n}get managedUsingOperations(){if(!this._liveRange)throw new qt("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new qt("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new qt("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new qt("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new qt("marker-destroyed",this);return this._liveRange.toRange()}is(e){return"marker"===e||"model:marker"===e}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}ir(Xs,Xt);class Js extends fs{get type(){return"noop"}clone(){return new Js(this.baseVersion)}getReversed(){return new Js(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const Qs={};Qs[Cs.className]=Cs,Qs[Ts.className]=Ts,Qs[As.className]=As,Qs[Ss.className]=Ss,Qs[Js.className]=Js,Qs[fs.className]=fs,Qs[Ps.className]=Ps,Qs[Is.className]=Is,Qs[Ms.className]=Ms,Qs[Os.className]=Os;class el extends ea{constructor(e,t,r="toNone"){if(super(e,t,r),!this.root.is("rootElement"))throw new qt("model-liveposition-root-not-rootelement",e);tl.call(this)}detach(){this.stopListening()}is(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e}toPosition(){return new ea(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function tl(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&rl.call(this,r)},{priority:"low"})}function rl(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}ir(el,Xt);class nl{constructor(e,t,r){this.model=e,this.writer=t,this.position=r,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}getSelectionRange(){return this.nodeToSelect?oa._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new oa(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){this.schema.isObject(e)?this._handleObject(e):this._checkAndSplitToAllowedPosition(e)?(this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this._handleDisallowedNode(e)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=el.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new qt("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=el.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=el.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Xi))return;if(!this._canMergeLeft(e))return;const t=el._createBefore(e);t.stickiness="toNext";const r=el.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=el._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=el._createAt(t.nodeBefore,"end","toNext")),this.position=r.toPosition(),r.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Xi))return;if(!this._canMergeRight(e))return;const t=el._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new qt("insertcontent-invalid-insertion-position",this);this.position=ea._createAt(t.nodeBefore,"end");const r=el.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=el._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=el._createAt(t.nodeBefore,0,"toPrevious")),this.position=r.toPosition(),r.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Xi&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Xi&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(t,this.position.parent)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(e,this.position.parent);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;){if(this.schema.isLimit(this.position.parent))return!1;if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}}return!0}_getAllowedIn(e,t){return this.schema.checkChild(t,e)?t:t.parent?this._getAllowedIn(e,t.parent):null}}function ol(e,t,r={}){if(t.isCollapsed)return;const n=t.getFirstRange();if("$graveyard"==n.root.rootName)return;const o=e.schema;e.change(e=>{if(!r.doNotResetEntireContent&&function(e,t){const r=e.getLimitElement(t);if(!t.containsEntireContent(r))return!1;const n=t.getFirstRange();return n.start.parent!=n.end.parent&&e.checkChild(r,"paragraph")}(o,t))return void function(e,t){const r=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(r)),al(e,e.createPositionAt(r,0),t)}(e,t);const[i,a]=function(e){const t=e.root.document.model,r=e.start;let n=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const r=function(e){const t=e.parent,r=t.root.document.model.schema,n=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const e of n){if(r.isLimit(e))return null;if(r.isBlock(e))return e}}(n);if(r&&n.isTouching(t.createPositionAt(r,0))){const r=t.createSelection(e);t.modifySelection(r,{direction:"backward"}),n=r.getLastPosition()}}return[el.fromPosition(r,"toPrevious"),el.fromPosition(n,"toNext")]}(n);i.isTouching(a)||e.remove(e.createRange(i,a)),r.leaveUnmerged||(function(e,t,r){const n=e.model;if(!il(e.model.schema,t,r))return;const[o,i]=function(e,t){const r=e.getAncestors(),n=t.getAncestors();let o=0;for(;r[o]&&r[o]==n[o];)o++;return[r[o],n[o]]}(t,r);o&&i&&(!n.hasContent(o,{ignoreMarkers:!0})&&n.hasContent(i,{ignoreMarkers:!0})?function e(t,r,n,o){const i=r.parent,a=n.parent;if(i!=o&&a!=o){for(r=t.createPositionAfter(i),(n=t.createPositionBefore(a)).isEqual(r)||t.insert(i,n);r.parent.isEmpty;){const e=r.parent;r=t.createPositionBefore(e),t.remove(e)}n=t.createPositionBefore(a),function(e,t){const r=t.nodeBefore,n=t.nodeAfter;r.name!=n.name&&e.rename(r,n.name),e.clearAttributes(r),e.setAttributes(Object.fromEntries(n.getAttributes()),r),e.merge(t)}(t,n),il(t.model.schema,r,n)&&e(t,r,n,o)}}(e,t,r,o.parent):function e(t,r,n,o){const i=r.parent,a=n.parent;if(i!=o&&a!=o){for(r=t.createPositionAfter(i),(n=t.createPositionBefore(a)).isEqual(r)||t.insert(a,r),t.merge(r);n.parent.isEmpty;){const e=n.parent;n=t.createPositionBefore(e),t.remove(e)}il(t.model.schema,r,n)&&e(t,r,n,o)}}(e,t,r,o.parent))}(e,i,a),o.removeDisallowedAttributes(i.parent.getChildren(),e)),sl(e,t,i),!r.doNotAutoparagraph&&function(e,t){const r=e.checkChild(t,"$text"),n=e.checkChild(t,"paragraph");return!r&&n}(o,i)&&al(e,i,t),i.detach(),a.detach()})}function il(e,t,r){const n=t.parent,o=r.parent;return n!=o&&!e.isLimit(n)&&!e.isLimit(o)&&function(e,t,r){const n=new oa(e,t);for(const e of n.getWalker())if(r.isLimit(e.item))return!1;return!0}(t,r,e)}function al(e,t,r){const n=e.createElement("paragraph");e.insert(n,t),sl(e,r,e.createPositionAt(n,0))}function sl(e,t,r){t instanceof wa?e.setSelection(r):t.setTo(r)}const ll=' ,.?!:;"-()';function cl(e,t){const{isForward:r,walker:n,unit:o,schema:i}=e,{type:a,item:s,nextPosition:l}=t;if("text"==a)return"word"===e.unit?function(e,t){let r=e.position.textNode;if(r){let n=e.position.offset-r.startOffset;for(;!dl(r.data,n,t)&&!hl(r,n,t);){e.next();const o=t?e.position.nodeAfter:e.position.nodeBefore;if(o&&o.is("$text")){const n=o.data.charAt(t?0:o.data.length-1);ll.includes(n)||(e.next(),r=e.position.textNode)}n=e.position.offset-r.startOffset}}return e.position}(n,r):function(e,t){const r=e.position.textNode;if(r){const n=r.data;let o=e.position.offset-r.startOffset;for(;Ws(n,o)||"character"==t&&Gs(n,o);)e.next(),o=e.position.offset-r.startOffset}return e.position}(n,o);if(a==(r?"elementStart":"elementEnd")){if(i.isSelectable(s))return ea._createAt(s,r?"after":"before");if(i.checkChild(l,"$text"))return l}else{if(i.isLimit(s))return void n.skip(()=>!0);if(i.checkChild(l,"$text"))return l}}function ul(e,t){const r=e.root,n=ea._createAt(r,t?"end":0);return t?new oa(e,n):new oa(n,e)}function dl(e,t,r){const n=t+(r?0:-1);return ll.includes(e.charAt(n))}function hl(e,t,r){return t===(r?e.endOffset:0)}function pl(e,t){const r=[];Array.from(e.getItems({direction:"backward"})).map(e=>t.createRangeOn(e)).filter(t=>(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end))).forEach(e=>{r.push(e.start.parent),t.remove(e)}),r.forEach(e=>{let r=e;for(;r.parent&&r.isEmpty;){const e=t.createRangeOn(r);r=r.parent,t.remove(e)}})}function fl(e,t){return e.isCollapsed?function(e,t){const r=e.start,n=t.getNearestSelectionRange(r);if(!n)return null;if(!n.isCollapsed)return n;const o=n.start;return r.isEqual(o)?null:new oa(o)}(e,t):function(e,t){const{start:r,end:n}=e,o=t.checkChild(r,"$text"),i=t.checkChild(n,"$text"),a=t.getLimitElement(r),s=t.getLimitElement(n);if(a===s){if(o&&i)return null;if(function(e,t,r){const n=e.nodeAfter&&!r.isLimit(e.nodeAfter)||r.checkChild(e,"$text"),o=t.nodeBefore&&!r.isLimit(t.nodeBefore)||r.checkChild(t,"$text");return n||o}(r,n,t)){const e=r.nodeAfter&&t.isSelectable(r.nodeAfter)?null:t.getNearestSelectionRange(r,"forward"),o=n.nodeBefore&&t.isSelectable(n.nodeBefore)?null:t.getNearestSelectionRange(n,"backward"),i=e?e.start:r,a=o?o.end:n;return new oa(i,a)}}const l=a&&!a.is("rootElement"),c=s&&!s.is("rootElement");if(l||c){const e=r.nodeAfter&&n.nodeBefore&&r.nodeAfter.parent===n.nodeBefore.parent,o=l&&(!e||!gl(r.nodeAfter,t)),i=c&&(!e||!gl(n.nodeBefore,t));let u=r,d=n;return o&&(u=ea._createBefore(ml(a,t))),i&&(d=ea._createAfter(ml(s,t))),new oa(u,d)}return null}(e,t)}function ml(e,t){let r=e,n=r;for(;t.isLimit(n)&&n.parent;)r=n,n=n.parent;return r}function gl(e,t){return e&&t.isSelectable(e)}class bl{constructor(){this.markers=new Ks,this.document=new Ys(this),this.schema=new Za,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,t)=>{t[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",isLimit:!0}),this.schema.extend("$text",{allowIn:"$clipboardHolder"}),this.schema.register("$marker"),this.schema.addChildCheck((e,t)=>{if("$marker"===t.name)return!0}),function(e){e.document.registerPostFixer(t=>function(e,t){const r=t.document.selection,n=t.schema,o=[];let i=!1;for(const e of r.getRanges()){const t=fl(e,n);t&&!t.isEqual(e)?(o.push(t),i=!0):o.push(e)}i&&e.setSelection(function(e){const t=[];t.push(e.shift());for(const r of e){const e=t.pop();if(r.isEqual(e))t.push(e);else if(r.isIntersecting(e)){const n=e.start.isAfter(r.start)?r.start:e.start,o=e.end.isAfter(r.end)?e.end:r.end,i=new oa(n,o);t.push(i)}else t.push(e),t.push(r)}return t}(o),{backward:r.isBackward})}(t,e))}(this),this.document.registerPostFixer(Da)}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new ps,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(e){qt.rethrowUnexpectedError(e,this)}}enqueueChange(e,t){try{"string"==typeof e?e=new ps(e):"function"==typeof e&&(t=e,e=new ps),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(e){qt.rethrowUnexpectedError(e,this)}}applyOperation(e){e._execute()}insertContent(e,t,r){return function(e,t,r,n){return e.change(o=>{let i;i=r?r instanceof ha||r instanceof wa?r:o.createSelection(r,n):e.document.selection,i.isCollapsed||e.deleteContent(i,{doNotAutoparagraph:!0});const a=new nl(e,o,i.anchor);let s;s=t.is("documentFragment")?t.getChildren():[t],a.handleNodes(s);const l=a.getSelectionRange();l&&(i instanceof wa?o.setSelection(l):i.setTo(l));const c=a.getAffectedRange()||e.createRange(i.anchor);return a.destroy(),c})}(this,e,t,r)}deleteContent(e,t){ol(this,e,t)}modifySelection(e,t){!function(e,t,r={}){const n=e.schema,o="backward"!=r.direction,i=r.unit?r.unit:"character",a=t.focus,s=new Ji({boundaries:ul(a,o),singleCharacters:!0,direction:o?"forward":"backward"}),l={walker:s,schema:n,isForward:o,unit:i};let c;for(;c=s.next();){if(c.done)return;const r=cl(l,c.value);if(r)return void(t instanceof wa?e.change(e=>{e.setSelectionFocus(r)}):t.setFocus(r))}}(this,e,t)}getSelectedContent(e){return function(e,t){return e.change(e=>{const r=e.createDocumentFragment(),n=t.getFirstRange();if(!n||n.isCollapsed)return r;const o=n.start.root,i=n.start.getCommonPath(n.end),a=o.getNodeByPath(i);let s;s=n.start.parent==n.end.parent?n:e.createRange(e.createPositionAt(a,n.start.path[i.length]),e.createPositionAt(a,n.end.path[i.length]+1));const l=s.end.offset-s.start.offset;for(const t of s.getItems({shallow:!0}))t.is("$textProxy")?e.appendText(t.data,t.getAttributes(),r):e.append(e.cloneElement(t,!0),r);if(s!=n){const t=n._getTransformedByMove(s.start,e.createPositionAt(r,0),l)[0],o=e.createRange(e.createPositionAt(r,0),t.start);pl(e.createRange(t.end,e.createPositionAt(r,"end")),e),pl(o,e)}return r})}(this,e)}hasContent(e,t={}){const r=e instanceof Xi?oa._createIn(e):e;if(r.isCollapsed)return!1;const{ignoreWhitespaces:n=!1,ignoreMarkers:o=!1}=t;if(!o)for(const e of this.markers.getMarkersIntersectingRange(r))if(e.affectsData)return!0;for(const e of r.getItems())if(this.schema.isContent(e)){if(!e.is("$textProxy"))return!0;if(!n)return!0;if(-1!==e.data.search(/\S/))return!0}return!1}createPositionFromPath(e,t,r){return new ea(e,t,r)}createPositionAt(e,t){return ea._createAt(e,t)}createPositionAfter(e){return ea._createAfter(e)}createPositionBefore(e){return ea._createBefore(e)}createRange(e,t){return new oa(e,t)}createRangeIn(e){return oa._createIn(e)}createRangeOn(e){return oa._createOn(e)}createSelection(e,t,r){return new ha(e,t,r)}createBatch(e){return new ps(e)}createOperationFromJSON(e){return class{static fromJSON(e,t){return Qs[e.__className].fromJSON(e,t)}}.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new zs(this,t);const r=this._pendingChanges[0].callback(this._currentWriter);e.push(r),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}ir(bl,fn);class vl{constructor(){this._listener=Object.create(Uo)}listenTo(e){this._listener.listenTo(e,"keydown",(e,t)=>{this._listener.fire("_keydown:"+Wn(t),t)})}set(e,t,r={}){const n=Gn(e),o=r.priority;this._listener.listenTo(this._listener,"_keydown:"+n,(e,r)=>{t(r,()=>{r.preventDefault(),r.stopPropagation(),e.stop()}),e.return=!0},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+Wn(e),e)}destroy(){this._listener.stopListening()}}class yl extends vl{constructor(e){super(),this.editor=e}set(e,t,r={}){if("string"==typeof t){const e=t;t=(t,r)=>{this.editor.execute(e),r()}}super.set(e,t,r)}}class _l{constructor(e={}){this._context=e.context||new hr({language:e.language}),this._context._addEditor(this,!e.context);const t=Array.from(this.constructor.builtinPlugins||[]);this.config=new Rt(e,this.constructor.defaultConfig),this.config.define("plugins",t),this.config.define(this._context._getEditorConfig()),this.plugins=new sr(this,t,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new Ha,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.set("isReadOnly",!1),this.model=new bl;const r=new tn;this.data=new cs(this.model,r),this.editing=new qa(this.model,r),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new us([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new yl(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,t=e.get("plugins"),r=e.get("removePlugins")||[],n=e.get("extraPlugins")||[];return this.plugins.init(t.concat(n),r)}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise(e=>this.once("ready",e))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(...e){try{return this.commands.execute(...e)}catch(e){qt.rethrowUnexpectedError(e,this)}}focus(){this.editing.view.focus()}}ir(_l,fn);const wl={setData(e){this.data.set(e)},getData(e){return this.data.get(e)}},xl={updateSourceElement(){if(!this.sourceElement)throw new qt("editor-missing-sourceelement",this);var e,t;e=this.sourceElement,t=this.data.get(),e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}};class kl{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(Cl(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new qt("componentfactory-item-missing",this,{name:e});return this._components.get(Cl(e)).callback(this.editor.locale)}has(e){return this._components.has(Cl(e))}}function Cl(e){return String(e).toLowerCase()}class El{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new qt("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}ir(El,Uo),ir(El,fn);class Sl{constructor(e){this.editor=e,this.componentFactory=new kl(e),this.focusTracker=new El,this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",()=>this.update())}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}}function Tl(e){return Array.isArray(e)?{items:e,removeItems:[]}:e?Object.assign({items:[],removeItems:[]},e):{items:[],removeItems:[]}}ir(Sl,Xt);var Al=i(3379),Pl=i.n(Al),Il=i(8894);Pl()(Il.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Il.Z.locals;const Ol=new WeakMap;function Ml(e){const{view:t,element:r,text:n,isDirectHost:o=!0}=e,i=t.document;Ol.has(i)||(Ol.set(i,new Map),i.registerPostFixer(e=>Dl(i,e))),Ol.get(i).set(r,{text:n,isDirectHost:o}),t.change(e=>Dl(i,e))}function Dl(e,t){const r=Ol.get(e);let n=!1;for(const[e,o]of r)zl(t,e,o)&&(n=!0);return n}function zl(e,t,r){const{text:n,isDirectHost:o}=r,i=o?t:function(e){if(1===e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}(t);let a=!1;return!!i&&(r.hostElement=i,i.getAttribute("data-placeholder")!==n&&(e.setAttribute("data-placeholder",n,i),a=!0),function(e){if(!e.isAttached())return!1;const t=!Array.from(e.getChildren()).some(e=>!e.is("uiElement")),r=e.document;if(!r.isFocused&&t)return!0;const n=r.selection.anchor;return!(!t||!n||n.parent===e)}(i)?function(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}(e,i)&&(a=!0):function(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}(e,i)&&(a=!0),a)}class jl{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}}class Rl extends Sl{constructor(e,t){super(e),this.view=t,this._toolbarConfig=Tl(e.config.get("toolbar")),this._elementReplacer=new jl}get element(){return this.view.element}init(e){const t=this.editor,r=this.view,n=t.editing.view,o=r.editable,i=n.document.getRoot();o.name=i.rootName,r.render();const a=o.element;this.setEditableElement(o.name,a),this.focusTracker.add(a),r.editable.bind("isFocused").to(this.focusTracker),n.attachDomRoot(a),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,t=this.view,r=e.editing.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,this._toolbarConfig.viewportTopOffset&&(t.stickyPanel.viewportTopOffset=this._toolbarConfig.viewportTopOffset),t.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),function({origin:e,originKeystrokeHandler:t,originFocusTracker:r,toolbar:n,beforeFocus:o,afterBlur:i}){r.add(n.element),t.set("Alt+F10",(e,t)=>{r.isFocused&&!n.focusTracker.isFocused&&(o&&o(),n.focus(),t())}),n.keystrokes.set("Esc",(t,r)=>{n.focusTracker.isFocused&&(e.focus(),i&&i(),r())})}({origin:r,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:t.toolbar})}_initPlaceholder(){const e=this.editor,t=e.editing.view,r=t.document.getRoot(),n=e.sourceElement,o=e.config.get("placeholder")||n&&"textarea"===n.tagName.toLowerCase()&&n.getAttribute("placeholder");o&&Ml({view:t,element:r,text:o,isDirectHost:!1})}}class Ll extends ar{constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(e,t,r)=>{this._renderViewIntoCollectionParent(t,r)}),this.on("remove",(e,t)=>{t.element&&this._parentElement&&t.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const e of this)this._renderViewIntoCollectionParent(e)}delegate(...e){if(!e.length||!e.every(e=>"string"==typeof e))throw new qt("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const r of this)for(const n of e)r.delegate(n).to(t);this.on("add",(r,n)=>{for(const r of e)n.delegate(r).to(t)}),this.on("remove",(r,n)=>{for(const r of e)n.stopDelegating(r,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}}class Nl{constructor(e){Object.assign(this,Yl(Zl(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:e,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new qt("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){yield*function*e(t){if(t.children)for(const r of t.children)Ql(r)?yield r:ec(r)&&(yield*e(r))}(this)}static bind(e,t){return{to:(r,n)=>new Fl({eventNameOrFunction:r,attribute:r,observable:e,emitter:t,callback:n}),if:(r,n,o)=>new Vl({observable:e,emitter:t,attribute:r,valueIfTrue:n,callback:o})}}static extend(e,t){if(e._isRendered)throw new qt("template-extend-render",[this,e]);!function e(t,r){if(r.attributes&&(t.attributes||(t.attributes={}),Xl(t.attributes,r.attributes)),r.eventListeners&&(t.eventListeners||(t.eventListeners={}),Xl(t.eventListeners,r.eventListeners)),r.text&&t.text.push(...r.text),r.children&&r.children.length){if(t.children.length!=r.children.length)throw new qt("ui-template-extend-children-mismatch",t);let n=0;for(const o of r.children)e(t.children[n++],o)}}(e,Yl(Zl(t)))}_renderNode(e){let t;if(t=e.node?this.tag&&this.text:this.tag?this.text:!this.text,t)throw new qt("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),Ul(this.text)?this._bindToObservable({schema:this.text,updater:Hl(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){let t,r,n,o;if(!this.attributes)return;const i=e.node,a=e.revertData;for(t in this.attributes)if(n=i.getAttribute(t),r=this.attributes[t],a&&(a.attributes[t]=n),o=I(r[0])&&r[0].ns?r[0].ns:null,Ul(r)){const s=o?r[0].value:r;a&&rc(t)&&s.unshift(n),this._bindToObservable({schema:s,updater:Wl(i,t,o),data:e})}else"style"==t&&"string"!=typeof r[0]?this._renderStyleAttribute(r[0],e):(a&&n&&rc(t)&&r.unshift(n),r=r.map(e=>e&&e.value||e).reduce((e,t)=>e.concat(t),[]).reduce(Kl,""),Jl(r)||i.setAttributeNS(o,t,r))}_renderStyleAttribute(e,t){const r=t.node;for(const n in e){const o=e[n];Ul(o)?this._bindToObservable({schema:[o],updater:Gl(r,n),data:t}):r.style[n]=o}}_renderElementChildren(e){const t=e.node,r=e.intoFragment?document.createDocumentFragment():t,n=e.isApplying;let o=0;for(const i of this.children)if(tc(i)){if(!n){i.setParent(t);for(const e of i)r.appendChild(e.element)}}else if(Ql(i))n||(i.isRendered||i.render(),r.appendChild(i.element));else if(Ao(i))r.appendChild(i);else if(n){const t={children:[],bindings:[],attributes:{}};e.revertData.children.push(t),i._renderNode({node:r.childNodes[o++],isApplying:!0,revertData:t})}else r.appendChild(i.render());e.intoFragment&&t.appendChild(r)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const r=this.eventListeners[t].map(r=>{const[n,o]=t.split("@");return r.activateDomEventListener(n,o,e)});e.revertData&&e.revertData.bindings.push(r)}}_bindToObservable({schema:e,updater:t,data:r}){const n=r.revertData;ql(e,t,r);const o=e.filter(e=>!Jl(e)).filter(e=>e.observable).map(n=>n.activateAttributeListener(e,t,r));n&&n.bindings.push(o)}_revertTemplateFromNode(e,t){for(const e of t.bindings)for(const t of e)t();if(t.text)e.textContent=t.text;else{for(const r in t.attributes){const n=t.attributes[r];null===n?e.removeAttribute(r):e.setAttribute(r,n)}for(let r=0;r<t.children.length;++r)this._revertTemplateFromNode(e.childNodes[r],t.children[r])}}}ir(Nl,Xt);class Bl{constructor(e){Object.assign(this,e)}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,r){const n=()=>ql(e,t,r);return this.emitter.listenTo(this.observable,"change:"+this.attribute,n),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,n)}}}class Fl extends Bl{activateDomEventListener(e,t,r){const n=(e,r)=>{t&&!r.target.matches(t)||("function"==typeof this.eventNameOrFunction?this.eventNameOrFunction(r):this.observable.fire(this.eventNameOrFunction,r))};return this.emitter.listenTo(r.node,e,n),()=>{this.emitter.stopListening(r.node,e,n)}}}class Vl extends Bl{getValue(e){return!Jl(super.getValue(e))&&(this.valueIfTrue||!0)}}function Ul(e){return!!e&&(e.value&&(e=e.value),Array.isArray(e)?e.some(Ul):e instanceof Bl)}function ql(e,t,{node:r}){let n=function(e,t){return e.map(e=>e instanceof Bl?e.getValue(t):e)}(e,r);n=1==e.length&&e[0]instanceof Vl?n[0]:n.reduce(Kl,""),Jl(n)?t.remove():t.set(n)}function Hl(e){return{set(t){e.textContent=t},remove(){e.textContent=""}}}function Wl(e,t,r){return{set(n){e.setAttributeNS(r,t,n)},remove(){e.removeAttributeNS(r,t)}}}function Gl(e,t){return{set(r){e.style[t]=r},remove(){e.style[t]=null}}}function Zl(e){return zt(e,e=>{if(e&&(e instanceof Bl||ec(e)||Ql(e)||tc(e)))return e})}function Yl(e){if("string"==typeof e?e=function(e){return{text:[e]}}(e):e.text&&function(e){e.text=lr(e.text)}(e),e.on&&(e.eventListeners=function(e){for(const t in e)$l(e,t);return e}(e.on),delete e.on),!e.text){e.attributes&&function(e){for(const t in e)e[t].value&&(e[t].value=lr(e[t].value)),$l(e,t)}(e.attributes);const t=[];if(e.children)if(tc(e.children))t.push(e.children);else for(const r of e.children)ec(r)||Ql(r)||Ao(r)?t.push(r):t.push(new Nl(r));e.children=t}return e}function $l(e,t){e[t]=lr(e[t])}function Kl(e,t){return Jl(t)?e:Jl(e)?t:`${e} ${t}`}function Xl(e,t){for(const r in t)e[r]?e[r].push(...t[r]):e[r]=t[r]}function Jl(e){return!e&&0!==e}function Ql(e){return e instanceof oc}function ec(e){return e instanceof Nl}function tc(e){return e instanceof Ll}function rc(e){return"class"==e||"style"==e}var nc=i(6150);Pl()(nc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),nc.Z.locals;class oc{constructor(e){this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new ar,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,r)=>{r.locale=e}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Nl.bind(this,this)}createCollection(e){const t=new Ll(e);return this._viewCollections.add(t),t}registerChild(e){or(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){or(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new Nl(e)}extendTemplate(e){Nl.extend(this.template,e)}render(){if(this.isRendered)throw new qt("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}ir(oc,Uo),ir(oc,fn);const ic=function(e){return"string"==typeof e||!de(e)&&v(e)&&"[object String]"==m(e)};function ac(e,t,r={},n=[]){const o=r&&r.xmlns,i=o?e.createElementNS(o,t):e.createElement(t);for(const e in r)i.setAttribute(e,r[e]);!ic(n)&&or(n)||(n=[n]);for(let t of n)ic(t)&&(t=e.createTextNode(t)),i.appendChild(t);return i}class sc extends Ll{constructor(e,t=[]){super(t),this.locale=e}attachToDom(){this._bodyCollectionContainer=new Nl({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=ac(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&0==e.childElementCount&&e.remove()}}var lc=i(4547);Pl()(lc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),lc.Z.locals;class cc extends oc{constructor(e){super(e),this.body=new sc(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}var uc=i(2751);Pl()(uc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),uc.Z.locals;class dc extends oc{constructor(e){super(e),this.set("text"),this.set("for"),this.id="ck-editor__label_"+Vt();const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}class hc extends cc{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new dc;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}class pc extends oc{constructor(e,t,r){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=r,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change(r=>{const n=e.document.getRoot(t.name);r.addClass(t.isFocused?"ck-focused":"ck-blurred",n),r.removeClass(t.isFocused?"ck-blurred":"ck-focused",n)})}e.isRenderingInProgress?function r(n){e.once("change:isRenderingInProgress",(e,o,i)=>{i?r(n):t(n)})}(this):t(this)}}class fc extends pc{constructor(e,t,r){super(e,t,r),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,t=this.t;e.change(r=>{const n=e.document.getRoot(this.name);r.setAttribute("aria-label",t("Rich Text Editor, %0",this.name),n)})}}function mc(e){return t=>t+e}var gc=i(3609);Pl()(gc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),gc.Z.locals;const bc=mc("px");class vc extends oc{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new Nl({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",e=>e?"block":"none"),height:t.to("isSticky",e=>e?bc(this._panelRect.height):null)}}}).render(),this._contentPanel=new Nl({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",e=>e?bc(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_hasViewportTopOffset",e=>e?bc(this.viewportTopOffset):null),bottom:t.to("_isStickyToTheLimiter",e=>e?bc(this.limiterBottomOffset):null),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(Do.window,"scroll",()=>{this._checkIfShouldBeSticky()}),this.listenTo(this,"change:isActive",()=>{this._checkIfShouldBeSticky()})}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let t;this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:bc(-Do.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}class yc{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const t in e.actions){let r=e.actions[t];"string"==typeof r&&(r=[r]);for(const n of r)e.keystrokeHandler.set(n,(e,r)=>{this[t](),r()})}}get first(){return this.focusables.find(_c)||null}get last(){return this.focusables.filter(_c).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find((t,r)=>{const n=t.element===this.focusTracker.focusedElement;return n&&(e=r),n}),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,r=this.focusables.length;if(!r)return null;if(null===t)return this[1===e?"first":"last"];let n=(t+r+e)%r;do{const t=this.focusables.get(n);if(_c(t))return t;n=(n+r+e)%r}while(n!==t);return null}}function _c(e){return!(!e.focus||"none"==Do.window.getComputedStyle(e.element).display)}class wc extends oc{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class xc extends oc{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}class kc{constructor(e,t){kc._observerInstance||kc._createObserver(),this._element=e,this._callback=t,kc._addElementCallback(e,t),kc._observerInstance.observe(e)}destroy(){kc._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){kc._elementCallbacks||(kc._elementCallbacks=new Map);let r=kc._elementCallbacks.get(e);r||(r=new Set,kc._elementCallbacks.set(e,r)),r.add(t)}static _deleteElementCallback(e,t){const r=kc._getElementCallbacks(e);r&&(r.delete(t),r.size||(kc._elementCallbacks.delete(e),kc._observerInstance.unobserve(e))),kc._elementCallbacks&&!kc._elementCallbacks.size&&(kc._observerInstance=null,kc._elementCallbacks=null)}static _getElementCallbacks(e){return kc._elementCallbacks?kc._elementCallbacks.get(e):null}static _createObserver(){let e;e="function"==typeof Do.window.ResizeObserver?Do.window.ResizeObserver:Cc,kc._observerInstance=new e(e=>{for(const t of e){const e=kc._getElementCallbacks(t.target);if(e)for(const r of e)r(t)}})}}kc._observerInstance=null,kc._elementCallbacks=null;class Cc{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,100)};this.listenTo(Do.window,"resize",()=>{this._checkElementRectsAndExecuteCallback()}),this._periodicCheckTimeout=setTimeout(e,100)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const t of this._elements)this._hasRectChanged(t)&&e.push({target:t,contentRect:this._previousRects.get(t)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const t=new Di(e),r=this._previousRects.get(e),n=!r||!r.isEqual(t);return this._previousRects.set(e,t),n}}ir(Cc,Uo);class Ec extends oc{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",e=>"ck-dropdown__panel_"+e),t.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:t.to(e=>e.preventDefault())}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;"function"==typeof e.focusLast?e.focusLast():e.focus()}}}var Sc=i(3488);function Tc({element:e,target:t,positions:r,limiter:n,fitInViewport:o}){O(t)&&(t=t()),O(n)&&(n=n());const i=function(e){return e&&e.parentNode?e.offsetParent===Do.document.body?null:e.offsetParent:null}(e),a=new Di(e),s=new Di(t);let l,c;if(n||o){const e=function(e,t){const{elementRect:r,viewportRect:n}=t,o=r.getArea(),i=function(e,{targetRect:t,elementRect:r,limiterRect:n,viewportRect:o}){const i=[],a=r.getArea();for(const s of e){const e=Ac(s,t,r);if(!e)continue;const[l,c]=e;let u=0,d=0;if(n)if(o){const e=n.getIntersection(o);e&&(u=e.getIntersectionArea(c))}else u=n.getIntersectionArea(c);o&&(d=o.getIntersectionArea(c));const h={positionName:l,positionRect:c,limiterIntersectArea:u,viewportIntersectArea:d};if(u===a)return[h];i.push(h)}return i}(e,t);if(n){const e=Pc(i.filter(({viewportIntersectArea:e})=>e===o),o);if(e)return e}return Pc(i,o)}(r,{targetRect:s,elementRect:a,limiterRect:n&&new Di(n).getVisible(),viewportRect:o&&new Di(Do.window)});[c,l]=e||Ac(r[0],s,a)}else[c,l]=Ac(r[0],s,a);let u=Ic(l);return i&&(u=function({left:e,top:t},r){const n=Ic(new Di(r)),o=Oi(r);return e-=n.left,t-=n.top,e+=r.scrollLeft,t+=r.scrollTop,{left:e-=o.left,top:t-=o.top}}(u,i)),{left:u.left,top:u.top,name:c}}function Ac(e,t,r){const n=e(t,r);if(!n)return null;const{left:o,top:i,name:a}=n;return[a,r.clone().moveTo(o,i)]}function Pc(e,t){let r,n,o=0;for(const{positionName:i,positionRect:a,limiterIntersectArea:s,viewportIntersectArea:l}of e){if(s===t)return[i,a];const e=l**2+s**2;e>o&&(o=e,r=a,n=i)}return r?[n,r]:null}function Ic({left:e,top:t}){const{scrollX:r,scrollY:n}=Do.window;return{left:e+r,top:t+n}}Pl()(Sc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Sc.Z.locals;class Oc extends oc{constructor(e,t,r){super(e);const n=this.bindTemplate;this.buttonView=t,this.panelView=r,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new vl,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",n.to("class"),n.if("isEnabled","ck-disabled",e=>!e)],id:n.to("id"),"aria-describedby":n.to("ariaDescribedById")},children:[t,r]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=Oc._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)}),this.keystrokes.listenTo(this.element);const e=(e,t)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,t())};this.keystrokes.set("arrowdown",(e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())}),this.keystrokes.set("arrowright",(e,t)=>{this.isOpen&&t()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:r,southWest:n,northEast:o,northWest:i,southMiddleEast:a,southMiddleWest:s,northMiddleEast:l,northMiddleWest:c}=Oc.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[r,n,a,s,e,o,i,l,c,t]:[n,r,s,a,e,i,o,c,l,t]}}Oc.defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"})},Oc._getOptimalPosition=Tc;var Mc=i(1174);Pl()(Mc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Mc.Z.locals;class Dc extends oc{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const e=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),t=e.getAttribute("viewBox");for(t&&(this.viewBox=t),this.element.innerHTML="";e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}var zc=i(9948);Pl()(zc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),zc.Z.locals;class jc extends oc{constructor(e){super(e),this.set("text",""),this.set("position","s");const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",t.to("position",e=>"ck-tooltip_"+e),t.if("text","ck-hidden",e=>!e.trim())]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:t.to("text")}]}]})}}var Rc=i(4499);Pl()(Rc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Rc.Z.locals;class Lc extends oc{constructor(e){super(e);const t=this.bindTemplate,r=Vt();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(r),this.iconView=new Dc,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",t.to("class"),t.if("isEnabled","ck-disabled",e=>!e),t.if("isVisible","ck-hidden",e=>!e),t.to("isOn",e=>e?"ck-on":"ck-off"),t.if("withText","ck-button_with-text"),t.if("withKeystroke","ck-button_with-keystroke")],type:t.to("type",e=>e||"button"),tabindex:t.to("tabindex"),"aria-labelledby":"ck-editor__aria-label_"+r,"aria-disabled":t.if("isEnabled",!0,e=>!e),"aria-pressed":t.to("isOn",e=>!!this.isToggleable&&String(e))},children:this.children,on:{mousedown:t.to(e=>{e.preventDefault()}),click:t.to(e=>{this.isEnabled?this.fire("execute"):e.preventDefault()})}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const e=new jc;return e.bind("text").to(this,"_tooltipString"),e.bind("position").to(this,"tooltipPosition"),e}_createLabelView(e){const t=new oc,r=this.bindTemplate;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:r.to("labelStyle"),id:"ck-editor__aria-label_"+e},children:[{text:this.bindTemplate.to("label")}]}),t}_createKeystrokeView(){const e=new oc;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",e=>Zn(e))}]}),e}_getTooltipString(e,t,r){return e?"string"==typeof e?e:(r&&(r=Zn(r)),e instanceof Function?e(t,r):`${t}${r?` (${r})`:""}`):""}}const Nc='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class Bc extends Lc{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Dc;return e.content=Nc,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}var Fc=i(1162);Pl()(Fc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Fc.Z.locals;class Vc extends oc{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new El,this.keystrokes=new vl,this._focusCycler=new yc({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class Uc extends oc{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class qc extends oc{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}var Hc=i(9681);Pl()(Hc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Hc.Z.locals;class Wc extends Lc{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new oc;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}function Gc({emitter:e,activator:t,callback:r,contextElements:n}){e.listenTo(document,"mousedown",(e,o)=>{if(!t())return;const i="function"==typeof o.composedPath?o.composedPath():[];for(const e of n)if(e.contains(o.target)||i.includes(e))return;r()})}var Zc=i(5075);Pl()(Zc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Zc.Z.locals;var Yc=i(6875);function $c(e,t=Bc){const r=new t(e),n=new Ec(e),o=new Oc(e,r,n);return r.bind("isEnabled").to(o),r instanceof Bc?r.bind("isOn").to(o,"isOpen"):r.arrowView.bind("isOn").to(o,"isOpen"),function(e){(function(e){e.on("render",()=>{Gc({emitter:e,activator:()=>e.isOpen,callback:()=>{e.isOpen=!1},contextElements:[e.element]})})})(e),function(e){e.on("execute",t=>{t.source instanceof Wc||(e.isOpen=!1)})}(e),function(e){e.keystrokes.set("arrowdown",(t,r)=>{e.isOpen&&(e.panelView.focus(),r())}),e.keystrokes.set("arrowup",(t,r)=>{e.isOpen&&(e.panelView.focusLast(),r())})}(e)}(o),o}function Kc(e,t){const r=e.locale,n=r.t,o=e.toolbarView=new Qc(r);o.set("ariaLabel",n("Dropdown toolbar")),e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map(e=>o.items.add(e)),e.panelView.children.add(o),o.items.delegate("execute").to(e)}function Xc(e,t){const r=e.locale,n=e.listView=new Vc(r);n.items.bindTo(t).using(({type:e,model:t})=>{if("separator"===e)return new qc(r);if("button"===e||"switchbutton"===e){const n=new Uc(r);let o;return o="button"===e?new Lc(r):new Wc(r),o.bind(...Object.keys(t)).to(t),o.delegate("execute").to(n),n.children.add(o),n}}),e.panelView.children.add(n),n.items.delegate("execute").to(e)}Pl()(Yc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Yc.Z.locals;var Jc=i(5571);Pl()(Jc.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Jc.Z.locals;class Qc extends oc{constructor(e,t){super(e);const r=this.bindTemplate,n=this.t;this.options=t||{},this.set("ariaLabel",n("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new El,this.keystrokes=new vl,this.set("class"),this.set("isCompact",!1),this.itemsView=new eu(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection(),this._focusCycler=new yc({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["arrowleft","arrowup"],focusNext:["arrowright","arrowdown"]}});const o=["ck","ck-toolbar",r.to("class"),r.if("isCompact","ck-toolbar_compact")];var i;this.options.shouldGroupWhenFull&&this.options.isFloating&&o.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:o,role:"toolbar","aria-label":r.to("ariaLabel"),style:{maxWidth:r.to("maxWidth")}},children:this.children,on:{mousedown:(i=this,i.bindTemplate.to(e=>{e.target===i.element&&e.preventDefault()}))}}),this._behavior=this.options.shouldGroupWhenFull?new ru(this):new tu(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t){const r=Tl(e),n=r.items.filter((e,n,o)=>"|"===e||-1===r.removeItems.indexOf(e)&&("-"===e?!this.options.shouldGroupWhenFull||(Ht("toolbarview-line-break-ignored-when-grouping-items",o),!1):!!t.has(e)||(Ht("toolbarview-item-unavailable",{name:e}),!1))),o=this._cleanSeparators(n).map(e=>"|"===e?new wc:"-"===e?new xc:t.create(e));this.items.addMany(o)}_cleanSeparators(e){const t=e=>"-"!==e&&"|"!==e,r=e.length,n=e.findIndex(t),o=r-e.slice().reverse().findIndex(t);return e.slice(n,o).filter((e,r,n)=>!!t(e)||!(r>0&&n[r-1]===e))}}class eu extends oc{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class tu{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(e=>e),e.focusables.bindTo(e.items).using(e=>e),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class ru{constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,e.itemsView.children.bindTo(this.ungroupedItems).using(e=>e),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("change",(e,t)=>{const r=t.index;for(const e of t.removed)r>=this.ungroupedItems.length?this.groupedItems.remove(e):this.ungroupedItems.remove(e);for(let e=r;e<r+t.added.length;e++){const n=t.added[e-r];e>this.ungroupedItems.length?this.groupedItems.add(n,e-this.ungroupedItems.length):this.ungroupedItems.add(n,e)}this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,r=new Di(e.lastChild),n=new Di(e);if(!this.cachedPadding){const r=Do.window.getComputedStyle(e),n="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(r[n])}return"ltr"===t?r.right>n.right-this.cachedPadding:r.left<n.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new kc(this.viewElement,t=>{e&&e===t.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new wc),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,r=$c(e);return r.class="ck-toolbar__grouped-dropdown",r.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",Kc(r,[]),r.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>'}),r.toolbarView.items.bindTo(this.groupedItems).using(e=>e),r}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}var nu=i(3638);Pl()(nu.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),nu.Z.locals;class ou extends hc{constructor(e,t,r={}){super(e),this.stickyPanel=new vc(e),this.toolbar=new Qc(e,{shouldGroupWhenFull:r.shouldToolbarGroupWhenFull}),this.editable=new fc(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class iu extends _l{constructor(e,t){super(t),jt(e)&&(this.sourceElement=e),this.model.document.createRoot();const r=!this.config.get("toolbar.shouldNotGroupWhenFull"),n=new ou(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:r});this.ui=new Rl(this,n),function(e){if(!O(e.updateSourceElement))throw new qt("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(t&&"textarea"===t.tagName.toLowerCase()&&t.form){let r;const n=t.form,o=()=>e.updateSourceElement();O(n.submit)&&(r=n.submit,n.submit=()=>{o(),r.apply(n)}),n.addEventListener("submit",o),e.on("destroy",()=>{n.removeEventListener("submit",o),r&&(n.submit=r)})}}(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(r=>{const n=new this(e,t);r(n.initPlugins().then(()=>n.ui.init(jt(e)?e:null)).then(()=>{if(!jt(e)&&t.initialData)throw new qt("editor-create-initial-data",null);const r=t.initialData||function(e){return jt(e)?(t=e)instanceof HTMLTextAreaElement?t.value:t.innerHTML:e;var t}(e);return n.data.init(r)}).then(()=>n.fire("ready")).then(()=>n))})}}ir(iu,wl),ir(iu,xl);class au{constructor(e){this.editor=e,this.set("isEnabled",!0),this._disableStack=new Set}forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",su,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),0==this._disableStack.size&&(this.off("set:isEnabled",su),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function su(e){e.return=!1,e.stop()}ir(au,fn);class lu{constructor(e){this.files=function(e){const t=e.files?Array.from(e.files):[],r=e.items?Array.from(e.items):[];return t.length?t:r.filter(e=>"file"===e.kind).map(e=>e.getAsFile())}(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}}class cu extends di{constructor(e){super(e);const t=this.document;function r(e,r){r.preventDefault();const n=r.dropRange?[r.dropRange]:Array.from(t.selection.getRanges()),o=new Bt(t,"clipboardInput");t.fire(o,{dataTransfer:r.dataTransfer,targetRanges:n}),o.stop.called&&r.stopPropagation()}this.domEventType=["paste","copy","cut","drop","dragover"],this.listenTo(t,"paste",r,{priority:"low"}),this.listenTo(t,"drop",r,{priority:"low"})}onDomEvent(e){const t={dataTransfer:new lu(e.clipboardData?e.clipboardData:e.dataTransfer)};"drop"==e.type&&(t.dropRange=function(e,t){const r=t.target.ownerDocument,n=t.clientX,o=t.clientY;let i;return r.caretRangeFromPoint&&r.caretRangeFromPoint(n,o)?i=r.caretRangeFromPoint(n,o):t.rangeParent&&(i=r.createRange(),i.setStart(t.rangeParent,t.rangeOffset),i.collapse(!0)),i?e.domConverter.domRangeToView(i):e.document.selection.getFirstRange()}(this.view,e)),this.fire(e.type,e,t)}}class uu extends au{static get pluginName(){return"PastePlainText"}init(){const e=this.editor.editing.view,t=e.document;let r=!1;e.addObserver(cu),this.listenTo(t,"keydown",(e,t)=>{r=t.shiftKey}),this.listenTo(t,"clipboardInput",(e,t)=>{r&&(t.asPlainText=!0)},{priority:"high"})}}const du=["figcaption","li"];class hu extends au{static get pluginName(){return"Clipboard"}static get requires(){return[uu]}init(){const e=this.editor,t=e.model.document,r=e.editing.view,n=r.document;function o(r,o){const i=o.dataTransfer;o.preventDefault();const a=e.data.toView(e.model.getSelectedContent(t.selection));n.fire("clipboardOutput",{dataTransfer:i,content:a,method:r.name})}r.addObserver(cu),this.listenTo(n,"clipboardInput",t=>{e.isReadOnly&&t.stop()},{priority:"highest"}),this.listenTo(n,"clipboardInput",(e,t)=>{const n=t.dataTransfer;let o="";var i;n.getData("text/html")?o=function(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>1==t.length?" ":t)}(n.getData("text/html")):n.getData("text/plain")&&(((i=(i=n.getData("text/plain")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).includes("</p><p>")||i.includes("<br>"))&&(i=`<p>${i}</p>`),o=i),o=this.editor.data.htmlProcessor.toView(o);const a=new Bt(this,"inputTransformation");this.fire(a,{content:o,dataTransfer:n,asPlainText:t.asPlainText}),a.stop.called&&e.stop(),r.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(e,t)=>{if(!t.content.isEmpty){const r=this.editor.data,n=this.editor.model,o=r.toModel(t.content,"$clipboardHolder");if(0==o.childCount)return;n.change(e=>{const r=n.document.selection;if(t.asPlainText||function(e,t){if(e.childCount>1)return!1;const r=e.getChild(0);return!t.isObject(r)&&0==[...r.getAttributeKeys()].length}(o,n.schema)){const t=Array.from(r.getAttributes()).filter(([e])=>n.schema.getAttributeProperties(e).isFormatting);r.isCollapsed||n.deleteContent(r,{doNotAutoparagraph:!0}),t.push(...r.getAttributes());const i=e.createRangeIn(o);for(const r of i.getItems())(r.is("$text")||r.is("$textProxy"))&&e.setAttributes(t,r)}n.insertContent(o)}),e.stop()}},{priority:"low"}),this.listenTo(n,"copy",o,{priority:"low"}),this.listenTo(n,"cut",(t,r)=>{e.isReadOnly?r.preventDefault():o(t,r)},{priority:"low"}),this.listenTo(n,"clipboardOutput",(r,n)=>{n.content.isEmpty||(n.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(n.content)),n.dataTransfer.setData("text/plain",function e(t){let r="";if(t.is("$text")||t.is("$textProxy"))r=t.data;else if(t.is("element","img")&&t.hasAttribute("alt"))r=t.getAttribute("alt");else if(t.is("element","br"))r="\n";else{let n=null;for(const o of t.getChildren()){const t=e(o);n&&(n.is("containerElement")||o.is("containerElement"))&&(du.includes(n.name)||du.includes(o.name)?r+="\n":r+="\n\n"),r+=t,n=o}}return r}(n.content))),"cut"==n.method&&e.model.deleteContent(t.selection)},{priority:"low"})}}class pu{constructor(e){this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.on("execute",e=>{this.isEnabled||e.stop()},{priority:"high"}),this.listenTo(e,"change:isReadOnly",(e,t,r)=>{r?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",fu,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),0==this._disableStack.size&&(this.off("set:isEnabled",fu),this.refresh())}execute(){}destroy(){this.stopListening()}}function fu(e){e.return=!1,e.stop()}function*mu(e,t){for(const r of t)r&&e.getAttributeProperties(r[0]).copyOnEnter&&(yield r)}ir(pu,fn);class gu extends pu{execute(){const e=this.editor.model,t=e.document;e.change(r=>{!function(e,t,r,n){const o=r.isCollapsed,i=r.getFirstRange(),a=i.start.parent,s=i.end.parent;if(n.isLimit(a)||n.isLimit(s))o||a!=s||e.deleteContent(r);else if(o){const e=mu(t.model.schema,r.getAttributes());bu(t,i.start),t.setSelectionAttribute(e)}else{const n=!(i.start.isAtStart&&i.end.isAtEnd),o=a==s;e.deleteContent(r,{leaveUnmerged:n}),n&&(o?bu(t,r.focus):t.setSelection(s,0))}}(this.editor.model,r,t.selection,e.schema),this.fire("afterExecute",{writer:r})})}}function bu(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}class vu extends Wo{constructor(e){super(e);const t=this.document;t.on("keydown",(e,r)=>{if(this.isEnabled&&r.keyCode==Hn.enter){let n;t.once("enter",e=>n=e,{priority:"highest"}),t.fire("enter",new ui(t,r.domEvent,{isSoft:r.shiftKey})),n&&n.stop.called&&e.stop()}})}observe(){}}class yu extends au{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,r=t.document;t.addObserver(vu),e.commands.add("enter",new gu(e)),this.listenTo(r,"enter",(r,n)=>{n.preventDefault(),n.isSoft||(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"})}}class _u extends pu{execute(){const e=this.editor.model,t=e.document;e.change(r=>{!function(e,t,r){const n=r.isCollapsed,o=r.getFirstRange(),i=o.start.parent,a=o.end.parent,s=i==a;if(n){const n=mu(e.schema,r.getAttributes());wu(e,t,o.end),t.removeSelectionAttribute(r.getAttributeKeys()),t.setSelectionAttribute(n)}else{const n=!(o.start.isAtStart&&o.end.isAtEnd);e.deleteContent(r,{leaveUnmerged:n}),s?wu(e,t,r.focus):n&&t.setSelection(a,0)}}(e,r,t.selection),this.fire("afterExecute",{writer:r})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=function(e,t){if(t.rangeCount>1)return!1;const r=t.anchor;if(!r||!e.checkChild(r,"softBreak"))return!1;const n=t.getFirstRange(),o=n.start.parent,i=n.end.parent;return!xu(o,e)&&!xu(i,e)||o===i}(e.schema,t.selection)}}function wu(e,t,r){const n=t.createElement("softBreak");e.insertContent(n,r),t.setSelection(n,"after")}function xu(e,t){return!e.is("rootElement")&&(t.isLimit(e)||xu(e.parent,t))}class ku extends au{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,r=e.conversion,n=e.editing.view,o=n.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),r.for("upcast").elementToElement({model:"softBreak",view:"br"}),r.for("downcast").elementToElement({model:"softBreak",view:(e,{writer:t})=>t.createEmptyElement("br")}),n.addObserver(vu),e.commands.add("shiftEnter",new _u(e)),this.listenTo(o,"enter",(t,r)=>{r.preventDefault(),r.isSoft&&(e.execute("shiftEnter"),n.scrollToTheSelection())},{priority:"low"})}}class Cu extends pu{execute(){const e=this.editor.model,t=e.document.selection;let r=e.schema.getLimitElement(t);if(t.containsEntireContent(r)||!Eu(e.schema,r))do{if(r=r.parent,!r)return}while(!Eu(e.schema,r));e.change(e=>{e.setSelection(r,"in")})}}function Eu(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}const Su=Gn("Ctrl+A");class Tu extends au{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,t=e.editing.view.document;e.commands.add("selectAll",new Cu(e)),this.listenTo(t,"keydown",(t,r)=>{Wn(r)===Su&&(e.execute("selectAll"),r.preventDefault())})}}class Au extends au{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",t=>{const r=e.commands.get("selectAll"),n=new Lc(t),o=t.t;return n.set({label:o("Select all"),icon:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',keystroke:"Ctrl+A",tooltip:!0}),n.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(n,"execute",()=>{e.execute("selectAll"),e.editing.view.focus()}),n})}}class Pu extends au{static get requires(){return[Tu,Au]}static get pluginName(){return"SelectAll"}}class Iu{constructor(e,t=20){this.model=e,this.size=0,this.limit=t,this.isLocked=!1,this._changeCallback=(e,t)=>{"transparent"!=t.type&&t!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){this.isLocked&&!e||(this._batch=null,this.size=0)}}class Ou extends pu{constructor(e,t){super(e),this._buffer=new Iu(e.model,t),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,r=t.document,n=e.text||"",o=n.length,i=e.range?t.createSelection(e.range):r.selection,a=e.resultRange;t.enqueueChange(this._buffer.batch,e=>{this._buffer.lock(),this._batches.add(this._buffer.batch),t.deleteContent(i),n&&t.insertContent(e.createText(n,r.selection.getAttributes()),i),a?e.setSelection(a):i.is("documentSelection")||e.setSelection(i),this._buffer.unlock(),this._buffer.input(o)})}}const Mu=[Wn("arrowUp"),Wn("arrowRight"),Wn("arrowDown"),Wn("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let e=112;e<=135;e++)Mu.push(e);function Du(e){return!!e.ctrlKey||Mu.includes(e.keyCode)}function zu(e){if(e.newChildren.length-e.oldChildren.length!=1)return;const t=function(e,t){const r=[];let n,o=0;return e.forEach(e=>{"equal"==e?(i(),o++):"insert"==e?(a("insert")?n.values.push(t[o]):(i(),n={type:"insert",index:o,values:[t[o]]}),o++):a("delete")?n.howMany++:(i(),n={type:"delete",index:o,howMany:1})}),i(),r;function i(){n&&(r.push(n),n=null)}function a(e){return n&&n.type==e}}(Eo(e.oldChildren,e.newChildren,ju),e.newChildren);if(t.length>1)return;const r=t[0];return r.values[0]&&r.values[0].is("$text")?r:void 0}function ju(e,t){return e&&e.is("$text")&&t&&t.is("$text")?e.data===t.data:e===t}class Ru{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,t){if(function(e){if(0==e.length)return!1;for(const t of e)if("children"===t.type&&!zu(t))return!0;return!1}(e))this._handleContainerChildrenMutations(e,t);else for(const r of e)this._handleTextMutation(r,t),this._handleTextNodeInsertion(r)}_handleContainerChildrenMutations(e,t){const r=function(e){const t=e.map(e=>e.node).reduce((e,t)=>e.getCommonAncestor(t,{includeSelf:!0}));if(t)return t.getAncestors({includeSelf:!0,parentFirst:!0}).find(e=>e.is("containerElement")||e.is("rootElement"))}(e);if(!r)return;const n=this.editor.editing.view.domConverter.mapViewToDom(r),o=new Lo(this.editor.editing.view.document),i=this.editor.data.toModel(o.domToView(n)).getChild(0),a=this.editor.editing.mapper.toModelElement(r);if(!a)return;const s=Array.from(i.getChildren()),l=Array.from(a.getChildren()),c=s[s.length-1],u=l[l.length-1],d=c&&c.is("element","softBreak"),h=u&&!u.is("element","softBreak");d&&h&&s.pop();const p=this.editor.model.schema;if(!Lu(s,p)||!Lu(l,p))return;const f=s.map(e=>e.is("$text")?e.data:"@").join("").replace(/\u00A0/g," "),m=l.map(e=>e.is("$text")?e.data:"@").join("").replace(/\u00A0/g," ");if(m===f)return;const g=Eo(m,f),{firstChangeAt:b,insertions:v,deletions:y}=Nu(g);let _=null;t&&(_=this.editing.mapper.toModelRange(t.getFirstRange()));const w=f.substr(b,v),x=this.editor.model.createRange(this.editor.model.createPositionAt(a,b),this.editor.model.createPositionAt(a,b+y));this.editor.execute("input",{text:w,range:x,resultRange:_})}_handleTextMutation(e,t){if("text"!=e.type)return;const r=e.newText.replace(/\u00A0/g," "),n=e.oldText.replace(/\u00A0/g," ");if(n===r)return;const o=Eo(n,r),{firstChangeAt:i,insertions:a,deletions:s}=Nu(o);let l=null;t&&(l=this.editing.mapper.toModelRange(t.getFirstRange()));const c=this.editing.view.createPositionAt(e.node,i),u=this.editing.mapper.toModelPosition(c),d=this.editor.model.createRange(u,u.getShiftedBy(s)),h=r.substr(i,a);this.editor.execute("input",{text:h,range:d,resultRange:l})}_handleTextNodeInsertion(e){if("children"!=e.type)return;const t=zu(e),r=this.editing.view.createPositionAt(e.node,t.index),n=this.editing.mapper.toModelPosition(r),o=t.values[0].data;this.editor.execute("input",{text:o.replace(/\u00A0/g," "),range:this.editor.model.createRange(n)})}}function Lu(e,t){return e.every(e=>t.isInline(e))}function Nu(e){let t=null,r=null;for(let n=0;n<e.length;n++)"equal"!=e[n]&&(t=null===t?n:t,r=n);let n=0,o=0;for(let i=t;i<=r;i++)"insert"!=e[i]&&n++,"delete"!=e[i]&&o++;return{insertions:o,deletions:n,firstChangeAt:t}}class Bu extends au{static get pluginName(){return"Input"}init(){const e=this.editor,t=new Ou(e,e.config.get("typing.undoStep")||20);e.commands.add("input",t),function(e){let t=null;const r=e.model,n=e.editing.view,o=e.commands.get("input");function i(e){const i=r.document,s=n.document.isComposing,l=t&&t.isEqual(i.selection);t=null,o.isEnabled&&(Du(e)||i.selection.isCollapsed||s&&229===e.keyCode||!s&&229===e.keyCode&&l||a())}function a(){const e=o.buffer;e.lock();const t=e.batch;o._batches.add(t),r.enqueueChange(t,()=>{r.deleteContent(r.document.selection)}),e.unlock()}Fn?n.document.on("beforeinput",(e,t)=>i(t),{priority:"lowest"}):n.document.on("keydown",(e,t)=>i(t),{priority:"lowest"}),n.document.on("compositionstart",(function(){const e=r.document,t=1!==e.selection.rangeCount||e.selection.getFirstRange().isFlat;e.selection.isCollapsed||t||a()}),{priority:"lowest"}),n.document.on("compositionend",()=>{t=r.createSelection(r.document.selection)},{priority:"lowest"})}(e),function(e){e.editing.view.document.on("mutations",(t,r,n)=>{new Ru(e).handle(r,n)})}(e)}isInput(e){return this.editor.commands.get("input")._batches.has(e)}}class Fu extends pu{constructor(e,t){super(e),this.direction=t,this._buffer=new Iu(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,r=t.document;t.enqueueChange(this._buffer.batch,n=>{this._buffer.lock();const o=n.createSelection(e.selection||r.selection),i=e.sequence||1,a=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(i))return void this._replaceEntireContentWithParagraph(n);if(this._shouldReplaceFirstBlockWithParagraph(o,i))return void this.editor.execute("paragraph",{selection:o});if(o.isCollapsed)return;let s=0;o.getFirstRange().getMinimalFlatRanges().forEach(e=>{s+=Tn(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:a,direction:this.direction}),this._buffer.input(s),n.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,r=t.document.selection,n=t.schema.getLimitElement(r);if(!r.isCollapsed||!r.containsEntireContent(n))return!1;if(!t.schema.checkChild(n,"paragraph"))return!1;const o=n.getChild(0);return!o||"paragraph"!==o.name}_replaceEntireContentWithParagraph(e){const t=this.editor.model,r=t.document.selection,n=t.schema.getLimitElement(r),o=e.createElement("paragraph");e.remove(e.createRangeIn(n)),e.insert(o,n),e.setSelection(o,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const r=this.editor.model;if(t>1||"backward"!=this.direction)return!1;if(!e.isCollapsed)return!1;const n=e.getFirstPosition(),o=r.schema.getLimitElement(n),i=o.getChild(0);return n.parent==i&&!!e.containsEntireContent(i)&&!!r.schema.checkChild(o,"paragraph")&&"paragraph"!=i.name}}class Vu extends Wo{constructor(e){super(e);const t=e.document;let r=0;function n(e,r,n){let o;t.once("delete",e=>o=e,{priority:Number.POSITIVE_INFINITY}),t.fire("delete",new ui(t,r,n)),o&&o.stop.called&&e.stop()}t.on("keyup",(e,t)=>{t.keyCode!=Hn.delete&&t.keyCode!=Hn.backspace||(r=0)}),t.on("keydown",(e,t)=>{const o={};if(t.keyCode==Hn.delete)o.direction="forward",o.unit="character";else{if(t.keyCode!=Hn.backspace)return;o.direction="backward",o.unit="codePoint"}const i=Ln?t.altKey:t.ctrlKey;o.unit=i?"word":o.unit,o.sequence=++r,n(e,t.domEvent,o)}),Fn&&t.on("beforeinput",(t,r)=>{if("deleteContentBackward"!=r.domEvent.inputType)return;const o={unit:"codepoint",direction:"backward",sequence:1},i=r.domTarget.ownerDocument.defaultView.getSelection();i.anchorNode==i.focusNode&&i.anchorOffset+1!=i.focusOffset&&(o.selectionToRemove=e.domConverter.domSelectionToView(i)),n(t,r.domEvent,o)})}observe(){}}class Uu extends au{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,r=t.document;if(t.addObserver(Vu),e.commands.add("forwardDelete",new Fu(e,"forward")),e.commands.add("delete",new Fu(e,"backward")),this.listenTo(r,"delete",(r,n)=>{const o={unit:n.unit,sequence:n.sequence};if(n.selectionToRemove){const t=e.model.createSelection(),r=[];for(const t of n.selectionToRemove.getRanges())r.push(e.editing.mapper.toModelRange(t));t.setTo(r),o.selection=t}e.execute("forward"==n.direction?"forwardDelete":"delete",o),n.preventDefault(),t.scrollToTheSelection()}),Fn){let e=null;this.listenTo(r,"delete",(t,r)=>{const n=r.domTarget.ownerDocument.defaultView.getSelection();e={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}},{priority:"lowest"}),this.listenTo(r,"keyup",(t,r)=>{if(e){const t=r.domTarget.ownerDocument.defaultView.getSelection();t.collapse(e.anchorNode,e.anchorOffset),t.extend(e.focusNode,e.focusOffset),e=null}})}}}class qu extends au{static get requires(){return[Bu,Uu]}static get pluginName(){return"Typing"}}const Hu=new Map;function Wu(e,t,r){let n=Hu.get(e);n||(n=new Map,Hu.set(e,n)),n.set(t,r)}function Gu(e){return[e]}function Zu(e,t,r={}){const n=function(e,t){const r=Hu.get(e);return r&&r.has(t)?r.get(t):Gu}(e.constructor,t.constructor);try{return n(e=e.clone(),t,r)}catch(e){throw e}}function Yu(e,t,r){e=e.slice(),t=t.slice();const n=new $u(r.document,r.useRelations,r.forceWeakRemove);n.setOriginalOperations(e),n.setOriginalOperations(t);const o=n.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:o};const i=new WeakMap;for(const t of e)i.set(t,0);const a={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let s=0;for(;s<e.length;){const r=e[s],o=i.get(r);if(o==t.length){s++;continue}const a=t[o],l=Zu(r,a,n.getContext(r,a,!0)),c=Zu(a,r,n.getContext(a,r,!1));n.updateRelation(r,a),n.setOriginalOperations(l,r),n.setOriginalOperations(c,a);for(const e of l)i.set(e,o+c.length);e.splice(s,1,...l),t.splice(o,1,...c)}if(r.padWithNoOps){const r=e.length-a.originalOperationsACount,n=t.length-a.originalOperationsBCount;Xu(e,n-r),Xu(t,r-n)}return Ku(e,a.nextBaseVersionB),Ku(t,a.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:o}}class $u{constructor(e,t,r=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!r,this._relations=new Map}setOriginalOperations(e,t=null){const r=t?this.originalOperations.get(t):null;for(const t of e)this.originalOperations.set(t,r||t)}updateRelation(e,t){switch(e.constructor){case Ss:switch(t.constructor){case Os:e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter");break;case Ss:e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter")}break;case Ms:switch(t.constructor){case Os:e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");break;case Ss:(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))&&this._setRelation(e,t,"splitBefore")}break;case Os:switch(t.constructor){case Os:e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement");break;case Ms:e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource")}break;case As:{const r=e.newRange;if(!r)return;switch(t.constructor){case Ss:{const n=oa._createFromPositionAndShift(t.sourcePosition,t.howMany),o=n.containsPosition(r.start)||n.start.isEqual(r.start),i=n.containsPosition(r.end)||n.end.isEqual(r.end);!o&&!i||n.containsRange(r)||this._setRelation(e,t,{side:o?"left":"right",path:o?r.start.path.slice():r.end.path.slice()});break}case Os:{const n=r.start.isEqual(t.targetPosition),o=r.start.isEqual(t.deletionPosition),i=r.end.isEqual(t.deletionPosition),a=r.end.isEqual(t.sourcePosition);(n||o||i||a)&&this._setRelation(e,t,{wasInLeftElement:n,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:i,wasInRightElement:a});break}}break}}}getContext(e,t,r){return{aIsStrong:r,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const r=this.originalOperations.get(t),n=this._history.getUndoneOperation(r);if(!n)return null;const o=this.originalOperations.get(e),i=this._relations.get(o);return i&&i.get(n)||null}_setRelation(e,t,r){const n=this.originalOperations.get(e),o=this.originalOperations.get(t);let i=this._relations.get(n);i||(i=new Map,this._relations.set(n,i)),i.set(o,r)}}function Ku(e,t){for(const r of e)r.baseVersion=t++}function Xu(e,t){for(let r=0;r<t;r++)e.push(new Js(0))}function Ju(e,t,r){const n=e.nodes.getNode(0).getAttribute(t);if(n==r)return null;const o=new oa(e.position,e.position.getShiftedBy(e.howMany));return new Cs(o,t,n,r,0)}function Qu(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function ed(e,t){const r=[];for(let n=0;n<e.length;n++){const o=e[n],i=new Ss(o.start,o.end.offset-o.start.offset,t,0);r.push(i);for(let t=n+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany)[0];t=t._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany)}return r}Wu(Cs,Cs,(e,t,r)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const n=e.range.getDifference(t.range).map(t=>new Cs(t,e.key,e.oldValue,e.newValue,0)),o=e.range.getIntersection(t.range);return o&&r.aIsStrong&&n.push(new Cs(o,t.key,t.newValue,e.newValue,0)),0==n.length?[new Js(0)]:n}return[e]}),Wu(Cs,Ts,(e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const r=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(t=>new Cs(t,e.key,e.oldValue,e.newValue,e.baseVersion));if(t.shouldReceiveAttributes){const n=Ju(t,e.key,e.oldValue);n&&r.unshift(n)}return r}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]}),Wu(Cs,Os,(e,t)=>{const r=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&r.push(oa._createFromPositionAndShift(t.graveyardPosition,1));const n=e.range._getTransformedByMergeOperation(t);return n.isCollapsed||r.push(n),r.map(t=>new Cs(t,e.key,e.oldValue,e.newValue,e.baseVersion))}),Wu(Cs,Ss,(e,t)=>function(e,t){const r=oa._createFromPositionAndShift(t.sourcePosition,t.howMany);let n=null,o=[];r.containsRange(e,!0)?n=e:e.start.hasSameParentAs(r.start)?(o=e.getDifference(r),n=e.getIntersection(r)):o=[e];const i=[];for(let e of o){e=e._getTransformedByDeletion(t.sourcePosition,t.howMany);const r=t.getMovedRangeStart(),n=e.start.hasSameParentAs(r);e=e._getTransformedByInsertion(r,t.howMany,n),i.push(...e)}return n&&i.push(n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),i}(e.range,t).map(t=>new Cs(t,e.key,e.oldValue,e.newValue,e.baseVersion))),Wu(Cs,Ms,(e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const r=e.clone();return r.range=new oa(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,r]}return e.range=e.range._getTransformedBySplitOperation(t),[e]}),Wu(Ts,Cs,(e,t)=>{const r=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const n=Ju(e,t.key,t.newValue);n&&r.push(n)}return r}),Wu(Ts,Ts,(e,t,r)=>(e.position.isEqual(t.position)&&r.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e])),Wu(Ts,Ss,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),Wu(Ts,Ms,(e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e])),Wu(Ts,Os,(e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e])),Wu(As,Ts,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e])),Wu(As,As,(e,t,r)=>{if(e.name==t.name){if(!r.aIsStrong)return[new Js(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]}),Wu(As,Os,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e])),Wu(As,Ss,(e,t,r)=>{if(e.oldRange&&(e.oldRange=oa._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){if(r.abRelation){const n=oa._createFromRanges(e.newRange._getTransformedByMoveOperation(t));if("left"==r.abRelation.side&&t.targetPosition.isEqual(e.newRange.start))return e.newRange.start.path=r.abRelation.path,e.newRange.end=n.end,[e];if("right"==r.abRelation.side&&t.targetPosition.isEqual(e.newRange.end))return e.newRange.start=n.start,e.newRange.end.path=r.abRelation.path,[e]}e.newRange=oa._createFromRanges(e.newRange._getTransformedByMoveOperation(t))}return[e]}),Wu(As,Ms,(e,t,r)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(r.abRelation){const n=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&r.abRelation.wasStartBeforeMergedElement?e.newRange.start=ea._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!r.abRelation.wasInLeftElement&&(e.newRange.start=ea._createAt(t.moveTargetPosition)),e.newRange.end.isEqual(t.splitPosition)&&r.abRelation.wasInRightElement?e.newRange.end=ea._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&r.abRelation.wasEndBeforeMergedElement?e.newRange.end=ea._createAt(t.insertionPosition):e.newRange.end=n.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]}),Wu(Os,Ts,(e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e])),Wu(Os,Os,(e,t,r)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(r.bWasUndone){const r=t.graveyardPosition.path.slice();return r.push(0),e.sourcePosition=new ea(t.graveyardPosition.root,r),e.howMany=0,[e]}return[new Js(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!r.bWasUndone&&"splitAtSource"!=r.abRelation){const n="$graveyard"==e.targetPosition.root.rootName,o="$graveyard"==t.targetPosition.root.rootName,i=n&&!o;if(o&&!n||!i&&r.aIsStrong){const r=t.targetPosition._getTransformedByMergeOperation(t),n=e.targetPosition._getTransformedByMergeOperation(t);return[new Ss(r,e.howMany,n,0)]}return[new Js(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&r.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),Wu(Os,Ss,(e,t,r)=>{const n=oa._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!r.bWasUndone&&!r.forceWeakRemove&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.sourcePosition)?[new Js(0)]:(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])}),Wu(Os,Ms,(e,t,r)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){const n=0!=t.howMany,o=t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition);if(n||o||"mergeTargetNotMoved"==r.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==r.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==r.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}),Wu(Ss,Ts,(e,t)=>{const r=oa._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=r.start,e.howMany=r.end.offset-r.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]}),Wu(Ss,Ss,(e,t,r)=>{const n=oa._createFromPositionAndShift(e.sourcePosition,e.howMany),o=oa._createFromPositionAndShift(t.sourcePosition,t.howMany);let i,a=r.aIsStrong,s=!r.aIsStrong;if("insertBefore"==r.abRelation||"insertAfter"==r.baRelation?s=!0:"insertAfter"!=r.abRelation&&"insertBefore"!=r.baRelation||(s=!1),i=e.targetPosition.isEqual(t.targetPosition)&&s?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Qu(e,t)&&Qu(t,e))return[t.getReversed()];if(n.containsPosition(t.targetPosition)&&n.containsRange(o,!0))return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),ed([n],i);if(o.containsPosition(e.targetPosition)&&o.containsRange(n,!0))return n.start=n.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),n.end=n.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),ed([n],i);const l=pr(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),ed([n],i);"remove"!=e.type||"remove"==t.type||r.aWasUndone||r.forceWeakRemove?"remove"==e.type||"remove"!=t.type||r.bWasUndone||r.forceWeakRemove||(a=!1):a=!0;const c=[],u=n.getDifference(o);for(const e of u){e.start=e.start._getTransformedByDeletion(t.sourcePosition,t.howMany),e.end=e.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const r="same"==pr(e.start.getParentPath(),t.getMovedRangeStart().getParentPath()),n=e._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,r);c.push(...n)}const d=n.getIntersection(o);return null!==d&&a&&(d.start=d.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),d.end=d.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===c.length?c.push(d):1==c.length?o.start.isBefore(n.start)||o.start.isEqual(n.start)?c.unshift(d):c.push(d):c.splice(1,0,d)),0===c.length?[new Js(e.baseVersion)]:ed(c,i)}),Wu(Ss,Ms,(e,t,r)=>{let n=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=r.abRelation||(n=e.targetPosition._getTransformedBySplitOperation(t));const o=oa._createFromPositionAndShift(e.sourcePosition,e.howMany);if(o.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=n,[e];if(o.start.hasSameParentAs(t.splitPosition)&&o.containsPosition(t.splitPosition)){let e=new oa(t.splitPosition,o.end);return e=e._getTransformedBySplitOperation(t),ed([new oa(o.start,t.splitPosition),e],n)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==r.abRelation&&(n=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==r.abRelation&&(n=e.targetPosition);const i=[o._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const n=o.start.isEqual(t.graveyardPosition)||o.containsPosition(t.graveyardPosition);e.howMany>1&&n&&!r.aWasUndone&&i.push(oa._createFromPositionAndShift(t.insertionPosition,1))}return ed(i,n)}),Wu(Ss,Os,(e,t,r)=>{const n=oa._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.sourcePosition))if("remove"!=e.type||r.forceWeakRemove){if(1==e.howMany)return r.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new Js(0)]}else if(!r.aWasUndone){const r=[];let n=t.graveyardPosition.clone(),o=t.targetPosition._getTransformedByMergeOperation(t);e.howMany>1&&(r.push(new Ss(e.sourcePosition,e.howMany-1,e.targetPosition,0)),n=n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1),o=o._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1));const i=t.deletionPosition._getCombined(e.sourcePosition,e.targetPosition),a=new Ss(n,1,i,0),s=a.getMovedRangeStart().path.slice();s.push(0);const l=new ea(a.targetPosition.root,s);o=o._getTransformedByMove(n,i,1);const c=new Ss(o,t.howMany,l,0);return r.push(a),r.push(c),r}const o=oa._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=o.start,e.howMany=o.end.offset-o.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]}),Wu(Ps,Ts,(e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e])),Wu(Ps,Os,(e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e])),Wu(Ps,Ss,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),Wu(Ps,Ps,(e,t,r)=>{if(e.position.isEqual(t.position)){if(!r.aIsStrong)return[new Js(0)];e.oldName=t.newName}return[e]}),Wu(Ps,Ms,(e,t)=>{if("same"==pr(e.position.path,t.splitPosition.getParentPath())&&!t.graveyardPosition){const t=new Ps(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]}),Wu(Is,Is,(e,t,r)=>{if(e.root===t.root&&e.key===t.key){if(!r.aIsStrong||e.newValue===t.newValue)return[new Js(0)];e.oldValue=t.newValue}return[e]}),Wu(Ms,Ts,(e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),[e])),Wu(Ms,Os,(e,t,r)=>{if(!e.graveyardPosition&&!r.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const r=t.graveyardPosition.path.slice();r.push(0);const n=new ea(t.graveyardPosition.root,r),o=Ms.getInsertionPosition(new ea(t.graveyardPosition.root,r)),i=new Ms(n,0,null,0);return i.insertionPosition=o,e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),e.graveyardPosition=i.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[i,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),Wu(Ms,Ss,(e,t,r)=>{const n=oa._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const o=n.start.isEqual(e.graveyardPosition)||n.containsPosition(e.graveyardPosition);if(!r.bWasUndone&&o){const r=e.splitPosition._getTransformedByMoveOperation(t),n=e.graveyardPosition._getTransformedByMoveOperation(t),o=n.path.slice();o.push(0);const i=new ea(n.root,o);return[new Ss(r,e.howMany,i,0)]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const r=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=r,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),[e]}return!e.splitPosition.isEqual(t.targetPosition)||"insertAtSource"!=r.baRelation&&"splitBefore"!=r.abRelation?(t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),[e]):(e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),[e])}),Wu(Ms,Ms,(e,t,r)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new Js(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new Js(0)];if("splitBefore"==r.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const n="$graveyard"==e.splitPosition.root.rootName,o="$graveyard"==t.splitPosition.root.rootName,i=n&&!o;if(o&&!n||!i&&r.aIsStrong){const r=[];return t.howMany&&r.push(new Ss(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&r.push(new Ss(e.splitPosition,e.howMany,e.moveTargetPosition,0)),r}return[new Js(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==r.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==r.baRelation){const r=t.insertionPosition.path.slice();r.push(0);const n=new ea(t.insertionPosition.root,r);return[e,new Ss(e.insertionPosition,1,n,0)]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=Ms.getInsertionPosition(e.splitPosition),[e]});class td extends pu{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(e.data,"set",()=>this.clearStack())}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const t=this.editor.model.document.selection,r={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:r}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,r){const n=this.editor.model,o=n.document,i=[],a=e.map(e=>e.getTransformedByOperations(r)),s=a.flat();for(const e of a){const t=e.filter(e=>e.root!=o.graveyard).filter(e=>!nd(e,s));t.length&&(rd(t),i.push(t[0]))}i.length&&n.change(e=>{e.setSelection(i,{backward:t})})}_undo(e,t){const r=this.editor.model,n=r.document;this._createdBatches.add(t);const o=e.operations.slice().filter(e=>e.isDocumentOperation);o.reverse();for(const e of o){const o=e.baseVersion+1,i=Array.from(n.history.getOperations(o)),a=Yu([e.getReversed()],i,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const o of a)t.addOperation(o),r.applyOperation(o),n.history.setOperationAsUndone(e,o)}}}function rd(e){e.sort((e,t)=>e.start.isBefore(t.start)?-1:1);for(let t=1;t<e.length;t++){const r=e[t-1].getJoined(e[t],!0);r&&(t--,e.splice(t,2,r))}}function nd(e,t){return t.some(t=>t!==e&&t.containsRange(e,!0))}class od extends td{execute(e=null){const t=e?this._stack.findIndex(t=>t.batch==e):this._stack.length-1,r=this._stack.splice(t,1)[0],n=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(n,()=>{this._undo(r.batch,n);const e=this.editor.model.document.history.getOperations(r.batch.baseVersion);this._restoreSelection(r.selection.ranges,r.selection.isBackward,e),this.fire("revert",r.batch,n)}),this.refresh()}}class id extends td{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(t,()=>{const r=e.batch.operations[e.batch.operations.length-1].baseVersion+1,n=this.editor.model.document.history.getOperations(r);this._restoreSelection(e.selection.ranges,e.selection.isBackward,n),this._undo(e.batch,t)}),this.refresh()}}class ad extends au{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new od(e),this._redoCommand=new id(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(e,t)=>{const r=t[0];if(!r.isDocumentOperation)return;const n=r.batch,o=this._redoCommand._createdBatches.has(n),i=this._undoCommand._createdBatches.has(n);this._batchRegistry.has(n)||"transparent"==n.type&&!o&&!i||(o?this._undoCommand.addBatch(n):i||(this._undoCommand.addBatch(n),this._redoCommand.clearStack()),this._batchRegistry.add(n))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(e,t,r)=>{this._redoCommand.addBatch(r)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}const sd='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',ld='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class cd extends au{init(){const e=this.editor,t=e.locale,r=e.t,n="ltr"==t.uiLanguageDirection?sd:ld,o="ltr"==t.uiLanguageDirection?ld:sd;this._addButton("undo",r("Undo"),"CTRL+Z",n),this._addButton("redo",r("Redo"),"CTRL+Y",o)}_addButton(e,t,r,n){const o=this.editor;o.ui.componentFactory.add(e,i=>{const a=o.commands.get(e),s=new Lc(i);return s.set({label:t,icon:n,keystroke:r,tooltip:!0}),s.bind("isEnabled").to(a,"isEnabled"),this.listenTo(s,"execute",()=>{o.execute(e),o.editing.view.focus()}),s})}}class ud extends au{static get requires(){return[ad,cd]}static get pluginName(){return"Undo"}}class dd{constructor(e){this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}ir(dd,fn);class hd extends dd{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new ar({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if("string"!=typeof e)throw new qt("pendingactions-add-invalid-message",this);const t=Object.create(fn);return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}class pd{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=e=>{this.loaded=e.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise((r,n)=>{t.onload=()=>{const e=t.result;this._data=e,r(e)},t.onerror=()=>{n("error")},t.onabort=()=>{n("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}}ir(pd,fn);class fd extends au{static get pluginName(){return"FileRepository"}static get requires(){return[hd]}init(){this.loaders=new ar,this.loaders.on("add",()=>this._updatePendingAction()),this.loaders.on("remove",()=>this._updatePendingAction()),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,t)=>t?e/t*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return Ht("filerepository-no-upload-adapter"),null;const t=new md(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then(e=>{this._loadersMap.set(e,t)}).catch(()=>{}),t.on("change:uploaded",()=>{let e=0;for(const t of this.loaders)e+=t.uploaded;this.uploaded=e}),t.on("change:uploadTotal",()=>{let e=0;for(const t of this.loaders)t.uploadTotal&&(e+=t.uploadTotal);this.uploadTotal=e}),t}destroyLoader(e){const t=e instanceof md?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach((e,r)=>{e===t&&this._loadersMap.delete(r)})}_updatePendingAction(){const e=this.editor.plugins.get(hd);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,r=e=>`${t("Upload in progress")} ${parseInt(e)}%.`;this._pendingAction=e.add(r(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",r)}}else e.remove(this._pendingAction),this._pendingAction=null}}ir(fd,fn);class md{constructor(e,t){this.id=Vt(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new pd,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,t)=>t?e/t*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new qt("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>{if("reading"!==this.status)throw this.status;return this.status="idle",e}).catch(e=>{if("aborted"===e)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:e})}upload(){if("idle"!=this.status)throw new qt("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{if("aborted"===this.status)throw"aborted";throw this.status="error",e})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise((r,n)=>{t.rejecter=n,t.isFulfilled=!1,e.then(e=>{t.isFulfilled=!0,r(e)}).catch(e=>{t.isFulfilled=!0,n(e)})}),t}}ir(md,fn);const gd="ckCsrfToken",bd="abcdefghijklmnopqrstuvwxyz0123456789";class vd extends au{static get requires(){return[fd]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(fd).createUploadAdapter=t=>new yd(t,e,this.editor.t))}}class yd{constructor(e,t,r){this.loader=e,this.url=t,this.t=r}upload(){return this.loader.file.then(e=>new Promise((t,r)=>{this._initRequest(),this._initListeners(t,r,e),this._sendRequest(e)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,t,r){const n=this.xhr,o=this.loader,i=(0,this.t)("Cannot upload file:")+` ${r.name}.`;n.addEventListener("error",()=>t(i)),n.addEventListener("abort",()=>t()),n.addEventListener("load",()=>{const r=n.response;if(!r||!r.uploaded)return t(r&&r.error&&r.error.message?r.error.message:i);e({default:r.url})}),n.upload&&n.upload.addEventListener("progress",e=>{e.lengthComputable&&(o.uploadTotal=e.total,o.uploaded=e.loaded)})}_sendRequest(e){const t=new FormData;t.append("upload",e),t.append("ckCsrfToken",function(){let e=function(e){e=e.toLowerCase();const t=document.cookie.split(";");for(const r of t){const t=r.split("=");if(decodeURIComponent(t[0].trim().toLowerCase())===e)return decodeURIComponent(t[1])}return null}(gd);var t;return e&&40==e.length||(e=function(e){let t="";const r=new Uint8Array(40);window.crypto.getRandomValues(r);for(let e=0;e<r.length;e++){const n=bd.charAt(r[e]%bd.length);t+=Math.random()>.5?n.toUpperCase():n}return t}(),t=e,document.cookie=encodeURIComponent("ckCsrfToken")+"="+encodeURIComponent(t)+";path=/"),e}()),this.xhr.send(t)}}function _d(e){const t=e.next();return t.done?null:t.value}function wd(e,t,r,n){let o,i=null;"function"==typeof n?o=n:(i=e.commands.get(n),o=()=>{e.execute(n)}),e.model.document.on("change:data",(a,s)=>{if(i&&!i.isEnabled||!t.isEnabled)return;const l=_d(e.model.document.selection.getRanges());if(!l.isCollapsed)return;if("transparent"==s.type)return;const c=Array.from(e.model.document.differ.getChanges()),u=c[0];if(1!=c.length||"insert"!==u.type||"$text"!=u.name||1!=u.length)return;const d=u.position.parent;if(d.is("element","codeBlock"))return;if(d.is("element","listItem")&&!["numberedList","bulletedList","todoList"].includes(n))return;if(i&&!0===i.value)return;const h=d.getChild(0),p=e.model.createRangeOn(h);if(!p.containsRange(l)&&!l.end.isEqual(p.end))return;const f=r.exec(h.data.substr(0,l.end.offset));f&&e.model.enqueueChange(t=>{const r=t.createPositionAt(d,0),n=t.createPositionAt(d,f[0].length),i=new ba(r,n);if(!1!==o({match:f})){t.remove(i);const r=e.model.document.selection.getFirstRange(),n=t.createRangeIn(d);!d.isEmpty||n.isEqual(r)||n.containsRange(r,!0)||t.remove(d)}i.detach()})})}function xd(e,t,r,n){let o,i;r instanceof RegExp?o=r:i=r,i=i||(e=>{let t;const r=[],n=[];for(;null!==(t=o.exec(e))&&!(t&&t.length<4);){let{index:e,1:o,2:i,3:a}=t;const s=o+i+a;e+=t[0].length-s.length;const l=[e,e+o.length],c=[e+o.length+i.length,e+o.length+i.length+a.length];r.push(l),r.push(c),n.push([e+o.length,e+o.length+i.length])}return{remove:r,format:n}}),e.model.document.on("change:data",(r,o)=>{if("transparent"==o.type||!t.isEnabled)return;const a=e.model,s=a.document.selection;if(!s.isCollapsed)return;const l=Array.from(a.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const u=s.focus,d=u.parent,{text:h,range:p}=function(e,t){let r=e.start;return{text:Array.from(e.getItems()).reduce((e,n)=>!n.is("$text")&&!n.is("$textProxy")||n.getAttribute("code")?(r=t.createPositionAfter(n),""):e+n.data,""),range:t.createRange(r,e.end)}}(a.createRange(a.createPositionAt(d,0),u),a),f=i(h),m=kd(p.start,f.format,a),g=kd(p.start,f.remove,a);m.length&&g.length&&a.enqueueChange(e=>{if(!1!==n(e,m))for(const t of g.reverse())e.remove(t)})})}function kd(e,t,r){return t.filter(e=>void 0!==e[0]&&void 0!==e[1]).map(t=>r.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1])))}function Cd(e,t){return(r,n)=>{if(!e.commands.get(t).isEnabled)return!1;const o=e.model.schema.getValidRanges(n,t);for(const e of o)r.setAttribute(t,!0,e);r.removeSelectionAttribute(t)}}class Ed extends pu{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,r=t.document.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change(e=>{if(r.isCollapsed)n?e.setSelectionAttribute(this.attributeKey,!0):e.removeSelectionAttribute(this.attributeKey);else{const o=t.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const t of o)n?e.setAttribute(this.attributeKey,n,t):e.removeAttribute(this.attributeKey,t)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,r=e.document.selection;if(r.isCollapsed)return r.hasAttribute(this.attributeKey);for(const e of r.getRanges())for(const r of e.getItems())if(t.checkAttribute(r,this.attributeKey))return r.hasAttribute(this.attributeKey);return!1}}const Sd="bold";class Td extends au{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Sd}),e.model.schema.setAttributeProperties(Sd,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Sd,view:"strong",upcastAlso:["b",e=>{const t=e.getStyle("font-weight");return t?"bold"==t||Number(t)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),e.commands.add(Sd,new Ed(e,Sd)),e.keystrokes.set("CTRL+B",Sd)}}const Ad="bold";class Pd extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Ad,r=>{const n=e.commands.get(Ad),o=new Lc(r);return o.set({label:t("Bold"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Ad),e.editing.view.focus()}),o})}}const Id="italic";class Od extends au{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Id}),e.model.schema.setAttributeProperties(Id,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Id,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Id,new Ed(e,Id)),e.keystrokes.set("CTRL+I",Id)}}const Md="italic";class Dd extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Md,r=>{const n=e.commands.get(Md),o=new Lc(r);return o.set({label:t("Italic"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.586 14.633l.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Md),e.editing.view.focus()}),o})}}class zd extends pu{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,r=t.schema,n=t.document.selection,o=Array.from(n.getSelectedBlocks()),i=void 0===e.forceValue?!this.value:e.forceValue;t.change(e=>{if(i){const t=o.filter(e=>jd(e)||Ld(r,e));this._applyQuote(e,t)}else this._removeQuote(e,o.filter(jd))})}_getValue(){const e=_d(this.editor.model.document.selection.getSelectedBlocks());return!(!e||!jd(e))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,r=_d(e.getSelectedBlocks());return!!r&&Ld(t,r)}_removeQuote(e,t){Rd(e,t).reverse().forEach(t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const r=e.createPositionBefore(t.start.parent);return void e.move(t,r)}t.end.isAtEnd||e.split(t.end);const r=e.createPositionAfter(t.end.parent);e.move(t,r)})}_applyQuote(e,t){const r=[];Rd(e,t).reverse().forEach(t=>{let n=jd(t.start);n||(n=e.createElement("blockQuote"),e.wrap(t,n)),r.push(n)}),r.reverse().reduce((t,r)=>t.nextSibling==r?(e.merge(e.createPositionAfter(t)),t):r)}}function jd(e){return"blockQuote"==e.parent.name?e.parent:null}function Rd(e,t){let r,n=0;const o=[];for(;n<t.length;){const i=t[n],a=t[n+1];r||(r=e.createPositionBefore(i)),a&&i.nextSibling==a||(o.push(e.createRange(r,e.createPositionAfter(i))),r=null),n++}return o}function Ld(e,t){const r=e.checkChild(t.parent,"blockQuote"),n=e.checkChild(["$root","blockQuote"],t);return r&&n}class Nd extends au{static get pluginName(){return"BlockQuoteEditing"}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new zd(e)),t.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),t.addChildCheck((e,t)=>{if(e.endsWith("blockQuote")&&"blockQuote"==t.name)return!1}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(r=>{const n=e.model.document.differ.getChanges();for(const e of n)if("insert"==e.type){const n=e.position.nodeAfter;if(!n)continue;if(n.is("element","blockQuote")&&n.isEmpty)return r.remove(n),!0;if(n.is("element","blockQuote")&&!t.checkChild(e.position,n))return r.unwrap(n),!0;if(n.is("element")){const e=r.createRangeIn(n);for(const n of e.getItems())if(n.is("element","blockQuote")&&!t.checkChild(r.createPositionBefore(n),n))return r.unwrap(n),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("element","blockQuote")&&t.isEmpty)return r.remove(t),!0}return!1});const r=this.editor.editing.view.document,n=e.model.document.selection,o=e.commands.get("blockQuote");this.listenTo(r,"enter",(t,r)=>{n.isCollapsed&&o.value&&n.getLastPosition().parent.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),r.preventDefault(),t.stop())},{priority:Ut.normal-10}),this.listenTo(r,"delete",(t,r)=>{if("backward"!=r.direction||!n.isCollapsed||!o.value)return;const i=n.getLastPosition().parent;i.isEmpty&&!i.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),r.preventDefault(),t.stop())},{priority:Ut.high+5})}}var Bd=i(636);Pl()(Bd.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Bd.Z.locals;class Fd extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",r=>{const n=e.commands.get("blockQuote"),o=new Lc(r);return o.set({label:t("Block quote"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute("blockQuote"),e.editing.view.focus()}),o})}}class Vd extends au{static get pluginName(){return"CKFinderUI"}init(){const e=this.editor,t=e.ui.componentFactory,r=e.t;t.add("ckfinder",t=>{const n=e.commands.get("ckfinder"),o=new Lc(t);return o.set({label:r("Insert image or file"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(n),o.on("execute",()=>{e.execute("ckfinder"),e.editing.view.focus()}),o})}}class Ud extends Wo{observe(e){this.listenTo(e,"load",(e,t)=>{const r=t.target;this.checkShouldIgnoreEventFromTarget(r)||"IMG"==r.tagName&&this._fireEvents(t)},{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}class qd{constructor(){this._stack=[]}add(e,t){const r=this._stack,n=r[0];this._insertDescriptor(e);const o=r[0];n===o||Hd(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:t})}remove(e,t){const r=this._stack,n=r[0];this._removeDescriptor(e);const o=r[0];n===o||Hd(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:t})}_insertDescriptor(e){const t=this._stack,r=t.findIndex(t=>t.id===e.id);if(Hd(e,t[r]))return;r>-1&&t.splice(r,1);let n=0;for(;t[n]&&Wd(t[n],e);)n++;t.splice(n,0,e)}_removeDescriptor(e){const t=this._stack,r=t.findIndex(t=>t.id===e);r>-1&&t.splice(r,1)}}function Hd(e,t){return e&&t&&e.priority==t.priority&&Gd(e.classes)==Gd(t.classes)}function Wd(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&Gd(e.classes)>Gd(t.classes)}function Gd(e){return Array.isArray(e)?e.sort().join(","):e}ir(qd,Xt);var Zd=i(8245);Pl()(Zd.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Zd.Z.locals;const Yd=mc("px"),$d=Do.document.body;class Kd extends oc{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",e=>"ck-balloon-panel_"+e),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Yd),left:t.to("left",Yd)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Kd.defaultPositions,r=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast],limiter:$d,fitInViewport:!0},e),n=Kd._getOptimalPosition(r),o=parseInt(n.left),i=parseInt(n.top),a=n.name;Object.assign(this,{top:i,left:o,position:a})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Xd(e.target),r=e.limiter?Xd(e.limiter):$d;this.listenTo(Do.document,"scroll",(n,o)=>{const i=o.target,a=t&&i.contains(t),s=r&&i.contains(r);!a&&!s&&t&&r||this.attachTo(e)},{useCapture:!0}),this.listenTo(Do.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(Do.document,"scroll"),this.stopListening(Do.window,"resize")}}function Xd(e){return jt(e)?e:Ii(e)?e.commonAncestorContainer:"function"==typeof e?Xd(e()):null}function Jd(e,t){return e.top-t.height-Kd.arrowVerticalOffset}function Qd(e){return e.bottom+Kd.arrowVerticalOffset}Kd.arrowHorizontalOffset=25,Kd.arrowVerticalOffset=10,Kd._getOptimalPosition=Tc,Kd.defaultPositions={northWestArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.left-Kd.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouthMiddleWest:(e,t)=>({top:Jd(e,t),left:e.left-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_smw"}),northWestArrowSouth:(e,t)=>({top:Jd(e,t),left:e.left-t.width/2,name:"arrow_s"}),northWestArrowSouthMiddleEast:(e,t)=>({top:Jd(e,t),left:e.left-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_sme"}),northWestArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.left-t.width+Kd.arrowHorizontalOffset,name:"arrow_se"}),northArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-Kd.arrowHorizontalOffset,name:"arrow_sw"}),northArrowSouthMiddleWest:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_smw"}),northArrowSouth:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s"}),northArrowSouthMiddleEast:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_sme"}),northArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-t.width+Kd.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.right-Kd.arrowHorizontalOffset,name:"arrow_sw"}),northEastArrowSouthMiddleWest:(e,t)=>({top:Jd(e,t),left:e.right-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_smw"}),northEastArrowSouth:(e,t)=>({top:Jd(e,t),left:e.right-t.width/2,name:"arrow_s"}),northEastArrowSouthMiddleEast:(e,t)=>({top:Jd(e,t),left:e.right-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_sme"}),northEastArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.right-t.width+Kd.arrowHorizontalOffset,name:"arrow_se"}),southWestArrowNorthWest:(e,t)=>({top:Qd(e),left:e.left-Kd.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorthMiddleWest:(e,t)=>({top:Qd(e),left:e.left-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_nmw"}),southWestArrowNorth:(e,t)=>({top:Qd(e),left:e.left-t.width/2,name:"arrow_n"}),southWestArrowNorthMiddleEast:(e,t)=>({top:Qd(e),left:e.left-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_nme"}),southWestArrowNorthEast:(e,t)=>({top:Qd(e),left:e.left-t.width+Kd.arrowHorizontalOffset,name:"arrow_ne"}),southArrowNorthWest:(e,t)=>({top:Qd(e),left:e.left+e.width/2-Kd.arrowHorizontalOffset,name:"arrow_nw"}),southArrowNorthMiddleWest:(e,t)=>({top:Qd(e),left:e.left+e.width/2-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_nmw"}),southArrowNorth:(e,t)=>({top:Qd(e),left:e.left+e.width/2-t.width/2,name:"arrow_n"}),southArrowNorthMiddleEast:(e,t)=>({top:Qd(e),left:e.left+e.width/2-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_nme"}),southArrowNorthEast:(e,t)=>({top:Qd(e),left:e.left+e.width/2-t.width+Kd.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorthWest:(e,t)=>({top:Qd(e),left:e.right-Kd.arrowHorizontalOffset,name:"arrow_nw"}),southEastArrowNorthMiddleWest:(e,t)=>({top:Qd(e),left:e.right-.25*t.width-Kd.arrowHorizontalOffset,name:"arrow_nmw"}),southEastArrowNorth:(e,t)=>({top:Qd(e),left:e.right-t.width/2,name:"arrow_n"}),southEastArrowNorthMiddleEast:(e,t)=>({top:Qd(e),left:e.right-.75*t.width+Kd.arrowHorizontalOffset,name:"arrow_nme"}),southEastArrowNorthEast:(e,t)=>({top:Qd(e),left:e.right-t.width+Kd.arrowHorizontalOffset,name:"arrow_ne"})};const eh="widget-type-around";function th(e,t,r){return e&&oh(e)&&!r.isInline(t)}function rh(e){return e.getAttribute(eh)}const nh="ck-widget_selected";function oh(e){return!!e.is("element")&&!!e.getCustomProperty("widget")}function ih(e,t,r={}){if(!e.is("containerElement"))throw new qt("widget-to-widget-wrong-element-type",null,{element:e});return t.setAttribute("contenteditable","false",e),t.addClass("ck-widget",e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=dh,r.label&&function(e,t,r){r.setCustomProperty("widgetLabel",t,e)}(e,r.label,t),r.hasSelectionHandle&&function(e,t){const r=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(e){const t=this.toDomElement(e),r=new Dc;return r.set("content",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>'),r.render(),t.appendChild(r.element),t}));t.insert(t.createPositionAt(e,0),r),t.addClass(["ck-widget_with-selection-handle"],e)}(e,t),ah(e,t,(e,t,r)=>r.addClass(lr(t.classes),e),(e,t,r)=>r.removeClass(lr(t.classes),e)),e}function ah(e,t,r,n){const o=new qd;o.on("change:top",(t,o)=>{o.oldDescriptor&&n(e,o.oldDescriptor,o.writer),o.newDescriptor&&r(e,o.newDescriptor,o.writer)}),t.setCustomProperty("addHighlight",(e,t,r)=>o.add(t,r),e),t.setCustomProperty("removeHighlight",(e,t,r)=>o.remove(t,r),e)}function sh(e){const t=e.getCustomProperty("widgetLabel");return t?"function"==typeof t?t():t:""}function lh(e,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",(r,n,o)=>{t.setAttribute("contenteditable",o?"false":"true",e)}),e.on("change:isFocused",(r,n,o)=>{o?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e)}),e}function ch(e,t){const r=e.getSelectedElement();if(r){const n=rh(e);if(n)return t.createPositionAt(r,n);if(t.schema.isBlock(r))return t.createPositionAfter(r)}const n=e.getSelectedBlocks().next().value;if(n){if(n.isEmpty)return t.createPositionAt(n,0);const r=t.createPositionAfter(n);return e.focus.isTouching(r)?r:t.createPositionBefore(n)}return e.focus}function uh(e,t){const r=new Di(Do.window),n=r.getIntersection(e),o=t.height+Kd.arrowVerticalOffset;if(e.top-o>r.top||e.bottom+o<r.bottom)return null;const i=n||e,a=i.left+i.width/2-t.width/2;return{top:Math.max(e.top,0)+Kd.arrowVerticalOffset,left:a,name:"arrow_n"}}function dh(){return null}function hh(e){const t=e.getSelectedElement();return t&&function(e){return!!e.getCustomProperty("image")&&oh(e)}(t)?t:null}function ph(e){return!!e&&e.is("element","image")}function fh(e,t={},r=null){e.change(n=>{const o=n.createElement("image",t),i=r||ch(e.document.selection,e);e.insertContent(o,i),o.parent&&n.setSelection(o,"on")})}function mh(e){const t=e.schema,r=e.document.selection;return function(e,t,r){const n=function(e,t){const r=ch(e,t).parent;return r.isEmpty&&!r.is("element","$root")?r.parent:r}(e,r);return t.checkChild(n,"image")}(r,t,e)&&!function(e,t){const r=e.getSelectedElement();return r&&t.isObject(r)}(r,t)&&function(e){return[...e.focus.getAncestors()].every(e=>!e.is("element","image"))}(r)}function gh(e){const t=[];for(const r of e.getChildren())t.push(r),r.is("element")&&t.push(...r.getChildren());return t.find(e=>e.is("element","img"))}function bh(e){return r=>{r.on(`attribute:${e}:image`,t)};function t(e,t,r){if(!r.consumable.consume(t.item,e.name))return;const n=r.writer,o=gh(r.mapper.toViewElement(t.item));n.setAttribute(t.attributeKey,t.attributeNewValue||"",o)}}class vh extends pu{refresh(){this.isEnabled=mh(this.editor.model)}execute(e){const t=this.editor.model;for(const r of lr(e.source))fh(t,{src:r})}}class yh extends au{static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.model.schema,r=e.t,n=e.conversion;e.editing.view.addObserver(Ud),t.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),n.for("dataDowncast").elementToElement({model:"image",view:(e,{writer:t})=>_h(t)}),n.for("editingDowncast").elementToElement({model:"image",view:(e,{writer:t})=>function(e,t,r){return t.setCustomProperty("image",!0,e),ih(e,t,{label:function(){const t=gh(e).getAttribute("alt");return t?`${t} ${r}`:r}})}(_h(t),t,r("image widget"))}),n.for("downcast").add(bh("src")).add(bh("alt")).add(function(){return t=>{t.on("attribute:srcset:image",e)};function e(e,t,r){if(!r.consumable.consume(t.item,e.name))return;const n=r.writer,o=gh(r.mapper.toViewElement(t.item));if(null===t.attributeNewValue){const e=t.attributeOldValue;e.data&&(n.removeAttribute("srcset",o),n.removeAttribute("sizes",o),e.width&&n.removeAttribute("width",o))}else{const e=t.attributeNewValue;e.data&&(n.setAttribute("srcset",e.data,o),n.setAttribute("sizes","100vw",o),e.width&&n.setAttribute("width",e.width,o))}}}()),n.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(e,{writer:t})=>t.createElement("image",{src:e.getAttribute("src")})}).attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:e=>{const t={data:e.getAttribute("srcset")};return e.hasAttribute("width")&&(t.width=e.getAttribute("width")),t}}}).add(function(){return t=>{t.on("element:figure",e)};function e(e,t,r){if(!r.consumable.test(t.viewItem,{name:!0,classes:"image"}))return;const n=gh(t.viewItem);if(!n||!n.hasAttribute("src")||!r.consumable.test(n,{name:!0}))return;const o=_d(r.convertItem(n,t.modelCursor).modelRange.getItems());o&&(r.convertChildren(t.viewItem,o),r.updateConversionResult(o,t))}}()),e.commands.add("imageInsert",new vh(e))}}function _h(e){const t=e.createEmptyElement("img"),r=e.createContainerElement("figure",{class:"image"});return e.insert(e.createPositionAt(r,0),t),r}class wh extends di{constructor(e){super(e),this.domEventType="mousedown"}onDomEvent(e){this.fire(e.type,e)}}class xh extends au{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,r=e.editing.view,n=e.locale,o=t.document.selection;this.listenTo(r.document,"keydown",(e,t)=>{if(!o.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;const r=t.keyCode==Hn.arrowright,i=t.keyCode==Hn.arrowleft;if(!r&&!i)return;const a=n.contentLanguageDirection;let s=!1;s="ltr"===a&&r||"rtl"===a&&i?this._handleForwardMovement(t):this._handleBackwardMovement(t),!0===s&&e.stop()},{priority:Ut.get("high")+1}),this._isNextGravityRestorationSkipped=!1,this.listenTo(o,"change:range",(e,t)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!t.directChange&&Sh(o.getFirstPosition(),this.attributes)||this._restoreGravity())})}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,r=this.editor.model.document.selection,n=r.getFirstPosition();return!this._isGravityOverridden&&(!n.isAtStart||!kh(r,t))&&(Sh(n,t)?(Eh(e),this._overrideGravity(),!0):void 0)}_handleBackwardMovement(e){const t=this.attributes,r=this.editor.model,n=r.document.selection,o=n.getFirstPosition();return this._isGravityOverridden?(Eh(e),this._restoreGravity(),Ch(r,t,o),!0):o.isAtStart?!!kh(n,t)&&(Eh(e),Ch(r,t,o),!0):function(e,t){return Sh(e.getShiftedBy(-1),t)}(o,t)?o.isAtEnd&&!kh(n,t)&&Sh(o,t)?(Eh(e),Ch(r,t,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function kh(e,t){for(const r of t)if(e.hasAttribute(r))return!0;return!1}function Ch(e,t,r){const n=r.nodeBefore;e.change(e=>{n?e.setSelectionAttribute(n.getAttributes()):e.removeSelectionAttribute(t)})}function Eh(e){e.preventDefault()}function Sh(e,t){const{nodeBefore:r,nodeAfter:n}=e;for(const e of t){const t=r?r.getAttribute(e):void 0;if((n?n.getAttribute(e):void 0)!==t)return!0}return!1}function Th(e,t,r,n){return n.createRange(Ah(e,t,r,!0,n),Ah(e,t,r,!1,n))}function Ah(e,t,r,n,o){let i=e.textNode||(n?e.nodeBefore:e.nodeAfter),a=null;for(;i&&i.getAttribute(t)==r;)a=i,i=n?i.previousSibling:i.nextSibling;return a?o.createPositionAt(a,n?"before":"after"):e}function Ph(e,t,r,n){const o=e.editing.view,i=new Set;o.document.registerPostFixer(o=>{const a=e.model.document.selection;let s=!1;if(a.hasAttribute(t)){const l=Th(a.getFirstPosition(),t,a.getAttribute(t),e.model),c=e.editing.mapper.toViewRange(l);for(const e of c.getItems())e.is("element",r)&&!e.hasClass(n)&&(o.addClass(n,e),i.add(e),s=!0)}return s}),e.conversion.for("editingDowncast").add(e=>{function t(){o.change(e=>{for(const t of i.values())e.removeClass(n,t),i.delete(t)})}e.on("insert",t,{priority:"highest"}),e.on("remove",t,{priority:"highest"}),e.on("attribute",t,{priority:"highest"}),e.on("selection",t,{priority:"highest"})})}class Ih{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach(e=>this._definitions.add(e)):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",(e,t,r)=>{if(!r.consumable.test(t.item,"attribute:linkHref"))return;const n=r.writer,o=n.document.selection;for(const e of this._definitions){const i=n.createAttributeElement("a",e.attributes,{priority:5});n.setCustomProperty("link",!0,i),e.callback(t.attributeNewValue)?t.item.is("selection")?n.wrap(o.getFirstRange(),i):n.wrap(r.mapper.toViewRange(t.range),i):n.unwrap(r.mapper.toViewRange(t.range),i)}},{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:image",(e,t,r)=>{const n=r.mapper.toViewElement(t.item),o=Array.from(n.getChildren()).find(e=>"a"===e.name);for(const e of this._definitions){const n=vr(e.attributes);if(e.callback(t.attributeNewValue))for(const[e,t]of n)"class"===e?r.writer.addClass(t,o):r.writer.setAttribute(e,t,o);else for(const[e,t]of n)"class"===e?r.writer.removeClass(t,o):r.writer.removeAttribute(e,o)}})}}}var Oh=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");const Mh=function(e){return Oh.test(e)};var Dh="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",zh="\\ud83c[\\udffb-\\udfff]",jh="[^\\ud800-\\udfff]",Rh="(?:\\ud83c[\\udde6-\\uddff]){2}",Lh="[\\ud800-\\udbff][\\udc00-\\udfff]",Nh="(?:"+Dh+"|"+zh+")?",Bh="[\\ufe0e\\ufe0f]?",Fh=Bh+Nh+"(?:\\u200d(?:"+[jh,Rh,Lh].join("|")+")"+Bh+Nh+")*",Vh="(?:"+[jh+Dh+"?",Dh,Rh,Lh,"[\\ud800-\\udfff]"].join("|")+")",Uh=RegExp(zh+"(?="+zh+")|"+Vh+Fh,"g");const qh=function(e){return Mh(e)?function(e){return e.match(Uh)||[]}(e):function(e){return e.split("")}(e)},Hh=function(e){e=Mr(e);var t=Mh(e)?qh(e):void 0,r=t?t[0]:e.charAt(0),n=t?function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:Rr(e,t,r)}(t,1).join(""):e.slice(1);return r.toUpperCase()+n},Wh=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Gh=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,Zh=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,Yh=/^((\w+:(\/{2,})?)|(\W))/i,$h="Ctrl+K";function Kh(e,{writer:t}){const r=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,r),r}function Xh(e){return function(e){return e.replace(Wh,"").match(Gh)}(e=String(e))?e:"#"}function Jh(e,t){return!!e&&e.is("element","image")&&t.checkAttribute("image","linkHref")}function Qh(e,t){const r=(n=e,Zh.test(n)?"mailto:":t);var n;const o=!!r&&!Yh.test(e);return e&&o?r+e:e}class ep extends pu{constructor(e){super(e),this.manualDecorators=new ar,this.automaticDecorators=new Ih}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document,r=_d(t.selection.getSelectedBlocks());Jh(r,e.schema)?(this.value=r.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(r,"linkHref")):(this.value=t.selection.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"linkHref"));for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}execute(e,t={}){const r=this.editor.model,n=r.document.selection,o=[],i=[];for(const e in t)t[e]?o.push(e):i.push(e);r.change(t=>{if(n.isCollapsed){const a=n.getFirstPosition();if(n.hasAttribute("linkHref")){const s=Th(a,"linkHref",n.getAttribute("linkHref"),r);t.setAttribute("linkHref",e,s),o.forEach(e=>{t.setAttribute(e,!0,s)}),i.forEach(e=>{t.removeAttribute(e,s)}),t.setSelection(t.createPositionAfter(s.end.nodeBefore))}else if(""!==e){const i=vr(n.getAttributes());i.set("linkHref",e),o.forEach(e=>{i.set(e,!0)});const{end:s}=r.insertContent(t.createText(e,i),a);t.setSelection(s)}["linkHref",...o,...i].forEach(e=>{t.removeSelectionAttribute(e)})}else{const a=r.schema.getValidRanges(n.getRanges(),"linkHref"),s=[];for(const e of n.getSelectedBlocks())r.schema.checkAttribute(e,"linkHref")&&s.push(t.createRangeOn(e));const l=s.slice();for(const e of a)this._isRangeToUpdate(e,s)&&l.push(e);for(const r of l)t.setAttribute("linkHref",e,r),o.forEach(e=>{t.setAttribute(e,!0,r)}),i.forEach(e=>{t.removeAttribute(e,r)})}})}_getDecoratorStateFromModel(e){const t=this.editor.model,r=t.document,n=_d(r.selection.getSelectedBlocks());return Jh(n,t.schema)?n.getAttribute(e):r.selection.getAttribute(e)}_isRangeToUpdate(e,t){for(const r of t)if(r.containsRange(e))return!1;return!0}}class tp extends pu{refresh(){const e=this.editor.model,t=e.document,r=_d(t.selection.getSelectedBlocks());Jh(r,e.schema)?this.isEnabled=e.schema.checkAttribute(r,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"linkHref")}execute(){const e=this.editor,t=this.editor.model,r=t.document.selection,n=e.commands.get("link");t.change(e=>{const o=r.isCollapsed?[Th(r.getFirstPosition(),"linkHref",r.getAttribute("linkHref"),t)]:t.schema.getValidRanges(r.getRanges(),"linkHref");for(const t of o)if(e.removeAttribute("linkHref",t),n)for(const r of n.manualDecorators)e.removeAttribute(r.id,t)})}}class rp{constructor({id:e,label:t,attributes:r,defaultValue:n}){this.id=e,this.set("value"),this.defaultValue=n,this.label=t,this.attributes=r}}ir(rp,fn);var np=i(399);Pl()(np.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),np.Z.locals;const op="automatic",ip=/^(https?:)?\/\//;class ap extends au{static get pluginName(){return"LinkEditing"}static get requires(){return[xh,Bu,hu]}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Kh}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(e,t)=>Kh(Xh(e),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:e=>e.getAttribute("href")}}),e.commands.add("link",new ep(e)),e.commands.add("unlink",new tp(e));const t=function(e,t){const r={"Open in a new tab":e("Open in a new tab"),Downloadable:e("Downloadable")};return t.forEach(e=>(e.label&&r[e.label]&&(e.label=r[e.label]),e)),t}(e.t,function(e){const t=[];if(e)for(const[r,n]of Object.entries(e)){const e=Object.assign({},n,{id:"link"+Hh(r)});t.push(e)}return t}(e.config.get("link.decorators")));this._enableAutomaticDecorators(t.filter(e=>e.mode===op)),this._enableManualDecorators(t.filter(e=>"manual"===e.mode)),e.plugins.get(xh).registerAttribute("linkHref"),Ph(e,"linkHref","a","ck-link_selected"),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(e){const t=this.editor,r=t.commands.get("link").automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&r.add({id:"linkIsExternal",mode:op,callback:e=>ip.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),r.add(e),r.length&&t.conversion.for("downcast").add(r.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,r=t.commands.get("link").manualDecorators;e.forEach(e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),r.add(new rp(e)),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,{writer:n})=>{if(t){const t=r.get(e.id).attributes,o=n.createAttributeElement("a",t,{priority:5});return n.setCustomProperty("link",!0,o),o}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:r.get(e.id).attributes},model:{key:e.id}})})}_enableInsertContentSelectionAttributesFixer(){const e=this.editor,t=e.model,r=t.document.selection,n=e.commands.get("link");this.listenTo(t,"insertContent",()=>{const e=r.anchor.nodeBefore,o=r.anchor.nodeAfter;r.hasAttribute("linkHref")&&e&&e.hasAttribute("linkHref")&&(o&&o.hasAttribute("linkHref")||t.change(e=>{sp(e,n.manualDecorators)}))},{priority:"low"})}_enableClickingAfterLink(){const e=this.editor,t=e.commands.get("link");e.editing.view.addObserver(wh);let r=!1;this.listenTo(e.editing.view.document,"mousedown",()=>{r=!0}),this.listenTo(e.editing.view.document,"selectionChange",()=>{if(!r)return;r=!1;const n=e.model.document.selection;if(!n.isCollapsed)return;if(!n.hasAttribute("linkHref"))return;const o=n.getFirstPosition(),i=Th(o,"linkHref",n.getAttribute("linkHref"),e.model);(o.isTouching(i.start)||o.isTouching(i.end))&&e.model.change(e=>{sp(e,t.manualDecorators)})})}_enableTypingOverLink(){const e=this.editor,t=e.editing.view;let r,n;this.listenTo(t.document,"delete",()=>{n=!0},{priority:"high"}),this.listenTo(e.model,"deleteContent",()=>{const t=e.model.document.selection;t.isCollapsed||(n?n=!1:lp(e)&&function(e){const t=e.document.selection,r=t.getFirstPosition(),n=t.getLastPosition(),o=r.nodeAfter;return!!o&&!!o.is("$text")&&!!o.hasAttribute("linkHref")&&(o===(n.textNode||n.nodeBefore)||Th(r,"linkHref",o.getAttribute("linkHref"),e).containsRange(e.createRange(r,n),!0))}(e.model)&&(r=t.getAttributes()))},{priority:"high"}),this.listenTo(e.model,"insertContent",(t,[o])=>{n=!1,lp(e)&&r&&(e.model.change(e=>{for(const[t,n]of r)e.setAttribute(t,n,o)}),r=null)},{priority:"high"})}_handleDeleteContentAfterLink(){const e=this.editor,t=e.model,r=t.document.selection,n=e.editing.view,o=e.commands.get("link");let i=!1,a=!1;this.listenTo(n.document,"delete",(e,t)=>{a=t.domEvent.keyCode===Hn.backspace},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{i=!1;const e=r.getFirstPosition(),n=r.getAttribute("linkHref");if(!n)return;const o=Th(e,"linkHref",n,t);i=o.containsPosition(e)||o.end.isEqual(e)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{a&&(a=!1,i||e.model.enqueueChange(e=>{sp(e,o.manualDecorators)}))},{priority:"low"})}}function sp(e,t){e.removeSelectionAttribute("linkHref");for(const r of t)e.removeSelectionAttribute(r.id)}function lp(e){return e.plugins.get("Input").isInput(e.model.change(e=>e.batch))}class cp extends dd{static get pluginName(){return"Notification"}init(){this.on("show:warning",(e,t)=>{window.alert(t.message)},{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t="show:"+e.type+(e.namespace?":"+e.namespace:"");this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}class up extends pu{constructor(e){super(e),this.stopListening(this.editor.model.document,"change"),this.listenTo(this.editor.model.document,"change",()=>this.refresh(),{priority:"low"})}refresh(){const e=this.editor.commands.get("imageInsert"),t=this.editor.commands.get("link");this.isEnabled=e.isEnabled||t.isEnabled}execute(){const e=this.editor,t=this.editor.config.get("ckfinder.openerMethod")||"modal";if("popup"!=t&&"modal"!=t)throw new qt("ckfinder-unknown-openermethod",e);const r=this.editor.config.get("ckfinder.options")||{};r.chooseFiles=!0;const n=r.onInit;r.language||(r.language=e.locale.uiLanguage),r.onInit=t=>{n&&n(t),t.on("files:choose",r=>{const n=r.data.files.toArray(),o=n.filter(e=>!e.isImage()),i=n.filter(e=>e.isImage());for(const t of o)e.execute("link",t.getUrl());const a=[];for(const e of i){const r=e.getUrl();a.push(r||t.request("file:getProxyUrl",{file:e}))}a.length&&dp(e,a)}),t.on("file:choose:resizedImage",t=>{const r=t.data.resizedUrl;if(r)dp(e,[r]);else{const t=e.plugins.get("Notification"),r=e.locale.t;t.showWarning(r("Could not obtain resized image URL."),{title:r("Selecting resized image failed"),namespace:"ckfinder"})}})},window.CKFinder[t](r)}}function dp(e,t){if(e.commands.get("imageInsert").isEnabled)e.execute("imageInsert",{source:t});else{const t=e.plugins.get("Notification"),r=e.locale.t;t.showWarning(r("Could not insert image at the current position."),{title:r("Inserting image failed"),namespace:"ckfinder"})}}class hp extends au{static get pluginName(){return"CKFinderEditing"}static get requires(){return[cp,yh,ap]}init(){const e=this.editor;e.commands.add("ckfinder",new up(e))}}const pp=/^data:(\S*?);base64,/;class fp{constructor(e,t,r){if(!e)throw new qt("fileuploader-missing-file",null);if(!t)throw new qt("fileuploader-missing-token",null);if(!r)throw new qt("fileuploader-missing-api-address",null);this.file=function(e){if("string"!=typeof e)return!1;const t=e.match(pp);return!(!t||!t.length)}(e)?function(e,t=512){try{const r=e.match(pp)[1],n=atob(e.replace(pp,"")),o=[];for(let e=0;e<n.length;e+=t){const r=n.slice(e,e+t),i=new Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);o.push(new Uint8Array(i))}return new Blob(o,{type:r})}catch(e){throw new qt("fileuploader-decoding-image-data-error",null)}}(e):e,this._token=t,this._apiAddress=r}onProgress(e){return this.on("progress",(t,r)=>e(r)),this}onError(e){return this.once("error",(t,r)=>e(r)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const e=new XMLHttpRequest;e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e}_attachXHRListeners(){const e=this,t=this.xhr;function r(t){return()=>e.fire("error",t)}t.addEventListener("error",r("Network Error")),t.addEventListener("abort",r("Abort")),t.upload&&t.upload.addEventListener("progress",e=>{e.lengthComputable&&this.fire("progress",{total:e.total,uploaded:e.loaded})}),t.addEventListener("load",()=>{const e=t.status,r=t.response;if(e<200||e>299)return this.fire("error",r.message||r.error)})}_sendRequest(){const e=new FormData,t=this.xhr;return e.append("file",this.file),new Promise((r,n)=>{t.addEventListener("load",()=>{const e=t.status,o=t.response;return e<200||e>299?o.message?n(new qt("fileuploader-uploading-data-failed",this,{message:o.message})):n(o.error):r(o)}),t.addEventListener("error",()=>n(new Error("Network Error"))),t.addEventListener("abort",()=>n(new Error("Abort"))),t.send(e)})}}ir(fp,Xt);const mp={autoRefresh:!0};class gp{constructor(e,t=mp){if(!e)throw new qt("token-missing-token-url",this);t.initValue&&this._validateTokenValue(t.initValue),this.set("value",t.initValue),this._refresh="function"==typeof e?e:()=>{return t=e,new Promise((e,r)=>{const n=new XMLHttpRequest;n.open("GET",t),n.addEventListener("load",()=>{const t=n.status,o=n.response;return t<200||t>299?r(new qt("token-cannot-download-new-token",null)):e(o)}),n.addEventListener("error",()=>r(new Error("Network Error"))),n.addEventListener("abort",()=>r(new Error("Abort"))),n.send()});var t},this._options=Object.assign({},mp,t)}init(){return new Promise((e,t)=>{this.value?(this._options.autoRefresh&&this._registerRefreshTokenTimeout(),e(this)):this.refreshToken().then(e).catch(t)})}refreshToken(){return this._refresh().then(e=>{this._validateTokenValue(e),this.set("value",e),this._options.autoRefresh&&this._registerRefreshTokenTimeout()}).then(()=>this)}destroy(){clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(e){const t="string"==typeof e,r=!/^".*"$/.test(e),n=t&&3===e.split(".").length;if(!r||!n)throw new qt("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(){const e=this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},e)}_getTokenRefreshTimeoutTime(){try{const[,e]=this.value.split("."),{exp:t}=JSON.parse(atob(e));return t?Math.floor((1e3*t-Date.now())/2):36e5}catch(e){return 36e5}}static create(e,t=mp){return new gp(e,t).init()}}ir(gp,fn);const bp=gp;class vp extends dd{static get pluginName(){return"CloudServices"}init(){const e=this.context.config.get("cloudServices")||{};for(const t in e)this[t]=e[t];if(this._tokens=new Map,this.tokenUrl)return this.token=new vp.Token(this.tokenUrl),this._tokens.set(this.tokenUrl,this.token),this.token.init();this.token=null}registerTokenUrl(e){if(this._tokens.has(e))return Promise.resolve(this.getTokenFor(e));const t=new vp.Token(e);return this._tokens.set(e,t),t.init()}getTokenFor(e){const t=this._tokens.get(e);if(!t)throw new qt("cloudservices-token-not-registered",this);return t}destroy(){super.destroy();for(const e of this._tokens.values())e.destroy()}}vp.Token=bp;class yp extends au{static get requires(){return[fd,vp]}init(){const e=this.editor,t=e.plugins.get(vp),r=t.token,n=t.uploadUrl;r&&(this._uploadGateway=new yp._UploadGateway(r,n),e.plugins.get(fd).createUploadAdapter=e=>new _p(this._uploadGateway,e))}}class _p{constructor(e,t){this.uploadGateway=e,this.loader=t}upload(){return this.loader.file.then(e=>(this.fileUploader=this.uploadGateway.upload(e),this.fileUploader.on("progress",(e,t)=>{this.loader.uploadTotal=t.total,this.loader.uploaded=t.uploaded}),this.fileUploader.send()))}abort(){this.fileUploader.abort()}}yp._UploadGateway=class{constructor(e,t){if(!e)throw new qt("uploadgateway-missing-token",null);if(!t)throw new qt("uploadgateway-missing-api-address",null);this._token=e,this._apiAddress=t}upload(e){return new fp(e,this._token,this._apiAddress)}};var wp=i(5137);Pl()(wp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),wp.Z.locals;const xp=["before","after"],kp=(new DOMParser).parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2l2 2.038"/></svg>',"image/svg+xml").firstChild,Cp="ck-widget__type-around_disabled";class Ep extends au{static get pluginName(){return"WidgetTypeAround"}constructor(e){super(e),this._currentFakeCaretModelElement=null}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(r,n,o)=>{t.change(e=>{for(const r of t.document.roots)o?e.removeClass(Cp,r):e.addClass(Cp,r)}),o||e.model.change(e=>{e.removeSelectionAttribute(eh)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const r=this.editor,n=r.editing.view;r.execute("insertParagraph",{position:r.model.createPositionAt(e,t)}),n.focus(),n.scrollToTheSelection()}_listenToIfEnabled(e,t,r,n){this.listenTo(e,t,(...e)=>{this.isEnabled&&r(...e)},n)}_insertParagraphAccordingToFakeCaretPosition(){const e=this.editor.model.document.selection,t=rh(e);if(!t)return!1;const r=e.getSelectedElement();return this._insertParagraph(r,t),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,r=e.locale.t,n={before:r("Insert paragraph before block"),after:r("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(e,r,o)=>{const i=o.mapper.toViewElement(r.item);th(i,r.item,t)&&function(e,t,r){const n=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(e){const r=this.toDomElement(e);return function(e,t){for(const r of xp){const n=new Nl({tag:"div",attributes:{class:["ck","ck-widget__type-around__button","ck-widget__type-around__button_"+r],title:t[r]},children:[e.ownerDocument.importNode(kp,!0)]});e.appendChild(n.render())}}(r,t),function(e){const t=new Nl({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}(r),r}));e.insert(e.createPositionAt(r,"end"),n)}(o.writer,n,i)},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,r=t.document.selection,n=t.schema,o=e.editing.view;function i(e){return"ck-widget_type-around_show-fake-caret_"+e}this._listenToIfEnabled(o.document,"keydown",(e,t)=>{Yn(t.keyCode)&&this._handleArrowKeyPress(e,t)},{priority:Ut.get("high")+10}),this._listenToIfEnabled(r,"change:range",(t,r)=>{r.directChange&&e.model.change(e=>{e.removeSelectionAttribute(eh)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const t=r.getSelectedElement();t&&th(e.editing.mapper.toViewElement(t),t,n)||e.model.change(e=>{e.removeSelectionAttribute(eh)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(e,t,r)=>{const o=r.writer;if(this._currentFakeCaretModelElement){const e=r.mapper.toViewElement(this._currentFakeCaretModelElement);e&&(o.removeClass(xp.map(i),e),this._currentFakeCaretModelElement=null)}const a=t.selection.getSelectedElement();if(!a)return;const s=r.mapper.toViewElement(a);if(!th(s,a,n))return;const l=rh(t.selection);l&&(o.addClass(i(l),s),this._currentFakeCaretModelElement=a)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(t,r,n)=>{n||e.model.change(e=>{e.removeSelectionAttribute(eh)})})}_handleArrowKeyPress(e,t){const r=this.editor,n=r.model,o=n.document.selection,i=n.schema,a=r.editing.view,s=Kn(t.keyCode,r.locale.contentLanguageDirection),l=a.document.selection.getSelectedElement();let c;th(l,r.editing.mapper.toModelElement(l),i)?c=this._handleArrowKeyPressOnSelectedWidget(s):o.isCollapsed&&(c=this._handleArrowKeyPressWhenSelectionNextToAWidget(s)),c&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const t=this.editor.model,r=rh(t.document.selection);return t.change(t=>r?r!==(e?"after":"before")&&(t.removeSelectionAttribute(eh),!0):(t.setSelectionAttribute(eh,e?"after":"before"),!0))}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,r=t.model,n=r.schema,o=t.plugins.get("Widget"),i=o._getObjectElementNextToSelection(e);return!!th(t.editing.mapper.toViewElement(i),i,n)&&(r.change(t=>{o._setSelectionOverElement(i),t.setSelectionAttribute(eh,e?"before":"after")}),!0)}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(r,n)=>{const o=n.domTarget.closest(".ck-widget__type-around__button");if(!o)return;const i=function(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}(o),a=function(e,t){const r=e.closest(".ck-widget");return t.mapDomToView(r)}(o,t.domConverter),s=e.editing.mapper.toModelElement(a);this._insertParagraph(s,i),n.preventDefault(),r.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"enter",(r,n)=>{const o=t.document.selection.getSelectedElement(),i=e.editing.mapper.toModelElement(o),a=e.model.schema;let s;this._insertParagraphAccordingToFakeCaretPosition()?s=!0:th(o,i,a)&&(this._insertParagraph(i,n.isSoft?"before":"after"),s=!0),s&&(n.preventDefault(),r.stop())})}_enableInsertingParagraphsOnTypingKeystroke(){const e=this.editor.editing.view,t=[Hn.enter,Hn.delete,Hn.backspace];this._listenToIfEnabled(e.document,"keydown",(e,r)=>{t.includes(r.keyCode)||Du(r)||this._insertParagraphAccordingToFakeCaretPosition()},{priority:Ut.get("high")+1})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,r=e.model,n=r.schema;this._listenToIfEnabled(t.document,"delete",(t,o)=>{const i=rh(r.document.selection);if(!i)return;const a=o.direction,s=r.document.selection.getSelectedElement(),l="forward"==a;if("before"===i===l)e.execute("delete",{selection:r.createSelection(s,"on")});else{const t=n.getNearestSelectionRange(r.createPositionAt(s,i),a);if(t)if(t.isCollapsed){const o=r.createSelection(t.start);if(r.modifySelection(o,{direction:a}),o.focus.isEqual(t.start)){const e=function(e,t){let r=t;for(const n of t.getAncestors({parentFirst:!0})){if(n.childCount>1||e.isLimit(n))break;r=n}return r}(n,t.start.parent);r.deleteContent(r.createSelection(e,"on"),{doNotAutoparagraph:!0})}else r.change(r=>{r.setSelection(t),e.execute(l?"forwardDelete":"delete")})}else r.change(r=>{r.setSelection(t),e.execute(l?"forwardDelete":"delete")})}o.preventDefault(),t.stop()},{priority:Ut.get("high")+1})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,r=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(e,[n,o])=>{if(o&&!o.is("documentSelection"))return;const i=rh(r);return i?(e.stop(),t.change(e=>{const o=r.getSelectedElement(),a=t.createPositionAt(o,i),s=e.createSelection(a),l=t.insertContent(n,s);return e.setSelection(s),l})):void 0},{priority:"high"})}}var Sp=i(6507);function Tp(e,t,r){const n=e.schema,o=e.createRangeIn(t.root),i="forward"==r?"elementStart":"elementEnd";for(const{previousPosition:e,item:a,type:s}of o.getWalker({startPosition:t,direction:r})){if(n.isLimit(a)&&!n.isInline(a))return e;if(s==i&&n.isBlock(a))return null}return null}function Ap(e,t,r){const n="backward"==r?t.end:t.start;if(e.checkChild(n,"$text"))return n;for(const{nextPosition:n}of t.getWalker({direction:r}))if(e.checkChild(n,"$text"))return n}Pl()(Sp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Sp.Z.locals;class Pp extends au{static get pluginName(){return"Widget"}static get requires(){return[Ep]}init(){const e=this.editor.editing.view,t=e.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(e,t,r)=>{this._clearPreviouslySelectedWidgets(r.writer);const n=r.writer,o=n.document.selection,i=o.getSelectedElement();let a=null;for(const e of o.getRanges())for(const t of e){const e=t.item;oh(e)&&!Ip(e,a)&&(n.addClass(nh,e),this._previouslySelected.add(e),a=e,e==i&&n.setSelection(o.getRanges(),{fake:!0,label:sh(i)}))}},{priority:"low"}),e.addObserver(wh),this.listenTo(t,"mousedown",(...e)=>this._onMousedown(...e)),this.listenTo(t,"keydown",(...e)=>{this._handleSelectionChangeOnArrowKeyPress(...e)},{priority:"high"}),this.listenTo(t,"keydown",(...e)=>{this._preventDefaultOnArrowKeyPress(...e)},{priority:Ut.get("high")-20}),this.listenTo(t,"keydown",function(e){const t=e.model;return(r,n)=>{const o=n.keyCode==Hn.arrowup,i=n.keyCode==Hn.arrowdown,a=n.shiftKey,s=t.document.selection;if(!o&&!i)return;const l=i;if(a&&function(e,t){return!e.isCollapsed&&e.isBackward==t}(s,l))return;const c=function(e,t,r){const n=e.model;if(r){const e=t.isCollapsed?t.focus:t.getLastPosition(),r=Tp(n,e,"forward");if(!r)return null;const o=n.createRange(e,r),i=Ap(n.schema,o,"backward");return i&&e.isBefore(i)?n.createRange(e,i):null}{const e=t.isCollapsed?t.focus:t.getFirstPosition(),r=Tp(n,e,"backward");if(!r)return null;const o=n.createRange(r,e),i=Ap(n.schema,o,"forward");return i&&e.isAfter(i)?n.createRange(i,e):null}}(e,s,l);c&&!c.isCollapsed&&function(e,t,r){const n=e.model,o=e.view.domConverter;if(r){const e=n.createSelection(t.start);n.modifySelection(e),e.focus.isAtEnd||t.start.isEqual(e.focus)||(t=n.createRange(e.focus,t.end))}const i=e.mapper.toViewRange(t),a=o.viewRangeToDom(i),s=Di.getDomRangeRects(a);let l;for(const e of s)if(void 0!==l){if(Math.round(e.top)>=l)return!1;l=Math.max(l,Math.round(e.bottom))}else l=Math.round(e.bottom);return!0}(e,c,l)&&(t.change(e=>{const r=l?c.end:c.start;if(a){const n=t.createSelection(s.anchor);n.setFocus(r),e.setSelection(n)}else e.setSelection(r)}),r.stop(),n.preventDefault(),n.stopPropagation())}}(this.editor.editing)),this.listenTo(t,"delete",(e,t)=>{this._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop())},{priority:"high"})}_onMousedown(e,t){const r=this.editor,n=r.editing.view,o=n.document;let i=t.target;if(function(e){for(;e;){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(oh(e))return!1;e=e.parent}return!1}(i)){if((Bn||Nn)&&t.domEvent.detail>=3){const e=r.editing.mapper,n=i.is("attributeElement")?i.findAncestor(e=>!e.is("attributeElement")):i,o=e.toModelElement(n);t.preventDefault(),this.editor.model.change(e=>{e.setSelection(o,"in")})}return}if(!oh(i)&&(i=i.findAncestor(oh),!i))return;t.preventDefault(),o.isFocused||n.focus();const a=r.editing.mapper.toModelElement(i);this._setSelectionOverElement(a)}_handleSelectionChangeOnArrowKeyPress(e,t){const r=t.keyCode;if(!Yn(r))return;const n=this.editor.model,o=n.schema,i=n.document.selection,a=i.getSelectedElement(),s=Kn(r,this.editor.locale.contentLanguageDirection);if(a&&o.isObject(a)){const r=s?i.getLastPosition():i.getFirstPosition(),a=o.getNearestSelectionRange(r,s?"forward":"backward");return void(a&&(n.change(e=>{e.setSelection(a)}),t.preventDefault(),e.stop()))}if(!i.isCollapsed)return;const l=this._getObjectElementNextToSelection(s);l&&o.isObject(l)&&(this._setSelectionOverElement(l),t.preventDefault(),e.stop())}_preventDefaultOnArrowKeyPress(e,t){if(!Yn(t.keyCode))return;const r=this.editor.model,n=r.schema,o=r.document.selection.getSelectedElement();o&&n.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const t=this.editor.model.document.selection;if(!t.isCollapsed)return;const r=this._getObjectElementNextToSelection(e);return r?(this.editor.model.change(e=>{let n=t.anchor.parent;for(;n.isEmpty;){const t=n;n=t.parent,e.remove(t)}this._setSelectionOverElement(r)}),!0):void 0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,r=t.schema,n=t.document.selection,o=t.createSelection(n);t.modifySelection(o,{direction:e?"forward":"backward"});const i=e?o.focus.nodeBefore:o.focus.nodeAfter;return i&&r.isObject(i)?i:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(nh,t);this._previouslySelected.clear()}}function Ip(e,t){return!!t&&Array.from(e.getAncestors()).includes(t)}class Op extends pu{refresh(){const e=this.editor.model.document.selection.getSelectedElement();this.isEnabled=ph(e),ph(e)&&e.hasAttribute("alt")?this.value=e.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor.model,r=t.document.selection.getSelectedElement();t.change(t=>{t.setAttribute("alt",e.newValue,r)})}}class Mp extends au{static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new Op(this.editor))}}var Dp=i(8111);Pl()(Dp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Dp.Z.locals;class zp extends oc{constructor(e,t){super(e);const r="ck-labeled-field-view-"+Vt(),n="ck-labeled-field-view-status-"+Vt();this.fieldView=t(this,r,n),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(r),this.statusView=this._createStatusView(n),this.bind("_statusText").to(this,"errorText",this,"infoText",(e,t)=>e||t);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",e=>!e),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(e){const t=new dc(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new oc(this.locale),r=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",r.if("errorText","ck-labeled-field-view__status_error"),r.if("_statusText","ck-hidden",e=>!e)],id:e,role:r.if("errorText","alert")},children:[{text:r.to("_statusText")}]}),t}focus(){this.fieldView.focus()}}var jp=i(7661);Pl()(jp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),jp.Z.locals;class Rp extends oc{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new El,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to("input"),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,r)=>{this._setDomElementValue(r),this._updateIsEmpty()})}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=!this.element.value}_setDomElementValue(e){this.element.value=e||0===e?e:""}}function Lp(e,t,r){const n=new Rp(e.locale);return n.set({id:t,ariaDescribedById:r}),n.bind("isReadOnly").to(e,"isEnabled",e=>!e),n.bind("hasError").to(e,"errorText",e=>!!e),n.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused","placeholder").to(n),n}function Np(e,t,r){const n=$c(e.locale);return n.set({id:t,ariaDescribedById:r}),n.bind("isEnabled").to(e),n}function Bp(e){e.set("_isCssTransitionsDisabled",!1),e.disableCssTransitions=()=>{e._isCssTransitionsDisabled=!0},e.enableCssTransitions=()=>{e._isCssTransitionsDisabled=!1},e.extendTemplate({attributes:{class:[e.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}function Fp({view:e}){e.listenTo(e.element,"submit",(t,r)=>{r.preventDefault(),e.fire("submit")},{useCapture:!0})}const Vp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Up='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>';var qp=i(6831);Pl()(qp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),qp.Z.locals;var Hp=i(1590);Pl()(Hp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Hp.Z.locals;class Wp extends oc{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new El,this.keystrokes=new vl,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("Save"),Vp,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("Cancel"),Up,"ck-button-cancel","cancel"),this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),Bp(this)}render(){super.render(),this.keystrokes.listenTo(this.element),Fp({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}_createButton(e,t,r,n){const o=new Lc(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:r}}),n&&o.delegate("execute").to(this,n),o}_createLabeledInputView(){const e=this.locale.t,t=new zp(this.locale,Lp);return t.label=e("Text alternative"),t}}var Gp=i(1757);Pl()(Gp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Gp.Z.locals;var Zp=i(3553);Pl()(Zp.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Zp.Z.locals;const Yp=mc("px");class $p extends au{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const e=this.editor.editing.view,t=e.document.selection.editableElement;return t?e.domConverter.mapViewToDom(t.root):null},this.set("visibleView",null),this.view=new Kd(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new qt("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));const r=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),r.set(e.view,e),this._viewToStack.set(e.view,r),r===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new qt("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new qt("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(t=>t[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new Kp(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(e,t)=>!t&&e>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(e,r)=>{if(r<2)return"";const n=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[n,r])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new Xp(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(e,t)=>!t&&e>=2?Math.min(e-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:r=!0,singleViewMode:n=!1}){this.view.class=t,this.view.withArrow=r,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),n&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&!e.limiter&&(e=Object.assign({},e,{limiter:this.positionLimiter})),e}}class Kp extends oc{constructor(e){super(e);const t=e.t,r=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new El,this.buttonPrevView=this._createButtonView(t("Previous"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>'),this.buttonNextView=this._createButtonView(t("Next"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>'),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",r.to("isNavigationVisible",e=>e?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:r.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const r=new Lc(this.locale);return r.set({label:e,icon:t,tooltip:!0}),r}}class Xp extends oc{constructor(e,t){super(e);const r=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",r.to("numberOfPanels",e=>e?"":"ck-hidden")],style:{top:r.to("top",Yp),left:r.to("left",Yp),width:r.to("width",Yp),height:r.to("height",Yp)}},children:this.content}),this.on("change:numberOfPanels",(e,t,r,n)=>{r>n?this._addPanels(r-n):this._removePanels(n-r),this.updatePosition()})}_addPanels(e){for(;e--;){const e=new oc;e.setTemplate({tag:"div"}),this.content.add(e),this.registerChild(e)}}_removePanels(e){for(;e--;){const e=this.content.last;this.content.remove(e),this.deregisterChild(e),e.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:r,height:n}=new Di(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:r,height:n})}}}function Jp(e){const t=e.editing.view,r=Kd.defaultPositions;return{target:t.domConverter.viewToDom(t.document.selection.getSelectedElement()),positions:[r.northArrowSouth,r.northArrowSouthWest,r.northArrowSouthEast,r.southArrowNorth,r.southArrowNorthWest,r.southArrowNorthEast]}}class Qp extends au{static get requires(){return[$p]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",r=>{const n=e.commands.get("imageTextAlternative"),o=new Lc(r);return o.set({label:t("Change image text alternative"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",()=>{this._showForm()}),o})}_createForm(){const e=this.editor,t=e.editing.view.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Wp(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(e,t)=>{this._hideForm(!0),t()}),this.listenTo(e.ui,"update",()=>{hh(t.selection)?this._isVisible&&function(e){const t=e.plugins.get("ContextualBalloon");if(hh(e.editing.view.document.selection)){const r=Jp(e);t.updatePosition(r)}}(e):this._hideForm(!0)}),Gc({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,t=e.commands.get("imageTextAlternative"),r=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Jp(e)}),r.fieldView.value=r.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class ef extends au{static get requires(){return[Mp,Qp]}static get pluginName(){return"ImageTextAlternative"}}var tf=i(9048);Pl()(tf.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),tf.Z.locals;class rf extends au{static get requires(){return[yh,Pp,ef]}static get pluginName(){return"Image"}}class nf extends oc{constructor(e){super(e),this.buttonView=new Lc(e),this._fileInputView=new of(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class of extends oc{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}function af(e){const t=e.map(e=>e.replace("+","\\+"));return new RegExp(`^image\\/(${t.join("|")})$`)}function sf(e){return new Promise((t,r)=>{const n=e.getAttribute("src");fetch(n).then(e=>e.blob()).then(e=>{const r=lf(e,n),o=r.replace("image/",""),i=new File([e],"image."+o,{type:r});t(i)}).catch(e=>e&&"TypeError"===e.name?function(e){return function(e){return new Promise((t,r)=>{const n=Do.document.createElement("img");n.addEventListener("load",()=>{const e=Do.document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0),e.toBlob(e=>e?t(e):r())}),n.addEventListener("error",()=>r()),n.src=e})}(e).then(t=>{const r=lf(t,e),n=r.replace("image/","");return new File([t],"image."+n,{type:r})})}(n).then(t).catch(r):r(e))})}function lf(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}class cf extends au{static get pluginName(){return"ImageUploadUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageUpload",r=>{const n=new nf(r),o=e.commands.get("imageUpload"),i=e.config.get("image.upload.types"),a=af(i);return n.set({acceptedType:i.map(e=>"image/"+e).join(","),allowMultipleFiles:!0}),n.buttonView.set({label:t("Insert image"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',tooltip:!0}),n.buttonView.bind("isEnabled").to(o),n.on("done",(t,r)=>{const n=Array.from(r).filter(e=>a.test(e.type));n.length&&e.execute("imageUpload",{file:n})}),n})}}var uf=i(5870);Pl()(uf.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),uf.Z.locals;var df=i(9899);Pl()(df.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),df.Z.locals;var hf=i(9825);Pl()(hf.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),hf.Z.locals;class pf extends au{constructor(e){super(e),this.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>')}init(){this.editor.editing.downcastDispatcher.on("attribute:uploadStatus:image",(...e)=>this.uploadStatusChange(...e))}uploadStatusChange(e,t,r){const n=this.editor,o=t.item,i=o.getAttribute("uploadId");if(!r.consumable.consume(t.item,e.name))return;const a=n.plugins.get(fd),s=i?t.attributeNewValue:null,l=this.placeholder,c=n.editing.mapper.toViewElement(o),u=r.writer;if("reading"==s)return ff(c,u),void mf(l,c,u);if("uploading"==s){const e=a.loaders.get(i);return ff(c,u),void(e?(gf(c,u),function(e,t,r,n){const o=function(e){const t=e.createUIElement("div",{class:"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t}(t);t.insert(t.createPositionAt(e,"end"),o),r.on("change:uploadedPercent",(e,t,r)=>{n.change(e=>{e.setStyle("width",r+"%",o)})})}(c,u,e,n.editing.view),function(e,t,r){if(r.data){const n=gh(e);t.setAttribute("src",r.data,n)}}(c,u,e)):mf(l,c,u))}"complete"==s&&a.loaders.get(i)&&function(e,t,r){const n=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),n),setTimeout(()=>{r.change(e=>e.remove(e.createRangeOn(n)))},3e3)}(c,u,n.editing.view),function(e,t){vf(e,t,"progressBar")}(c,u),gf(c,u),function(e,t){t.removeClass("ck-appear",e)}(c,u)}}function ff(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e)}function mf(e,t,r){t.hasClass("ck-image-upload-placeholder")||r.addClass("ck-image-upload-placeholder",t);const n=gh(t);n.getAttribute("src")!==e&&r.setAttribute("src",e,n),bf(t,"placeholder")||r.insert(r.createPositionAfter(n),function(e){const t=e.createUIElement("div",{class:"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t}(r))}function gf(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),vf(e,t,"placeholder")}function bf(e,t){for(const r of e.getChildren())if(r.getCustomProperty(t))return r}function vf(e,t,r){const n=bf(e,r);n&&t.remove(t.createRangeOn(n))}class yf{constructor(e){this.document=e}createDocumentFragment(e){return new ro(this.document,e)}createElement(e,t,r){return new on(this.document,e,t,r)}createText(e){return new gr(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,r){return r._insertChild(e,t)}removeChildren(e,t,r){return r._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const r=e.parent;if(r){const n=r.getChildIndex(e);return this.removeChildren(n,1,r),this.insertChild(n,t,r),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const r=t.getChildIndex(e);this.remove(e),this.insertChild(r,e.getChildren(),t)}}rename(e,t){const r=new on(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,r)?r:null}setAttribute(e,t,r){r._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,r){C(e)&&void 0===r&&(r=t),r._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,r){r._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return Cn._createAt(e,t)}createPositionAfter(e){return Cn._createAfter(e)}createPositionBefore(e){return Cn._createBefore(e)}createRange(e,t){return new En(e,t)}createRangeOn(e){return En._createOn(e)}createRangeIn(e){return En._createIn(e)}createSelection(e,t,r){return new An(e,t,r)}}class _f extends pu{refresh(){const e=this.editor.model.document.selection.getSelectedElement(),t=e&&"image"===e.name||!1;this.isEnabled=mh(this.editor.model)||t}execute(e){const t=this.editor,r=t.model,n=t.plugins.get(fd);for(const t of lr(e.file))wf(r,n,t)}}function wf(e,t,r){const n=t.createLoader(r);n&&fh(e,{uploadId:n.id})}class xf extends au{static get requires(){return[fd,cp,hu]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}})}init(){const e=this.editor,t=e.model.document,r=e.model.schema,n=e.conversion,o=e.plugins.get(fd),i=af(e.config.get("image.upload.types"));r.extend("image",{allowAttributes:["uploadId","uploadStatus"]}),e.commands.add("imageUpload",new _f(e)),n.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",(t,r)=>{if(n=r.dataTransfer,Array.from(n.types).includes("text/html")&&""!==n.getData("text/html"))return;var n;const o=Array.from(r.dataTransfer.files).filter(e=>!!e&&i.test(e.type)),a=r.targetRanges.map(t=>e.editing.mapper.toModelRange(t));e.model.change(r=>{r.setSelection(a),o.length&&(t.stop(),e.model.enqueueChange("default",()=>{e.execute("imageUpload",{file:o})}))})}),this.listenTo(e.plugins.get(hu),"inputTransformation",(t,r)=>{const n=Array.from(e.editing.view.createRangeIn(r.content)).filter(e=>{return!(!(t=e.item).is("element","img")||!t.getAttribute("src"))&&(t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||t.getAttribute("src").match(/^blob:/g))&&!e.item.getAttribute("uploadProcessed");var t}).map(e=>({promise:sf(e.item),imageElement:e.item}));if(!n.length)return;const i=new yf(e.editing.view.document);for(const e of n){i.setAttribute("uploadProcessed",!0,e.imageElement);const t=o.createLoader(e.promise);t&&(i.setAttribute("src","",e.imageElement),i.setAttribute("uploadId",t.id,e.imageElement))}}),e.editing.view.document.on("dragover",(e,t)=>{t.preventDefault()}),t.on("change",()=>{const r=t.differ.getChanges({includeChangesInGraveyard:!0});for(const t of r)if("insert"==t.type&&"$text"!=t.name){const r=t.position.nodeAfter,n="$graveyard"==t.position.root.rootName;for(const t of kf(e,r)){const e=t.getAttribute("uploadId");if(!e)continue;const r=o.loaders.get(e);r&&(n?r.abort():"idle"==r.status&&this._readAndUpload(r,t))}}})}_readAndUpload(e,t){const r=this.editor,n=r.model,o=r.locale.t,i=r.plugins.get(fd),a=r.plugins.get(cp);return n.enqueueChange("transparent",e=>{e.setAttribute("uploadStatus","reading",t)}),e.read().then(()=>{const o=e.upload();if(Bn){const e=gh(r.editing.mapper.toViewElement(t));r.editing.view.once("render",()=>{if(!e.parent)return;const t=r.editing.view.domConverter.mapViewToDom(e.parent);if(!t)return;const n=t.style.display;t.style.display="none",t._ckHack=t.offsetHeight,t.style.display=n})}return n.enqueueChange("transparent",e=>{e.setAttribute("uploadStatus","uploading",t)}),o}).then(e=>{n.enqueueChange("transparent",r=>{r.setAttributes({uploadStatus:"complete",src:e.default},t),this._parseAndSetSrcsetAttributeOnImage(e,t,r)}),s()}).catch(r=>{if("error"!==e.status&&"aborted"!==e.status)throw r;"error"==e.status&&r&&a.showWarning(r,{title:o("Upload failed"),namespace:"upload"}),s(),n.enqueueChange("transparent",e=>{e.remove(t)})});function s(){n.enqueueChange("transparent",e=>{e.removeAttribute("uploadId",t),e.removeAttribute("uploadStatus",t)}),i.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,r){let n=0;const o=Object.keys(e).filter(e=>{const t=parseInt(e,10);if(!isNaN(t))return n=Math.max(n,t),!0}).map(t=>`${e[t]} ${t}w`).join(", ");""!=o&&r.setAttribute("srcset",{data:o,width:n},t)}}function kf(e,t){return Array.from(e.model.createRangeOn(t)).filter(e=>e.item.is("element","image")).map(e=>e.item)}class Cf extends au{static get pluginName(){return"ImageUpload"}static get requires(){return[xf,cf,pf]}}class Ef extends pu{refresh(){const e=this.editor.model,t=_d(e.document.selection.getSelectedBlocks());this.value=!!t&&t.is("element","paragraph"),this.isEnabled=!!t&&Sf(t,e.schema)}execute(e={}){const t=this.editor.model,r=t.document;t.change(n=>{const o=(e.selection||r.selection).getSelectedBlocks();for(const e of o)!e.is("element","paragraph")&&Sf(e,t.schema)&&n.rename(e,"paragraph")})}}function Sf(e,t){return t.checkChild(e.parent,"paragraph")&&!t.isObject(e)}class Tf extends pu{execute(e){const t=this.editor.model;let r=e.position;t.change(e=>{const n=e.createElement("paragraph");if(!t.schema.checkChild(r.parent,n)){const o=t.schema.findAllowedParent(r,n);if(!o)return;r=e.split(r,o).position}t.insertContent(n,r),e.setSelection(n,"in")})}}class Af extends au{static get pluginName(){return"Paragraph"}init(){const e=this.editor,t=e.model;e.commands.add("paragraph",new Ef(e)),e.commands.add("insertParagraph",new Tf(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(e,{writer:t})=>Af.paragraphLikeElements.has(e.name)?e.isEmpty?null:t.createElement("paragraph"):null,view:/.+/,converterPriority:"low"})}}Af.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);class Pf extends pu{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=_d(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(t=>If(e,t,this.editor.model.schema))}execute(e){const t=this.editor.model,r=t.document,n=e.value;t.change(e=>{const o=Array.from(r.selection.getSelectedBlocks()).filter(e=>If(e,n,t.schema));for(const t of o)t.is("element",n)||e.rename(t,n)})}}function If(e,t,r){return r.checkChild(e.parent,t)&&!r.isObject(e)}const Of="paragraph";class Mf extends au{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Af]}init(){const e=this.editor,t=e.config.get("heading.options"),r=[];for(const n of t)n.model!==Of&&(e.model.schema.register(n.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(n),r.push(n.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new Pf(e,r))}afterInit(){const e=this.editor,t=e.commands.get("enter"),r=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",(t,n)=>{const o=e.model.document.selection.getFirstPosition().parent;r.some(e=>o.is("element",e.model))&&!o.is("element",Of)&&0===o.childCount&&n.writer.rename(o,Of)})}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Ut.get("low")+1})}}class Df{constructor(e,t){t&&cn(this,t),e&&this.set(e)}}ir(Df,fn);var zf=i(3230);Pl()(zf.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),zf.Z.locals;class jf extends au{init(){const e=this.editor,t=e.t,r=function(e){const t=e.t,r={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return e.config.get("heading.options").map(e=>{const t=r[e.title];return t&&t!=e.title&&(e.title=t),e})}(e),n=t("Choose heading"),o=t("Heading");e.ui.componentFactory.add("heading",t=>{const i={},a=new ar,s=e.commands.get("heading"),l=e.commands.get("paragraph"),c=[s];for(const e of r){const t={type:"button",model:new Df({label:e.title,class:e.class,withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(l,"value"),t.model.set("commandName","paragraph"),c.push(l)):(t.model.bind("isOn").to(s,"value",t=>t===e.model),t.model.set({commandName:"heading",commandValue:e.model})),a.add(t),i[e.model]=e.title}const u=$c(t);return Xc(u,a),u.buttonView.set({isOn:!1,withText:!0,tooltip:o}),u.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),u.bind("isEnabled").toMany(c,"isEnabled",(...e)=>e.some(e=>e)),u.buttonView.bind("label").to(s,"value",l,"value",(e,t)=>{const r=e||t&&"paragraph";return i[r]?i[r]:n}),this.listenTo(u,"execute",t=>{e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()}),u})}}function Rf(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}function Lf(e){const t=e.parent;return"figcaption"==e.name&&t&&"figure"==t.name&&t.hasClass("image")?{name:!0}:null}class Nf extends au{static get pluginName(){return"ImageCaptionEditing"}init(){const e=this.editor,t=e.editing.view,r=e.model.schema,n=e.data,o=e.editing,i=e.t;r.register("caption",{allowIn:"image",allowContentOf:"$block",isLimit:!0}),e.model.document.registerPostFixer(e=>this._insertMissingModelCaptionElement(e)),e.conversion.for("upcast").elementToElement({view:Lf,model:"caption"}),n.downcastDispatcher.on("insert:caption",Bf(e=>e.createContainerElement("figcaption"),!1));const a=function(e,t){return r=>{const n=r.createEditableElement("figcaption");return r.setCustomProperty("imageCaption",!0,n),Ml({view:e,element:n,text:t}),lh(n,r)}}(t,i("Enter image caption"));o.downcastDispatcher.on("insert:caption",Bf(a)),o.downcastDispatcher.on("insert",this._fixCaptionVisibility(e=>e.item),{priority:"high"}),o.downcastDispatcher.on("remove",this._fixCaptionVisibility(e=>e.position.parent),{priority:"high"}),t.document.registerPostFixer(e=>this._updateCaptionVisibility(e))}_updateCaptionVisibility(e){const t=this.editor.editing.mapper,r=this._lastSelectedCaption;let n;const o=this.editor.model.document.selection,i=o.getSelectedElement();if(i&&i.is("element","image")){const e=Rf(i);n=t.toViewElement(e)}const a=Ff(o.getFirstPosition().parent);if(a&&(n=t.toViewElement(a)),n&&!this.editor.isReadOnly)return r?(r===n||(Vf(r,e),this._lastSelectedCaption=n),Uf(n,e)):(this._lastSelectedCaption=n,Uf(n,e));if(r){const t=Vf(r,e);return this._lastSelectedCaption=null,t}return!1}_fixCaptionVisibility(e){return(t,r,n)=>{const o=Ff(e(r)),i=this.editor.editing.mapper,a=n.writer;if(o){const e=i.toViewElement(o);e&&(o.childCount?a.removeClass("ck-hidden",e):a.addClass("ck-hidden",e))}}}_insertMissingModelCaptionElement(e){const t=this.editor.model,r=t.document.differ.getChanges(),n=[];for(const e of r)if("insert"==e.type&&"$text"!=e.name){const r=e.position.nodeAfter;if(r.is("element","image")&&!Rf(r)&&n.push(r),!r.is("element","image")&&r.childCount)for(const e of t.createRangeIn(r).getItems())e.is("element","image")&&!Rf(e)&&n.push(e)}for(const t of n)e.appendElement("caption",t);return!!n.length}}function Bf(e,t=!0){return(r,n,o)=>{const i=n.item;if((i.childCount||t)&&ph(i.parent)){if(!o.consumable.consume(n.item,"insert"))return;const t=o.mapper.toViewElement(n.range.start.parent),r=e(o.writer),a=o.writer;i.childCount||a.addClass("ck-hidden",r),function(e,t,r,n){const o=n.writer.createPositionAt(r,"end");n.writer.insert(o,e),n.mapper.bindElements(t,e)}(r,n.item,t,o)}}}function Ff(e){const t=e.getAncestors({includeSelf:!0}).find(e=>"caption"==e.name);return t&&t.parent&&"image"==t.parent.name?t:null}function Vf(e,t){return!e.childCount&&!e.hasClass("ck-hidden")&&(t.addClass("ck-hidden",e),!0)}function Uf(e,t){return!!e.hasClass("ck-hidden")&&(t.removeClass("ck-hidden",e),!0)}var qf=i(8662);Pl()(qf.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),qf.Z.locals;class Hf extends pu{constructor(e,t){super(e),this.defaultStyle=!1,this.styles=t.reduce((e,t)=>(e[t.name]=t,t.isDefault&&(this.defaultStyle=t.name),e),{})}refresh(){const e=this.editor.model.document.selection.getSelectedElement();if(this.isEnabled=ph(e),e)if(e.hasAttribute("imageStyle")){const t=e.getAttribute("imageStyle");this.value=!!this.styles[t]&&t}else this.value=this.defaultStyle;else this.value=!1}execute(e){const t=e.value,r=this.editor.model,n=r.document.selection.getSelectedElement();r.change(e=>{this.styles[t].isDefault?e.removeAttribute("imageStyle",n):e.setAttribute("imageStyle",t,n)})}}function Wf(e,t){for(const r of t)if(r.name===e)return r}const Gf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>',Zf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>',Yf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>',$f='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>',Kf={full:{name:"full",title:"Full size image",icon:Gf,isDefault:!0},side:{name:"side",title:"Side image",icon:$f,className:"image-style-side"},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:Zf,className:"image-style-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:Yf,className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:$f,className:"image-style-align-right"}},Xf={full:Gf,left:Zf,right:$f,center:Yf};function Jf(e=[]){return e.map(Qf)}function Qf(e){if("string"==typeof e){const t=e;Kf[t]?e=Object.assign({},Kf[t]):(Ht("image-style-not-found",{name:t}),e={name:t})}else if(Kf[e.name]){const t=Kf[e.name],r=Object.assign({},e);for(const n in t)Object.prototype.hasOwnProperty.call(e,n)||(r[n]=t[n]);e=r}return"string"==typeof e.icon&&Xf[e.icon]&&(e.icon=Xf[e.icon]),e}class em extends au{static get pluginName(){return"ImageStyleEditing"}init(){const e=this.editor,t=e.model.schema,r=e.data,n=e.editing;e.config.define("image.styles",["full","side"]);const o=Jf(e.config.get("image.styles"));t.extend("image",{allowAttributes:"imageStyle"});const i=function(e){return(t,r,n)=>{if(!n.consumable.consume(r.item,t.name))return;const o=Wf(r.attributeNewValue,e),i=Wf(r.attributeOldValue,e),a=n.mapper.toViewElement(r.item),s=n.writer;i&&s.removeClass(i.className,a),o&&s.addClass(o.className,a)}}(o);n.downcastDispatcher.on("attribute:imageStyle:image",i),r.downcastDispatcher.on("attribute:imageStyle:image",i),r.upcastDispatcher.on("element:figure",function(e){const t=e.filter(e=>!e.isDefault);return(e,r,n)=>{if(!r.modelRange)return;const o=r.viewItem,i=_d(r.modelRange.getItems());if(!i||n.schema.checkAttribute(i,"imageStyle"))for(const e of t)n.consumable.consume(o,{classes:e.className})&&n.writer.setAttribute("imageStyle",e.name,i)}}(o),{priority:"low"}),e.commands.add("imageStyle",new Hf(e,o))}}var tm=i(4622);Pl()(tm.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),tm.Z.locals;class rm extends au{static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=function(e,t){for(const r of e)t[r.title]&&(r.title=t[r.title]);return e}(Jf(this.editor.config.get("image.styles")),this.localizedDefaultStylesTitles);for(const t of e)this._createButton(t)}_createButton(e){const t=this.editor,r="imageStyle:"+e.name;t.ui.componentFactory.add(r,r=>{const n=t.commands.get("imageStyle"),o=new Lc(r);return o.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n,"isEnabled"),o.bind("isOn").to(n,"value",t=>t===e.name),this.listenTo(o,"execute",()=>{t.execute("imageStyle",{value:e.name}),t.editing.view.focus()}),o})}}class nm extends au{static get requires(){return[$p]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",t=>{(function(e){const t=e.getSelectedElement();return!(!t||!oh(t))})(e.editing.view.document.selection)&&t.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:r,getRelatedElement:n,balloonClassName:o="ck-toolbar-container"}){if(!r.length)return void Ht("widget-toolbar-no-items",{toolbarId:e});const i=this.editor,a=i.t,s=new Qc(i.locale);if(s.ariaLabel=t||a("Widget toolbar"),this._toolbarDefinitions.has(e))throw new qt("widget-toolbar-duplicated",this,{toolbarId:e});s.fillFromConfig(r,i.ui.componentFactory),this._toolbarDefinitions.set(e,{view:s,getRelatedElement:n,balloonClassName:o})}_updateToolbarsVisibility(){let e=0,t=null,r=null;for(const n of this._toolbarDefinitions.values()){const o=n.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&o)if(this.editor.ui.focusTracker.isFocused){const i=o.getAncestors().length;i>e&&(e=i,t=o,r=n)}else this._isToolbarVisible(n)&&this._hideToolbar(n);else this._isToolbarInBalloon(n)&&this._hideToolbar(n)}r&&this._showToolbar(r,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?om(this.editor,t):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:im(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const e of this._toolbarDefinitions.values())if(this._isToolbarVisible(e)){const t=e.getRelatedElement(this.editor.editing.view.document.selection);om(this.editor,t)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function om(e,t){const r=e.plugins.get("ContextualBalloon"),n=im(e,t);r.updatePosition(n)}function im(e,t){const r=e.editing.view,n=Kd.defaultPositions;return{target:r.domConverter.mapViewToDom(t),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,uh]}}class am extends pu{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){return this._getFirstEnabledCommand().execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find(e=>e.isEnabled)}}class sm extends au{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new am(e)),e.commands.add("outdent",new am(e))}}const lm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95L5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',cm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';class um extends au{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,r=e.t,n="ltr"==t.uiLanguageDirection?lm:cm,o="ltr"==t.uiLanguageDirection?cm:lm;this._defineButton("indent",r("Increase indent"),n),this._defineButton("outdent",r("Decrease indent"),o)}_defineButton(e,t,r){const n=this.editor;n.ui.componentFactory.add(e,o=>{const i=n.commands.get(e),a=new Lc(o);return a.set({label:t,icon:r,tooltip:!0}),a.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(a,"execute",()=>{n.execute(e),n.editing.view.focus()}),a})}}class dm extends di{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}var hm=i(4827);Pl()(hm.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),hm.Z.locals;class pm extends oc{constructor(e,t){super(e);const r=e.t;this.focusTracker=new El,this.keystrokes=new vl,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(r("Save"),Vp,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(r("Cancel"),Up,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const n=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&n.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:n,tabindex:"-1"},children:this.children}),Bp(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,t)=>(e[t.name]=t.isOn,e),{})}render(){super.render(),Fp({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new zp(this.locale,Lp);return t.label=e("Link URL"),t}_createButton(e,t,r,n){const o=new Lc(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:r}}),n&&o.delegate("execute").to(this,n),o}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const r of e.manualDecorators){const n=new Wc(this.locale);n.set({name:r.id,label:r.label,withText:!0}),n.bind("isOn").toMany([r,e],"value",(e,t)=>void 0===t&&void 0===e?r.defaultValue:e),n.on("execute",()=>{r.set("value",!n.isOn)}),t.add(n)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new oc;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}const fm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.3 17.37l-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506L13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5L9.375 17H19v1.5H8z"/></svg>';var mm=i(9465);Pl()(mm.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),mm.Z.locals;class gm extends oc{constructor(e){super(e);const t=e.t;this.focusTracker=new El,this.keystrokes=new vl,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(t("Unlink"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562l-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',"unlink"),this.editButtonView=this._createButton(t("Edit link"),fm,"edit"),this.set("href"),this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(e,t,r){const n=new Lc(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.delegate("execute").to(this,r),n}_createPreviewButton(){const e=new Lc(this.locale),t=this.bindTemplate,r=this.t;return e.set({withText:!0,tooltip:r("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",e=>e&&Xh(e)),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",e=>e||r("This link has no URL")),e.bind("isEnabled").to(this,"href",e=>!!e),e.template.tag="a",e.template.eventListeners={},e}}const bm="link-ui";class vm extends au{static get requires(){return[$p]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(dm),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get($p),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),e.conversion.for("editingDowncast").markerToHighlight({model:bm,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:bm,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new gm(e.locale),r=e.commands.get("link"),n=e.commands.get("unlink");return t.bind("href").to(r,"value"),t.editButtonView.bind("isEnabled").to(r),t.unlinkButtonView.bind("isEnabled").to(n),this.listenTo(t,"edit",()=>{this._addFormView()}),this.listenTo(t,"unlink",()=>{e.execute("unlink"),this._hideUI()}),t.keystrokes.set("Esc",(e,t)=>{this._hideUI(),t()}),t.keystrokes.set($h,(e,t)=>{this._addFormView(),t()}),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),r=e.config.get("link.defaultProtocol"),n=new pm(e.locale,t);return n.urlInputView.fieldView.bind("value").to(t,"value"),n.urlInputView.bind("isReadOnly").to(t,"isEnabled",e=>!e),n.saveButtonView.bind("isEnabled").to(t),this.listenTo(n,"submit",()=>{const{value:t}=n.urlInputView.fieldView.element,o=Qh(t,r);e.execute("link",o,n.getDecoratorSwitchesState()),this._closeFormView()}),this.listenTo(n,"cancel",()=>{this._closeFormView()}),n.keystrokes.set("Esc",(e,t)=>{this._closeFormView(),t()}),n}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link"),r=e.t;e.keystrokes.set($h,(e,r)=>{r(),t.isEnabled&&this._showUI(!0)}),e.ui.componentFactory.add("link",e=>{const n=new Lc(e);return n.isEnabled=!0,n.label=r("Link"),n.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>',n.keystroke=$h,n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(t,"isEnabled"),n.bind("isOn").to(t,"value",e=>!!e),this.listenTo(n,"execute",()=>this._showUI(!0)),n})}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,t)=>{this._isUIVisible&&(this._hideUI(),t())}),Gc({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const e=this.editor.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=e.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let r=this._getSelectedLinkElement(),n=i();const o=()=>{const e=this._getSelectedLinkElement(),t=i();r&&!e||!r&&t!==n?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),r=e,n=t};function i(){return t.selection.focus.getAncestors().reverse().find(e=>e.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,r=e.document;let n=null;if(t.markers.has(bm)){const t=Array.from(this.editor.editing.mapper.markerNameToElements(bm)),r=e.createRange(e.createPositionBefore(t[0]),e.createPositionAfter(t[t.length-1]));n=e.domConverter.viewRangeToDom(r)}else{const t=this._getSelectedLinkElement(),o=r.selection.getFirstRange();n=t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(o)}return{target:n}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection;if(t.isCollapsed)return ym(t.getFirstPosition());{const r=t.getFirstRange().getTrimmed(),n=ym(r.start),o=ym(r.end);return n&&n==o&&e.createRangeIn(n).getTrimmed().isEqual(r)?n:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change(t=>{const r=e.document.selection.getFirstRange();if(e.markers.has(bm))t.updateMarker(bm,{range:r});else if(r.start.isAtEnd){const n=r.start.getLastMatchingPosition(({item:t})=>!e.schema.isContent(t),{boundaries:r});t.addMarker(bm,{usingOperation:!1,affectsData:!1,range:t.createRange(n,r.end)})}else t.addMarker(bm,{usingOperation:!1,affectsData:!1,range:r})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(bm)&&e.change(e=>{e.removeMarker(bm)})}}function ym(e){return e.getAncestors().find(e=>{return(t=e).is("attributeElement")&&!!t.getCustomProperty("link");var t})}function _m(e,t){let r=e.start;return{text:Array.from(e.getItems()).reduce((e,n)=>n.is("$text")||n.is("$textProxy")?e+n.data:(r=t.createPositionAfter(n),""),""),range:t.createRange(r,e.end)}}class wm{constructor(e,t){this.model=e,this.testCallback=t,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}_startListening(){const e=this.model.document;this.listenTo(e.selection,"change:range",(t,{directChange:r})=>{r&&(e.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))}),this.listenTo(e,"change:data",(e,t)=>{"transparent"!=t.type&&this._evaluateTextBeforeSelection("data",{batch:t})})}_evaluateTextBeforeSelection(e,t={}){const r=this.model,n=r.document.selection,o=r.createRange(r.createPositionAt(n.focus.parent,0),n.focus),{text:i,range:a}=_m(o,r),s=this.testCallback(i);if(!s&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!s,s){const r=Object.assign(t,{text:i,range:a});"object"==typeof s&&Object.assign(r,s),this.fire("matched:"+e,r)}}}ir(wm,fn);const xm=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?![-_])(?:[-\\w\\u00a1-\\uffff]{0,63}[^-_]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-\\w\\u00a1-\\uffff]{0,63}[^-_]\\.))+(?:[a-z\\u00a1-\\uffff]{2,})))$","i");class km extends au{static get pluginName(){return"AutoLink"}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const e=this.editor,t=new wm(e.model,e=>{if(!function(e){return e.length>4&&" "===e[e.length-1]&&" "!==e[e.length-2]}(e))return;const t=Cm(e.substr(0,e.length-1));return t?{url:t}:void 0}),r=e.plugins.get("Input");t.on("matched:data",(t,n)=>{const{batch:o,range:i,url:a}=n;if(!r.isInput(o))return;const s=i.end.getShiftedBy(-1),l=s.getShiftedBy(-a.length),c=e.model.createRange(l,s);this._applyAutoLink(a,c)}),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,r=e.commands.get("enter");r&&r.on("execute",()=>{const e=t.document.selection.getFirstPosition();if(!e.parent.previousSibling)return;const r=t.createRangeIn(e.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(r)})}_enableShiftEnterHandling(){const e=this.editor,t=e.model,r=e.commands.get("shiftEnter");r&&r.on("execute",()=>{const e=t.document.selection.getFirstPosition(),r=t.createRange(t.createPositionAt(e.parent,0),e.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(r)})}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:r,range:n}=_m(e,t),o=Cm(r);if(o){const e=t.createRange(n.end.getShiftedBy(-o.length),n.end);this._applyAutoLink(o,e)}}_applyAutoLink(e,t){const r=this.editor.model;this.isEnabled&&function(e,t){return t.schema.checkAttributeInSelection(t.createSelection(e),"linkHref")}(t,r)&&r.enqueueChange(r=>{const n=this.editor.config.get("link.defaultProtocol"),o=Qh(e,n);r.setAttribute("linkHref",o,t)})}}function Cm(e){const t=xm.exec(e);return t?t[2]:null}class Em extends pu{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document,r=Array.from(t.selection.getSelectedBlocks()).filter(t=>Tm(t,e.schema)),n=!0===this.value;e.change(e=>{if(n){let t=r[r.length-1].nextSibling,n=Number.POSITIVE_INFINITY,o=[];for(;t&&"listItem"==t.name&&0!==t.getAttribute("listIndent");){const e=t.getAttribute("listIndent");e<n&&(n=e);const r=e-n;o.push({element:t,listIndent:r}),t=t.nextSibling}o=o.reverse();for(const t of o)e.setAttribute("listIndent",t.listIndent,t.element)}if(!n){let e=Number.POSITIVE_INFINITY;for(const t of r)t.is("element","listItem")&&t.getAttribute("listIndent")<e&&(e=t.getAttribute("listIndent"));e=0===e?1:e,Sm(r,!0,e),Sm(r,!1,e)}for(const t of r.reverse())n&&"listItem"==t.name?e.rename(t,"paragraph"):n||"listItem"==t.name?n||"listItem"!=t.name||t.getAttribute("listType")==this.type||e.setAttribute("listType",this.type,t):(e.setAttributes({listType:this.type,listIndent:0},t),e.rename(t,"listItem"));this.fire("_executeCleanup",r)})}_getValue(){const e=_d(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("element","listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,r=_d(e.getSelectedBlocks());return!!r&&Tm(r,t)}}function Sm(e,t,r){const n=t?e[0]:e[e.length-1];if(n.is("element","listItem")){let o=n[t?"previousSibling":"nextSibling"],i=n.getAttribute("listIndent");for(;o&&o.is("element","listItem")&&o.getAttribute("listIndent")>=r;)i>o.getAttribute("listIndent")&&(i=o.getAttribute("listIndent")),o.getAttribute("listIndent")==i&&e[t?"unshift":"push"](o),o=o[t?"previousSibling":"nextSibling"]}}function Tm(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e)}class Am extends pu{constructor(e,t){super(e),this._indentBy="forward"==t?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document;let r=Array.from(t.selection.getSelectedBlocks());e.change(e=>{const t=r[r.length-1];let n=t.nextSibling;for(;n&&"listItem"==n.name&&n.getAttribute("listIndent")>t.getAttribute("listIndent");)r.push(n),n=n.nextSibling;this._indentBy<0&&(r=r.reverse());for(const t of r){const r=t.getAttribute("listIndent")+this._indentBy;r<0?e.rename(t,"paragraph"):e.setAttribute("listIndent",r,t)}this.fire("_executeCleanup",r)})}_checkEnabled(){const e=_d(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("element","listItem"))return!1;if(this._indentBy>0){const t=e.getAttribute("listIndent"),r=e.getAttribute("listType");let n=e.previousSibling;for(;n&&n.is("element","listItem")&&n.getAttribute("listIndent")>=t;){if(n.getAttribute("listIndent")==t)return n.getAttribute("listType")==r;n=n.previousSibling}return!1}return!0}}function Pm(e,t,r,n){const o=t.parent,i=r.mapper,a=r.writer;let s=i.toViewPosition(n.createPositionBefore(e));const l=Mm(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),c=e.previousSibling;if(l&&l.getAttribute("listIndent")==e.getAttribute("listIndent")){const e=i.toViewElement(l);s=a.breakContainer(a.createPositionAfter(e))}else if(c&&"listItem"==c.name){s=i.toViewPosition(n.createPositionAt(c,"end"));const e=i.findMappedViewAncestor(s),t=function(e){for(const t of e.getChildren())if("ul"==t.name||"ol"==t.name)return t;return null}(e);s=t?a.createPositionBefore(t):a.createPositionAt(e,"end")}else s=i.toViewPosition(n.createPositionBefore(e));if(s=Om(s),a.insert(s,o),c&&"listItem"==c.name){const e=i.toViewElement(c),r=a.createRange(a.createPositionAt(e,0),s).getWalker({ignoreElementEnd:!0});for(const e of r)if(e.item.is("element","li")){const n=a.breakContainer(a.createPositionBefore(e.item)),o=e.item.parent,i=a.createPositionAt(t,"end");Im(a,i.nodeBefore,i.nodeAfter),a.move(a.createRangeOn(o),i),r.position=n}}else{const r=o.nextSibling;if(r&&(r.is("element","ul")||r.is("element","ol"))){let n=null;for(const t of r.getChildren()){const r=i.toModelElement(t);if(!(r&&r.getAttribute("listIndent")>e.getAttribute("listIndent")))break;n=t}n&&(a.breakContainer(a.createPositionAfter(n)),a.move(a.createRangeOn(n.parent),a.createPositionAt(t,"end")))}}Im(a,o,o.nextSibling),Im(a,o.previousSibling,o)}function Im(e,t,r){return!t||!r||"ul"!=t.name&&"ol"!=t.name||t.name!=r.name||t.getAttribute("class")!==r.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t))}function Om(e){return e.getLastMatchingPosition(e=>e.item.is("uiElement"))}function Mm(e,t){const r=!!t.sameIndent,n=!!t.smallerIndent,o=t.listIndent;let i=e;for(;i&&"listItem"==i.name;){const e=i.getAttribute("listIndent");if(r&&o==e||n&&o>e)return i;i="forward"===t.direction?i.nextSibling:i.previousSibling}return null}function Dm(e,t,r,n){e.ui.componentFactory.add(t,o=>{const i=e.commands.get(t),a=new Lc(o);return a.set({label:r,icon:n,tooltip:!0,isToggleable:!0}),a.bind("isOn","isEnabled").to(i,"value","isEnabled"),a.on("execute",()=>{e.execute(t),e.editing.view.focus()}),a})}function zm(){const e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:ln.call(this)}function jm(e){return(t,r,n)=>{const o=n.consumable;if(!o.test(r.item,"insert")||!o.test(r.item,"attribute:listType")||!o.test(r.item,"attribute:listIndent"))return;o.consume(r.item,"insert"),o.consume(r.item,"attribute:listType"),o.consume(r.item,"attribute:listIndent");const i=r.item;Pm(i,function(e,t){const r=t.mapper,n=t.writer,o="numbered"==e.getAttribute("listType")?"ol":"ul",i=function(e){const t=e.createContainerElement("li");return t.getFillerOffset=zm,t}(n),a=n.createContainerElement(o,null);return n.insert(n.createPositionAt(a,0),i),r.bindElements(e,i),i}(i,n),n,e)}}function Rm(e,t,r){if(!r.consumable.consume(t.item,"attribute:listType"))return;const n=r.mapper.toViewElement(t.item),o=r.writer;o.breakContainer(o.createPositionBefore(n)),o.breakContainer(o.createPositionAfter(n));const i=n.parent,a="numbered"==t.attributeNewValue?"ol":"ul";o.rename(a,i)}function Lm(e,t,r){const n=r.mapper.toViewElement(t.item).parent,o=r.writer;Im(o,n,n.nextSibling),Im(o,n.previousSibling,n);for(const e of t.item.getChildren())r.consumable.consume(e,"insert")}function Nm(e,t,r){if("listItem"!=t.item.name){let e=r.mapper.toViewPosition(t.range.start);const n=r.writer,o=[];for(;("ul"==e.parent.name||"ol"==e.parent.name)&&(e=n.breakContainer(e),"li"==e.parent.name);){const t=e,r=n.createPositionAt(e.parent,"end");if(!t.isEqual(r)){const e=n.remove(n.createRange(t,r));o.push(e)}e=n.createPositionAfter(e.parent)}if(o.length>0){for(let t=0;t<o.length;t++){const r=e.nodeBefore;if(e=n.insert(e,o[t]).end,t>0){const t=Im(n,r,r.nextSibling);t&&t.parent==r&&e.offset--}}Im(n,e.nodeBefore,e.nodeAfter)}}}function Bm(e,t,r){const n=r.mapper.toViewPosition(t.position),o=n.nodeBefore,i=n.nodeAfter;Im(r.writer,o,i)}function Fm(e,t,r){if(r.consumable.consume(t.viewItem,{name:!0})){const e=r.writer,n=e.createElement("listItem"),o=function(e){let t=0,r=e.parent;for(;r;){if(r.is("element","li"))t++;else{const e=r.previousSibling;e&&e.is("element","li")&&t++}r=r.parent}return t}(t.viewItem);e.setAttribute("listIndent",o,n);const i=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";if(e.setAttribute("listType",i,n),!r.safeInsert(n,t.modelCursor))return;const a=function(e,t,r){const{writer:n,schema:o}=r;let i=n.createPositionAfter(e);for(const a of t)if("ul"==a.name||"ol"==a.name)i=r.convertItem(a,i).modelCursor;else{const t=r.convertItem(a,n.createPositionAt(e,"end")),s=t.modelRange.start.nodeAfter;s&&s.is("element")&&!o.checkChild(e,s.name)&&(e=t.modelCursor.parent.is("element","listItem")?t.modelCursor.parent:Wm(t.modelCursor),i=n.createPositionAfter(e))}return i}(n,t.viewItem.getChildren(),r);t.modelRange=e.createRange(t.modelCursor,a),r.updateConversionResult(n,t)}}function Vm(e,t,r){if(r.consumable.test(t.viewItem,{name:!0})){const e=Array.from(t.viewItem.getChildren());for(const t of e)!t.is("element","li")&&!Zm(t)&&t._remove()}}function Um(e,t,r){if(r.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;const e=[...t.viewItem.getChildren()];let r=!1,n=!0;for(const t of e)r&&!Zm(t)&&t._remove(),t.is("$text")?(n&&(t._data=t.data.replace(/^\s+/,"")),t.nextSibling&&!Zm(t.nextSibling)||(t._data=t.data.replace(/\s+$/,""))):Zm(t)&&(r=!0),n=!1}}function qm(e){return(t,r)=>{if(r.isPhantom)return;const n=r.modelPosition.nodeBefore;if(n&&n.is("element","listItem")){const t=r.mapper.toViewElement(n),o=t.getAncestors().find(Zm),i=e.createPositionAt(t,0).getWalker();for(const e of i){if("elementStart"==e.type&&e.item.is("element","li")){r.viewPosition=e.previousPosition;break}if("elementEnd"==e.type&&e.item==o){r.viewPosition=e.nextPosition;break}}}}}function Hm(e,[t,r]){let n,o=t.is("documentFragment")?t.getChild(0):t;if(n=r?this.createSelection(r):this.document.selection,o&&o.is("element","listItem")){const e=n.getFirstPosition();let t=null;if(e.parent.is("element","listItem")?t=e.parent:e.nodeBefore&&e.nodeBefore.is("element","listItem")&&(t=e.nodeBefore),t){const e=t.getAttribute("listIndent");if(e>0)for(;o&&o.is("element","listItem");)o._setAttribute("listIndent",o.getAttribute("listIndent")+e),o=o.nextSibling}}}function Wm(e){const t=new Ji({startPosition:e});let r;do{r=t.next()}while(!r.value.item.is("element","listItem"));return r.value.item}function Gm(e,t,r,n,o,i){const a=Mm(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e,foo:"b"}),s=o.mapper,l=o.writer,c=a?a.getAttribute("listIndent"):null;let u;if(a)if(c==e){const e=s.toViewElement(a).parent;u=l.createPositionAfter(e)}else{const e=i.createPositionAt(a,"end");u=s.toViewPosition(e)}else u=r;u=Om(u);for(const e of[...n.getChildren()])Zm(e)&&(u=l.move(l.createRangeOn(e),u).end,Im(l,e,e.nextSibling),Im(l,e.previousSibling,e))}function Zm(e){return e.is("element","ol")||e.is("element","ul")}class Ym extends au{static get pluginName(){return"ListEditing"}static get requires(){return[Af]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const t=e.data,r=e.editing;var n;e.model.document.registerPostFixer(t=>function(e,t){const r=e.document.differ.getChanges(),n=new Map;let o=!1;for(const n of r)if("insert"==n.type&&"listItem"==n.name)i(n.position);else if("insert"==n.type&&"listItem"!=n.name){if("$text"!=n.name){const r=n.position.nodeAfter;r.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",r),o=!0),r.hasAttribute("listType")&&(t.removeAttribute("listType",r),o=!0),r.hasAttribute("listStyle")&&(t.removeAttribute("listStyle",r),o=!0);for(const t of Array.from(e.createRangeIn(r)).filter(e=>e.item.is("element","listItem")))i(t.previousPosition)}i(n.position.getShiftedBy(n.length))}else"remove"==n.type&&"listItem"==n.name?i(n.position):("attribute"==n.type&&"listIndent"==n.attributeKey||"attribute"==n.type&&"listType"==n.attributeKey)&&i(n.range.start);for(const e of n.values())a(e),s(e);return o;function i(e){const t=e.nodeBefore;if(t&&t.is("element","listItem")){let e=t;if(n.has(e))return;for(let t=e.previousSibling;t&&t.is("element","listItem");t=e.previousSibling)if(e=t,n.has(e))return;n.set(t,e)}else{const t=e.nodeAfter;t&&t.is("element","listItem")&&n.set(t,t)}}function a(e){let r=0,n=null;for(;e&&e.is("element","listItem");){const i=e.getAttribute("listIndent");if(i>r){let a;null===n?(n=i-r,a=r):(n>i&&(n=i),a=i-n),t.setAttribute("listIndent",a,e),o=!0}else n=null,r=e.getAttribute("listIndent")+1;e=e.nextSibling}}function s(e){let r=[],n=null;for(;e&&e.is("element","listItem");){const i=e.getAttribute("listIndent");if(n&&n.getAttribute("listIndent")>i&&(r=r.slice(0,i+1)),0!=i)if(r[i]){const n=r[i];e.getAttribute("listType")!=n&&(t.setAttribute("listType",n,e),o=!0)}else r[i]=e.getAttribute("listType");n=e,e=e.nextSibling}}}(e.model,t)),r.mapper.registerViewToModelLength("li",$m),t.mapper.registerViewToModelLength("li",$m),r.mapper.on("modelToViewPosition",qm(r.view)),r.mapper.on("viewToModelPosition",(n=e.model,(e,t)=>{const r=t.viewPosition,o=r.parent,i=t.mapper;if("ul"==o.name||"ol"==o.name){if(r.isAtEnd){const e=i.toModelElement(r.nodeBefore),o=i.getModelLength(r.nodeBefore);t.modelPosition=n.createPositionBefore(e).getShiftedBy(o)}else{const e=i.toModelElement(r.nodeAfter);t.modelPosition=n.createPositionBefore(e)}e.stop()}else if("li"==o.name&&r.nodeBefore&&("ul"==r.nodeBefore.name||"ol"==r.nodeBefore.name)){const a=i.toModelElement(o);let s=1,l=r.nodeBefore;for(;l&&Zm(l);)s+=i.getModelLength(l),l=l.previousSibling;t.modelPosition=n.createPositionBefore(a).getShiftedBy(s),e.stop()}})),t.mapper.on("modelToViewPosition",qm(r.view)),e.conversion.for("editingDowncast").add(t=>{t.on("insert",Nm,{priority:"high"}),t.on("insert:listItem",jm(e.model)),t.on("attribute:listType:listItem",Rm,{priority:"high"}),t.on("attribute:listType:listItem",Lm,{priority:"low"}),t.on("attribute:listIndent:listItem",function(e){return(t,r,n)=>{if(!n.consumable.consume(r.item,"attribute:listIndent"))return;const o=n.mapper.toViewElement(r.item),i=n.writer;i.breakContainer(i.createPositionBefore(o)),i.breakContainer(i.createPositionAfter(o));const a=o.parent,s=a.previousSibling,l=i.createRangeOn(a);i.remove(l),s&&s.nextSibling&&Im(i,s,s.nextSibling),Gm(r.attributeOldValue+1,r.range.start,l.start,o,n,e),Pm(r.item,o,n,e);for(const e of r.item.getChildren())n.consumable.consume(e,"insert")}}(e.model)),t.on("remove:listItem",function(e){return(t,r,n)=>{const o=n.mapper.toViewPosition(r.position).getLastMatchingPosition(e=>!e.item.is("element","li")).nodeAfter,i=n.writer;i.breakContainer(i.createPositionBefore(o)),i.breakContainer(i.createPositionAfter(o));const a=o.parent,s=a.previousSibling,l=i.createRangeOn(a),c=i.remove(l);s&&s.nextSibling&&Im(i,s,s.nextSibling),Gm(n.mapper.toModelElement(o).getAttribute("listIndent")+1,r.position,l.start,o,n,e);for(const e of i.createRangeIn(c).getItems())n.mapper.unbindViewElement(e);t.stop()}}(e.model)),t.on("remove",Bm,{priority:"low"})}),e.conversion.for("dataDowncast").add(t=>{t.on("insert",Nm,{priority:"high"}),t.on("insert:listItem",jm(e.model))}),e.conversion.for("upcast").add(e=>{e.on("element:ul",Vm,{priority:"high"}),e.on("element:ol",Vm,{priority:"high"}),e.on("element:li",Um,{priority:"high"}),e.on("element:li",Fm)}),e.model.on("insertContent",Hm,{priority:"high"}),e.commands.add("numberedList",new Em(e,"numbered")),e.commands.add("bulletedList",new Em(e,"bulleted")),e.commands.add("indentList",new Am(e,"forward")),e.commands.add("outdentList",new Am(e,"backward"));const o=r.view.document;this.listenTo(o,"enter",(e,t)=>{const r=this.editor.model.document,n=r.selection.getLastPosition().parent;r.selection.isCollapsed&&"listItem"==n.name&&n.isEmpty&&(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),this.listenTo(o,"delete",(e,t)=>{if("backward"!==t.direction)return;const r=this.editor.model.document.selection;if(!r.isCollapsed)return;const n=r.getFirstPosition();if(!n.isAtStart)return;const o=n.parent;"listItem"===o.name&&(o.previousSibling&&"listItem"===o.previousSibling.name||(this.editor.execute("outdentList"),t.preventDefault(),e.stop()))},{priority:Ut.high+10});const i=e=>(t,r)=>{this.editor.commands.get(e).isEnabled&&(this.editor.execute(e),r())};e.keystrokes.set("Tab",i("indentList")),e.keystrokes.set("Shift+Tab",i("outdentList"))}afterInit(){const e=this.editor.commands,t=e.get("indent"),r=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),r&&r.registerChildCommand(e.get("outdentList"))}}function $m(e){let t=1;for(const r of e.getChildren())if("ul"==r.name||"ol"==r.name)for(const e of r.getChildren())t+=$m(e);return t}class Km extends au{init(){const e=this.editor.t;Dm(this.editor,"numberedList",e("Numbered List"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>'),Dm(this.editor,"bulletedList",e("Bulleted List"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>')}}function Xm(e,t){return e=>{e.on("attribute:url:media",r)};function r(r,n,o){if(!o.consumable.consume(n.item,r.name))return;const i=n.attributeNewValue,a=o.writer,s=o.mapper.toViewElement(n.item),l=[...s.getChildren()].find(e=>e.getCustomProperty("media-content"));a.remove(l);const c=e.getMediaViewElement(a,i,t);a.insert(a.createPositionAt(s,0),c)}}function Jm(e,t,r,n){const o=e.createContainerElement("figure",{class:"media"});return e.insert(e.createPositionAt(o,0),t.getMediaViewElement(e,r,n)),o}function Qm(e){const t=e.getSelectedElement();return t&&t.is("element","media")?t:null}function eg(e,t,r){e.change(n=>{const o=n.createElement("media",{url:t});e.insertContent(o,r),n.setSelection(o,"on")})}class tg extends pu{refresh(){const e=this.editor.model,t=e.document.selection,r=e.schema,n=ch(t,e),o=Qm(t);let i=n.parent;i.isEmpty&&!e.schema.isLimit(i)&&(i=i.parent),this.value=o?o.getAttribute("url"):null,this.isEnabled=r.checkChild(i,"media")}execute(e){const t=this.editor.model,r=t.document.selection,n=Qm(r);if(n)t.change(t=>{t.setAttribute("url",e,n)});else{const n=ch(r,t);eg(t,e,n)}}}class rg{constructor(e,t){const r=t.providers,n=t.extraProviders||[],o=new Set(t.removeProviders),i=r.concat(n).filter(e=>{const t=e.name;return t?!o.has(t):(Ht("media-embed-no-provider-name",{provider:e}),!1)});this.locale=e,this.providerDefinitions=i}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,r){return this._getMedia(t).getViewElement(e,r)}_getMedia(e){if(!e)return new ng(this.locale);e=e.trim();for(const t of this.providerDefinitions){const r=t.html,n=lr(t.url);for(const t of n){const n=this._getUrlMatches(e,t);if(n)return new ng(this.locale,e,n,r)}}return null}_getUrlMatches(e,t){let r=e.match(t);if(r)return r;let n=e.replace(/^https?:\/\//,"");return r=n.match(t),r||(n=n.replace(/^www\./,""),r=n.match(t),r||null)}}class ng{constructor(e,t,r,n){this.url=this._getValidUrl(t),this._t=e.t,this._match=r,this._previewRenderer=n}getViewElement(e,t){const r={};let n;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(r["data-oembed-url"]=this.url),t.renderForEditingView&&(r.class="ck-media__wrapper");const o=this._getPreviewHtml(t);n=e.createRawElement("div",r,(function(e){e.innerHTML=o}))}else this.url&&(r.url=this.url),n=e.createEmptyElement("oembed",r);return e.setCustomProperty("media-content",!0,n),n}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new jc,t=new Dc;return e.text=this._t("Open media in new tab"),t.content='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>',t.viewBox="0 0 64 42",new Nl({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render().outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}var og=i(952);Pl()(og.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),og.Z.locals;class ig extends au{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:/^google\.com\/maps/},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new rg(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,r=e.t,n=e.conversion,o=e.config.get("mediaEmbed.previewsInData"),i=this.registry;e.commands.add("mediaEmbed",new tg(e)),t.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),n.for("dataDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const r=e.getAttribute("url");return Jm(t,i,r,{renderMediaPreview:r&&o})}}),n.for("dataDowncast").add(Xm(i,{renderMediaPreview:o})),n.for("editingDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const n=e.getAttribute("url");return function(e,t,r){return t.setCustomProperty("media",!0,e),ih(e,t,{label:r})}(Jm(t,i,n,{renderForEditingView:!0}),t,r("media widget"))}}),n.for("editingDowncast").add(Xm(i,{renderForEditingView:!0})),n.for("upcast").elementToElement({view:{name:"oembed",attributes:{url:!0}},model:(e,{writer:t})=>{const r=e.getAttribute("url");if(i.hasMedia(r))return t.createElement("media",{url:r})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(e,{writer:t})=>{const r=e.getAttribute("data-oembed-url");if(i.hasMedia(r))return t.createElement("media",{url:r})}})}}const ag=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=%]+$/;class sg extends au{static get requires(){return[hu,ud]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document;this.listenTo(e.plugins.get(hu),"inputTransformation",()=>{const e=t.selection.getFirstRange(),r=el.fromPosition(e.start);r.stickiness="toPrevious";const n=el.fromPosition(e.end);n.stickiness="toNext",t.once("change:data",()=>{this._embedMediaBetweenPositions(r,n),r.detach(),n.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(Do.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(e,t){const r=this.editor,n=r.plugins.get(ig).registry,o=new ba(e,t),i=o.getWalker({ignoreElementEnd:!0});let a="";for(const e of i)e.item.is("$textProxy")&&(a+=e.item.data);a=a.trim(),a.match(ag)&&n.hasMedia(a)&&r.commands.get("mediaEmbed").isEnabled?(this._positionToInsert=el.fromPosition(e),this._timeoutId=Do.window.setTimeout(()=>{r.model.change(e=>{let t;this._timeoutId=null,e.remove(o),o.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(t=this._positionToInsert),eg(r.model,a,t),this._positionToInsert.detach(),this._positionToInsert=null})},100)):o.detach()}}var lg=i(3525);Pl()(lg.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),lg.Z.locals;class cg extends oc{constructor(e,t){super(t);const r=t.t;this.focusTracker=new El,this.keystrokes=new vl,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(r("Save"),Vp,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",e=>!!e),this.cancelButtonView=this._createButton(r("Cancel"),Up,"ck-button-cancel","cancel"),this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),Bp(this)}render(){super.render(),Fp({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element);const e=e=>e.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e),this.listenTo(this.urlInputView.element,"selectstart",(e,t)=>{t.stopPropagation()},{priority:"high"})}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new zp(this.locale,Lp),r=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,r.on("input",()=>{t.infoText=r.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=r.element.value.trim()}),t}_createButton(e,t,r,n){const o=new Lc(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:r}}),n&&o.delegate("execute").to(this,n),o}}class ug extends au{static get requires(){return[ig]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed"),r=e.plugins.get(ig).registry;e.ui.componentFactory.add("mediaEmbed",n=>{const o=$c(n),i=new cg(function(e,t){return[t=>{if(!t.url.length)return e("The URL must not be empty.")},r=>{if(!t.hasMedia(r.url))return e("This media URL is not supported.")}]}(e.t,r),e.locale);return this._setUpDropdown(o,i,t,e),this._setUpForm(o,i,t),o})}_setUpDropdown(e,t,r){const n=this.editor,o=n.t,i=e.buttonView;function a(){n.editing.view.focus(),e.isOpen=!1}e.bind("isEnabled").to(r),e.panelView.children.add(t),i.set({label:o("Insert media"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>',tooltip:!0}),i.on("open",()=>{t.disableCssTransitions(),t.url=r.value||"",t.urlInputView.fieldView.select(),t.focus(),t.enableCssTransitions()},{priority:"low"}),e.on("submit",()=>{t.isValid()&&(n.execute("mediaEmbed",t.url),a())}),e.on("change:isOpen",()=>t.resetFormStatus()),e.on("cancel",()=>a())}_setUpForm(e,t,r){t.delegate("submit","cancel").to(e),t.urlInputView.bind("value").to(r,"value"),t.urlInputView.bind("isReadOnly").to(r,"isEnabled",e=>!e)}}var dg=i(5777);function hg(e){switch(e){case"arabic-leading-zero":return"decimal-leading-zero";case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return e;default:return null}}function pg(e,t,r){const n=t.parent,o=r.createElement(e.type),i=n.getChildIndex(t)+1;return r.insertChild(i,o,n),e.style&&r.setStyle("list-style-type",e.style,o),o}function fg(e){const t={},r=e.getStyle("mso-list");if(r){const e=r.match(/(^|\s+)l(\d+)/i),n=r.match(/\s*lfo(\d+)/i),o=r.match(/\s*level(\d+)/i);e&&n&&o&&(t.id=e[2],t.order=n[1],t.indent=o[1])}return t}Pl()(dg.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),dg.Z.locals;const mg=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class gg{constructor(e){this.document=e}isActive(e){return mg.test(e)}execute(e){const t=new yf(this.document);!function(e,t){for(const r of e.getChildren())if(r.is("element","b")&&"normal"===r.getStyle("font-weight")){const n=e.getChildIndex(r);t.remove(r),t.insertChild(n,r.getChildren(),e)}}(e.content,t),function(e,t){for(const r of t.createRangeIn(e)){const e=r.item;if(e.is("element","li")){const r=e.getChild(0);r&&r.is("element","p")&&t.unwrapElement(r)}}}(e.content,t)}}function bg(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>1===t.length?" ":Array(t.length+1).join(" ").substr(0,t.length))}function vg(e){return btoa(e.match(/\w{2}/g).map(e=>String.fromCharCode(parseInt(e,16))).join(""))}const yg=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,_g=/xmlns:o="urn:schemas-microsoft-com/i;class wg{constructor(e){this.document=e}isActive(e){return yg.test(e)||_g.test(e)}execute(e){const{body:t,stylesString:r}=function(e,t){const r=new DOMParser,n=function(e){return bg(bg(e)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[\s]*?)[\r\n]+(\s*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g,"</").replace(/ <o:p><\/o:p>/g,"<o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>(\s*[\r\n]\s*)</g,"><")}(function(e){const t=e.match(/<\/body>(.*?)(<\/html>|$)/);return t&&t[1]&&(e=e.slice(0,t.index)+e.slice(t.index).replace(t[1],"")),e}(e=e.replace(/<!--\[if gte vml 1]>/g,""))),o=r.parseFromString(n,"text/html");!function(e){e.querySelectorAll("span[style*=spacerun]").forEach(e=>{const t=e.innerText.length||0;e.innerHTML=Array(t+1).join(" ").substr(0,t)})}(o);const i=o.body.innerHTML,a=function(e,t){const r=new In(t),n=new Lo(r,{blockFillerMode:"nbsp"}),o=e.createDocumentFragment(),i=e.body.childNodes;for(;i.length>0;)o.appendChild(i[0]);return n.domToView(o)}(o,t),s=function(e){const t=[],r=[],n=Array.from(e.getElementsByTagName("style"));for(const e of n)e.sheet&&e.sheet.cssRules&&e.sheet.cssRules.length&&(t.push(e.sheet),r.push(e.innerHTML));return{styles:t,stylesString:r.join(" ")}}(o);return{body:a,bodyString:i,styles:s.styles,stylesString:s.stylesString}}(e.dataTransfer.getData("text/html"),this.document.stylesProcessor);(function(e,t){if(!e.childCount)return;const r=new yf(e.document),n=function(e,t){const r=t.createRangeIn(e),n=new yr({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),o=[];for(const e of r)if("elementStart"===e.type&&n.match(e.item)){const t=fg(e.item);o.push({element:e.item,id:t.id,order:t.order,indent:t.indent})}return o}(e,r);if(!n.length)return;let o=null,i=1;n.forEach((e,a)=>{const s=function(e,t){if(!e)return!0;if(e.id!==t.id)return t.indent-e.indent!=1;const r=t.element.previousSibling;return!r||!((n=r).is("element","ol")||n.is("element","ul"));var n}(n[a-1],e),l=(u=e,(c=s?null:n[a-1])?u.indent-c.indent:u.indent-1);var c,u;if(s&&(o=null,i=1),!o||0!==l){const n=function(e,t){const r=/mso-level-number-format:([^;]*);/gi,n=new RegExp(`@list l${e.id}:level${e.indent}\\s*({[^}]*)`,"gi").exec(t);let o="decimal",i="ol";if(n&&n[1]){const t=r.exec(n[1]);if(t&&t[1]&&(o=t[1].trim(),i="bullet"!==o&&"image"!==o?"ol":"ul"),"bullet"===o){const t=function(e){const t=function(e){if(e.getChild(0).is("$text"))return null;const t=e.getChild(0).getChild(0);return t.is("$text")?t:t.getChild(0)}(e);if(!t)return null;const r=t._data;return"o"===r?"circle":""===r?"disc":""===r?"square":null}(e.element);t&&(o=t)}}return{type:i,style:hg(o)}}(e,t);if(o){if(e.indent>i){const e=o.getChild(o.childCount-1),t=e.getChild(e.childCount-1);o=pg(n,t,r),i+=1}else if(e.indent<i){const t=i-e.indent;o=function(e,t){const r=e.getAncestors({parentFirst:!0});let n=null,o=0;for(const e of r)if("ul"!==e.name&&"ol"!==e.name||o++,o===t){n=e;break}return n}(o,t),i=parseInt(e.indent)}}else o=pg(n,e.element,r);e.indent<=i&&(o.is("element",n.type)||(o=r.rename(n.type,o)))}const d=function(e,t){return function(e,t){const r=new yr({name:"span",styles:{"mso-list":"Ignore"}}),n=t.createRangeIn(e);for(const e of n)"elementStart"===e.type&&r.match(e.item)&&t.remove(e.item)}(e,t),t.rename("li",e)}(e.element,r);r.appendChild(d,o)})})(t,r),function(e,t){if(!e.childCount)return;const r=new yf;!function(e,t,r){const n=r.createRangeIn(t),o=new yr({name:"img"}),i=[];for(const t of n)if(o.match(t.item)){const r=t.item,n=r.getAttribute("v:shapes")?r.getAttribute("v:shapes").split(" "):[];n.length&&n.every(t=>e.indexOf(t)>-1)?i.push(r):r.getAttribute("src")||i.push(r)}for(const e of i)r.remove(e)}(function(e,t){const r=t.createRangeIn(e),n=new yr({name:/v:(.+)/}),o=[];for(const e of r){const t=e.item,r=t.previousSibling&&t.previousSibling.name||null;n.match(t)&&t.getAttribute("o:gfxdata")&&"v:shapetype"!==r&&o.push(e.item.getAttribute("id"))}return o}(e,r),e,r),function(e,t){const r=t.createRangeIn(e),n=new yr({name:/v:(.+)/}),o=[];for(const e of r)n.match(e.item)&&o.push(e.item);for(const e of o)t.remove(e)}(e,r);const n=function(e,t){const r=t.createRangeIn(e),n=new yr({name:"img"}),o=[];for(const e of r)n.match(e.item)&&e.item.getAttribute("src").startsWith("file://")&&o.push(e.item);return o}(e,r);n.length&&function(e,t,r){if(e.length===t.length)for(let n=0;n<e.length;n++){const o=`data:${t[n].type};base64,${vg(t[n].hex)}`;r.setAttribute("src",o,e[n])}}(n,function(e){if(!e)return[];const t=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,r=new RegExp("(?:("+t.source+"))([\\da-fA-F\\s]+)\\}","g"),n=e.match(r),o=[];if(n)for(const e of n){let r=!1;e.includes("\\pngblip")?r="image/png":e.includes("\\jpegblip")&&(r="image/jpeg"),r&&o.push({hex:e.replace(t,"").replace(/[^\da-fA-F]/g,""),type:r})}return o}(t),r)}(t,e.dataTransfer.getData("text/rtf")),e.content=t}}function xg(e,t,r,n,o=1){t>o?n.setAttribute(e,t,r):n.removeAttribute(e,r)}function kg(e,t,r={}){const n=e.createElement("tableCell",r);return e.insertElement("paragraph",n),e.insert(n,t),n}function Cg(e,t){const r=t.parent.parent,n=parseInt(r.getAttribute("headingColumns")||0),{column:o}=e.getCellLocation(t);return!!n&&o<n}function Eg(e){let t=0,r=0;const n=Array.from(e.getChildren()).filter(e=>"th"===e.name||"td"===e.name);for(;r<n.length&&"th"===n[r].name;){const e=n[r];t+=parseInt(e.getAttribute("colspan")||1),r++}return t}class Sg{constructor(e,t={}){this._table=e,this._startRow=void 0!==t.row?t.row:t.startRow||0,this._endRow=void 0!==t.row?t.row:t.endRow,this._startColumn=void 0!==t.column?t.column:t.startColumn||0,this._endColumn=void 0!==t.column?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this._table.getChild(this._row);if(!e||this._isOverEndRow())return{done:!0};if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const r=this._getSpanned();if(r)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(r.cell,r.row,r.column));else{const r=e.getChild(this._cellIndex);if(!r)return this._advanceToNextRow();const n=parseInt(r.getAttribute("colspan")||1),o=parseInt(r.getAttribute("rowspan")||1);(n>1||o>1)&&this._recordSpans(r,o,n),this._shouldSkipSlot()||(t=this._formatOutValue(r)),this._nextCellAtColumn=this._column+n}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow}_isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn}_formatOutValue(e,t=this._row,r=this._column){return{done:!1,value:new Tg(this,e,t,r)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,r=this._column<this._startColumn,n=void 0!==this._endColumn&&this._column>this._endColumn;return e||t||r||n}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,r){const n={cell:e,row:this._row,column:this._column};for(let e=this._row;e<this._row+t;e++)for(let t=this._column;t<this._column+r;t++)e==this._row&&t==this._column||this._markSpannedCell(e,t,n)}_markSpannedCell(e,t,r){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(t,r)}}class Tg{constructor(e,t,r,n){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=r,this.cellAnchorColumn=n,this._cellIndex=e._cellIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function Ag(e={}){return t=>t.on("insert:table",(t,r,n)=>{const o=r.item;if(!n.consumable.consume(o,"insert"))return;n.consumable.consume(o,"attribute:headingRows:table"),n.consumable.consume(o,"attribute:headingColumns:table");const i=e&&e.asWidget,a=n.writer.createContainerElement("figure",{class:"table"}),s=n.writer.createContainerElement("table");let l;var c,u;n.writer.insert(n.writer.createPositionAt(a,0),s),i&&(c=a,(u=n.writer).setCustomProperty("table",!0,c),l=ih(c,u,{hasSelectionHandle:!0}));const d=new Sg(o),h={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},p=new Map;for(const t of d){const{row:r,cell:i}=t,a=o.getChild(r),l=p.get(r)||Dg(s,a,r,h,n);p.set(r,l),n.consumable.consume(i,"insert"),Mg(t,h,n.writer.createPositionAt(l,"end"),n,e)}for(const e of o.getChildren()){const t=e.index;p.has(t)||p.set(t,Dg(s,e,t,h,n))}const f=n.mapper.toViewPosition(r.range.start);n.mapper.bindElements(o,i?l:a),n.writer.insert(f,i?l:a)})}function Pg(e,t){const{writer:r}=t;if(e.parent.is("element","tableCell"))return Ig(e)?r.createContainerElement("span",{style:"display:inline-block"}):r.createContainerElement("p")}function Ig(e){return 1===e.parent.childCount&&!Lg(e)}function Og(e,t,r){const{cell:n}=e,o=zg(e,t),i=r.mapper.toViewElement(n);i&&i.name!==o&&function(e,t,r){const n=r.writer,o=r.mapper.toViewElement(e),i=lh(n.createEditableElement(t,o.getAttributes()),n);ah(i,n,(e,t,r)=>r.addClass(lr(t.classes),e),(e,t,r)=>r.removeClass(lr(t.classes),e)),n.insert(n.createPositionAfter(o),i),n.move(n.createRangeIn(o),n.createPositionAt(i,0)),n.remove(n.createRangeOn(o)),r.mapper.unbindViewElement(o),r.mapper.bindElements(e,i)}(n,o,r)}function Mg(e,t,r,n,o){const i=o&&o.asWidget,a=zg(e,t),s=i?lh(n.writer.createEditableElement(a),n.writer):n.writer.createContainerElement(a);i&&ah(s,n.writer,(e,t,r)=>r.addClass(lr(t.classes),e),(e,t,r)=>r.removeClass(lr(t.classes),e));const l=e.cell,c=l.getChild(0),u=1===l.childCount&&"paragraph"===c.name;if(n.writer.insert(r,s),n.mapper.bindElements(l,s),!i&&!Lg(c)&&u){const e=l.getChild(0);n.consumable.consume(e,"insert"),n.mapper.bindElements(e,s)}}function Dg(e,t,r,n,o){o.consumable.consume(t,"insert");const i=t.isEmpty?o.writer.createEmptyElement("tr"):o.writer.createContainerElement("tr");o.mapper.bindElements(t,i);const a=n.headingRows,s=function(e,t,r){return jg(e,t)||function(e,t,r){const n=r.writer.createContainerElement(e),o=r.writer.createPositionAt(t,"tbody"==e?"end":0);return r.writer.insert(o,n),n}(e,t,r)}(function(e,t){return e<t.headingRows?"thead":"tbody"}(r,n),e,o),l=a>0&&r>=a?r-a:r,c=o.writer.createPositionAt(s,l);return o.writer.insert(c,i),i}function zg(e,t){const{row:r,column:n}=e,{headingColumns:o,headingRows:i}=t;return i&&i>r||o&&o>n?"th":"td"}function jg(e,t){for(const r of t.getChildren())if(r.name==e)return r}function Rg(e,t,r){const n=jg(e,t);n&&0===n.childCount&&r.writer.remove(r.writer.createRangeOn(n))}function Lg(e){return!![...e.getAttributeKeys()].length}class Ng extends pu{refresh(){const e=this.editor.model,t=e.document.selection,r=e.schema,n=function(e){const t=e.parent;return t===t.root?t:t.parent}(t.getFirstPosition());this.isEnabled=r.checkChild(n,"table")}execute(e={}){const t=this.editor.model,r=t.document.selection,n=this.editor.plugins.get("TableUtils"),o=ch(r,t);t.change(r=>{const i=n.createTable(r,e);t.insertContent(i,o),r.setSelection(r.createPositionAt(i.getNodeByPath([0,0,0]),0))})}}function Bg(e){const t=[];for(const r of Wg(e.getRanges())){const e=r.getContainedElement();e&&e.is("element","tableCell")&&t.push(e)}return t}function Fg(e){const t=[];for(const r of e.getRanges()){const e=r.start.findAncestor("tableCell");e&&t.push(e)}return t}function Vg(e){const t=Bg(e);return t.length?t:Fg(e)}function Ug(e){return Gg(e.map(e=>e.parent.index))}function qg(e){const t=e[0].findAncestor("table");return Gg([...new Sg(t)].filter(t=>e.includes(t.cell)).map(e=>e.column))}function Hg(e,t){if(e.length<2||!function(e){const t=e[0].findAncestor("table");if(!Yg(Ug(e),parseInt(t.getAttribute("headingRows")||0)))return!1;const r=parseInt(t.getAttribute("headingColumns")||0);return Yg(qg(e),r)}(e))return!1;const r=new Set,n=new Set;let o=0;for(const i of e){const{row:e,column:a}=t.getCellLocation(i),s=parseInt(i.getAttribute("rowspan")||1),l=parseInt(i.getAttribute("colspan")||1);r.add(e),n.add(a),s>1&&r.add(e+s-1),l>1&&n.add(a+l-1),o+=s*l}return function(e,t){const r=Array.from(e.values()),n=Array.from(t.values());return(Math.max(...r)-Math.min(...r)+1)*(Math.max(...n)-Math.min(...n)+1)}(r,n)==o}function Wg(e){return Array.from(e).sort(Zg)}function Gg(e){const t=e.sort((e,t)=>e-t);return{first:t[0],last:t[t.length-1]}}function Zg(e,t){const r=e.start,n=t.start;return r.isBefore(n)?-1:1}function Yg({first:e,last:t},r){return e<r==t<r}class $g extends pu{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection.getFirstPosition().findAncestor("table");this.isEnabled=!!e}execute(){const e=this.editor,t=e.model.document.selection,r=e.plugins.get("TableUtils"),n="above"===this.order,o=Vg(t),i=Ug(o),a=n?i.first:i.last,s=o[0].findAncestor("table");r.insertRows(s,{at:n?a:a+1,copyStructureFromAbove:!n})}}class Kg extends pu{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection.getFirstPosition().findAncestor("table");this.isEnabled=!!e}execute(){const e=this.editor,t=e.model.document.selection,r=e.plugins.get("TableUtils"),n="left"===this.order,o=Vg(t),i=qg(o),a=n?i.first:i.last,s=o[0].findAncestor("table");r.insertColumns(s,{columns:1,at:n?a:a+1})}}class Xg extends pu{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const e=Vg(this.editor.model.document.selection);this.isEnabled=1===e.length}execute(){const e=Vg(this.editor.model.document.selection)[0],t="horizontally"===this.direction,r=this.editor.plugins.get("TableUtils");t?r.splitCellHorizontally(e,2):r.splitCellVertically(e,2)}}function Jg(e,t,r){const{startRow:n,startColumn:o,endRow:i,endColumn:a}=t,s=r.createElement("table"),l=i-n+1;for(let e=0;e<l;e++)r.insertElement("tableRow",s,"end");const c=[...new Sg(e,{startRow:n,endRow:i,startColumn:o,endColumn:a,includeAllSlots:!0})];for(const{row:e,column:t,cell:l,isAnchor:u,cellAnchorRow:d,cellAnchorColumn:h}of c){const c=e-n,p=s.getChild(c);if(u){const n=r.cloneElement(l);r.append(n,p),nb(n,e,t,i,a,r)}else(d<n||h<o)&&kg(r,r.createPositionAt(p,"end"))}return function(e,t,r,n,o){const i=parseInt(t.getAttribute("headingRows")||0);i>0&&xg("headingRows",i-r,e,o,0);const a=parseInt(t.getAttribute("headingColumns")||0);a>0&&xg("headingColumns",a-n,e,o,0)}(s,e,n,o,r),s}function Qg(e,t,r=0){const n=[],o=new Sg(e,{startRow:r,endRow:t-1});for(const e of o){const{row:r,cellHeight:o}=e,i=r+o-1;r<t&&t<=i&&n.push(e)}return n}function eb(e,t,r){const n=e.parent,o=n.parent,i=n.index,a=t-i,s={},l=parseInt(e.getAttribute("rowspan"))-a;l>1&&(s.rowspan=l);const c=parseInt(e.getAttribute("colspan")||1);c>1&&(s.colspan=c);const u=i+a,d=[...new Sg(o,{startRow:i,endRow:u,includeAllSlots:!0})];let h,p=null;for(const t of d){const{row:n,column:o,cell:i}=t;i===e&&void 0===h&&(h=o),void 0!==h&&h===o&&n===u&&(p=kg(r,t.getPositionBefore(),s))}return xg("rowspan",a,e,r),p}function tb(e,t){const r=[],n=new Sg(e);for(const e of n){const{column:n,cellWidth:o}=e,i=n+o-1;n<t&&t<=i&&r.push(e)}return r}function rb(e,t,r,n){const o=r-t,i={},a=parseInt(e.getAttribute("colspan"))-o;a>1&&(i.colspan=a);const s=parseInt(e.getAttribute("rowspan")||1);s>1&&(i.rowspan=s);const l=kg(n,n.createPositionAfter(e),i);return xg("colspan",o,e,n),l}function nb(e,t,r,n,o,i){const a=parseInt(e.getAttribute("colspan")||1),s=parseInt(e.getAttribute("rowspan")||1);r+a-1>o&&xg("colspan",o-r+1,e,i,1),t+s-1>n&&xg("rowspan",n-t+1,e,i,1)}function ob(e,t){const r=t.getColumns(e),n=new Array(r).fill(0);for(const{column:t}of new Sg(e))n[t]++;const o=n.reduce((e,t,r)=>t?e:[...e,r],[]);if(o.length>0){const r=o[o.length-1];return t.removeColumns(e,{at:r}),!0}return!1}function ib(e,t){const r=[];for(let t=0;t<e.childCount;t++)e.getChild(t).isEmpty&&r.push(t);if(r.length>0){const n=r[r.length-1];return t.removeRows(e,{at:n}),!0}return!1}function ab(e,t){ob(e,t)||ib(e,t)}function sb(e,t){const r=Array.from(new Sg(e,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(r.every(({cellHeight:e})=>1===e))return t.lastRow;const n=r[0].cellHeight-1;return t.lastRow+n}function lb(e,t){const r=Array.from(new Sg(e,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(r.every(({cellWidth:e})=>1===e))return t.lastColumn;const n=r[0].cellWidth-1;return t.lastColumn+n}class cb extends pu{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=Fg(e.document.selection)[0],r=this.value,n=this.direction;e.change(e=>{const o="right"==n||"down"==n,i=o?t:r,a=o?r:t,s=a.parent;!function(e,t,r){ub(e)||(ub(t)&&r.remove(r.createRangeIn(t)),r.move(r.createRangeIn(e),r.createPositionAt(t,"end"))),r.remove(e)}(a,i,e);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(t.getAttribute(l)||1),u=parseInt(r.getAttribute(l)||1);e.setAttribute(l,c+u,i),e.setSelection(e.createRangeIn(i));const d=this.editor.plugins.get("TableUtils");ab(s.findAncestor("table"),d)})}_getMergeableCell(){const e=Fg(this.editor.model.document.selection)[0];if(!e)return;const t=this.editor.plugins.get("TableUtils"),r=this.isHorizontal?function(e,t,r){const n=e.parent.parent,o="right"==t?e.nextSibling:e.previousSibling,i=(n.getAttribute("headingColumns")||0)>0;if(!o)return;const a="right"==t?e:o,s="right"==t?o:e,{column:l}=r.getCellLocation(a),{column:c}=r.getCellLocation(s),u=parseInt(a.getAttribute("colspan")||1),d=Cg(r,a),h=Cg(r,s);return i&&d!=h?void 0:l+u===c?o:void 0}(e,this.direction,t):function(e,t){const r=e.parent,n=r.parent,o=n.getChildIndex(r);if("down"==t&&o===n.childCount-1||"up"==t&&0===o)return;const i=parseInt(e.getAttribute("rowspan")||1),a=n.getAttribute("headingRows")||0;if(a&&("down"==t&&o+i===a||"up"==t&&o===a))return;const s=parseInt(e.getAttribute("rowspan")||1),l="down"==t?o+s:o,c=[...new Sg(n,{endRow:l})],u=c.find(t=>t.cell===e).column,d=c.find(({row:e,cellHeight:r,column:n})=>n===u&&("down"==t?e===l:l===e+r));return d&&d.cell}(e,this.direction);if(!r)return;const n=this.isHorizontal?"rowspan":"colspan",o=parseInt(e.getAttribute(n)||1);return parseInt(r.getAttribute(n)||1)===o?r:void 0}}function ub(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}class db extends pu{refresh(){const e=Vg(this.editor.model.document.selection),t=e[0];if(t){const r=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getRows(r)-1,o=Ug(e),i=0===o.first&&o.last===n;this.isEnabled=!i}else this.isEnabled=!1}execute(){const e=this.editor.model,t=Vg(e.document.selection),r=Ug(t),n=t[0],o=n.findAncestor("table"),i=this.editor.plugins.get("TableUtils").getCellLocation(n).column;e.change(e=>{const t=r.last-r.first+1;this.editor.plugins.get("TableUtils").removeRows(o,{at:r.first,rows:t});const n=function(e,t,r){const n=e.getChild(t)||e.getChild(e.childCount-1);let o=n.getChild(0),i=0;for(const e of n.getChildren()){if(i>r)return o;o=e,i+=parseInt(e.getAttribute("colspan")||1)}return o}(o,r.first,i);e.setSelection(e.createPositionAt(n,0))})}}class hb extends pu{refresh(){const e=Vg(this.editor.model.document.selection),t=e[0];if(t){const r=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getColumns(r),{first:o,last:i}=qg(e);this.isEnabled=i-o<n-1}else this.isEnabled=!1}execute(){const[e,t]=function(e){const t=Vg(e),r=t[0],n=t.pop(),o=[r,n];return r.isBefore(n)?o:o.reverse()}(this.editor.model.document.selection),r=e.parent.parent,n=[...new Sg(r)],o={first:n.find(t=>t.cell===e).column,last:n.find(e=>e.cell===t).column},i=function(e,t,r,n){return parseInt(r.getAttribute("colspan")||1)>1?r:t.previousSibling||r.nextSibling?r.nextSibling||t.previousSibling:n.first?e.reverse().find(({column:e})=>e<n.first).cell:e.reverse().find(({column:e})=>e>n.last).cell}(n,e,t,o);this.editor.model.change(e=>{const t=o.last-o.first+1;this.editor.plugins.get("TableUtils").removeColumns(r,{at:o.first,columns:t}),e.setSelection(e.createPositionAt(i,0))})}}class pb extends pu{refresh(){const e=Vg(this.editor.model.document.selection),t=e.length>0;this.isEnabled=t,this.value=t&&e.every(e=>this._isInHeading(e,e.parent.parent))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,r=Vg(t.document.selection),n=r[0].findAncestor("table"),{first:o,last:i}=Ug(r),a=this.value?o:i+1,s=n.getAttribute("headingRows")||0;t.change(e=>{if(a){const t=Qg(n,a,a>s?s:0);for(const{cell:r}of t)eb(r,a,e)}xg("headingRows",a,n,e,0)})}_isInHeading(e,t){const r=parseInt(t.getAttribute("headingRows")||0);return!!r&&e.parent.index<r}}class fb extends pu{refresh(){const e=Vg(this.editor.model.document.selection),t=this.editor.plugins.get("TableUtils"),r=e.length>0;this.isEnabled=r,this.value=r&&e.every(e=>Cg(t,e))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,r=Vg(t.document.selection),n=r[0].findAncestor("table"),{first:o,last:i}=qg(r),a=this.value?o:i+1;t.change(e=>{if(a){const t=tb(n,a);for(const{cell:r,column:n}of t)rb(r,n,a,e)}xg("headingColumns",a,n,e,0)})}}class mb extends au{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,r=t.parent,n=r.getChildIndex(t),o=new Sg(r,{row:n});for(const{cell:t,row:r,column:n}of o)if(t===e)return{row:r,column:n}}createTable(e,t){const r=e.createElement("table");return gb(e,r,0,parseInt(t.rows)||2,parseInt(t.columns)||2),t.headingRows&&xg("headingRows",t.headingRows,r,e,0),t.headingColumns&&xg("headingColumns",t.headingColumns,r,e,0),r}insertRows(e,t={}){const r=this.editor.model,n=t.at||0,o=t.rows||1,i=void 0!==t.copyStructureFromAbove,a=t.copyStructureFromAbove?n-1:n,s=this.getRows(e),l=this.getColumns(e);r.change(t=>{const r=e.getAttribute("headingRows")||0;if(r>n&&xg("headingRows",r+o,e,t,0),!i&&(0===n||n===s))return void gb(t,e,n,o,l);const c=i?Math.max(n,a):n,u=new Sg(e,{endRow:c}),d=new Array(l).fill(1);for(const{row:e,column:r,cellHeight:s,cellWidth:l,cell:c}of u){const u=e+s-1,h=e<=a&&a<=u;e<n&&n<=u?(t.setAttribute("rowspan",s+o,c),d[r]=-l):i&&h&&(d[r]=l)}for(let r=0;r<o;r++){const r=t.createElement("tableRow");t.insert(r,e,n);for(let e=0;e<d.length;e++){const n=d[e],o=t.createPositionAt(r,"end");n>0&&kg(t,o,n>1?{colspan:n}:null),e+=Math.abs(n)-1}}})}insertColumns(e,t={}){const r=this.editor.model,n=t.at||0,o=t.columns||1;r.change(t=>{const r=e.getAttribute("headingColumns");n<r&&t.setAttribute("headingColumns",r+o,e);const i=this.getColumns(e);if(0===n||i===n){for(const r of e.getChildren())bb(o,t,t.createPositionAt(r,n?"end":0));return}const a=new Sg(e,{column:n,includeAllSlots:!0});for(const e of a){const{row:r,cell:i,cellAnchorColumn:s,cellAnchorRow:l,cellWidth:c,cellHeight:u}=e;if(s<n){t.setAttribute("colspan",c+o,i);const e=l+u-1;for(let t=r;t<=e;t++)a.skipRow(t)}else bb(o,t,e.getPositionBefore())}})}removeRows(e,t){const r=this.editor.model,n=t.rows||1,o=t.at,i=o+n-1;r.change(t=>{const{cellsToMove:r,cellsToTrim:n}=function(e,t,r){const n=new Map,o=[];for(const{row:i,column:a,cellHeight:s,cell:l}of new Sg(e,{endRow:r})){const e=i+s-1;if(i>=t&&i<=r&&e>r){const e=s-(r-i+1);n.set(a,{cell:l,rowspan:e})}if(i<t&&e>=t){let n;n=e>=r?r-t+1:e-t+1,o.push({cell:l,rowspan:s-n})}}return{cellsToMove:n,cellsToTrim:o}}(e,o,i);r.size&&function(e,t,r,n){const o=[...new Sg(e,{includeAllSlots:!0,row:t})],i=e.getChild(t);let a;for(const{column:e,cell:t,isAnchor:s}of o)if(r.has(e)){const{cell:t,rowspan:o}=r.get(e),s=a?n.createPositionAfter(a):n.createPositionAt(i,0);n.move(n.createRangeOn(t),s),xg("rowspan",o,t,n),a=t}else s&&(a=t)}(e,i+1,r,t);for(let r=i;r>=o;r--)t.remove(e.getChild(r));for(const{rowspan:e,cell:r}of n)xg("rowspan",e,r,t);!function(e,t,r,n){const o=e.getAttribute("headingRows")||0;t<o&&xg("headingRows",r<o?o-(r-t+1):t,e,n,0)}(e,o,i,t),ob(e,this)||ib(e,this)})}removeColumns(e,t){const r=this.editor.model,n=t.at,o=t.columns||1,i=t.at+o-1;r.change(t=>{!function(e,t,r){const n=e.getAttribute("headingColumns")||0;if(n&&t.first<n){const o=Math.min(n-1,t.last)-t.first+1;r.setAttribute("headingColumns",n-o,e)}}(e,{first:n,last:i},t);for(let r=i;r>=n;r--)for(const{cell:n,column:o,cellWidth:i}of[...new Sg(e)])o<=r&&i>1&&o+i>r?xg("colspan",i-1,n,t):o===r&&t.remove(n);ib(e,this)||ob(e,this)})}splitCellVertically(e,t=2){const r=this.editor.model,n=e.parent.parent,o=parseInt(e.getAttribute("rowspan")||1),i=parseInt(e.getAttribute("colspan")||1);r.change(r=>{if(i>1){const{newCellsSpan:n,updatedSpan:a}=vb(i,t);xg("colspan",a,e,r);const s={};n>1&&(s.colspan=n),o>1&&(s.rowspan=o),bb(i>t?t-1:i-1,r,r.createPositionAfter(e),s)}if(i<t){const a=t-i,s=[...new Sg(n)],{column:l}=s.find(({cell:t})=>t===e),c=s.filter(({cell:t,cellWidth:r,column:n})=>t!==e&&n===l||n<l&&n+r>l);for(const{cell:e,cellWidth:t}of c)r.setAttribute("colspan",t+a,e);const u={};o>1&&(u.rowspan=o),bb(a,r,r.createPositionAfter(e),u);const d=n.getAttribute("headingColumns")||0;d>l&&xg("headingColumns",d+a,n,r)}})}splitCellHorizontally(e,t=2){const r=this.editor.model,n=e.parent,o=n.parent,i=o.getChildIndex(n),a=parseInt(e.getAttribute("rowspan")||1),s=parseInt(e.getAttribute("colspan")||1);r.change(r=>{if(a>1){const n=[...new Sg(o,{startRow:i,endRow:i+a-1,includeAllSlots:!0})],{newCellsSpan:l,updatedSpan:c}=vb(a,t);xg("rowspan",c,e,r);const{column:u}=n.find(({cell:t})=>t===e),d={};l>1&&(d.rowspan=l),s>1&&(d.colspan=s);for(const e of n){const{column:t,row:n}=e,o=t===u,a=(n+i+c)%l==0;n>=i+c&&o&&a&&bb(1,r,e.getPositionBefore(),d)}}if(a<t){const n=t-a,l=[...new Sg(o,{startRow:0,endRow:i})];for(const{cell:t,cellHeight:o,row:a}of l)if(t!==e&&a+o>i){const e=o+n;r.setAttribute("rowspan",e,t)}const c={};s>1&&(c.colspan=s),gb(r,o,i+1,n,1,c);const u=o.getAttribute("headingRows")||0;u>i&&xg("headingRows",u+n,o,r)}})}getColumns(e){return[...e.getChild(0).getChildren()].reduce((e,t)=>e+parseInt(t.getAttribute("colspan")||1),0)}getRows(e){return e.childCount}}function gb(e,t,r,n,o,i={}){for(let a=0;a<n;a++){const n=e.createElement("tableRow");e.insert(n,t,r),bb(o,e,e.createPositionAt(n,"end"),i)}}function bb(e,t,r,n={}){for(let o=0;o<e;o++)kg(t,r,n)}function vb(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};const r=Math.floor(e/t);return{newCellsSpan:r,updatedSpan:e-r*t+r}}class yb extends pu{refresh(){const e=Bg(this.editor.model.document.selection);this.isEnabled=Hg(e,this.editor.plugins.get(mb))}execute(){const e=this.editor.model,t=this.editor.plugins.get(mb);e.change(r=>{const n=Bg(e.document.selection),o=n.shift(),{mergeWidth:i,mergeHeight:a}=function(e,t,r){let n=0,o=0;for(const e of t){const{row:t,column:i}=r.getCellLocation(e);n=xb(e,i,n,"colspan"),o=xb(e,t,o,"rowspan")}const{row:i,column:a}=r.getCellLocation(e);return{mergeWidth:n-a,mergeHeight:o-i}}(o,n,t);xg("colspan",i,o,r),xg("rowspan",a,o,r);for(const e of n)_b(e,o,r);ab(o.findAncestor("table"),t),r.setSelection(o,"in")})}}function _b(e,t,r){wb(e)||(wb(t)&&r.remove(r.createRangeIn(t)),r.move(r.createRangeIn(e),r.createPositionAt(t,"end"))),r.remove(e)}function wb(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}function xb(e,t,r,n){const o=parseInt(e.getAttribute(n)||1);return Math.max(r,t+o)}class kb extends pu{refresh(){const e=Vg(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Vg(e.document.selection),r=Ug(t),n=t[0].findAncestor("table"),o=[];for(let t=r.first;t<=r.last;t++)for(const r of n.getChild(t).getChildren())o.push(e.createRangeOn(r));e.change(e=>{e.setSelection(o)})}}class Cb extends pu{refresh(){const e=Vg(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Vg(e.document.selection),r=t[0],n=t.pop(),o=r.findAncestor("table"),i=this.editor.plugins.get("TableUtils"),a=i.getCellLocation(r),s=i.getCellLocation(n),l=Math.min(a.column,s.column),c=Math.max(a.column,s.column),u=[];for(const t of new Sg(o,{startColumn:l,endColumn:c}))u.push(e.createRangeOn(t.cell));e.change(e=>{e.setSelection(u)})}}function Eb(e,t){let r=!1;const n=function(e){const t=parseInt(e.getAttribute("headingRows")||0),r=e.childCount,n=[];for(const{row:o,cell:i,cellHeight:a}of new Sg(e)){if(a<2)continue;const e=o<t?t:r;if(o+a>e){const t=e-o;n.push({cell:i,rowspan:t})}}return n}(e);if(n.length){r=!0;for(const e of n)xg("rowspan",e.rowspan,e.cell,t,1)}return r}function Sb(e,t){let r=!1;const n=function(e){const t=new Array(e.childCount).fill(0);for(const{row:r}of new Sg(e,{includeAllSlots:!0}))t[r]++;return t}(e),o=[];for(const[e,t]of n.entries())t||o.push(e);if(o.length){r=!0;for(const r of o.reverse())t.remove(e.getChild(r)),n.splice(r,1)}const i=n[0];if(!n.every(e=>e===i)){const o=n.reduce((e,t)=>t>e?t:e,0);for(const[i,a]of n.entries()){const n=o-a;if(n){for(let r=0;r<n;r++)kg(t,t.createPositionAt(e.getChild(i),"end"));r=!0}}}return r}function Tb(e){const t="attribute"===e.type,r=e.attributeKey;return t&&("headingRows"===r||"colspan"===r||"rowspan"===r)}function Ab(e,t){let r=!1;for(const n of e.getChildren())r=Pb(n,t)||r;return r}function Pb(e,t){let r=!1;for(const n of e.getChildren())r=Ib(n,t)||r;return r}function Ib(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;const r=Array.from(e.getChildren()).filter(e=>e.is("$text"));for(const e of r)t.wrap(t.createRangeOn(e),"paragraph");return!!r.length}function Ob(e){return!(!e.position||!e.position.parent.is("element","tableCell"))&&("insert"==e.type&&"$text"==e.name||"remove"==e.type)}function Mb(e,t){if(!e.is("element","paragraph"))return!1;const r=t.toViewElement(e);return!!r&&Ig(e)!==r.is("element","span")}var Db=i(4777);Pl()(Db.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Db.Z.locals;class zb extends au{static get pluginName(){return"TableEditing"}init(){const e=this.editor,t=e.model,r=t.schema,n=e.conversion;r.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),r.register("tableRow",{allowIn:"table",isLimit:!0}),r.register("tableCell",{allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),r.extend("$block",{allowIn:"tableCell"}),r.addChildCheck((e,t)=>{if("table"==t.name&&Array.from(e.getNames()).includes("table"))return!1}),n.for("upcast").add(e=>{e.on("element:table",(e,t,r)=>{const n=t.viewItem;if(!r.consumable.test(n,{name:!0}))return;const{rows:o,headingRows:i,headingColumns:a}=function(e){const t={headingRows:0,headingColumns:0},r=[],n=[];let o;for(const i of Array.from(e.getChildren()))if("tbody"===i.name||"thead"===i.name||"tfoot"===i.name){"thead"!==i.name||o||(o=i);const e=Array.from(i.getChildren()).filter(e=>e.is("element","tr"));for(const i of e)if("thead"===i.parent.name&&i.parent===o)t.headingRows++,r.push(i);else{n.push(i);const e=Eg(i);e>t.headingColumns&&(t.headingColumns=e)}}return t.rows=[...r,...n],t}(n),s={};a&&(s.headingColumns=a),i&&(s.headingRows=i);const l=r.writer.createElement("table",s);if(r.safeInsert(l,t.modelCursor)){if(r.consumable.consume(n,{name:!0}),o.forEach(e=>r.convertItem(e,r.writer.createPositionAt(l,"end"))),l.isEmpty){const e=r.writer.createElement("tableRow");r.writer.insert(e,r.writer.createPositionAt(l,"end")),kg(r.writer,r.writer.createPositionAt(e,"end"))}r.updateConversionResult(l,t)}})}),n.for("editingDowncast").add(Ag({asWidget:!0})),n.for("dataDowncast").add(Ag()),n.for("upcast").elementToElement({model:"tableRow",view:"tr"}),n.for("upcast").add(e=>{e.on("element:tr",(e,t)=>{t.viewItem.isEmpty&&0==t.modelCursor.index&&e.stop()},{priority:"high"})}),n.for("editingDowncast").add(e=>e.on("insert:tableRow",(e,t,r)=>{const n=t.item;if(!r.consumable.consume(n,"insert"))return;const o=n.parent,i=function(e){for(const t of e.getChildren())if("table"===t.name)return t}(r.mapper.toViewElement(o)),a=o.getChildIndex(n),s=new Sg(o,{row:a}),l={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},c=new Map;for(const e of s){const t=c.get(a)||Dg(i,n,a,l,r);c.set(a,t),r.consumable.consume(e.cell,"insert"),Mg(e,l,r.writer.createPositionAt(t,"end"),r,{asWidget:!0})}})),n.for("editingDowncast").add(e=>e.on("remove:tableRow",(e,t,r)=>{e.stop();const n=r.writer,o=r.mapper,i=o.toViewPosition(t.position).getLastMatchingPosition(e=>!e.item.is("element","tr")).nodeAfter,a=i.parent.parent,s=n.createRangeOn(i),l=n.remove(s);for(const e of n.createRangeIn(l).getItems())o.unbindViewElement(e);Rg("thead",a,r),Rg("tbody",a,r)},{priority:"higher"})),n.for("upcast").elementToElement({model:"tableCell",view:"td"}),n.for("upcast").elementToElement({model:"tableCell",view:"th"}),n.for("editingDowncast").add(e=>e.on("insert:tableCell",(e,t,r)=>{const n=t.item;if(!r.consumable.consume(n,"insert"))return;const o=n.parent,i=o.parent,a=i.getChildIndex(o),s=new Sg(i,{row:a}),l={headingRows:i.getAttribute("headingRows")||0,headingColumns:i.getAttribute("headingColumns")||0};for(const e of s)if(e.cell===n){const t=r.mapper.toViewElement(o);return void Mg(e,l,r.writer.createPositionAt(t,o.getChildIndex(n)),r,{asWidget:!0})}})),e.conversion.for("editingDowncast").elementToElement({model:"paragraph",view:Pg,converterPriority:"high"}),n.attributeToAttribute({model:"colspan",view:"colspan"}),n.attributeToAttribute({model:"rowspan",view:"rowspan"}),n.for("editingDowncast").add(e=>e.on("attribute:headingColumns:table",(e,t,r)=>{const n=t.item;if(!r.consumable.consume(t.item,e.name))return;const o={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},i=t.attributeOldValue,a=t.attributeNewValue,s=(i>a?i:a)-1;for(const e of new Sg(n,{endColumn:s}))Og(e,o,r)})),e.commands.add("insertTable",new Ng(e)),e.commands.add("insertTableRowAbove",new $g(e,{order:"above"})),e.commands.add("insertTableRowBelow",new $g(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Kg(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Kg(e,{order:"right"})),e.commands.add("removeTableRow",new db(e)),e.commands.add("removeTableColumn",new hb(e)),e.commands.add("splitTableCellVertically",new Xg(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Xg(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new yb(e)),e.commands.add("mergeTableCellRight",new cb(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new cb(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new cb(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new cb(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new fb(e)),e.commands.add("setTableRowHeader",new pb(e)),e.commands.add("selectTableRow",new kb(e)),e.commands.add("selectTableColumn",new Cb(e)),function(e){e.document.registerPostFixer(()=>function(e){const t=e.document.differ,r=new Set;for(const e of t.getChanges()){if("attribute"!=e.type)continue;const t=e.range.start.nodeAfter;t&&t.is("element","table")&&"headingRows"==e.attributeKey&&r.add(t)}if(r.size){for(const e of r.values())t.refreshItem(e);return!0}return!1}(e))}(t),function(e){e.document.registerPostFixer(t=>function(e,t){const r=t.document.differ.getChanges();let n=!1;const o=new Set;for(const t of r){let r;"table"==t.name&&"insert"==t.type&&(r=t.position.nodeAfter),"tableRow"!=t.name&&"tableCell"!=t.name||(r=t.position.findAncestor("table")),Tb(t)&&(r=t.range.start.findAncestor("table")),r&&!o.has(r)&&(n=Eb(r,e)||n,n=Sb(r,e)||n,o.add(r))}return n}(t,e))}(t),function(e,t){e.document.registerPostFixer(()=>function(e,t){const r=new Set;for(const t of e.getChanges()){const e="attribute"==t.type?t.range.start.parent:t.position.parent;e.is("element","tableCell")&&r.add(e)}for(const n of r.values())for(const r of[...n.getChildren()].filter(e=>Mb(e,t)))e.refreshItem(r);return!1}(e.document.differ,t))}(t,e.editing.mapper),function(e){e.document.registerPostFixer(t=>function(e,t){const r=t.document.differ.getChanges();let n=!1;for(const t of r)"insert"==t.type&&"table"==t.name&&(n=Ab(t.position.nodeAfter,e)||n),"insert"==t.type&&"tableRow"==t.name&&(n=Pb(t.position.nodeAfter,e)||n),"insert"==t.type&&"tableCell"==t.name&&(n=Ib(t.position.nodeAfter,e)||n),Ob(t)&&(n=Ib(t.position.parent,e)||n);return n}(t,e))}(t)}static get requires(){return[mb]}}var jb=i(66);Pl()(jb.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),jb.Z.locals;class Rb extends oc{constructor(e){super(e);const t=this.bindTemplate;this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new vl,this.focusTracker=new El,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",t.if("isVisible","ck-hidden",e=>!e),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}focus(){this.actionView.focus()}_createActionView(){const e=new Lc;return e.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),e.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),e.delegate("execute").to(this),e}_createArrowView(){const e=new Lc,t=e.bindTemplate;return e.icon=Nc,e.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":t.to("isOn",e=>String(e))}}),e.bind("isEnabled").to(this),e.delegate("execute").to(this,"open"),e}}var Lb=i(8085);Pl()(Lb.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Lb.Z.locals;class Nb extends oc{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(e,t)=>`${t}  ${e}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:t.to("label")}]}],on:{mousedown:t.to(e=>{e.preventDefault()}),click:t.to(()=>{this.fire("execute")})}}),this.on("boxover",(e,t)=>{const{row:r,column:n}=t.target.dataset;this.set({rows:parseInt(r),columns:parseInt(n)})}),this.on("change:columns",()=>{this._highlightGridBoxes()}),this.on("change:rows",()=>{this._highlightGridBoxes()})}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map((r,n)=>{const o=Math.floor(n/10)<e&&n%10<t;r.set("isOn",o)})}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const r=Math.floor(t/10),n=t%10;e.push(new Bb(this.locale,r+1,n+1))}return this.createCollection(e)}}class Bb extends oc{constructor(e,t,r){super(e);const n=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",n.if("isOn","ck-on")],"data-row":t,"data-column":r}})}}class Fb extends au{init(){const e=this.editor,t=this.editor.t,r="ltr"===e.locale.contentLanguageDirection;e.ui.componentFactory.add("insertTable",r=>{const n=e.commands.get("insertTable"),o=$c(r);let i;return o.bind("isEnabled").to(n),o.buttonView.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',label:t("Insert table"),tooltip:!0}),o.on("change:isOpen",()=>{i||(i=new Nb(r),o.panelView.children.add(i),i.delegate("execute").to(o),o.buttonView.on("open",()=>{i.rows=0,i.columns=0}),o.on("execute",()=>{e.execute("insertTable",{rows:i.rows,columns:i.columns}),e.editing.view.focus()}))}),o}),e.ui.componentFactory.add("tableColumn",e=>{const n=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:r?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:r?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',n,e)}),e.ui.componentFactory.add("tableRow",e=>{const r=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',r,e)}),e.ui.componentFactory.add("mergeTableCells",e=>{const n=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:r?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:r?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',n,e)})}_prepareDropdown(e,t,r,n){const o=this.editor,i=$c(n),a=this._fillDropdownWithListOptions(i,r);return i.buttonView.set({label:e,icon:t,tooltip:!0}),i.bind("isEnabled").toMany(a,"isEnabled",(...e)=>e.some(e=>e)),this.listenTo(i,"execute",e=>{o.execute(e.source.commandName),o.editing.view.focus()}),i}_prepareMergeSplitButtonDropdown(e,t,r,n){const o=this.editor,i=$c(n,Rb);return this._fillDropdownWithListOptions(i,r),i.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),this.listenTo(i.buttonView,"execute",()=>{o.execute("mergeTableCells"),o.editing.view.focus()}),this.listenTo(i,"execute",e=>{o.execute(e.source.commandName),o.editing.view.focus()}),i}_fillDropdownWithListOptions(e,t){const r=this.editor,n=[],o=new ar;for(const e of t)Vb(e,r,n,o);return Xc(e,o,r.ui.componentFactory),n}}function Vb(e,t,r,n){const o=e.model=new Df(e.model),{commandName:i,bindIsOn:a}=e.model;if("button"===e.type||"switchbutton"===e.type){const e=t.commands.get(i);r.push(e),o.set({commandName:i}),o.bind("isEnabled").to(e),a&&o.bind("isOn").to(e,"value")}o.set({withText:!0}),n.add(e)}var Ub=i(5593);Pl()(Ub.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Ub.Z.locals;class qb extends au{static get pluginName(){return"TableSelection"}static get requires(){return[mb]}init(){const e=this.editor.model;this.listenTo(e,"deleteContent",(e,t)=>this._handleDeleteContent(e,t),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=Bg(this.editor.model.document.selection);return 0==e.length?null:e}getSelectionAsFragment(){const e=this.getSelectedTableCells();return e?this.editor.model.change(t=>{const r=t.createDocumentFragment(),n=this.editor.plugins.get("TableUtils"),{first:o,last:i}=qg(e),{first:a,last:s}=Ug(e),l=e[0].findAncestor("table");let c=s,u=i;if(Hg(e,n)){const e={firstColumn:o,lastColumn:i,firstRow:a,lastRow:s};c=sb(l,e),u=lb(l,e)}const d=Jg(l,{startRow:a,startColumn:o,endRow:c,endColumn:u},t);return t.insert(d,r,0),r}):null}setCellSelection(e,t){const r=this._getCellsToSelect(e,t);this.editor.model.change(e=>{e.setSelection(r.cells.map(t=>e.createRangeOn(t)),{backward:r.backward})})}getFocusCell(){const e=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return e&&e.is("element","tableCell")?e:null}getAnchorCell(){const e=_d(this.editor.model.document.selection.getRanges()).getContainedElement();return e&&e.is("element","tableCell")?e:null}_defineSelectionConverter(){const e=this.editor,t=new Set;e.conversion.for("editingDowncast").add(e=>e.on("selection",(e,r,n)=>{const o=n.writer;!function(e){for(const r of t)e.removeClass("ck-editor__editable_selected",r);t.clear()}(o);const i=this.getSelectedTableCells();if(!i)return;for(const e of i){const r=n.mapper.toViewElement(e);o.addClass("ck-editor__editable_selected",r),t.add(r)}const a=n.mapper.toViewElement(i[i.length-1]);o.setSelection(a,0)},{priority:"lowest"}))}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change(r=>{const n=r.createPositionAt(t[0],0),o=e.model.schema.getNearestSelectionRange(n);r.setSelection(o)})}})}_handleDeleteContent(e,t){const[r,n]=t,o=this.editor.model,i=!n||"backward"==n.direction,a=Bg(r);a.length&&(e.stop(),o.change(e=>{const t=a[i?a.length-1:0];o.change(e=>{for(const t of a)o.deleteContent(e.createSelection(t,"in"))});const n=o.schema.getNearestSelectionRange(e.createPositionAt(t,0));r.is("documentSelection")?e.setSelection(n):r.setTo(n)}))}_getCellsToSelect(e,t){const r=this.editor.plugins.get("TableUtils"),n=r.getCellLocation(e),o=r.getCellLocation(t),i=Math.min(n.row,o.row),a=Math.max(n.row,o.row),s=Math.min(n.column,o.column),l=Math.max(n.column,o.column),c=new Array(a-i+1).fill(null).map(()=>[]),u={startRow:i,endRow:a,startColumn:s,endColumn:l};for(const{row:t,cell:r}of new Sg(e.findAncestor("table"),u))c[t-i].push(r);const d=o.row<n.row,h=o.column<n.column;return d&&c.reverse(),h&&c.forEach(e=>e.reverse()),{cells:c.flat(),backward:d||h}}}class Hb extends au{static get pluginName(){return"TableClipboard"}static get requires(){return[qb,mb]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",(e,t)=>this._onCopyCut(e,t)),this.listenTo(t,"cut",(e,t)=>this._onCopyCut(e,t)),this.listenTo(e.model,"insertContent",(e,t)=>this._onInsertContent(e,...t),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const r=this.editor.plugins.get(qb);if(!r.getSelectedTableCells())return;if("cut"==e.name&&this.editor.isReadOnly)return;t.preventDefault(),e.stop();const n=this.editor.data,o=this.editor.editing.view.document,i=n.toView(r.getSelectionAsFragment());o.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:i,method:e.name})}_onInsertContent(e,t,r){if(r&&!r.is("documentSelection"))return;const n=this.editor.model,o=this.editor.plugins.get(mb);let i=function(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(1==e.childCount&&e.getChild(0).is("element","table"))return e.getChild(0);const r=t.createRangeIn(e);for(const e of r.getItems())if(e.is("element","table")){const n=t.createRange(r.start,t.createPositionBefore(e));if(t.hasContent(n,{ignoreWhitespaces:!0}))return null;const o=t.createRange(t.createPositionAfter(e),r.end);return t.hasContent(o,{ignoreWhitespaces:!0})?null:e}return null}(t,n);if(!i)return;const a=Vg(n.document.selection);a.length?(e.stop(),n.change(e=>{const t={width:o.getColumns(i),height:o.getRows(i)},r=function(e,t,r,n){const o=e[0].findAncestor("table"),i=qg(e),a=Ug(e),s={firstColumn:i.first,lastColumn:i.last,firstRow:a.first,lastRow:a.last},l=1===e.length;return l&&(s.lastRow+=t.height-1,s.lastColumn+=t.width-1,function(e,t,r,n){const o=n.getColumns(e),i=n.getRows(e);r>o&&n.insertColumns(e,{at:o,columns:r-o}),t>i&&n.insertRows(e,{at:i,rows:t-i})}(o,s.lastRow+1,s.lastColumn+1,n)),l||!Hg(e,n)?function(e,t,r){const{firstRow:n,lastRow:o,firstColumn:i,lastColumn:a}=t,s={first:n,last:o},l={first:i,last:a};Gb(e,i,s,r),Gb(e,a+1,s,r),Wb(e,n,l,r),Wb(e,o+1,l,r,n)}(o,s,r):(s.lastRow=sb(o,s),s.lastColumn=lb(o,s)),s}(a,t,e,o),n=r.lastRow-r.firstRow+1,s=r.lastColumn-r.firstColumn+1,l={startRow:0,startColumn:0,endRow:Math.min(n,t.height)-1,endColumn:Math.min(s,t.width)-1};i=Jg(i,l,e);const c=a[0].findAncestor("table"),u=this._replaceSelectedCellsWithPasted(i,t,c,r,e);if(this.editor.plugins.get("TableSelection").isEnabled){const t=Wg(u.map(t=>e.createRangeOn(t)));e.setSelection(t)}else e.setSelection(u[0],0)})):ab(i,o)}_replaceSelectedCellsWithPasted(e,t,r,n,o){const{width:i,height:a}=t,s=function(e,t,r){const n=new Array(r).fill(null).map(()=>new Array(t).fill(null));for(const{column:t,row:r,cell:o}of new Sg(e))n[r][t]=o;return n}(e,i,a),l=[...new Sg(r,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})],c=[];let u;for(const e of l){const{row:t,column:r}=e;r===n.firstColumn&&(u=e.getPositionBefore());const l=t-n.firstRow,d=r-n.firstColumn,h=s[l%a][d%i],p=h?o.cloneElement(h):null,f=this._replaceTableSlotCell(e,p,u,o);f&&(nb(f,t,r,n.lastRow,n.lastColumn,o),c.push(f),u=o.createPositionAfter(f))}const d=parseInt(r.getAttribute("headingRows")||0),h=parseInt(r.getAttribute("headingColumns")||0),p=n.firstRow<d&&d<=n.lastRow,f=n.firstColumn<h&&h<=n.lastColumn;if(p){const e=Wb(r,d,{first:n.firstColumn,last:n.lastColumn},o,n.firstRow);c.push(...e)}if(f){const e=Gb(r,h,{first:n.firstRow,last:n.lastRow},o);c.push(...e)}return c}_replaceTableSlotCell(e,t,r,n){const{cell:o,isAnchor:i}=e;return i&&n.remove(o),t?(n.insert(t,r),t):null}}function Wb(e,t,r,n,o=0){if(!(t<1))return Qg(e,t,o).filter(({column:e,cellWidth:t})=>Zb(e,t,r)).map(({cell:e})=>eb(e,t,n))}function Gb(e,t,r,n){if(!(t<1))return tb(e,t).filter(({row:e,cellHeight:t})=>Zb(e,t,r)).map(({cell:e,column:r})=>rb(e,r,t,n))}function Zb(e,t,r){const n=e+t-1,{first:o,last:i}=r;return e>=o&&e<=i||e<o&&n>=o}class Yb extends au{static get pluginName(){return"TableKeyboard"}static get requires(){return[qb]}init(){const e=this.editor.editing.view.document;this.editor.keystrokes.set("Tab",(...e)=>this._handleTabOnSelectedTable(...e),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(e,"keydown",(...e)=>this._onKeydown(...e),{priority:Ut.get("high")-10})}_handleTabOnSelectedTable(e,t){const r=this.editor,n=r.model.document.selection.getSelectedElement();n&&n.is("element","table")&&(t(),r.model.change(e=>{e.setSelection(e.createRangeIn(n.getChild(0).getChild(0)))}))}_getTabHandler(e){const t=this.editor;return(r,n)=>{let o=Fg(t.model.document.selection)[0];if(o||(o=this.editor.plugins.get("TableSelection").getFocusCell()),!o)return;n();const i=o.parent,a=i.parent,s=a.getChildIndex(i),l=i.getChildIndex(o),c=0===l;if(!e&&c&&0===s)return void t.model.change(e=>{e.setSelection(e.createRangeOn(a))});const u=l===i.childCount-1,d=s===a.childCount-1;if(e&&d&&u&&(t.execute("insertTableRowBelow"),s===a.childCount-1))return void t.model.change(e=>{e.setSelection(e.createRangeOn(a))});let h;if(e&&u){const e=a.getChild(s+1);h=e.getChild(0)}else if(!e&&c){const e=a.getChild(s-1);h=e.getChild(e.childCount-1)}else h=i.getChild(l+(e?1:-1));t.model.change(e=>{e.setSelection(e.createRangeIn(h))})}}_onKeydown(e,t){const r=this.editor,n=t.keyCode;if(!Yn(n))return;const o=$n(n,r.locale.contentLanguageDirection);this._handleArrowKeys(o,t.shiftKey)&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const r=this.editor.model.document.selection,n=["right","down"].includes(e),o=Bg(r);if(o.length){let r;return r=t?this.editor.plugins.get("TableSelection").getFocusCell():n?o[o.length-1]:o[0],this._navigateFromCellInDirection(r,e,t),!0}const i=r.focus.findAncestor("tableCell");return!(!i||t&&!r.isCollapsed&&r.isBackward==n||!this._isSelectionAtCellEdge(r,i,n)||(this._navigateFromCellInDirection(i,e,t),0))}_isSelectionAtCellEdge(e,t,r){const n=this.editor.model,o=this.editor.model.schema,i=r?e.getLastPosition():e.getFirstPosition();if(!o.getLimitElement(i).is("element","tableCell"))return n.createPositionAt(t,r?"end":0).isTouching(i);const a=n.createSelection(i);return n.modifySelection(a,{direction:r?"forward":"backward"}),i.isEqual(a.focus)}_navigateFromCellInDirection(e,t,r=!1){const n=this.editor.model,o=e.findAncestor("table"),i=[...new Sg(o,{includeAllSlots:!0})],{row:a,column:s}=i[i.length-1],l=i.find(({cell:t})=>t==e);let{row:c,column:u}=l;switch(t){case"left":u--;break;case"up":c--;break;case"right":u+=l.cellWidth;break;case"down":c+=l.cellHeight}if(c<0||c>a||u<0&&c<=0||u>s&&c>=a)return void n.change(e=>{e.setSelection(e.createRangeOn(o))});u<0?(u=r?0:s,c--):u>s&&(u=r?s:0,c++);const d=i.find(e=>e.row==c&&e.column==u).cell,h=["right","down"].includes(t),p=this.editor.plugins.get("TableSelection");if(r&&p.isEnabled){const t=p.getAnchorCell()||e;p.setCellSelection(t,d)}else{const e=n.createPositionAt(d,h?0:"end");n.change(t=>{t.setSelection(e)})}}}class $b extends di{constructor(e){super(e),this.domEventType=["mousemove","mouseup","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}class Kb extends au{static get pluginName(){return"TableMouse"}static get requires(){return[qb]}init(){this.editor.editing.view.addObserver($b),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor;let t=!1;const r=e.plugins.get(qb);this.listenTo(e.editing.view.document,"mousedown",(n,o)=>{if(!this.isEnabled||!r.isEnabled)return;if(!o.domEvent.shiftKey)return;const i=r.getAnchorCell()||Fg(e.model.document.selection)[0];if(!i)return;const a=this._getModelTableCellFromDomEvent(o);a&&Xb(i,a)&&(t=!0,r.setCellSelection(i,a),o.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{t=!1}),this.listenTo(e.editing.view.document,"selectionChange",e=>{t&&e.stop()},{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,r,n=!1,o=!1;const i=e.plugins.get(qb);this.listenTo(e.editing.view.document,"mousedown",(e,r)=>{this.isEnabled&&i.isEnabled&&(r.domEvent.shiftKey||r.domEvent.ctrlKey||r.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(r)))}),this.listenTo(e.editing.view.document,"mousemove",(e,a)=>{if(!a.domEvent.buttons)return;if(!t)return;const s=this._getModelTableCellFromDomEvent(a);s&&Xb(t,s)&&(r=s,n||r==t||(n=!0)),n&&(o=!0,i.setCellSelection(t,r),a.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{n=!1,o=!1,t=null,r=null}),this.listenTo(e.editing.view.document,"selectionChange",e=>{o&&e.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,r=this.editor.editing.view.createPositionAt(t,0);return this.editor.editing.mapper.toModelPosition(r).parent.findAncestor("tableCell",{includeSelf:!0})}}function Xb(e,t){return e.parent.parent==t.parent.parent}var Jb=i(4104);function Qb(e){const t=e.getSelectedElement();return t&&tv(t)?t:null}function ev(e){const t=function(e,t){let r=t.parent;for(;r;){if("table"===r.name)return r;r=r.parent}}(0,e.getFirstPosition());return t&&tv(t.parent)?t.parent:null}function tv(e){return!!e.getCustomProperty("table")&&oh(e)}Pl()(Jb.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Jb.Z.locals;var rv=/[\\^$.*+?()[\]{}|]/g,nv=RegExp(rv.source);const ov={copyright:{from:"(c)",to:""},registeredTrademark:{from:"(r)",to:""},trademark:{from:"(tm)",to:""},oneHalf:{from:"1/2",to:""},oneThird:{from:"1/3",to:""},twoThirds:{from:"2/3",to:""},oneForth:{from:"1/4",to:""},threeQuarters:{from:"3/4",to:""},lessThanOrEqual:{from:"<=",to:""},greaterThanOrEqual:{from:">=",to:""},notEqual:{from:"!=",to:""},arrowLeft:{from:"<-",to:""},arrowRight:{from:"->",to:""},horizontalEllipsis:{from:"...",to:""},enDash:{from:/(^| )(--)( )$/,to:[null,"",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"",null]},quotesPrimary:{from:uv('"'),to:[null,"",null,""]},quotesSecondary:{from:uv("'"),to:[null,"",null,""]},quotesPrimaryEnGb:{from:uv("'"),to:[null,"",null,""]},quotesSecondaryEnGb:{from:uv('"'),to:[null,"",null,""]},quotesPrimaryPl:{from:uv('"'),to:[null,"",null,""]},quotesSecondaryPl:{from:uv("'"),to:[null,"",null,""]}},iv={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},av=["symbols","mathematical","typography","quotes"];function sv(e){return"string"==typeof e?new RegExp(`(${function(e){return(e=Mr(e))&&nv.test(e)?e.replace(rv,"\\$&"):e}(e)})$`):e}function lv(e){return"string"==typeof e?()=>[e]:e instanceof Array?()=>e:e}function cv(e){return(e.textNode?e.textNode:e.nodeAfter).getAttributes()}function uv(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}const dv=["left","right","center","justify"];function hv(e){return dv.includes(e)}function pv(e,t){return"rtl"==t.contentLanguageDirection?"right"===e:"left"===e}const fv="alignment";class mv extends pu{refresh(){const e=this.editor.locale,t=_d(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!t&&this._canBeAligned(t),this.isEnabled&&t.hasAttribute("alignment")?this.value=t.getAttribute("alignment"):this.value="rtl"===e.contentLanguageDirection?"right":"left"}execute(e={}){const t=this.editor,r=t.locale,n=t.model,o=n.document,i=e.value;n.change(e=>{const t=Array.from(o.selection.getSelectedBlocks()).filter(e=>this._canBeAligned(e)),n=t[0].getAttribute("alignment");pv(i,r)||n===i||!i?function(e,t){for(const r of e)t.removeAttribute(fv,r)}(t,e):function(e,t,r){for(const n of e)t.setAttribute(fv,r,n)}(t,e,i)})}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,fv)}}class gv extends au{static get pluginName(){return"AlignmentEditing"}constructor(e){super(e),e.config.define("alignment",{options:[...dv]})}init(){const e=this.editor,t=e.locale,r=e.model.schema,n=e.config.get("alignment.options").filter(hv);r.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0});const o=function(e){const t={model:{key:"alignment",values:e.slice()},view:{}};for(const r of e)t.view[r]={key:"style",value:{"text-align":r}};return t}(n.filter(e=>!pv(e,t)));e.conversion.attributeToAttribute(o),e.commands.add("alignment",new mv(e))}}const bv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',vv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',yv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',_v='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',wv=new Map([["left",bv],["right",vv],["center",yv],["justify",_v]]);class xv extends au{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const e=this.editor,t=e.ui.componentFactory,r=e.t,n=e.config.get("alignment.options");n.filter(hv).forEach(e=>this._addButton(e)),t.add("alignment",e=>{const o=$c(e),i=n.map(e=>t.create("alignment:"+e));Kc(o,i),o.buttonView.set({label:r("Text alignment"),tooltip:!0}),o.toolbarView.isVertical=!0,o.toolbarView.ariaLabel=r("Text alignment toolbar"),o.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const a="rtl"===e.contentLanguageDirection?vv:bv;return o.buttonView.bind("icon").toMany(i,"isOn",(...e)=>{const t=e.findIndex(e=>e);return t<0?a:i[t].icon}),o.bind("isEnabled").toMany(i,"isEnabled",(...e)=>e.some(e=>e)),o})}_addButton(e){const t=this.editor;t.ui.componentFactory.add("alignment:"+e,r=>{const n=t.commands.get("alignment"),o=new Lc(r);return o.set({label:this.localizedOptionTitles[e],icon:wv.get(e),tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n),o.bind("isOn").to(n,"value",t=>t===e),this.listenTo(o,"execute",()=>{t.execute("alignment",{value:e}),t.editing.view.focus()}),o})}}class kv extends au{static get pluginName(){return"Autosave"}static get requires(){return[hd]}constructor(e){super(e);const t=e.config.get("autosave")||{},r=t.waitingTime||1e3;this.set("state","synchronized"),this._debouncedSave=Ci(this._save.bind(this),r),this._lastDocumentVersion=e.model.document.version,this._domEmitter=Object.create(Uo),this._config=t}init(){const e=this.editor,t=e.model.document,r=e.t;this._pendingActions=e.plugins.get(hd),this.listenTo(t,"change:data",()=>{this._saveCallbacks.length&&("synchronized"==this.state?(this._action=this._pendingActions.add(r("Saving changes")),this.state="waiting",this._debouncedSave()):"waiting"==this.state&&this._debouncedSave())}),this.listenTo(e,"destroy",()=>this._flush(),{priority:"highest"}),this._domEmitter.listenTo(window,"beforeunload",(e,t)=>{this._pendingActions.hasAny&&(t.returnValue=this._pendingActions.first.message)})}destroy(){this._domEmitter.stopListening(),super.destroy()}_flush(){this._debouncedSave.flush()}_save(){const e=this.editor.model.document.version;e<this._lastDocumentVersion||"initializing"===this.editor.state?this._debouncedSave.cancel():(this._lastDocumentVersion=e,this.state="saving",Promise.resolve().then(()=>Promise.all(this._saveCallbacks.map(e=>e(this.editor)))).catch(e=>{throw this.state="error",this.state="saving",this._debouncedSave(),e}).then(()=>{this.editor.model.document.version>this._lastDocumentVersion?(this.state="waiting",this._debouncedSave()):(this.state="synchronized",this._pendingActions.remove(this._action),this._action=null)}))}get _saveCallbacks(){const e=[];return this.adapter&&this.adapter.save&&e.push(this.adapter.save),this._config.save&&e.push(this._config.save),e}}ir(kv,fn);const Cv="underline";class Ev extends au{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Cv}),e.model.schema.setAttributeProperties(Cv,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Cv,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Cv,new Ed(e,Cv)),e.keystrokes.set("CTRL+U","underline")}}const Sv="underline";class Tv extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Sv,r=>{const n=e.commands.get(Sv),o=new Lc(r);return o.set({label:t("Underline"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>',keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Sv),e.editing.view.focus()}),o})}}const Av="strikethrough";class Pv extends au{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Av}),e.model.schema.setAttributeProperties(Av,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Av,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Av,new Ed(e,Av)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}const Iv="strikethrough";class Ov extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Iv,r=>{const n=e.commands.get(Iv),o=new Lc(r);return o.set({label:t("Strikethrough"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9L6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>',keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Iv),e.editing.view.focus()}),o})}}const Mv="code";class Dv extends au{static get pluginName(){return"CodeEditing"}static get requires(){return[xh]}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Mv}),e.model.schema.setAttributeProperties(Mv,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:Mv,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(Mv,new Ed(e,Mv)),e.plugins.get(xh).registerAttribute(Mv),Ph(e,Mv,"code","ck-code_selected")}}var zv=i(8180);Pl()(zv.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),zv.Z.locals;const jv="code";class Rv extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(jv,r=>{const n=e.commands.get(jv),o=new Lc(r);return o.set({label:t("Code"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 5.7l5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>',tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(jv),e.editing.view.focus()}),o})}}const Lv="subscript";class Nv extends au{static get pluginName(){return"SubscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Lv}),e.model.schema.setAttributeProperties(Lv,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Lv,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add(Lv,new Ed(e,Lv))}}const Bv="subscript";class Fv extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Bv,r=>{const n=e.commands.get(Bv),o=new Lc(r);return o.set({label:t("Subscript"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>',tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Bv),e.editing.view.focus()}),o})}}const Vv="superscript";class Uv extends au{static get pluginName(){return"SuperscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Vv}),e.model.schema.setAttributeProperties(Vv,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Vv,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(Vv,new Ed(e,Vv))}}const qv="superscript";class Hv extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(qv,r=>{const n=e.commands.get(qv),o=new Lc(r);return o.set({label:t("Superscript"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>',tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(qv),e.editing.view.focus()}),o})}}class Wv extends pu{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,r=t.document.selection,n=e.value;t.change(e=>{if(r.isCollapsed)n?e.setSelectionAttribute(this.attributeKey,n):e.removeSelectionAttribute(this.attributeKey);else{const o=t.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const t of o)n?e.setAttribute(this.attributeKey,n,t):e.removeAttribute(this.attributeKey,t)}})}}class Gv extends Lc{constructor(e){super(e);const t=this.bindTemplate;this.set("color"),this.set("hasBorder"),this.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035L8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',this.extendTemplate({attributes:{style:{backgroundColor:t.to("color")},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-table__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}var Zv=i(4923);Pl()(Zv.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Zv.Z.locals;class Yv extends oc{constructor(e,t){super(e);const r=t&&t.colorDefinitions||[],n={};t&&t.columns&&(n.gridTemplateColumns=`repeat( ${t.columns}, 1fr)`),this.set("selectedColor"),this.items=this.createCollection(),this.focusTracker=new El,this.keystrokes=new vl,this._focusCycler=new yc({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.items.on("add",(e,t)=>{t.isOn=t.color===this.selectedColor}),r.forEach(e=>{const t=new Gv;t.set({color:e.color,label:e.label,tooltip:!0,hasBorder:e.options.hasBorder}),t.on("execute",()=>{this.fire("execute",{value:e.color,hasBorder:e.options.hasBorder,label:e.label})}),this.items.add(t)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:n}}),this.on("change:selectedColor",(e,t,r)=>{for(const e of this.items)e.isOn=e.color===r})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element)}}class $v extends ar{constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",0===this.length)})}add(e,t){this.find(t=>t.color===e.color)||super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}}ir($v,fn);const Kv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.636 9.531l-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>';var Xv=i(2585);Pl()(Xv.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Xv.Z.locals;class Jv extends oc{constructor(e,{colors:t,columns:r,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:i}){super(e),this.items=this.createCollection(),this.colorDefinitions=t,this.focusTracker=new El,this.keystrokes=new vl,this.set("selectedColor"),this.removeButtonLabel=n,this.columns=r,this.documentColors=new $v,this.documentColorsCount=i,this._focusCycler=new yc({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-table"]},children:this.items}),this.items.add(this._removeColorButton())}updateDocumentColors(e,t){const r=e.document,n=this.documentColorsCount;this.documentColors.clear();for(const o of r.getRootNames()){const i=r.getRoot(o),a=e.createRangeIn(i);for(const e of a.getItems())if(e.is("$textProxy")&&e.hasAttribute(t)&&(this._addColorToDocumentColors(e.getAttribute(t)),this.documentColors.length>=n))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,r=this.selectedColor;t.selectedColor=r,e&&(e.selectedColor=r)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}appendGrids(){if(!this.staticColorsGrid&&(this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount)){const e=Nl.bind(this.documentColors,this.documentColors),t=new dc(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_removeColorButton(){const e=new Lc;return e.set({withText:!0,icon:Kv,tooltip:!0,label:this.removeButtonLabel}),e.class="ck-color-table__remove-color",e.on("execute",()=>{this.fire("execute",{value:null})}),e}_createStaticColorsGrid(){const e=new Yv(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.delegate("execute").to(this),e}_createDocumentColorsGrid(){const e=Nl.bind(this.documentColors,this.documentColors),t=new Yv(this.locale,{columns:this.columns});return t.delegate("execute").to(this),t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(e=>{const t=new Gv;return t.set({color:e.color,hasBorder:e.options&&e.options.hasBorder}),e.label&&t.set({label:e.label,tooltip:!0}),t.on("execute",()=>{this.fire("execute",{value:e.color})}),t}),this.documentColors.on("change:isEmpty",(e,r,n)=>{n&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(t=>t.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}const Qv="fontSize",ey="fontFamily",ty="fontColor",ry="fontBackgroundColor";function ny(e,t){const r={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const e of t)r.model.values.push(e.model),r.view[e.model]=e.view,e.upcastAlso&&(r.upcastAlso[e.model]=e.upcastAlso);return r}function oy(e){return t=>t.getStyle(e).replace(/\s/g,"")}function iy(e){return(t,{writer:r})=>r.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}class ay extends Wv{constructor(e){super(e,ey)}}function sy(e){return e.map(ly).filter(e=>!!e)}function ly(e){return"object"==typeof e?e:"default"===e?{title:"Default",model:void 0}:"string"==typeof e?function(e){const t=e.replace(/"|'/g,"").split(","),r=t[0],n=t.map(cy).join(", ");return{title:r,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}(e):void 0}function cy(e){return(e=e.trim()).indexOf(" ")>0&&(e=`'${e}'`),e}class uy extends au{static get pluginName(){return"FontFamilyEditing"}constructor(e){super(e),e.config.define(ey,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:ey}),e.model.schema.setAttributeProperties(ey,{isFormatting:!0,copyOnEnter:!0});const t=sy(e.config.get("fontFamily.options")).filter(e=>e.model),r=ny(ey,t);e.config.get("fontFamily.supportAllValues")?this._prepareAnyValueConverters():e.conversion.attributeToElement(r),e.commands.add(ey,new ay(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:ey,view:(e,{writer:t})=>t.createAttributeElement("span",{style:"font-family:"+e},{priority:7})}),e.conversion.for("upcast").attributeToAttribute({model:{key:ey,value:e=>e.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}}class dy extends au{init(){const e=this.editor,t=e.t,r=this._getLocalizedOptions(),n=e.commands.get(ey);e.ui.componentFactory.add(ey,o=>{const i=$c(o);return Xc(i,function(e,t){const r=new ar;for(const n of e){const e={type:"button",model:new Df({commandName:ey,commandParam:n.model,label:n.title,withText:!0})};e.model.bind("isOn").to(t,"value",e=>e===n.model||!(!e||!n.model)&&e.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase()),n.view&&n.view.styles&&e.model.set("labelStyle","font-family: "+n.view.styles["font-family"]),r.add(e)}return r}(r,n)),i.buttonView.set({label:t("Font Family"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>',tooltip:!0}),i.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),i.bind("isEnabled").to(n),this.listenTo(i,"execute",t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()}),i})}_getLocalizedOptions(){const e=this.editor,t=e.t;return sy(e.config.get(ey).options).map(e=>("Default"===e.title&&(e.title=t("Default")),e))}}class hy extends au{static get requires(){return[uy,dy]}static get pluginName(){return"FontFamily"}}class py extends Wv{constructor(e){super(e,Qv)}}function fy(e){return e.map(e=>function(e){if("object"==typeof(t=e)&&t.title&&t.model&&t.view)return gy(e);var t;const r=function(e){return my[e]||my[e.model]}(e);return r?gy(r):"default"===e?{model:void 0,title:"Default"}:function(e){let t;if("object"==typeof e){if(!e.model)throw new qt("font-size-invalid-definition",null,e);t=parseFloat(e.model)}else t=parseFloat(e);return isNaN(t)}(e)?void 0:function(e){return"number"!=typeof e&&"string"!=typeof e||(e={title:String(e),model:parseFloat(e)+"px"}),e.view={name:"span",styles:{"font-size":e.model}},gy(e)}(e)}(e)).filter(e=>!!e)}const my={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function gy(e){return e.view.priority||(e.view.priority=7),e}class by extends au{static get pluginName(){return"FontSizeEditing"}constructor(e){super(e),e.config.define(Qv,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Qv}),e.model.schema.setAttributeProperties(Qv,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),r=fy(this.editor.config.get("fontSize.options")).filter(e=>e.model),n=ny(Qv,r);t?this._prepareAnyValueConverters(n):e.conversion.attributeToElement(n),e.commands.add(Qv,new py(e))}_prepareAnyValueConverters(e){const t=this.editor,r=e.model.values.filter(e=>!String(e).match(/[\d.]+[\w%]+/));if(r.length)throw new qt("font-size-invalid-use-of-named-presets",null,{presets:r});t.conversion.for("downcast").attributeToElement({model:Qv,view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{style:"font-size:"+e},{priority:7})}}),t.conversion.for("upcast").attributeToAttribute({model:{key:Qv,value:e=>e.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}}var vy=i(6203);Pl()(vy.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),vy.Z.locals;class yy extends au{init(){const e=this.editor,t=e.t,r=this._getLocalizedOptions(),n=e.commands.get(Qv);e.ui.componentFactory.add(Qv,o=>{const i=$c(o);return Xc(i,function(e,t){const r=new ar;for(const n of e){const e={type:"button",model:new Df({commandName:Qv,commandParam:n.model,label:n.title,class:"ck-fontsize-option",withText:!0})};n.view&&n.view.styles&&e.model.set("labelStyle","font-size:"+n.view.styles["font-size"]),n.view&&n.view.classes&&e.model.set("class",`${e.model.class} ${n.view.classes}`),e.model.bind("isOn").to(t,"value",e=>e===n.model),r.add(e)}return r}(r,n)),i.buttonView.set({label:t("Font Size"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5L7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279l.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>',tooltip:!0}),i.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),i.bind("isEnabled").to(n),this.listenTo(i,"execute",t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()}),i})}_getLocalizedOptions(){const e=this.editor,t=e.t,r={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return fy(e.config.get(Qv).options).map(e=>{const t=r[e.title];return t&&t!=e.title&&(e=Object.assign({},e,{title:t})),e})}}class _y extends au{static get requires(){return[by,yy]}static get pluginName(){return"FontSize"}}class wy extends Wv{constructor(e){super(e,ty)}}class xy extends au{static get pluginName(){return"FontColorEditing"}constructor(e){super(e),e.config.define(ty,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:ty,value:oy("color")}}),e.conversion.for("downcast").attributeToElement({model:ty,view:iy("color")}),e.commands.add(ty,new wy(e)),e.model.schema.extend("$text",{allowAttributes:ty}),e.model.schema.setAttributeProperties(ty,{isFormatting:!0,copyOnEnter:!0})}}function ky(e,t){const r=e.t,n={Black:r("Black"),"Dim grey":r("Dim grey"),Grey:r("Grey"),"Light grey":r("Light grey"),White:r("White"),Red:r("Red"),Orange:r("Orange"),Yellow:r("Yellow"),"Light green":r("Light green"),Green:r("Green"),Aquamarine:r("Aquamarine"),Turquoise:r("Turquoise"),"Light blue":r("Light blue"),Blue:r("Blue"),Purple:r("Purple")};return t.map(e=>{const t=n[e.label];return t&&t!=e.label&&(e.label=t),e})}function Cy(e){return e.map(Ey).filter(e=>!!e)}function Ey(e){return"string"==typeof e?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:void 0!==e.hasBorder&&e.hasBorder,view:{name:"span",styles:{color:""+e.color}}}}class Sy extends au{constructor(e,{commandName:t,icon:r,componentName:n,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=n,this.icon=r,this.dropdownLabel=o,this.columns=e.config.get(this.componentName+".columns"),this.colorTableView=void 0}init(){const e=this.editor,t=e.locale,r=t.t,n=e.commands.get(this.commandName),o=ky(t,Cy(e.config.get(this.componentName).colors)),i=e.config.get(this.componentName+".documentColors");e.ui.componentFactory.add(this.componentName,t=>{const a=$c(t);return this.colorTableView=function({dropdownView:e,colors:t,columns:r,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:i}){const a=e.locale,s=new Jv(a,{colors:t,columns:r,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:i});return e.colorTableView=s,e.panelView.children.add(s),s.delegate("execute").to(e,"execute"),s}({dropdownView:a,colors:o.map(e=>({label:e.label,color:e.model,options:{hasBorder:e.hasBorder}})),columns:this.columns,removeButtonLabel:r("Remove color"),documentColorsLabel:0!==i?r("Document colors"):void 0,documentColorsCount:void 0===i?this.columns:i}),this.colorTableView.bind("selectedColor").to(n,"value"),a.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),a.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),a.bind("isEnabled").to(n),a.on("execute",(t,r)=>{e.execute(this.commandName,r),e.editing.view.focus()}),a.on("change:isOpen",(t,r,n)=>{a.colorTableView.appendGrids(),n&&(0!==i&&this.colorTableView.updateDocumentColors(e.model,this.componentName),this.colorTableView.updateSelectedColors())}),a})}}class Ty extends Sy{constructor(e){const t=e.locale.t;super(e,{commandName:ty,componentName:ty,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3L10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>',dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}class Ay extends au{static get requires(){return[xy,Ty]}static get pluginName(){return"FontColor"}}class Py extends Wv{constructor(e){super(e,ry)}}const Iy=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Oy=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,My=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Dy=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,zy=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,jy=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","rebeccapurple","currentcolor","transparent"]);function Ry(e){return e.startsWith("#")?Iy.test(e):e.startsWith("rgb")?Oy.test(e)||My.test(e):e.startsWith("hsl")?Dy.test(e)||zy.test(e):jy.has(e.toLowerCase())}const Ly=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function Ny(e){return Ly.includes(e)}const By=/^([+-]?[0-9]*[.]?[0-9]+(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Fy(e){return By.test(e)}const Vy=/^[+-]?[0-9]*[.]?[0-9]+%$/,Uy=["repeat-x","repeat-y","repeat","space","round","no-repeat"],qy=["center","top","bottom","left","right"];function Hy(e){return qy.includes(e)}const Wy=["fixed","scroll","local"];function Gy(e){return Wy.includes(e)}const Zy=/^url\(/;function Yy(e){return Zy.test(e)}function $y(e=""){if(""===e)return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=Jy(e),r=t[0],n=t[2]||r,o=t[1]||r;return{top:r,bottom:n,right:o,left:t[3]||o}}function Ky(e){return t=>{const{top:r,right:n,bottom:o,left:i}=t,a=[];return[r,n,i,o].every(e=>!!e)?a.push([e,Xy(t)]):(r&&a.push([e+"-top",r]),n&&a.push([e+"-right",n]),o&&a.push([e+"-bottom",o]),i&&a.push([e+"-left",i])),a}}function Xy({top:e,right:t,bottom:r,left:n}){const o=[];return n!==t?o.push(e,t,r,n):r!==e?o.push(e,t,r):t!==e?o.push(e,t):o.push(e),o.join(" ")}function Jy(e){return e.replace(/, /g,",").split(" ").map(e=>e.replace(/,/g,", "))}function Qy(e){e.setNormalizer("background",e_),e.setNormalizer("background-color",e=>({path:"background.color",value:e})),e.setReducer("background",e=>{const t=[];return t.push(["background-color",e.color]),t})}function e_(e){const t={},r=Jy(e);for(const e of r)n=e,Uy.includes(n)?(t.repeat=t.repeat||[],t.repeat.push(e)):Hy(e)?(t.position=t.position||[],t.position.push(e)):Gy(e)?t.attachment=e:Ry(e)?t.color=e:Yy(e)&&(t.image=e);var n;return{path:"background",value:t}}class t_ extends au{static get pluginName(){return"FontBackgroundColorEditing"}constructor(e){super(e),e.config.define(ry,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(Qy),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:ry,value:oy("background-color")}}),e.conversion.for("downcast").attributeToElement({model:ry,view:iy("background-color")}),e.commands.add(ry,new Py(e)),e.model.schema.extend("$text",{allowAttributes:ry}),e.model.schema.setAttributeProperties(ry,{isFormatting:!0,copyOnEnter:!0})}}class r_ extends Sy{constructor(e){const t=e.locale.t;super(e,{commandName:ry,componentName:ry,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>',dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}class n_ extends au{static get requires(){return[t_,r_]}static get pluginName(){return"FontBackgroundColor"}}class o_ extends pu{refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("highlight"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"highlight")}execute(e={}){const t=this.editor.model,r=t.document.selection,n=e.value;t.change(e=>{const o=t.schema.getValidRanges(r.getRanges(),"highlight");if(r.isCollapsed){const t=r.getFirstPosition();if(r.hasAttribute("highlight")){const r=e=>e.item.hasAttribute("highlight")&&e.item.getAttribute("highlight")===this.value,o=t.getLastMatchingPosition(r,{direction:"backward"}),i=t.getLastMatchingPosition(r),a=e.createRange(o,i);n&&this.value!==n?(e.setAttribute("highlight",n,a),e.setSelectionAttribute("highlight",n)):(e.removeAttribute("highlight",a),e.removeSelectionAttribute("highlight"))}else n&&e.setSelectionAttribute("highlight",n)}else for(const t of o)n?e.setAttribute("highlight",n,t):e.removeAttribute("highlight",t)})}}class i_ extends au{static get pluginName(){return"HighlightEditing"}constructor(e){super(e),e.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"highlight"});const t=e.config.get("highlight.options");e.conversion.attributeToElement(function(e){const t={model:{key:"highlight",values:[]},view:{}};for(const r of e)t.model.values.push(r.model),t.view[r.model]={name:"mark",classes:r.class};return t}(t)),e.commands.add("highlight",new o_(e))}}var a_=i(713);Pl()(a_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),a_.Z.locals;class s_ extends au{get localizedOptionTitles(){const e=this.editor.t;return{"Yellow marker":e("Yellow marker"),"Green marker":e("Green marker"),"Pink marker":e("Pink marker"),"Blue marker":e("Blue marker"),"Red pen":e("Red pen"),"Green pen":e("Green pen")}}static get pluginName(){return"HighlightUI"}init(){const e=this.editor.config.get("highlight.options");for(const t of e)this._addHighlighterButton(t);this._addRemoveHighlightButton(),this._addDropdown(e)}_addRemoveHighlightButton(){const e=this.editor.t;this._addButton("removeHighlight",e("Remove highlight"),Kv)}_addHighlighterButton(e){const t=this.editor.commands.get("highlight");this._addButton("highlight:"+e.model,e.title,l_(e.type),e.model,(function(r){r.bind("isEnabled").to(t,"isEnabled"),r.bind("isOn").to(t,"value",t=>t===e.model),r.iconView.fillColor=e.color,r.isToggleable=!0}))}_addButton(e,t,r,n,o=(()=>{})){const i=this.editor;i.ui.componentFactory.add(e,e=>{const a=new Lc(e),s=this.localizedOptionTitles[t]?this.localizedOptionTitles[t]:t;return a.set({label:s,icon:r,tooltip:!0}),a.on("execute",()=>{i.execute("highlight",{value:n}),i.editing.view.focus()}),o(a),a})}_addDropdown(e){const t=this.editor,r=t.t,n=t.ui.componentFactory,o=e[0],i=e.reduce((e,t)=>(e[t.model]=t,e),{});n.add("highlight",a=>{const s=t.commands.get("highlight"),l=$c(a,Rb),c=l.buttonView;c.set({tooltip:r("Highlight"),lastExecuted:o.model,commandValue:o.model,isToggleable:!0}),c.bind("icon").to(s,"value",e=>l_(d(e,"type"))),c.bind("color").to(s,"value",e=>d(e,"color")),c.bind("commandValue").to(s,"value",e=>d(e,"model")),c.bind("isOn").to(s,"value",e=>!!e),c.delegate("execute").to(l);const u=e.map(e=>{const t=n.create("highlight:"+e.model);return this.listenTo(t,"execute",()=>l.buttonView.set({lastExecuted:e.model})),t});function d(e,t){const r=e&&e!==c.lastExecuted?e:c.lastExecuted;return i[r][t]}return l.bind("isEnabled").toMany(u,"isEnabled",(...e)=>e.some(e=>e)),u.push(new wc),u.push(n.create("removeHighlight")),Kc(l,u),function(e){e.buttonView.actionView.iconView.bind("fillColor").to(e.buttonView,"color")}(l),l.toolbarView.ariaLabel=r("Text highlight toolbar"),c.on("execute",()=>{t.execute("highlight",{value:c.commandValue}),t.editing.view.focus()}),l})}}function l_(e){return"marker"===e?'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.798 1.59L3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="M2.556 16.727l.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415l1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656l-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5L9.59 17h9.406v1.5H8.245z"/></svg>':'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268L2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="M4.5 18.088l-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166l-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5L9.59 17h9.406v1.5H8.245z"/></svg>'}class c_ extends pu{refresh(){this.isEnabled=function(e){const t=e.schema,r=e.document.selection;return function(e,t,r){const n=function(e,t){const r=ch(e,t).parent;return r.isEmpty&&!r.is("element","$root")?r.parent:r}(e,r);return t.checkChild(n,"horizontalLine")}(r,t,e)&&!function(e,t){const r=e.getSelectedElement();return r&&t.isObject(r)}(r,t)}(this.editor.model)}execute(){const e=this.editor.model;e.change(t=>{const r=t.createElement("horizontalLine");e.insertContent(r);let n=r.nextSibling;!(n&&e.schema.checkChild(n,"$text"))&&e.schema.checkChild(r.parent,"paragraph")&&(n=t.createElement("paragraph"),e.insertContent(n,t.createPositionAfter(r))),n&&t.setSelection(n,0)})}}var u_=i(2536);Pl()(u_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),u_.Z.locals;class d_ extends au{static get pluginName(){return"HorizontalLineEditing"}init(){const e=this.editor,t=e.model.schema,r=e.t,n=e.conversion;t.register("horizontalLine",{isObject:!0,allowWhere:"$block"}),n.for("dataDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>t.createEmptyElement("hr")}),n.for("editingDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>{const n=r("Horizontal line"),o=t.createContainerElement("div"),i=t.createEmptyElement("hr");return t.addClass("ck-horizontal-line",o),t.setCustomProperty("hr",!0,o),t.insert(t.createPositionAt(o,0),i),function(e,t,r){return t.setCustomProperty("horizontalLine",!0,e),ih(e,t,{label:r})}(o,t,n)}}),n.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new c_(e))}}class h_ extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("horizontalLine",r=>{const n=e.commands.get("horizontalLine"),o=new Lc(r);return o.set({label:t("Horizontal line"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("horizontalLine"),e.editing.view.focus()}),o})}}class p_ extends pu{refresh(){const e=this.editor.model,t=e.document;this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"mention")}execute(e){const t=this.editor.model,r=t.document.selection,n="string"==typeof e.mention?{id:e.mention}:e.mention,o=n.id,i=e.range||r.getFirstRange(),a=e.text||o,s=m_({_text:a,id:o},n);if(1!=e.marker.length)throw new qt("mentioncommand-incorrect-marker",this);if(o.charAt(0)!=e.marker)throw new qt("mentioncommand-incorrect-id",this);t.change(e=>{const n=vr(r.getAttributes()),o=new Map(n.entries());o.set("mention",s),t.insertContent(e.createText(a,o),i),t.insertContent(e.createText(" ",n),i.start.getShiftedBy(a.length))})}}class f_ extends au{static get pluginName(){return"MentionEditing"}init(){const e=this.editor,t=e.model,r=t.document;t.schema.extend("$text",{allowAttributes:"mention"}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",key:"data-mention",classes:"mention"},model:{key:"mention",value:e=>g_(e)}}),e.conversion.for("downcast").attributeToElement({model:"mention",view:v_}),e.conversion.for("downcast").add(b_),r.registerPostFixer(e=>function(e,t,r){const n=t.differ.getChanges();let o=!1;for(const t of n){const n=t.position;if("$text"==t.name){const t=n.textNode&&n.textNode.nextSibling;o=__(n.textNode,e)||o,o=__(t,e)||o,o=__(n.nodeBefore,e)||o,o=__(n.nodeAfter,e)||o}if("$text"!=t.name&&"insert"==t.type){const t=n.nodeAfter;for(const r of e.createRangeIn(t).getItems())o=__(r,e)||o}if("insert"==t.type&&r.isInline(t.name)){const t=n.nodeAfter&&n.nodeAfter.nextSibling;o=__(n.nodeBefore,e)||o,o=__(t,e)||o}}return o}(e,r,t.schema)),r.registerPostFixer(e=>function(e,t){const r=t.differ.getChanges();let n=!1;for(const t of r)if("attribute"===t.type&&"mention"!=t.attributeKey){const r=t.range.start.nodeBefore,o=t.range.end.nodeAfter;for(const i of[r,o])y_(i)&&i.getAttribute(t.attributeKey)!=t.attributeNewValue&&(e.setAttribute(t.attributeKey,t.attributeNewValue,i),n=!0)}return n}(e,r)),r.registerPostFixer(e=>function(e,t){const r=t.selection,n=r.focus;if(r.isCollapsed&&r.hasAttribute("mention")&&function(e){const t=e.isAtStart;return e.nodeBefore&&e.nodeBefore.is("$text")||t}(n))return e.removeSelectionAttribute("mention"),!0}(e,r)),e.commands.add("mention",new p_(e))}}function m_(e,t){return Object.assign({uid:Vt()},e,t||{})}function g_(e,t){const r=e.getAttribute("data-mention"),n=e.getChild(0);if(n)return m_({id:r,_text:n.data},t)}function b_(e){e.on("attribute:mention",(e,t,r)=>{const n=t.attributeNewValue;if(!t.item.is("$textProxy")||!n)return;const o=t.range.start;(o.textNode||o.nodeAfter).data!=n._text&&r.consumable.consume(t.item,e.name)},{priority:"highest"})}function v_(e,{writer:t}){if(!e)return;const r={class:"mention","data-mention":e.id},n={id:e.uid,priority:20};return t.createAttributeElement("span",r,n)}function y_(e){return!(!e||!e.is("$text")&&!e.is("$textProxy")||!e.hasAttribute("mention"))&&e.data!=e.getAttribute("mention")._text}function __(e,t){return!!y_(e)&&(t.removeAttribute("mention",e),!0)}var w_=i(6391);Pl()(w_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),w_.Z.locals;class x_ extends Vc{constructor(e){super(e),this.extendTemplate({attributes:{class:["ck-mentions"],tabindex:"-1"}})}selectFirst(){this.select(0)}selectNext(){const e=this.selected,t=this.items.getIndex(e);this.select(t+1)}selectPrevious(){const e=this.selected,t=this.items.getIndex(e);this.select(t-1)}select(e){let t=0;e>0&&e<this.items.length?t=e:e<0&&(t=this.items.length-1);const r=this.items.get(t);this.selected!==r&&(this.selected&&this.selected.removeHighlight(),r.highlight(),this.selected=r,this._isItemVisibleInScrolledArea(r)||(this.element.scrollTop=r.element.offsetTop))}executeSelected(){this.selected.fire("execute")}_isItemVisibleInScrolledArea(e){return new Di(this.element).contains(new Di(e.element))}}class k_ extends oc{constructor(e,t){super(e),this.template=!1,this.domElement=t,this.domElement.classList.add("ck-button"),this.set("isOn",!1),this.on("change:isOn",(e,t,r)=>{r?(this.domElement.classList.add("ck-on"),this.domElement.classList.remove("ck-off")):(this.domElement.classList.add("ck-off"),this.domElement.classList.remove("ck-on"))}),this.listenTo(this.domElement,"click",()=>{this.fire("execute")})}render(){super.render(),this.element=this.domElement}}class C_ extends Uc{highlight(){this.children.first.isOn=!0}removeHighlight(){this.children.first.isOn=!1}}const E_=[Hn.arrowup,Hn.arrowdown,Hn.enter,Hn.tab,Hn.esc];class S_ extends au{static get pluginName(){return"MentionUI"}static get requires(){return[$p]}constructor(e){super(e),this._mentionsView=this._createMentionView(),this._mentionsConfigurations=new Map,this._requestFeedDebounced=Ci(this._requestFeed,100),e.config.define("mention",{feeds:[]})}init(){const e=this.editor;this._balloon=e.plugins.get($p),e.editing.view.document.on("keydown",(e,t)=>{var r;r=t.keyCode,E_.includes(r)&&this._isUIVisible&&(t.preventDefault(),e.stop(),t.keyCode==Hn.arrowdown&&this._mentionsView.selectNext(),t.keyCode==Hn.arrowup&&this._mentionsView.selectPrevious(),t.keyCode!=Hn.enter&&t.keyCode!=Hn.tab||this._mentionsView.executeSelected(),t.keyCode==Hn.esc&&this._hideUIAndRemoveMarker())},{priority:"highest"}),Gc({emitter:this._mentionsView,activator:()=>this._isUIVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideUIAndRemoveMarker()});const t=e.config.get("mention.feeds");for(const e of t){const t=e.feed,r=e.marker;if(!I_(r))throw new qt("mentionconfig-incorrect-marker",null,{marker:r});const n=e.minimumCharacters||0,o="function"==typeof t?t.bind(this.editor):P_(t),i={watcher:this._setupTextWatcherForFeed(r,n),marker:r,feedCallback:o,itemRenderer:e.itemRenderer};this._mentionsConfigurations.set(r,i)}this.on("requestFeed:response",(e,t)=>this._handleFeedResponse(t)),this.on("requestFeed:error",()=>this._hideUIAndRemoveMarker())}destroy(){super.destroy(),this._mentionsView.destroy()}get _isUIVisible(){return this._balloon.visibleView===this._mentionsView}_createMentionView(){const e=this.editor.locale,t=new x_(e);return this._items=new ar,t.items.bindTo(this._items).using(r=>{const{item:n,marker:o}=r,i=new C_(e),a=this._renderItem(n,o);return a.delegate("execute").to(i),i.children.add(a),i.item=n,i.marker=o,i.on("execute",()=>{t.fire("execute",{item:n,marker:o})}),i}),t.on("execute",(e,t)=>{const r=this.editor,n=r.model,o=t.item,i=t.marker,a=r.model.markers.get("mention"),s=n.createPositionAt(n.document.selection.focus),l=n.createPositionAt(a.getStart()),c=n.createRange(l,s);this._hideUIAndRemoveMarker(),r.execute("mention",{mention:o,text:o.text,marker:i,range:c}),r.editing.view.focus()}),t}_getItemRenderer(e){const{itemRenderer:t}=this._mentionsConfigurations.get(e);return t}_requestFeed(e,t){this._lastRequested=t;const{feedCallback:r}=this._mentionsConfigurations.get(e),n=r(t);n instanceof Promise?n.then(r=>{this._lastRequested==t?this.fire("requestFeed:response",{feed:r,marker:e,feedText:t}):this.fire("requestFeed:discarded",{feed:r,marker:e,feedText:t})}).catch(t=>{this.fire("requestFeed:error",{error:t}),Ht("mention-feed-callback-error",{marker:e})}):this.fire("requestFeed:response",{feed:n,marker:e,feedText:t})}_setupTextWatcherForFeed(e,t){const r=this.editor,n=new wm(r.model,function(e,t){const r=A_(e,t);return e=>r.test(e)}(e,t));n.on("matched",(t,n)=>{const o=r.model.document.selection.focus;if(function(e){const t=e.textNode&&e.textNode.hasAttribute("mention"),r=e.nodeBefore;return t||r&&r.is("$text")&&r.hasAttribute("mention")}(o))return void this._hideUIAndRemoveMarker();const i=function(e,t){const r=A_(e,0);return t.match(r)[2]}(e,n.text),a=e.length+i.length,s=o.getShiftedBy(-a),l=o.getShiftedBy(-i.length),c=r.model.createRange(s,l);if(O_(r)){const e=r.model.markers.get("mention");r.model.change(t=>{t.updateMarker(e,{range:c})})}else r.model.change(e=>{e.addMarker("mention",{range:c,usingOperation:!1,affectsData:!1})});this._requestFeedDebounced(e,i)}),n.on("unmatched",()=>{this._hideUIAndRemoveMarker()});const o=r.commands.get("mention");return n.bind("isEnabled").to(o),n}_handleFeedResponse(e){const{feed:t,marker:r}=e;if(!O_(this.editor))return;this._items.clear();for(const e of t){const t="object"!=typeof e?{id:e,text:e}:e;this._items.add({item:t,marker:r})}const n=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(n):this._hideUIAndRemoveMarker()}_showOrUpdateUI(e){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(e,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(e,this._mentionsView.position),withArrow:!1,singleViewMode:!0}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst()}_hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),O_(this.editor)&&this.editor.model.change(e=>e.removeMarker("mention")),this._mentionsView.position=void 0}_renderItem(e,t){const r=this.editor;let n,o=e.id;const i=this._getItemRenderer(t);if(i){const t=i(e);"string"!=typeof t?n=new k_(r.locale,t):o=t}if(!n){const e=new Lc(r.locale);e.label=o,e.withText=!0,n=e}return n}_getBalloonPanelPositionData(e,t){const r=this.editor,n=r.editing,o=n.view.domConverter,i=n.mapper;return{target:()=>{let t=e.getRange();"$graveyard"==t.start.root.rootName&&(t=r.model.document.selection.getFirstRange());const n=i.toViewRange(t);return Di.getDomRangeRects(o.viewRangeToDom(n)).pop()},limiter:()=>{const e=this.editor.editing.view,t=e.document.selection.editableElement;return t?e.domConverter.mapViewToDom(t.root):null},positions:T_(t)}}}function T_(e){const t={caret_se:e=>({top:e.bottom+3,left:e.right,name:"caret_se"}),caret_ne:(e,t)=>({top:e.top-t.height-3,left:e.right,name:"caret_ne"}),caret_sw:(e,t)=>({top:e.bottom+3,left:e.right-t.width,name:"caret_sw"}),caret_nw:(e,t)=>({top:e.top-t.height-3,left:e.right-t.width,name:"caret_nw"})};return Object.prototype.hasOwnProperty.call(t,e)?[t[e]]:[t.caret_se,t.caret_sw,t.caret_ne,t.caret_nw]}function A_(e,t){const r=0==t?"*":`{${t},}`,n=Vn.isRegExpUnicodePropertySupported?"\\p{Ps}\\p{Pi}\"'":"\\(\\[{\"'";return new RegExp(`(?:^|[ ${n}])([${e}])([\\S]${r})$`,"u")}function P_(e){return t=>e.filter(e=>("string"==typeof e?e:String(e.id)).toLowerCase().includes(t.toLowerCase())).slice(0,10)}function I_(e){return e&&1==e.length}function O_(e){return e.model.markers.has("mention")}var M_=i(7583);Pl()(M_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),M_.Z.locals;class D_ extends pu{refresh(){this.isEnabled=function(e){const t=e.schema,r=e.document.selection;return function(e,t,r){const n=function(e,t){const r=ch(e,t).parent;return r.isEmpty&&!r.is("element","$root")?r.parent:r}(e,r);return t.checkChild(n,"pageBreak")}(r,t,e)&&!function(e,t){const r=e.getSelectedElement();return r&&t.isObject(r)}(r,t)}(this.editor.model)}execute(){const e=this.editor.model;e.change(t=>{const r=t.createElement("pageBreak");e.insertContent(r);let n=r.nextSibling;!(n&&e.schema.checkChild(n,"$text"))&&e.schema.checkChild(r.parent,"paragraph")&&(n=t.createElement("paragraph"),e.insertContent(n,t.createPositionAfter(r))),n&&t.setSelection(n,0)})}}var z_=i(6448);Pl()(z_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),z_.Z.locals;class j_ extends au{static get pluginName(){return"PageBreakEditing"}init(){const e=this.editor,t=e.model.schema,r=e.t,n=e.conversion;t.register("pageBreak",{isObject:!0,allowWhere:"$block"}),n.for("dataDowncast").elementToElement({model:"pageBreak",view:(e,{writer:t})=>{const r=t.createContainerElement("div",{class:"page-break",style:"page-break-after: always"}),n=t.createContainerElement("span",{style:"display: none"});return t.insert(t.createPositionAt(r,0),n),r}}),n.for("editingDowncast").elementToElement({model:"pageBreak",view:(e,{writer:t})=>{const n=r("Page break"),o=t.createContainerElement("div"),i=t.createUIElement("span",{class:"page-break__label"},(function(e){const t=this.toDomElement(e);return t.innerText=r("Page break"),t}));return t.addClass("page-break",o),t.insert(t.createPositionAt(o,0),i),function(e,t,r){return t.setCustomProperty("pageBreak",!0,e),ih(e,t,{label:r})}(o,t,n)}}),n.for("upcast").elementToElement({view:e=>{const t="always"==e.getStyle("page-break-before"),r="always"==e.getStyle("page-break-after");if(t||r){if(1==e.childCount){const t=e.getChild(0);if(!t.is("element","span")||"none"!=t.getStyle("display")||1!=t.childCount)return;const r=t.getChild(0);if(!r.is("$text")||" "!==r.data)return}else if(e.childCount>1)return;return{name:!0}}},model:"pageBreak",converterPriority:"high"}),e.commands.add("pageBreak",new D_(e))}}class R_ extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("pageBreak",r=>{const n=e.commands.get("pageBreak"),o=new Lc(r);return o.set({label:t("Page break"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.598.687h1.5v5h-1.5zm14.5 0h1.5v5h-1.5z"/><path d="M19.598 4.187v1.5h-16v-1.5zm-16 14.569h1.5v-5h-1.5zm14.5 0h1.5v-5h-1.5z"/><path d="M19.598 15.256v-1.5h-16v1.5zM5.081 9h6v2h-6zm8 0h6v2h-6zm-9.483 1L0 12.5v-5z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("pageBreak"),e.editing.view.focus()}),o})}}const L_="removeFormat";class N_ extends au{static get pluginName(){return"RemoveFormatUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(L_,r=>{const n=e.commands.get(L_),o=new Lc(r);return o.set({label:t("Remove Format"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>',tooltip:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(L_),e.editing.view.focus()}),o})}}class B_ extends pu{refresh(){const e=this.editor.model;this.isEnabled=!!_d(this._getFormattingItems(e.document.selection,e.schema))}execute(){const e=this.editor.model,t=e.schema;e.change(r=>{for(const n of this._getFormattingItems(e.document.selection,t))if(n.is("selection"))for(const e of this._getFormattingAttributes(n,t))r.removeSelectionAttribute(e);else{const e=r.createRangeOn(n);for(const o of this._getFormattingAttributes(n,t))r.removeAttribute(o,e)}})}*_getFormattingItems(e,t){const r=e=>!!_d(this._getFormattingAttributes(e,t));for(const n of e.getRanges())for(const e of n.getItems())!t.isBlock(e)&&r(e)&&(yield e);for(const t of e.getSelectedBlocks())r(t)&&(yield t);r(e)&&(yield e)}*_getFormattingAttributes(e,t){for(const[r]of e.getAttributes()){const e=t.getAttributeProperties(r);e&&e.isFormatting&&(yield r)}}}class F_ extends au{static get pluginName(){return"RemoveFormatEditing"}init(){const e=this.editor;e.commands.add("removeFormat",new B_(e))}}class V_ extends pu{refresh(){const e=this.editor.model,t=e.document;this.value=!!t.selection.getAttribute("restrictedEditingException"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"restrictedEditingException")}execute(e={}){const t=this.editor.model,r=t.document.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change(e=>{const o=t.schema.getValidRanges(r.getRanges(),"restrictedEditingException");if(r.isCollapsed)if(n)e.setSelectionAttribute("restrictedEditingException",n);else{const t=e=>e.item.getAttribute("restrictedEditingException")===this.value,n=r.focus.getLastMatchingPosition(t,{direction:"backward"}),o=r.focus.getLastMatchingPosition(t),i=r.focus;e.removeSelectionAttribute("restrictedEditingException"),i.isEqual(n)||i.isEqual(o)||e.removeAttribute("restrictedEditingException",e.createRange(n,o))}else for(const t of o)n?e.setAttribute("restrictedEditingException",n,t):e.removeAttribute("restrictedEditingException",t)})}}class U_ extends au{static get pluginName(){return"StandardEditingModeEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:["restrictedEditingException"]}),e.conversion.for("upcast").elementToAttribute({model:"restrictedEditingException",view:{name:"span",classes:"restricted-editing-exception"}}),e.conversion.for("downcast").attributeToElement({model:"restrictedEditingException",view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{class:"restricted-editing-exception"},{priority:-10})}}),e.commands.add("restrictedEditingException",new V_(e)),e.editing.view.change(t=>{for(const r of e.editing.view.document.roots)t.addClass("ck-restricted-editing_mode_standard",r)})}}class q_ extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("restrictedEditingException",r=>{const n=e.commands.get("restrictedEditingException"),o=new Lc(r);return o.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.25 16a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm0-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm3-5a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1 0-1.5h8.5zm6-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 0 1 0-1.5h14.5zm.25 5.5a3.5 3.5 0 0 1 3.143 1.959.75.75 0 0 1-1.36.636A2 2 0 0 0 13.5 10v2H19a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-5a1 1 0 0 1 1-1v-2l.005-.192A3.5 3.5 0 0 1 15.5 6.5zm0 7.5a.5.5 0 0 0-.492.41L15 14.5v2a.5.5 0 0 0 .992.09L16 16.5v-2a.5.5 0 0 0-.5-.5z"/></svg>',tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),o.bind("label").to(n,"value",e=>t(e?"Disable editing":"Enable editing")),this.listenTo(o,"execute",()=>{e.execute("restrictedEditingException"),e.editing.view.focus()}),o})}}var H_=i(2353);function W_(e){const t=e.t,r=e.config.get("codeBlock.languages");for(const e of r)"Plain text"===e.label&&(e.label=t("Plain text")),void 0===e.class&&(e.class="language-"+e.language);return r}function G_(e,t,r){const n={};for(const o of e)"class"===t?n[o[t].split(" ").shift()]=o[r]:n[o[t]]=o[r];return n}function Z_(e){return e.data.match(/^(\s*)/)[0]}function Y_(e,t){const r=e.createDocumentFragment(),n=t.split("\n").map(t=>e.createText(t)),o=n[n.length-1];for(const t of n)e.append(t,r),t!==o&&e.appendElement("softBreak",r);return r}function $_(e){const t=e.document.selection,r=[];if(t.isCollapsed)r.push(t.anchor);else{const n=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:t}of n)if(t.is("$textProxy")&&t.parent.is("element","codeBlock")){const n=Z_(t.textNode),{parent:o,startOffset:i}=t.textNode,a=e.createPositionAt(o,i+n.length);r.push(a)}}return r}function K_(e){const t=_d(e.getSelectedBlocks());return t&&t.is("element","codeBlock")}Pl()(H_.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),H_.Z.locals;class X_ extends pu{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,r=t.model,n=r.document.selection,o=W_(t)[0],i=Array.from(n.getSelectedBlocks()),a=void 0===e.forceValue?!this.value:e.forceValue,s=e.language||o.language;r.change(e=>{a?this._applyCodeBlock(e,i,s):this._removeCodeBlock(e,i)})}_getValue(){const e=_d(this.editor.model.document.selection.getSelectedBlocks());return!(!e||!e.is("element","codeBlock"))&&e.getAttribute("language")}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,r=_d(e.getSelectedBlocks());return!!r&&J_(t,r)}_applyCodeBlock(e,t,r){const n=this.editor.model.schema,o=t.filter(e=>J_(n,e));for(const t of o)e.rename(t,"codeBlock"),e.setAttribute("language",r,t),n.removeDisallowedAttributes([t],e);o.reverse().forEach((t,r)=>{const n=o[r+1];t.previousSibling===n&&(e.appendElement("softBreak",n),e.merge(e.createPositionBefore(t)))})}_removeCodeBlock(e,t){const r=t.filter(e=>e.is("element","codeBlock"));for(const t of r){const r=e.createRangeOn(t);for(const t of Array.from(r.getItems()).reverse())if(t.is("element","softBreak")&&t.parent.is("element","codeBlock")){const{position:r}=e.split(e.createPositionBefore(t));e.rename(r.nodeAfter,"paragraph"),e.removeAttribute("language",r.nodeAfter),e.remove(t)}e.rename(t,"paragraph"),e.removeAttribute("language",t)}}}function J_(e,t){return!t.is("rootElement")&&!e.isLimit(t)&&e.checkChild(t.parent,"codeBlock")}class Q_ extends pu{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model;e.change(t=>{const r=$_(e);for(const e of r)t.insertText(this._indentSequence,e)})}_checkEnabled(){return!!this._indentSequence&&K_(this.editor.model.document.selection)}}class ew extends pu{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model;e.change(t=>{const r=$_(e);for(const e of r){const r=tw(this.editor.model,e,this._indentSequence);r&&t.remove(r)}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return!!K_(e.document.selection)&&$_(e).some(t=>tw(e,t,this._indentSequence))}}function tw(e,t,r){const n=function(e){let t=e.parent.getChild(e.index);return t&&!t.is("element","softBreak")||(t=e.nodeBefore),!t||t.is("element","softBreak")?null:t}(t);if(!n)return null;const o=Z_(n),i=o.lastIndexOf(r);if(i+r.length!==o.length)return null;if(-1===i)return null;const{parent:a,startOffset:s}=n;return e.createRange(e.createPositionAt(a,s+i),e.createPositionAt(a,s+i+r.length))}function rw(e,t,r=!1){const n=G_(t,"language","class"),o=G_(t,"language","label");return(t,i,a)=>{const{writer:s,mapper:l,consumable:c}=a;if(!c.consume(i.item,"insert"))return;const u=i.item.getAttribute("language"),d=l.toViewPosition(e.createPositionBefore(i.item)),h={};r&&(h["data-language"]=o[u],h.spellcheck="false");const p=s.createContainerElement("pre",h),f=s.createContainerElement("code",{class:n[u]||null});s.insert(s.createPositionAt(p,0),f),s.insert(d,p),l.bindElements(i.item,f)}}const nw="paragraph";class ow extends au{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[ku]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"\t"})}init(){const e=this.editor,t=e.model.schema,r=e.model,n=W_(e);e.commands.add("codeBlock",new X_(e)),e.commands.add("indentCodeBlock",new Q_(e)),e.commands.add("outdentCodeBlock",new ew(e));const o=e=>(t,r)=>{this.editor.commands.get(e).isEnabled&&(this.editor.execute(e),r())};e.keystrokes.set("Tab",o("indentCodeBlock")),e.keystrokes.set("Shift+Tab",o("outdentCodeBlock")),t.register("codeBlock",{allowWhere:"$block",isBlock:!0,allowAttributes:["language"]}),t.extend("$text",{allowIn:"codeBlock"}),t.addAttributeCheck(e=>{if(e.endsWith("codeBlock $text"))return!1}),e.editing.downcastDispatcher.on("insert:codeBlock",rw(r,n,!0)),e.data.downcastDispatcher.on("insert:codeBlock",rw(r,n)),e.data.downcastDispatcher.on("insert:softBreak",function(e){return(t,r,n)=>{if("codeBlock"!==r.item.parent.name)return;const{writer:o,mapper:i,consumable:a}=n;if(!a.consume(r.item,"insert"))return;const s=i.toViewPosition(e.createPositionBefore(r.item));o.insert(s,o.createText("\n"))}}(r),{priority:"high"}),e.data.upcastDispatcher.on("element:pre",function(e,t){const r=G_(t,"class","language"),n=t[0].language;return(t,o,i)=>{const a=o.viewItem,s=a.getChild(0);if(!s||!s.is("element","code"))return;const{consumable:l,writer:c}=i;if(!l.test(a,{name:!0})||!l.test(s,{name:!0}))return;const u=c.createElement("codeBlock"),d=[...s.getClassNames()];d.length||d.push("");for(const e of d){const t=r[e];if(t){c.setAttribute("language",t,u);break}}u.hasAttribute("language")||c.setAttribute("language",n,u);const h=Y_(c,[...e.createRangeIn(s)].filter(e=>"text"===e.type).map(({item:e})=>e.data).join(""));c.append(h,u),i.safeInsert(u,o.modelCursor)&&(l.consume(a,{name:!0}),l.consume(s,{name:!0}),i.updateConversionResult(u,o))}}(e.editing.view,n)),this.listenTo(e.editing.view.document,"clipboardInput",(e,t)=>{const n=r.document.selection;if(!n.anchor.parent.is("element","codeBlock"))return;const o=t.dataTransfer.getData("text/plain");r.change(t=>{r.insertContent(Y_(t,o),n),e.stop()})}),this.listenTo(r,"getSelectedContent",(e,[n])=>{const o=n.anchor;!n.isCollapsed&&o.parent.is("element","codeBlock")&&o.hasSameParentAs(n.focus)&&r.change(r=>{const i=e.return;if(i.childCount>1||n.containsEntireContent(o.parent)){const t=r.createElement("codeBlock",o.parent.getAttributes());r.append(i,t);const n=r.createDocumentFragment();r.append(t,n),e.return=n}else{const e=i.getChild(0);t.checkAttribute(e,"code")&&r.setAttribute("code",!0,e)}})})}afterInit(){const e=this.editor,t=e.commands,r=t.get("indent"),n=t.get("outdent");r&&r.registerChildCommand(t.get("indentCodeBlock")),n&&n.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",(t,r)=>{e.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(function(e,t){const r=e.model.document,n=e.editing.view,o=r.selection.getLastPosition(),i=o.nodeAfter;return!(t||!r.selection.isCollapsed||!o.isAtStart||!i||!i.is("element","softBreak")||(e.model.change(t=>{e.execute("enter");const n=r.selection.anchor.parent.previousSibling;t.rename(n,nw),t.setSelection(n,"in"),e.model.schema.removeDisallowedAttributes([n],t),t.remove(i)}),n.scrollToTheSelection(),0))}(e,r.isSoft)||function(e,t){const r=e.model,n=r.document,o=e.editing.view,i=n.selection.getLastPosition(),a=i.nodeBefore;let s;if(t||!n.selection.isCollapsed||!i.isAtEnd||!a)return!1;if(a.is("element","softBreak"))s=r.createRangeOn(a);else{if(!a.is("$text")||a.data.match(/\S/)||!a.previousSibling||!a.previousSibling.is("element","softBreak"))return!1;s=r.createRange(r.createPositionBefore(a.previousSibling),r.createPositionAfter(a))}return e.model.change(t=>{t.remove(s),e.execute("enter");const r=n.selection.anchor.parent;t.rename(r,nw),e.model.schema.removeDisallowedAttributes([r],t)}),o.scrollToTheSelection(),!0}(e,r.isSoft)||function(e){const t=e.model.document,r=t.selection.getLastPosition(),n=r.nodeBefore||r.textNode;let o;n&&n.is("$text")&&(o=Z_(n)),e.model.change(r=>{e.execute("shiftEnter"),o&&r.insertText(o,t.selection.anchor)})}(e),r.preventDefault(),t.stop())})}}var iw=i(9085);Pl()(iw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),iw.Z.locals;class aw extends au{init(){const e=this.editor,t=e.t,r=e.ui.componentFactory,n=W_(e),o=n[0];r.add("codeBlock",r=>{const i=e.commands.get("codeBlock"),a=$c(r,Rb),s=a.buttonView;return s.set({label:t("Insert code block"),tooltip:!0,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231l.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2l-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',isToggleable:!0}),s.bind("isOn").to(i,"value",e=>!!e),s.on("execute",()=>{e.execute("codeBlock",{language:o.language}),e.editing.view.focus()}),a.on("execute",t=>{e.execute("codeBlock",{language:t.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()}),a.class="ck-code-block-dropdown",a.bind("isEnabled").to(i),Xc(a,this._getLanguageListItemDefinitions(n)),a})}_getLanguageListItemDefinitions(e){const t=this.editor.commands.get("codeBlock"),r=new ar;for(const n of e){const e={type:"button",model:new Df({_codeBlockLanguage:n.language,label:n.label,withText:!0})};e.model.bind("isOn").to(t,"value",t=>t===e.model._codeBlockLanguage),r.add(e)}return r}}var sw=i(5523);Pl()(sw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),sw.Z.locals;class lw extends oc{constructor(e,t={}){super(e);const r=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",r.to("class")]},children:this.children});const n=new oc(e);n.setTemplate({tag:"span",attributes:{class:["ck","ck-form__header__label"]},children:[{text:r.to("label")}]}),this.children.add(n)}}class cw extends lw{constructor(e,t){super(e);const r=e.t;this.set("class","ck-special-characters-navigation"),this.groupDropdownView=this._createGroupDropdown(t),this.groupDropdownView.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",this.label=r("Special characters"),this.children.add(this.groupDropdownView)}get currentGroupName(){return this.groupDropdownView.value}_createGroupDropdown(e){const t=this.locale,r=t.t,n=$c(t),o=this._getCharacterGroupListItemDefinitions(n,e);return n.set("value",o.first.model.label),n.buttonView.bind("label").to(n,"value"),n.buttonView.set({isOn:!1,withText:!0,tooltip:r("Character categories"),class:["ck-dropdown__button_label-width_auto"]}),n.on("execute",e=>{n.value=e.source.label}),n.delegate("execute").to(this),Xc(n,o),n}_getCharacterGroupListItemDefinitions(e,t){const r=new ar;for(const n of t){const t={type:"button",model:new Df({label:n,withText:!0})};t.model.bind("isOn").to(e,"value",e=>e===t.model.label),r.add(t)}return r}}var uw=i(4046);Pl()(uw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),uw.Z.locals;class dw extends oc{constructor(e){super(e),this.tiles=this.createCollection(),this.setTemplate({tag:"div",children:[{tag:"div",attributes:{class:["ck","ck-character-grid__tiles"]},children:this.tiles}],attributes:{class:["ck","ck-character-grid"]}})}createTile(e,t){const r=new Lc(this.locale);return r.set({label:e,withText:!0,class:"ck-character-grid__tile"}),r.extendTemplate({attributes:{title:t},on:{mouseover:r.bindTemplate.to("mouseover")}}),r.on("mouseover",()=>{this.fire("tileHover",{name:t,character:e})}),r.on("execute",()=>{this.fire("execute",{name:t,character:e})}),r}}var hw=i(4779);Pl()(hw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),hw.Z.locals;class pw extends oc{constructor(e){super(e);const t=this.bindTemplate;this.set("character",null),this.set("name",null),this.bind("code").to(this,"character",fw),this.setTemplate({tag:"div",children:[{tag:"span",attributes:{class:["ck-character-info__name"]},children:[{text:t.to("name",e=>e||"")}]},{tag:"span",attributes:{class:["ck-character-info__code"]},children:[{text:t.to("code")}]}],attributes:{class:["ck","ck-character-info"]}})}}function fw(e){return null===e?"":"U+"+("0000"+e.codePointAt(0).toString(16)).slice(-4)}var mw=i(8170);Pl()(mw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),mw.Z.locals;class gw extends au{init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Currency",[{character:"$",title:t("Dollar sign")},{character:"",title:t("Euro sign")},{character:"",title:t("Yen sign")},{character:"",title:t("Pound sign")},{character:"",title:t("Cent sign")},{character:"",title:t("Euro-currency sign")},{character:"",title:t("Colon sign")},{character:"",title:t("Cruzeiro sign")},{character:"",title:t("French franc sign")},{character:"",title:t("Lira sign")},{character:"",title:t("Currency sign")},{character:"",title:t("Bitcoin sign")},{character:"",title:t("Mill sign")},{character:"",title:t("Naira sign")},{character:"",title:t("Peseta sign")},{character:"",title:t("Rupee sign")},{character:"",title:t("Won sign")},{character:"",title:t("New sheqel sign")},{character:"",title:t("Dong sign")},{character:"",title:t("Kip sign")},{character:"",title:t("Tugrik sign")},{character:"",title:t("Drachma sign")},{character:"",title:t("German penny sign")},{character:"",title:t("Peso sign")},{character:"",title:t("Guarani sign")},{character:"",title:t("Austral sign")},{character:"",title:t("Hryvnia sign")},{character:"",title:t("Cedi sign")},{character:"",title:t("Livre tournois sign")},{character:"",title:t("Spesmilo sign")},{character:"",title:t("Tenge sign")},{character:"",title:t("Indian rupee sign")},{character:"",title:t("Turkish lira sign")},{character:"",title:t("Nordic mark sign")},{character:"",title:t("Manat sign")},{character:"",title:t("Ruble sign")}])}}class bw extends au{init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Mathematical",[{character:"<",title:t("Less-than sign")},{character:">",title:t("Greater-than sign")},{character:"",title:t("Less-than or equal to")},{character:"",title:t("Greater-than or equal to")},{character:"",title:t("En dash")},{character:"",title:t("Em dash")},{character:"",title:t("Macron")},{character:"",title:t("Overline")},{character:"",title:t("Degree sign")},{character:"",title:t("Minus sign")},{character:"",title:t("Plus-minus sign")},{character:"",title:t("Division sign")},{character:"",title:t("Fraction slash")},{character:"",title:t("Multiplication sign")},{character:"",title:t("Latin small letter f with hook")},{character:"",title:t("Integral")},{character:"",title:t("N-ary summation")},{character:"",title:t("Infinity")},{character:"",title:t("Square root")},{character:"",title:t("Tilde operator")},{character:"",title:t("Approximately equal to")},{character:"",title:t("Almost equal to")},{character:"",title:t("Not equal to")},{character:"",title:t("Identical to")},{character:"",title:t("Element of")},{character:"",title:t("Not an element of")},{character:"",title:t("Contains as member")},{character:"",title:t("N-ary product")},{character:"",title:t("Logical and")},{character:"",title:t("Logical or")},{character:"",title:t("Not sign")},{character:"",title:t("Intersection")},{character:"",title:t("Union")},{character:"",title:t("Partial differential")},{character:"",title:t("For all")},{character:"",title:t("There exists")},{character:"",title:t("Empty set")},{character:"",title:t("Nabla")},{character:"",title:t("Asterisk operator")},{character:"",title:t("Proportional to")},{character:"",title:t("Angle")},{character:"",title:t("Vulgar fraction one quarter")},{character:"",title:t("Vulgar fraction one half")},{character:"",title:t("Vulgar fraction three quarters")}])}}class vw extends au{init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Arrows",[{title:t("leftwards double arrow"),character:""},{title:t("rightwards double arrow"),character:""},{title:t("upwards double arrow"),character:""},{title:t("downwards double arrow"),character:""},{title:t("leftwards dashed arrow"),character:""},{title:t("rightwards dashed arrow"),character:""},{title:t("upwards dashed arrow"),character:""},{title:t("downwards dashed arrow"),character:""},{title:t("leftwards arrow to bar"),character:""},{title:t("rightwards arrow to bar"),character:""},{title:t("upwards arrow to bar"),character:""},{title:t("downwards arrow to bar"),character:""},{title:t("up down arrow with base"),character:""},{title:t("back with leftwards arrow above"),character:""},{title:t("end with leftwards arrow above"),character:""},{title:t("on with exclamation mark with left right arrow above"),character:""},{title:t("soon with rightwards arrow above"),character:""},{title:t("top with upwards arrow above"),character:""}])}}class yw extends au{init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Latin",[{character:"",title:t("Latin capital letter a with macron")},{character:"",title:t("Latin small letter a with macron")},{character:"",title:t("Latin capital letter a with breve")},{character:"",title:t("Latin small letter a with breve")},{character:"",title:t("Latin capital letter a with ogonek")},{character:"",title:t("Latin small letter a with ogonek")},{character:"",title:t("Latin capital letter c with acute")},{character:"",title:t("Latin small letter c with acute")},{character:"",title:t("Latin capital letter c with circumflex")},{character:"",title:t("Latin small letter c with circumflex")},{character:"",title:t("Latin capital letter c with dot above")},{character:"",title:t("Latin small letter c with dot above")},{character:"",title:t("Latin capital letter c with caron")},{character:"",title:t("Latin small letter c with caron")},{character:"",title:t("Latin capital letter d with caron")},{character:"",title:t("Latin small letter d with caron")},{character:"",title:t("Latin capital letter d with stroke")},{character:"",title:t("Latin small letter d with stroke")},{character:"",title:t("Latin capital letter e with macron")},{character:"",title:t("Latin small letter e with macron")},{character:"",title:t("Latin capital letter e with breve")},{character:"",title:t("Latin small letter e with breve")},{character:"",title:t("Latin capital letter e with dot above")},{character:"",title:t("Latin small letter e with dot above")},{character:"",title:t("Latin capital letter e with ogonek")},{character:"",title:t("Latin small letter e with ogonek")},{character:"",title:t("Latin capital letter e with caron")},{character:"",title:t("Latin small letter e with caron")},{character:"",title:t("Latin capital letter g with circumflex")},{character:"",title:t("Latin small letter g with circumflex")},{character:"",title:t("Latin capital letter g with breve")},{character:"",title:t("Latin small letter g with breve")},{character:"",title:t("Latin capital letter g with dot above")},{character:"",title:t("Latin small letter g with dot above")},{character:"",title:t("Latin capital letter g with cedilla")},{character:"",title:t("Latin small letter g with cedilla")},{character:"",title:t("Latin capital letter h with circumflex")},{character:"",title:t("Latin small letter h with circumflex")},{character:"",title:t("Latin capital letter h with stroke")},{character:"",title:t("Latin small letter h with stroke")},{character:"",title:t("Latin capital letter i with tilde")},{character:"",title:t("Latin small letter i with tilde")},{character:"",title:t("Latin capital letter i with macron")},{character:"",title:t("Latin small letter i with macron")},{character:"",title:t("Latin capital letter i with breve")},{character:"",title:t("Latin small letter i with breve")},{character:"",title:t("Latin capital letter i with ogonek")},{character:"",title:t("Latin small letter i with ogonek")},{character:"",title:t("Latin capital letter i with dot above")},{character:"",title:t("Latin small letter dotless i")},{character:"",title:t("Latin capital ligature ij")},{character:"",title:t("Latin small ligature ij")},{character:"",title:t("Latin capital letter j with circumflex")},{character:"",title:t("Latin small letter j with circumflex")},{character:"",title:t("Latin capital letter k with cedilla")},{character:"",title:t("Latin small letter k with cedilla")},{character:"",title:t("Latin small letter kra")},{character:"",title:t("Latin capital letter l with acute")},{character:"",title:t("Latin small letter l with acute")},{character:"",title:t("Latin capital letter l with cedilla")},{character:"",title:t("Latin small letter l with cedilla")},{character:"",title:t("Latin capital letter l with caron")},{character:"",title:t("Latin small letter l with caron")},{character:"",title:t("Latin capital letter l with middle dot")},{character:"",title:t("Latin small letter l with middle dot")},{character:"",title:t("Latin capital letter l with stroke")},{character:"",title:t("Latin small letter l with stroke")},{character:"",title:t("Latin capital letter n with acute")},{character:"",title:t("Latin small letter n with acute")},{character:"",title:t("Latin capital letter n with cedilla")},{character:"",title:t("Latin small letter n with cedilla")},{character:"",title:t("Latin capital letter n with caron")},{character:"",title:t("Latin small letter n with caron")},{character:"",title:t("Latin small letter n preceded by apostrophe")},{character:"",title:t("Latin capital letter eng")},{character:"",title:t("Latin small letter eng")},{character:"",title:t("Latin capital letter o with macron")},{character:"",title:t("Latin small letter o with macron")},{character:"",title:t("Latin capital letter o with breve")},{character:"",title:t("Latin small letter o with breve")},{character:"",title:t("Latin capital letter o with double acute")},{character:"",title:t("Latin small letter o with double acute")},{character:"",title:t("Latin capital ligature oe")},{character:"",title:t("Latin small ligature oe")},{character:"",title:t("Latin capital letter r with acute")},{character:"",title:t("Latin small letter r with acute")},{character:"",title:t("Latin capital letter r with cedilla")},{character:"",title:t("Latin small letter r with cedilla")},{character:"",title:t("Latin capital letter r with caron")},{character:"",title:t("Latin small letter r with caron")},{character:"",title:t("Latin capital letter s with acute")},{character:"",title:t("Latin small letter s with acute")},{character:"",title:t("Latin capital letter s with circumflex")},{character:"",title:t("Latin small letter s with circumflex")},{character:"",title:t("Latin capital letter s with cedilla")},{character:"",title:t("Latin small letter s with cedilla")},{character:"",title:t("Latin capital letter s with caron")},{character:"",title:t("Latin small letter s with caron")},{character:"",title:t("Latin capital letter t with cedilla")},{character:"",title:t("Latin small letter t with cedilla")},{character:"",title:t("Latin capital letter t with caron")},{character:"",title:t("Latin small letter t with caron")},{character:"",title:t("Latin capital letter t with stroke")},{character:"",title:t("Latin small letter t with stroke")},{character:"",title:t("Latin capital letter u with tilde")},{character:"",title:t("Latin small letter u with tilde")},{character:"",title:t("Latin capital letter u with macron")},{character:"",title:t("Latin small letter u with macron")},{character:"",title:t("Latin capital letter u with breve")},{character:"",title:t("Latin small letter u with breve")},{character:"",title:t("Latin capital letter u with ring above")},{character:"",title:t("Latin small letter u with ring above")},{character:"",title:t("Latin capital letter u with double acute")},{character:"",title:t("Latin small letter u with double acute")},{character:"",title:t("Latin capital letter u with ogonek")},{character:"",title:t("Latin small letter u with ogonek")},{character:"",title:t("Latin capital letter w with circumflex")},{character:"",title:t("Latin small letter w with circumflex")},{character:"",title:t("Latin capital letter y with circumflex")},{character:"",title:t("Latin small letter y with circumflex")},{character:"",title:t("Latin capital letter y with diaeresis")},{character:"",title:t("Latin capital letter z with acute")},{character:"",title:t("Latin small letter z with acute")},{character:"",title:t("Latin capital letter z with dot above")},{character:"",title:t("Latin small letter z with dot above")},{character:"",title:t("Latin capital letter z with caron")},{character:"",title:t("Latin small letter z with caron")},{character:"",title:t("Latin small letter long s")}])}}class _w extends au{init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Text",[{character:"",title:t("Single left-pointing angle quotation mark")},{character:"",title:t("Single right-pointing angle quotation mark")},{character:"",title:t("Left-pointing double angle quotation mark")},{character:"",title:t("Right-pointing double angle quotation mark")},{character:"",title:t("Left single quotation mark")},{character:"",title:t("Right single quotation mark")},{character:"",title:t("Left double quotation mark")},{character:"",title:t("Right double quotation mark")},{character:"",title:t("Single low-9 quotation mark")},{character:"",title:t("Double low-9 quotation mark")},{character:"",title:t("Inverted exclamation mark")},{character:"",title:t("Inverted question mark")},{character:"",title:t("Two dot leader")},{character:"",title:t("Horizontal ellipsis")},{character:"",title:t("Double dagger")},{character:"",title:t("Per mille sign")},{character:"",title:t("Per ten thousand sign")},{character:"",title:t("Double exclamation mark")},{character:"",title:t("Question exclamation mark")},{character:"",title:t("Exclamation question mark")},{character:"",title:t("Double question mark")},{character:"",title:t("Copyright sign")},{character:"",title:t("Registered sign")},{character:"",title:t("Trade mark sign")},{character:"",title:t("Section sign")},{character:"",title:t("Paragraph sign")},{character:"",title:t("Reversed paragraph sign")}])}}function ww(e){if(e.is("$text")||e.is("$textProxy"))return e.data;let t="",r=null;for(const n of e.getChildren()){const e=ww(n);r&&r.is("element")&&(t+="\n"),t+=e,r=n}return t}const xw=function(e,t,r){var n=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return I(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),Ci(e,t,{leading:n,maxWait:t,trailing:o})};class kw extends pu{refresh(){const e=this.editor.model.document.selection.getSelectedElement();this.isEnabled=ph(e),e&&e.hasAttribute("width")?this.value={width:e.getAttribute("width"),height:null}:this.value=null}execute(e){const t=this.editor.model,r=t.document.selection.getSelectedElement();this.value={width:e.width,height:null},r&&t.change(t=>{t.setAttribute("width",e.width,r)})}}class Cw extends au{static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"imageResize:original",value:null,icon:"original"},{name:"imageResize:25",value:"25",icon:"small"},{name:"imageResize:50",value:"50",icon:"medium"},{name:"imageResize:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new kw(e);this._registerSchema(),this._registerConverters(),e.commands.add("imageResize",t)}_registerSchema(){this.editor.model.schema.extend("image",{allowAttributes:"width"}),this.editor.model.schema.setAttributeProperties("width",{isFormatting:!0})}_registerConverters(){const e=this.editor;e.conversion.for("downcast").add(e=>e.on("attribute:width:image",(e,t,r)=>{if(!r.consumable.consume(t.item,e.name))return;const n=r.writer,o=r.mapper.toViewElement(t.item);null!==t.attributeNewValue?(n.setStyle("width",t.attributeNewValue,o),n.addClass("image_resized",o)):(n.removeStyle("width",o),n.removeClass("image_resized",o))})),e.conversion.for("upcast").attributeToAttribute({view:{name:"figure",styles:{width:/.+/}},model:{key:"width",value:e=>e.getStyle("width")}})}}const Ew='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',Sw={small:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',medium:Ew,large:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',original:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>'};class Tw extends au{static get requires(){return[Cw]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),r=e.commands.get("imageResize");this.bind("isEnabled").to(r);for(const e of t)this._registerImageResizeButton(e);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:r,value:n,icon:o}=e,i=n?n+this._resizeUnit:null;t.ui.componentFactory.add(r,r=>{const n=new Lc(r),a=t.commands.get("imageResize"),s=this._getOptionLabelValue(e,!0);if(!Sw[o])throw new qt("imageresizebuttons-missing-icon",t,e);return n.set({label:s,icon:Sw[o],tooltip:s,isToggleable:!0}),n.bind("isEnabled").to(this),n.bind("isOn").to(a,"value",Aw(i)),this.listenTo(n,"execute",()=>{t.execute("imageResize",{width:i})}),n})}_registerImageResizeDropdown(e){const t=this.editor,r=t.t,n=e.find(e=>!e.value);t.ui.componentFactory.add("imageResize",o=>{const i=t.commands.get("imageResize"),a=$c(o,Bc),s=a.buttonView;return s.set({tooltip:r("Resize image"),commandValue:n.value,icon:Ew,isToggleable:!0,label:this._getOptionLabelValue(n),withText:!0,class:"ck-resize-image-button"}),s.bind("label").to(i,"value",e=>e&&e.width?e.width:this._getOptionLabelValue(n)),a.bind("isOn").to(i),a.bind("isEnabled").to(this),Xc(a,this._getResizeDropdownListItemDefinitions(e,i)),a.listView.ariaLabel=r("Image resize list"),this.listenTo(a,"execute",e=>{t.execute(e.source.commandName,{width:e.source.commandValue}),t.editing.view.focus()}),a})}_getOptionLabelValue(e,t){const r=this.editor.t;return e.label?e.label:t?e.value?r("Resize image to %0",e.value+this._resizeUnit):r("Resize image to the original size"):e.value?e.value+this._resizeUnit:r("Original")}_getResizeDropdownListItemDefinitions(e,t){const r=new ar;return e.map(e=>{const n=e.value?e.value+this._resizeUnit:null,o={type:"button",model:new Df({commandName:"imageResize",commandValue:n,label:this._getOptionLabelValue(e),withText:!0,icon:null})};o.model.bind("isOn").to(t,"value",Aw(n)),r.add(o)}),r}}function Aw(e){return t=>null===e&&t===e||t&&t.width===e}class Pw{constructor(e){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}begin(e,t,r){const n=new Di(t);this.activeHandlePosition=function(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const r of t)if(e.classList.contains(Iw(r)))return r}(e),this._referenceCoordinates=function(e,t){const r=new Di(e),n=t.split("-"),o={x:"right"==n[1]?r.right:r.left,y:"bottom"==n[0]?r.bottom:r.top};return o.x+=e.ownerDocument.defaultView.scrollX,o.y+=e.ownerDocument.defaultView.scrollY,o}(t,function(e){const t=e.split("-"),r={top:"bottom",bottom:"top",left:"right",right:"left"};return`${r[t[0]]}-${r[t[1]]}`}(this.activeHandlePosition)),this.originalWidth=n.width,this.originalHeight=n.height,this.aspectRatio=n.width/n.height;const o=r.style.width;o&&o.match(/^\d+\.?\d*%$/)?this.originalWidthPercents=parseFloat(o):this.originalWidthPercents=function(e,t){const r=e.parentElement,n=parseFloat(r.ownerDocument.defaultView.getComputedStyle(r).width);return t.width/n*100}(r,n)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function Iw(e){return"ck-widget__resizer__handle-"+e}ir(Pw,fn);class Ow{constructor(e){this._options=e,this._domResizerWrapper=null,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",e=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),e.stop())},{priority:"high"}),this.on("change:isEnabled",()=>{this.isEnabled&&this.redraw()})}attach(){const e=this,t=this._options.viewElement;this._options.editor.editing.view.change(r=>{const n=r.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},(function(t){const r=this.toDomElement(t);return e._appendHandles(r),e._appendSizeUI(r),e._domResizerWrapper=r,e.on("change:isEnabled",(e,t,n)=>{r.style.display=n?"":"none"}),r.style.display=e.isEnabled?"":"none",r}));r.insert(r.createPositionAt(t,"end"),n),r.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=n})}begin(e){this.state=new Pw(this._options),this._sizeUI.bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e);this._options.editor.editing.view.change(e=>{const r=this._options.unit||"%",n=("%"===r?t.widthPercents:t.width)+r;e.setStyle("width",n,this._options.viewElement)});const r=this._getHandleHost(),n=new Di(r);t.handleHostWidth=Math.round(n.width),t.handleHostHeight=Math.round(n.height);const o=new Di(r);t.width=Math.round(o.width),t.height=Math.round(o.height),this.redraw(n),this.state.update(t)}commit(){const e=this._options.unit||"%",t=("%"===e?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(t)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!((r=t)&&r.ownerDocument&&r.ownerDocument.contains(r)))return;var r;const n=t.parentElement,o=this._getHandleHost(),i=this._viewResizerWrapper,a=[i.getStyle("width"),i.getStyle("height"),i.getStyle("left"),i.getStyle("top")];let s;if(n.isSameNode(o)){const t=e||new Di(o);s=[t.width+"px",t.height+"px",void 0,void 0]}else s=[o.offsetWidth+"px",o.offsetHeight+"px",o.offsetLeft+"px",o.offsetTop+"px"];"same"!==pr(a,s)&&this._options.editor.editing.view.change(e=>{e.setStyle({width:s[0],height:s[1],left:s[2],top:s[3]},i)})}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeUI.dismiss(),this._sizeUI.isVisible=!1,this._options.editor.editing.view.change(e=>{e.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(e){const t=this.state,r=(o=e).pageX,n=o.pageY;var o;const i=!this._options.isCentered||this._options.isCentered(this),a={x:t._referenceCoordinates.x-(r+t.originalWidth),y:n-t.originalHeight-t._referenceCoordinates.y};i&&t.activeHandlePosition.endsWith("-right")&&(a.x=r-(t._referenceCoordinates.x+t.originalWidth)),i&&(a.x*=2);const s={width:Math.abs(t.originalWidth+a.x),height:Math.abs(t.originalHeight+a.y)};s.dominant=s.width/t.aspectRatio>s.height?"width":"height",s.max=s[s.dominant];const l={width:s.width,height:s.height};return"width"==s.dominant?l.height=l.width/t.aspectRatio:l.width=l.height*t.aspectRatio,{width:Math.round(l.width),height:Math.round(l.height),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*l.width*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const n of t)e.appendChild(new Nl({tag:"div",attributes:{class:"ck-widget__resizer__handle "+(r=n,"ck-widget__resizer__handle-"+r)}}).render());var r}_appendSizeUI(e){const t=new Mw;t.render(),this._sizeUI=t,e.appendChild(t.element)}}ir(Ow,fn);class Mw extends oc{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("activeHandlePosition",e=>e?"ck-orientation-"+e:"")],style:{display:e.if("isVisible","none",e=>!e)}},children:[{text:e.to("label")}]})}bindToState(e,t){this.bind("isVisible").to(t,"proposedWidth",t,"proposedHeight",(e,t)=>null!==e&&null!==t),this.bind("label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",(t,r,n)=>"px"===e.unit?`${t}${r}`:n+"%"),this.bind("activeHandlePosition").to(t)}dismiss(){this.unbind(),this.isVisible=!1}}var Dw=i(2263);Pl()(Dw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Dw.Z.locals;class zw extends au{static get pluginName(){return"WidgetResize"}init(){this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map;const e=Do.window.document;this.editor.model.schema.setAttributeProperties("width",{isFormatting:!0}),this.editor.editing.view.addObserver(wh),this._observer=Object.create(Uo),this.listenTo(this.editor.editing.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(e,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(e,"mouseup",this._mouseUpListener.bind(this));const t=()=>{this.visibleResizer&&this.visibleResizer.redraw()},r=xw(t,200);this.on("change:visibleResizer",t),this.editor.ui.on("update",r),this._observer.listenTo(Do.window,"resize",r);const n=this.editor.editing.view.document.selection;n.on("change",()=>{const e=n.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(e)||null})}destroy(){this._observer.stopListening();for(const e of this._resizers.values())e.destroy()}attachTo(e){const t=new Ow(e),r=this.editor.plugins;if(t.attach(),r.has("WidgetToolbarRepository")){const e=r.get("WidgetToolbarRepository");t.on("begin",()=>{e.forceDisabled("resize")},{priority:"lowest"}),t.on("cancel",()=>{e.clearForceDisabled("resize")},{priority:"highest"}),t.on("commit",()=>{e.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(e.viewElement,t);const n=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(n)==t&&(this.visibleResizer=t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const r=t.domTarget;Ow.isResizeHandle(r)&&(this._activeResizer=this._getResizerByHandle(r),this._activeResizer&&(this._activeResizer.begin(r),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}ir(zw,fn);class jw extends au{static get requires(){return[zw]}static get pluginName(){return"ImageResizeHandles"}init(){const e=this.editor.commands.get("imageResize");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view;t.addObserver(Ud),this.listenTo(t.document,"imageLoaded",(r,n)=>{if(!n.target.matches("figure.image.ck-widget > img, figure.image.ck-widget > a > img"))return;const o=e.editing.view.domConverter.domToView(n.target).findAncestor("figure");let i=this.editor.plugins.get(zw).getResizerByViewElement(o);if(i)return void i.redraw();const a=e.editing.mapper.toModelElement(o);i=e.plugins.get(zw).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:a,viewElement:o,editor:e,getHandleHost:e=>e.querySelector("img"),getResizeHost:e=>e,isCentered(){const e=a.getAttribute("imageStyle");return!e||"full"==e||"alignCenter"==e},onCommit(t){e.execute("imageResize",{width:t})}}),i.on("updateSize",()=>{o.hasClass("image_resized")||t.change(e=>{e.addClass("image_resized",o)})}),i.bind("isEnabled").to(this)})}}var Rw=i(1043);Pl()(Rw.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Rw.Z.locals;class Lw{constructor(e,t){this.loader=e,this.options=t}upload(){return this.loader.file.then(e=>new Promise((t,r)=>{this._initRequest(),this._initListeners(t,r,e),this._sendRequest(e)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.options.uploadUrl,!0),e.responseType="json"}_initListeners(e,t,r){const n=this.xhr,o=this.loader,i=`Couldn't upload file: ${r.name}.`;n.addEventListener("error",()=>t(i)),n.addEventListener("abort",()=>t()),n.addEventListener("load",()=>{const r=n.response;if(!r||r.error)return t(r&&r.error&&r.error.message?r.error.message:i);e(r.url?{default:r.url}:r.urls)}),n.upload&&n.upload.addEventListener("progress",e=>{e.lengthComputable&&(o.uploadTotal=e.total,o.uploaded=e.loaded)})}_sendRequest(e){const t=this.options.headers||{},r=this.options.withCredentials||!1;for(const e of Object.keys(t))this.xhr.setRequestHeader(e,t[e]);this.xhr.withCredentials=r;const n=new FormData;n.append("upload",e),this.xhr.send(n)}}function Nw(e){e.setNormalizer("border",Bw),e.setNormalizer("border-top",Fw("top")),e.setNormalizer("border-right",Fw("right")),e.setNormalizer("border-bottom",Fw("bottom")),e.setNormalizer("border-left",Fw("left")),e.setNormalizer("border-color",Vw("color")),e.setNormalizer("border-width",Vw("width")),e.setNormalizer("border-style",Vw("style")),e.setNormalizer("border-top-color",qw("color","top")),e.setNormalizer("border-top-style",qw("style","top")),e.setNormalizer("border-top-width",qw("width","top")),e.setNormalizer("border-right-color",qw("color","right")),e.setNormalizer("border-right-style",qw("style","right")),e.setNormalizer("border-right-width",qw("width","right")),e.setNormalizer("border-bottom-color",qw("color","bottom")),e.setNormalizer("border-bottom-style",qw("style","bottom")),e.setNormalizer("border-bottom-width",qw("width","bottom")),e.setNormalizer("border-left-color",qw("color","left")),e.setNormalizer("border-left-style",qw("style","left")),e.setNormalizer("border-left-width",qw("width","left")),e.setExtractor("border-top",Hw("top")),e.setExtractor("border-right",Hw("right")),e.setExtractor("border-bottom",Hw("bottom")),e.setExtractor("border-left",Hw("left")),e.setExtractor("border-top-color","border.color.top"),e.setExtractor("border-right-color","border.color.right"),e.setExtractor("border-bottom-color","border.color.bottom"),e.setExtractor("border-left-color","border.color.left"),e.setExtractor("border-top-width","border.width.top"),e.setExtractor("border-right-width","border.width.right"),e.setExtractor("border-bottom-width","border.width.bottom"),e.setExtractor("border-left-width","border.width.left"),e.setExtractor("border-top-style","border.style.top"),e.setExtractor("border-right-style","border.style.right"),e.setExtractor("border-bottom-style","border.style.bottom"),e.setExtractor("border-left-style","border.style.left"),e.setReducer("border-color",Ky("border-color")),e.setReducer("border-style",Ky("border-style")),e.setReducer("border-width",Ky("border-width")),e.setReducer("border-top",Yw("top")),e.setReducer("border-right",Yw("right")),e.setReducer("border-bottom",Yw("bottom")),e.setReducer("border-left",Yw("left")),e.setReducer("border",Zw),e.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),e.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),e.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),e.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),e.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),e.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function Bw(e){const{color:t,style:r,width:n}=Gw(e);return{path:"border",value:{color:$y(t),style:$y(r),width:$y(n)}}}function Fw(e){return t=>{const{color:r,style:n,width:o}=Gw(t),i={};return void 0!==r&&(i.color={[e]:r}),void 0!==n&&(i.style={[e]:n}),void 0!==o&&(i.width={[e]:o}),{path:"border",value:i}}}function Vw(e){return t=>({path:"border",value:Uw(t,e)})}function Uw(e,t){return{[t]:$y(e)}}function qw(e,t){return r=>({path:"border",value:{[e]:{[t]:r}}})}function Hw(e){return(t,r)=>{if(r.border)return Ww(r.border,e)}}function Ww(e,t){const r={};return e.width&&e.width[t]&&(r.width=e.width[t]),e.style&&e.style[t]&&(r.style=e.style[t]),e.color&&e.color[t]&&(r.color=e.color[t]),r}function Gw(e){const t={},r=Jy(e);for(const e of r)Fy(e)||/thin|medium|thick/.test(e)?t.width=e:Ny(e)?t.style=e:t.color=e;return t}function Zw(e){const t=[];return t.push(...$w(Ww(e,"top"),"top")),t.push(...$w(Ww(e,"right"),"right")),t.push(...$w(Ww(e,"bottom"),"bottom")),t.push(...$w(Ww(e,"left"),"left")),t}function Yw(e){return t=>$w(t,e)}function $w(e,t){const r=[];return e&&void 0!==e.width&&r.push(e.width),e&&void 0!==e.style&&r.push(e.style),e&&void 0!==e.color&&r.push(e.color),r.length?[["border-"+t,r.join(" ")]]:[]}function Kw(e,t,r,n){e.for("upcast").attributeToAttribute({view:{styles:{[n]:/[\s\S]+/}},model:{name:t,key:r,value:e=>e.getNormalizedStyle(n)}})}function Xw(e,t){e.for("upcast").add(e=>e.on("element:"+t,(e,t,r)=>{if(!t.modelRange)return;const n=["border-top","border-right","border-bottom","border-left"].filter(e=>t.viewItem.hasStyle(e));if(!n.length)return;const o={styles:n};if(!r.consumable.test(t.viewItem,o))return;const i=[...t.modelRange.getItems({shallow:!0})].pop();r.consumable.consume(t.viewItem,o),r.writer.setAttribute("borderStyle",t.viewItem.getNormalizedStyle("border-style"),i),r.writer.setAttribute("borderColor",t.viewItem.getNormalizedStyle("border-color"),i),r.writer.setAttribute("borderWidth",t.viewItem.getNormalizedStyle("border-width"),i)}))}function Jw(e,t,r,n){e.for("downcast").attributeToAttribute({model:{name:t,key:r},view:e=>({key:"style",value:{[n]:e}})})}function Qw(e,t,r){e.for("downcast").add(e=>e.on(`attribute:${t}:table`,(e,t,n)=>{const{item:o,attributeNewValue:i}=t,{mapper:a,writer:s}=n;if(!n.consumable.consume(t.item,e.name))return;const l=[...a.toViewElement(o).getChildren()].find(e=>e.is("element","table"));i?s.setStyle(r,i,l):s.removeStyle(r,l)}))}class ex extends pu{constructor(e,t){super(e),this.attributeName=t}refresh(){const e=this.editor.model.document.selection.getFirstPosition().findAncestor("table");this.isEnabled=!!e,this.value=this._getValue(e)}execute(e={}){const t=this.editor.model,r=t.document.selection,{value:n,batch:o}=e,i=r.getFirstPosition().findAncestor("table"),a=this._getValueToSet(n);t.enqueueChange(o||"default",e=>{a?e.setAttribute(this.attributeName,a,i):e.removeAttribute(this.attributeName,i)})}_getValue(e){if(e)return e.getAttribute(this.attributeName)}_getValueToSet(e){return e}}class tx extends ex{constructor(e){super(e,"backgroundColor")}}function rx(e){if(!e||!I(e))return e;const{top:t,right:r,bottom:n,left:o}=e;return t==r&&r==n&&n==o?t:void 0}function nx(e,t){const r=parseFloat(e);return Number.isNaN(r)||String(r)!==String(e)?e:`${r}${t}`}class ox extends ex{constructor(e){super(e,"borderColor")}_getValue(e){if(e)return rx(e.getAttribute(this.attributeName))}}class ix extends ex{constructor(e){super(e,"borderStyle")}_getValue(e){if(e)return rx(e.getAttribute(this.attributeName))}}class ax extends ex{constructor(e){super(e,"borderWidth")}_getValue(e){if(e)return rx(e.getAttribute(this.attributeName))}_getValueToSet(e){return nx(e,"px")}}class sx extends ex{constructor(e){super(e,"width")}_getValueToSet(e){return nx(e,"px")}}class lx extends ex{constructor(e){super(e,"height")}_getValueToSet(e){return nx(e,"px")}}class cx extends ex{constructor(e){super(e,"alignment")}}const ux=/^(left|right)$/;class dx extends au{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[zb]}init(){const e=this.editor,t=e.model.schema,r=e.conversion;e.data.addStyleProcessorRules(Nw),function(e,t){e.extend("table",{allowAttributes:["borderWidth","borderColor","borderStyle"]}),Xw(t,"table"),Qw(t,"borderColor","border-color"),Qw(t,"borderStyle","border-style"),Qw(t,"borderWidth","border-width")}(t,r),e.commands.add("tableBorderColor",new ox(e)),e.commands.add("tableBorderStyle",new ix(e)),e.commands.add("tableBorderWidth",new ax(e)),function(e,t){e.extend("table",{allowAttributes:["alignment"]}),t.attributeToAttribute({model:{name:"table",key:"alignment",values:["left","right"]},view:{left:{key:"style",value:{float:"left"}},right:{key:"style",value:{float:"right"}}},converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{attributes:{align:ux}},model:{name:"table",key:"alignment",value:e=>e.getAttribute("align")}})}(t,r),e.commands.add("tableAlignment",new cx(e)),hx(t,r,"width","width"),e.commands.add("tableWidth",new sx(e)),hx(t,r,"height","height"),e.commands.add("tableHeight",new lx(e)),e.data.addStyleProcessorRules(Qy),function(e,t,r,n){e.extend("table",{allowAttributes:[r]}),Kw(t,"table",r,n),Qw(t,r,n)}(t,r,"backgroundColor","background-color"),e.commands.add("tableBackgroundColor",new tx(e))}}function hx(e,t,r,n){e.extend("table",{allowAttributes:[r]}),Kw(t,"table",r,n),Jw(t,"table",r,n)}var px=i(4082);Pl()(px.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),px.Z.locals;class fx extends oc{constructor(e,t){super(e);const r=this.bindTemplate;this.set("value",""),this.set("id"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.set("ariaDescribedById"),this.options=t,this._dropdownView=this._createDropdownView(e),this._inputView=this._createInputTextView(e),this._stillTyping=!1,this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color",r.if("hasError","ck-error")],id:r.to("id"),"aria-invalid":r.if("hasError",!0),"aria-describedby":r.to("ariaDescribedById")},children:[this._dropdownView,this._inputView]}),this.on("change:value",(e,t,r)=>this._setInputValue(r))}focus(){this._inputView.focus()}_createDropdownView(){const e=this.locale,t=e.t,r=this.bindTemplate,n=this._createColorGrid(e),o=$c(e),i=new oc,a=this._createRemoveColorButton(e);return i.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:r.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",r.if("value","ck-hidden",e=>""!=e)]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(i),o.buttonView.tooltip=t("Color picker"),o.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",o.panelView.children.add(a),o.panelView.children.add(n),o.bind("isEnabled").to(this,"isReadOnly",e=>!e),o}_createInputTextView(){const e=this.locale,t=new Rp(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",()=>{const e=t.element.value,r=this.options.colorDefinitions.find(t=>e===t.label);this._stillTyping=!0,this.value=r&&r.color||e}),t.on("blur",()=>{this._stillTyping=!1,this._setInputValue(t.element.value)}),t.delegate("input").to(this),t}_createRemoveColorButton(){const e=this.locale,t=e.t,r=new Lc(e);return r.class="ck-input-color__remove-color",r.withText=!0,r.icon=Kv,r.label=t("Remove color"),r.on("execute",()=>{this.value="",this._dropdownView.isOpen=!1,this.fire("input")}),r}_createColorGrid(e){const t=new Yv(e,{colorDefinitions:this.options.colorDefinitions,columns:this.options.columns});return t.on("execute",(e,t)=>{this.value=t.value,this._dropdownView.isOpen=!1,this.fire("input")}),t.bind("selectedColor").to(this,"value"),t}_setInputValue(e){if(!this._stillTyping){const t=mx(e),r=this.options.colorDefinitions.find(e=>t===mx(e.color));this._inputView.value=r?r.label:e||""}}}function mx(e){return e.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}const gx=e=>""===e;function bx(e){return{none:e("None"),solid:e("Solid"),dotted:e("Dotted"),dashed:e("Dashed"),double:e("Double"),groove:e("Groove"),ridge:e("Ridge"),inset:e("Inset"),outset:e("Outset")}}function vx(e){return e('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function yx(e){return e('The value is invalid. Try "10px" or "2em" or simply "2".')}function _x(e){return e=e.trim(),gx(e)||Ry(e)}function wx(e){return e=e.trim(),gx(e)||Tx(e)||Fy(e)||(t=e,Vy.test(t));var t}function xx(e){return e=e.trim(),gx(e)||Tx(e)||Fy(e)}function kx(e){const t=new ar,r=bx(e.t);for(const n in r){const o={type:"button",model:new Df({_borderStyleValue:"none"===n?"":n,label:r[n],withText:!0})};"none"===n?o.model.bind("isOn").to(e,"borderStyle",e=>!e):o.model.bind("isOn").to(e,"borderStyle",e=>e===n),t.add(o)}return t}function Cx({view:e,icons:t,toolbar:r,labels:n,propertyName:o,nameToValue:i}){for(const a in n){const s=new Lc(e.locale);s.set({label:n[a],icon:t[a],tooltip:n[a]}),s.bind("isOn").to(e,o,e=>e===i(a)),s.on("execute",()=>{e[o]=i(a)}),r.items.add(s)}}const Ex=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function Sx(e){return(t,r,n)=>{const o=new fx(t.locale,{colorDefinitions:(i=e.colorConfig,i.map(e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}}))),columns:e.columns});var i;return o.set({id:r,ariaDescribedById:n}),o.bind("isReadOnly").to(t,"isEnabled",e=>!e),o.bind("hasError").to(t,"errorText",e=>!!e),o.on("input",()=>{t.errorText=null}),t.bind("isEmpty","isFocused").to(o),o}}function Tx(e){const t=parseFloat(e);return!Number.isNaN(t)&&e===String(t)}var Ax=i(9865);Pl()(Ax.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Ax.Z.locals;class Px extends oc{constructor(e,t={}){super(e);const r=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach(e=>this.children.add(e)),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",r.to("class")],role:r.to("_role"),"aria-labelledby":r.to("_ariaLabelledBy")},children:this.children})}}var Ix=i(4880);Pl()(Ix.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Ix.Z.locals;var Ox=i(6706);Pl()(Ox.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Ox.Z.locals;var Mx=i(9221);Pl()(Mx.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Mx.Z.locals;const Dx={left:Zf,center:Yf,right:$f};class zx extends oc{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:r,borderWidthInput:n,borderColorInput:o,borderRowLabel:i}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:s}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:u,dimensionsLabel:d}=this._createDimensionFields(),{alignmentToolbar:h,alignmentLabel:p}=this._createAlignmentFields();this.focusTracker=new El,this.keystrokes=new vl,this.children=this.createCollection(),this.borderStyleDropdown=r,this.borderWidthInput=n,this.borderColorInput=o,this.backgroundInput=s,this.widthInput=l,this.heightInput=u,this.alignmentToolbar=h;const{saveButtonView:f,cancelButtonView:m}=this._createActionButtons();this.saveButtonView=f,this.cancelButtonView=m,this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new lw(e,{label:this.t("Table properties")})),this.children.add(new Px(e,{labelView:i,children:[i,r,o,n],class:"ck-table-form__border-row"})),this.children.add(new Px(e,{labelView:a,children:[a,s],class:"ck-table-form__background-row"})),this.children.add(new Px(e,{children:[new Px(e,{labelView:d,children:[d,l,c,u],class:"ck-table-form__dimensions-row"}),new Px(e,{labelView:p,children:[p,h],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new Px(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Fp({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=Sx({colorConfig:this.options.borderColors,columns:5}),t=this.locale,r=this.t,n=new dc(t);n.text=r("Border");const o=bx(this.t),i=new zp(t,Np);i.set({label:r("Style"),class:"ck-table-form__border-style"}),i.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:r("Style")}),i.fieldView.buttonView.bind("label").to(this,"borderStyle",e=>o[e||"none"]),i.fieldView.on("execute",e=>{this.borderStyle=e.source._borderStyleValue}),i.bind("isEmpty").to(this,"borderStyle",e=>!e),Xc(i.fieldView,kx(this));const a=new zp(t,Lp);a.set({label:r("Width"),class:"ck-table-form__border-width"}),a.fieldView.bind("value").to(this,"borderWidth"),a.bind("isEnabled").to(this,"borderStyle",jx),a.fieldView.on("input",()=>{this.borderWidth=a.fieldView.element.value});const s=new zp(t,e);return s.set({label:r("Color"),class:"ck-table-form__border-color"}),s.fieldView.bind("value").to(this,"borderColor"),s.bind("isEnabled").to(this,"borderStyle",jx),s.fieldView.on("input",()=>{this.borderColor=s.fieldView.value}),this.on("change:borderStyle",(e,t,r)=>{jx(r)||(this.borderColor="",this.borderWidth="")}),{borderRowLabel:n,borderStyleDropdown:i,borderColorInput:s,borderWidthInput:a}}_createBackgroundFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Background");const n=Sx({colorConfig:this.options.backgroundColors,columns:5}),o=new zp(e,n);return o.set({label:t("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:r,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Dimensions");const n=new zp(e,Lp);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",()=>{this.width=n.fieldView.element.value});const o=new oc(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:""}]});const i=new zp(e,Lp);return i.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),i.fieldView.bind("value").to(this,"height"),i.fieldView.on("input",()=>{this.height=i.fieldView.element.value}),{dimensionsLabel:r,widthInput:n,operatorLabel:o,heightInput:i}}_createAlignmentFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Alignment");const n=new Qc(e);return n.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),Cx({view:this,icons:Dx,toolbar:n,labels:this._alignmentLabels,propertyName:"alignment",nameToValue:e=>"center"===e?"":e}),{alignmentLabel:r,alignmentToolbar:n}}_createActionButtons(){const e=this.locale,t=this.t,r=new Lc(e),n=new Lc(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return r.set({label:t("Save"),icon:Vp,class:"ck-button-save",type:"submit",withText:!0}),r.bind("isEnabled").toMany(o,"errorText",(...e)=>e.every(e=>!e)),n.set({label:t("Cancel"),icon:Up,class:"ck-button-cancel",type:"cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:r,cancelButtonView:n}}get _alignmentLabels(){const e=this.locale,t=this.t,r=t("Align table to the left"),n=t("Center table"),o=t("Align table to the right");return"rtl"===e.uiLanguageDirection?{right:o,center:n,left:r}:{left:r,center:n,right:o}}}function jx(e){return!!e}const Rx=Kd.defaultPositions,Lx=[Rx.northArrowSouth,Rx.northArrowSouthWest,Rx.northArrowSouthEast,Rx.southArrowNorth,Rx.southArrowNorthWest,Rx.southArrowNorthEast],Nx=[...Lx,uh];function Bx(e,t){const r=e.plugins.get("ContextualBalloon");if(ev(e.editing.view.document.selection)){let n;n="cell"===t?Vx(e):Fx(e),r.updatePosition(n)}}function Fx(e){const t=e.model.document.selection.getFirstPosition().findAncestor("table"),r=e.editing.mapper.toViewElement(t);return{target:e.editing.view.domConverter.viewToDom(r),positions:Nx}}function Vx(e){const t=e.editing.mapper,r=e.editing.view.domConverter,n=e.model.document.selection;if(n.rangeCount>1)return{target:()=>function(e,t){const r=t.editing.mapper,n=t.editing.view.domConverter,o=Array.from(e).map(e=>{const t=Ux(e.start),o=r.toViewElement(t);return new Di(n.viewToDom(o))});return Di.getBoundingRect(o)}(n.getRanges(),e),positions:Lx};const o=Ux(n.getFirstPosition()),i=t.toViewElement(o);return{target:r.viewToDom(i),positions:Lx}}function Ux(e){return e.nodeAfter&&e.nodeAfter.is("element","tableCell")?e.nodeAfter:e.findAncestor("tableCell")}const qx={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class Hx extends au{static get requires(){return[$p]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),e.config.define("table.tableProperties",{borderColors:Ex,backgroundColors:Ex})}init(){const e=this.editor,t=e.t;this._balloon=e.plugins.get($p),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableProperties",r=>{const n=new Lc(r);n.set({label:t("Table properties"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="M15.5 11.5l1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>',tooltip:!0}),this.listenTo(n,"execute",()=>this._showView());const o=Object.values(qx).map(t=>e.commands.get(t));return n.bind("isEnabled").toMany(o,"isEnabled",(...e)=>e.some(e=>e)),n})}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),r=Cy(t.borderColors),n=ky(e.locale,r),o=Cy(t.backgroundColors),i=ky(e.locale,o),a=new zx(e.locale,{borderColors:n,backgroundColors:i}),s=e.t;a.render(),this.listenTo(a,"submit",()=>{this._hideView()}),this.listenTo(a,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),a.keystrokes.set("Esc",(e,t)=>{this._hideView(),t()}),Gc({emitter:a,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const l=vx(s),c=yx(s);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableBorderColor",errorText:l,validator:_x})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableBorderWidth",errorText:c,validator:xx})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableBackgroundColor",errorText:l,validator:_x})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableWidth",errorText:c,validator:wx})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableHeight",errorText:c,validator:wx})),a.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),a}_fillViewFormFromCommandValues(){const e=this.editor.commands;Object.entries(qx).map(([t,r])=>[t,e.get(r).value||""]).forEach(([e,t])=>this.view.set(e,t))}_showView(){const e=this.editor;this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:Fx(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor;ev(e.editing.view.document.selection)?this._isViewVisible&&Bx(e,"table"):this._hideView()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,r,n)=>{this.editor.execute(e,{value:n,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback({commandName:e,viewField:t,validator:r,errorText:n}){const o=Ci(()=>{t.errorText=n},500);return(n,i,a)=>{o.cancel(),r(a)?(this.editor.execute(e,{value:a,batch:this._undoStepBatch}),t.errorText=null):o()}}}var Wx=i(5737);Pl()(Wx.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),Wx.Z.locals;const Gx={left:bv,center:yv,right:vv,justify:_v,top:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.261 7.062l2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',middle:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',bottom:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.239 13.938l-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>'};class Zx extends oc{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:r,borderWidthInput:n,borderColorInput:o,borderRowLabel:i}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:s}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:u,dimensionsLabel:d}=this._createDimensionFields(),{horizontalAlignmentToolbar:h,verticalAlignmentToolbar:p,alignmentLabel:f}=this._createAlignmentFields();this.focusTracker=new El,this.keystrokes=new vl,this.children=this.createCollection(),this.borderStyleDropdown=r,this.borderWidthInput=n,this.borderColorInput=o,this.backgroundInput=s,this.paddingInput=this._createPaddingField(),this.widthInput=l,this.heightInput=u,this.horizontalAlignmentToolbar=h,this.verticalAlignmentToolbar=p;const{saveButtonView:m,cancelButtonView:g}=this._createActionButtons();this.saveButtonView=m,this.cancelButtonView=g,this._focusables=new Ll,this._focusCycler=new yc({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new lw(e,{label:this.t("Cell properties")})),this.children.add(new Px(e,{labelView:i,children:[i,r,o,n],class:"ck-table-form__border-row"})),this.children.add(new Px(e,{labelView:a,children:[a,s],class:"ck-table-form__background-row"})),this.children.add(new Px(e,{children:[new Px(e,{labelView:d,children:[d,l,c,u],class:"ck-table-form__dimensions-row"}),new Px(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new Px(e,{labelView:f,children:[f,h,p],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new Px(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Fp({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=Sx({colorConfig:this.options.borderColors,columns:5}),t=this.locale,r=this.t,n=new dc(t);n.text=r("Border");const o=bx(r),i=new zp(t,Np);i.set({label:r("Style"),class:"ck-table-form__border-style"}),i.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:r("Style")}),i.fieldView.buttonView.bind("label").to(this,"borderStyle",e=>o[e||"none"]),i.fieldView.on("execute",e=>{this.borderStyle=e.source._borderStyleValue}),i.bind("isEmpty").to(this,"borderStyle",e=>!e),Xc(i.fieldView,kx(this));const a=new zp(t,Lp);a.set({label:r("Width"),class:"ck-table-form__border-width"}),a.fieldView.bind("value").to(this,"borderWidth"),a.bind("isEnabled").to(this,"borderStyle",Yx),a.fieldView.on("input",()=>{this.borderWidth=a.fieldView.element.value});const s=new zp(t,e);return s.set({label:r("Color"),class:"ck-table-form__border-color"}),s.fieldView.bind("value").to(this,"borderColor"),s.bind("isEnabled").to(this,"borderStyle",Yx),s.fieldView.on("input",()=>{this.borderColor=s.fieldView.value}),this.on("change:borderStyle",(e,t,r)=>{Yx(r)||(this.borderColor="",this.borderWidth="")}),{borderRowLabel:n,borderStyleDropdown:i,borderColorInput:s,borderWidthInput:a}}_createBackgroundFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Background");const n=Sx({colorConfig:this.options.backgroundColors,columns:5}),o=new zp(e,n);return o.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:r,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Dimensions");const n=new zp(e,Lp);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",()=>{this.width=n.fieldView.element.value});const o=new oc(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:""}]});const i=new zp(e,Lp);return i.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),i.fieldView.bind("value").to(this,"height"),i.fieldView.on("input",()=>{this.height=i.fieldView.element.value}),{dimensionsLabel:r,widthInput:n,operatorLabel:o,heightInput:i}}_createPaddingField(){const e=this.locale,t=this.t,r=new zp(e,Lp);return r.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),r.fieldView.bind("value").to(this,"padding"),r.fieldView.on("input",()=>{this.padding=r.fieldView.element.value}),r}_createAlignmentFields(){const e=this.locale,t=this.t,r=new dc(e);r.text=t("Table cell text alignment");const n=new Qc(e),o="rtl"===this.locale.contentLanguageDirection;n.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),Cx({view:this,icons:Gx,toolbar:n,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:e=>e===(o?"right":"left")?"":e});const i=new Qc(e);return i.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),Cx({view:this,icons:Gx,toolbar:i,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",nameToValue:e=>"middle"===e?"":e}),{horizontalAlignmentToolbar:n,verticalAlignmentToolbar:i,alignmentLabel:r}}_createActionButtons(){const e=this.locale,t=this.t,r=new Lc(e),n=new Lc(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return r.set({label:t("Save"),icon:Vp,class:"ck-button-save",type:"submit",withText:!0}),r.bind("isEnabled").toMany(o,"errorText",(...e)=>e.every(e=>!e)),n.set({label:t("Cancel"),icon:Up,class:"ck-button-cancel",type:"cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:r,cancelButtonView:n}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,r=t("Align cell text to the left"),n=t("Align cell text to the center"),o=t("Align cell text to the right"),i=t("Justify cell text");return"rtl"===e.uiLanguageDirection?{right:o,center:n,left:r,justify:i}:{left:r,center:n,right:o,justify:i}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function Yx(e){return!!e}const $x={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",width:"tableCellWidth",height:"tableCellHeight",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class Kx extends au{static get requires(){return[$p]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:Ex,backgroundColors:Ex})}init(){const e=this.editor,t=e.t;this._balloon=e.plugins.get($p),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableCellProperties",r=>{const n=new Lc(r);n.set({label:t("Cell properties"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.105 18l-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="M15.5 11.5l1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>',tooltip:!0}),this.listenTo(n,"execute",()=>this._showView());const o=Object.values($x).map(t=>e.commands.get(t));return n.bind("isEnabled").toMany(o,"isEnabled",(...e)=>e.some(e=>e)),n})}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.editing.view.document,r=e.config.get("table.tableCellProperties"),n=Cy(r.borderColors),o=ky(e.locale,n),i=Cy(r.backgroundColors),a=ky(e.locale,i),s=new Zx(e.locale,{borderColors:o,backgroundColors:a}),l=e.t;s.render(),this.listenTo(s,"submit",()=>{this._hideView()}),this.listenTo(s,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),s.keystrokes.set("Esc",(e,t)=>{this._hideView(),t()}),this.listenTo(e.ui,"update",()=>{ev(t.selection)?this._isViewVisible&&Bx(e,"cell"):this._hideView()}),Gc({emitter:s,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const c=vx(l),u=yx(l);return s.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),s.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:s.borderColorInput,commandName:"tableCellBorderColor",errorText:c,validator:_x})),s.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:s.borderWidthInput,commandName:"tableCellBorderWidth",errorText:u,validator:xx})),s.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:s.paddingInput,commandName:"tableCellPadding",errorText:u,validator:wx})),s.on("change:width",this._getValidatedPropertyChangeCallback({viewField:s.widthInput,commandName:"tableCellWidth",errorText:u,validator:wx})),s.on("change:height",this._getValidatedPropertyChangeCallback({viewField:s.heightInput,commandName:"tableCellHeight",errorText:u,validator:wx})),s.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:s.backgroundInput,commandName:"tableCellBackgroundColor",errorText:c,validator:_x})),s.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),s.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),s}_fillViewFormFromCommandValues(){const e=this.editor.commands;Object.entries($x).map(([t,r])=>[t,e.get(r).value||""]).forEach(([e,t])=>this.view.set(e,t))}_showView(){const e=this.editor;this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:Vx(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){if(!this._isViewInBalloon)return;const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,r,n)=>{this.editor.execute(e,{value:n,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback({commandName:e,viewField:t,validator:r,errorText:n}){const o=Ci(()=>{t.errorText=n},500);return(n,i,a)=>{o.cancel(),r(a)?(this.editor.execute(e,{value:a,batch:this._undoStepBatch}),t.errorText=null):o()}}}function Xx(e){e.setNormalizer("padding",e=>({path:"padding",value:$y(e)})),e.setNormalizer("padding-top",e=>({path:"padding.top",value:e})),e.setNormalizer("padding-right",e=>({path:"padding.right",value:e})),e.setNormalizer("padding-bottom",e=>({path:"padding.bottom",value:e})),e.setNormalizer("padding-left",e=>({path:"padding.left",value:e})),e.setReducer("padding",Ky("padding")),e.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}class Jx extends pu{constructor(e,t){super(e),this.attributeName=t}refresh(){const e=Vg(this.editor.model.document.selection);this.isEnabled=!!e.length,this.value=this._getSingleValue(e)}execute(e={}){const{value:t,batch:r}=e,n=this.editor.model,o=Vg(n.document.selection),i=this._getValueToSet(t);n.enqueueChange(r||"default",e=>{i?o.forEach(t=>e.setAttribute(this.attributeName,i,t)):o.forEach(t=>e.removeAttribute(this.attributeName,t))})}_getAttribute(e){if(e)return e.getAttribute(this.attributeName)}_getValueToSet(e){return e}_getSingleValue(e){const t=this._getAttribute(e[0]);return e.every(e=>this._getAttribute(e)===t)?t:void 0}}class Qx extends Jx{constructor(e){super(e,"padding")}_getAttribute(e){if(e)return rx(e.getAttribute(this.attributeName))}_getValueToSet(e){return nx(e,"px")}}class ek extends Jx{constructor(e){super(e,"width")}_getValueToSet(e){return nx(e,"px")}}class tk extends Jx{constructor(e){super(e,"height")}_getValueToSet(e){return nx(e,"px")}}class rk extends Jx{constructor(e){super(e,"backgroundColor")}}class nk extends Jx{constructor(e){super(e,"verticalAlignment")}}class ok extends Jx{constructor(e){super(e,"horizontalAlignment")}}class ik extends Jx{constructor(e){super(e,"borderStyle")}_getAttribute(e){if(e)return rx(e.getAttribute(this.attributeName))}}class ak extends Jx{constructor(e){super(e,"borderColor")}_getAttribute(e){if(e)return rx(e.getAttribute(this.attributeName))}}class sk extends Jx{constructor(e){super(e,"borderWidth")}_getAttribute(e){if(e)return rx(e.getAttribute(this.attributeName))}_getValueToSet(e){return nx(e,"px")}}const lk=/^(top|bottom)$/;class ck extends au{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[zb]}init(){const e=this.editor,t=e.model.schema,r=e.conversion,n=e.locale;e.data.addStyleProcessorRules(Nw),function(e,t){e.extend("tableCell",{allowAttributes:["borderWidth","borderColor","borderStyle"]}),Xw(t,"td"),Xw(t,"th"),Jw(t,"tableCell","borderStyle","border-style"),Jw(t,"tableCell","borderColor","border-color"),Jw(t,"tableCell","borderWidth","border-width")}(t,r),e.commands.add("tableCellBorderStyle",new ik(e)),e.commands.add("tableCellBorderColor",new ak(e)),e.commands.add("tableCellBorderWidth",new sk(e)),function(e,t,r){e.extend("tableCell",{allowAttributes:["horizontalAlignment"]});const n=["rtl"==r.contentLanguageDirection?"left":"right","center","justify"];t.attributeToAttribute({model:{name:"tableCell",key:"horizontalAlignment",values:n},view:n.reduce((e,t)=>({...e,[t]:{key:"style",value:{"text-align":t}}}),{})})}(t,r,n),e.commands.add("tableCellHorizontalAlignment",new ok(e)),uk(t,r,"width","width"),e.commands.add("tableCellWidth",new ek(e)),uk(t,r,"height","height"),e.commands.add("tableCellHeight",new tk(e)),e.data.addStyleProcessorRules(Xx),uk(t,r,"padding","padding"),e.commands.add("tableCellPadding",new Qx(e)),e.data.addStyleProcessorRules(Qy),uk(t,r,"backgroundColor","background-color"),e.commands.add("tableCellBackgroundColor",new rk(e)),function(e,t){e.extend("tableCell",{allowAttributes:["verticalAlignment"]}),t.attributeToAttribute({model:{name:"tableCell",key:"verticalAlignment",values:["top","bottom"]},view:{top:{key:"style",value:{"vertical-align":"top"}},bottom:{key:"style",value:{"vertical-align":"bottom"}}}}),t.for("upcast").attributeToAttribute({view:{attributes:{valign:lk}},model:{name:"tableCell",key:"verticalAlignment",value:e=>e.getAttribute("valign")}})}(t,r),e.commands.add("tableCellVerticalAlignment",new nk(e))}}function uk(e,t,r,n){e.extend("tableCell",{allowAttributes:[r]}),Kw(t,"tableCell",r,n),Jw(t,"tableCell",r,n)}class dk extends pu{refresh(){this.isEnabled=function(e){const t=e.schema,r=e.document.selection;return function(e,t,r){const n=function(e,t){const r=ch(e,t).parent;return r.isEmpty&&!r.is("element","$root")?r.parent:r}(e,r);return t.checkChild(n,"rawHtml")}(r,t,e)&&!function(e,t){const r=e.getSelectedElement();return r&&t.isObject(r)}(r,t)}(this.editor.model)}execute(){const e=this.editor.model;e.change(t=>{const r=t.createElement("rawHtml");e.insertContent(r),t.setSelection(r,"on")})}}class hk extends pu{refresh(){const e=pk(this.editor.model.document.selection);this.isEnabled=!!e}execute(e){const t=this.editor.model,r=pk(t.document.selection);t.change(t=>{t.setAttribute("value",e,r)})}}function pk(e){const t=e.getSelectedElement();return t&&t.is("element","rawHtml")?t:null}var fk=i(3403);Pl()(fk.Z,{injectType:"singletonStyleTag",insert:"head",singleton:!0}),fk.Z.locals;class mk extends au{static get pluginName(){return"HtmlEmbedEditing"}constructor(e){super(e),e.config.define("htmlEmbed",{showPreviews:!1,sanitizeHtml:e=>(Ht("html-embed-provide-sanitize-function"),{html:e,hasChanged:!1})})}init(){const e=this.editor;e.model.schema.register("rawHtml",{isObject:!0,allowWhere:"$block",allowAttributes:["value"]}),e.commands.add("updateHtmlEmbed",new hk(e)),e.commands.add("insertHtmlEmbed",new dk(e)),this._setupConversion()}_setupConversion(){const e=this.editor,t=e.t,r=e.editing.view,n=e.config.get("htmlEmbed");function o({domElement:e,editor:r,state:n,props:o}){e.textContent="";const a=e.ownerDocument;let s;if(n.isEditable){const t={isDisabled:!1,placeholder:o.textareaPlaceholder};s=i({domDocument:a,state:n,props:t}),e.append(s)}else if(n.showPreviews){const i={sanitizeHtml:o.sanitizeHtml};e.append(function({domDocument:e,state:r,props:n,editor:o}){const i=n.sanitizeHtml(r.getRawHtmlValue()),a=ac(e,"div",{class:"ck ck-reset_all raw-html-embed__preview-placeholder"},r.getRawHtmlValue().length>0?t("No preview available"):t("Empty snippet content")),s=ac(e,"div",{class:"raw-html-embed__preview-content",dir:o.locale.contentLanguageDirection});return s.innerHTML=i.html,ac(e,"div",{class:"raw-html-embed__preview"},[a,s])}({domDocument:a,state:n,props:i,editor:r}))}else{const t={isDisabled:!0,placeholder:o.textareaPlaceholder};e.append(i({domDocument:a,state:n,props:t}))}const l={onEditClick:o.onEditClick,onSaveClick:()=>{o.onSaveClick(s.value)},onCancelClick:o.onCancelClick};e.prepend(function({editor:e,domDocument:t,state:r,props:n}){const o=ac(t,"div",{class:"raw-html-embed__buttons-wrapper"}),i=gk(e,"edit"),a=gk(e,"save"),s=gk(e,"cancel");if(r.isEditable){const e=a.cloneNode(!0),t=s.cloneNode(!0);e.addEventListener("click",e=>{e.preventDefault(),n.onSaveClick()}),t.addEventListener("click",e=>{e.preventDefault(),n.onCancelClick()}),o.appendChild(e),o.appendChild(t)}else{const e=i.cloneNode(!0);e.addEventListener("click",e=>{e.preventDefault(),n.onEditClick()}),o.appendChild(e)}return o}({editor:r,domDocument:a,state:n,props:l}))}function i({domDocument:e,state:t,props:r}){const n=ac(e,"textarea",{placeholder:r.placeholder,class:"ck ck-reset ck-input ck-input-text raw-html-embed__source"});return n.disabled=r.isDisabled,n.value=t.getRawHtmlValue(),n}e.data.registerRawContentMatcher({name:"div",classes:"raw-html-embed"}),e.conversion.for("upcast").elementToElement({view:{name:"div",classes:"raw-html-embed"},model:(e,{writer:t})=>t.createElement("rawHtml",{value:e.getCustomProperty("$rawContent")})}),e.conversion.for("dataDowncast").elementToElement({model:"rawHtml",view:(e,{writer:t})=>t.createRawElement("div",{class:"raw-html-embed"},(function(t){t.innerHTML=e.getAttribute("value")||""}))}),e.conversion.for("editingDowncast").elementToElement({triggerBy:{attributes:["value"]},model:"rawHtml",view:(i,{writer:a})=>{let s,l,c;const u=a.createContainerElement("div",{class:"raw-html-embed","data-html-embed-label":t("HTML snippet"),dir:e.locale.uiLanguageDirection}),d=a.createRawElement("div",{class:"raw-html-embed__content-wrapper"},(function(t){s=t,o({domElement:t,editor:e,state:l,props:c}),s.addEventListener("mousedown",()=>{if(l.isEditable){const t=e.model;t.document.selection.getSelectedElement()!==i&&t.change(e=>e.setSelection(i,"on"))}},!0)})),h={makeEditable(){l=Object.assign({},l,{isEditable:!0}),o({domElement:s,editor:e,state:l,props:c}),r.change(e=>{e.setAttribute("data-cke-ignore-events","true",d)}),s.querySelector("textarea").focus()},save(t){t!==l.getRawHtmlValue()?(e.execute("updateHtmlEmbed",t),e.editing.view.focus()):this.cancel()},cancel(){l=Object.assign({},l,{isEditable:!1}),o({domElement:s,editor:e,state:l,props:c}),e.editing.view.focus(),r.change(e=>{e.removeAttribute("data-cke-ignore-events",d)})}};return l={showPreviews:n.showPreviews,isEditable:!1,getRawHtmlValue:()=>i.getAttribute("value")||""},c={sanitizeHtml:n.sanitizeHtml,textareaPlaceholder:t("Paste raw HTML here..."),onEditClick(){h.makeEditable()},onSaveClick(e){h.save(e)},onCancelClick(){h.cancel()}},a.insert(a.createPositionAt(u,0),d),a.setCustomProperty("rawHtmlApi",h,u),a.setCustomProperty("rawHtml",!0,u),ih(u,a,{widgetLabel:t("HTML snippet"),hasSelectionHandle:!0})}})}}function gk(e,t){const r=e.locale.t,n=new Lc(e.locale),o=e.commands.get("updateHtmlEmbed");return n.set({tooltipPosition:"rtl"===e.locale.uiLanguageDirection?"e":"w",icon:fm,tooltip:!0}),n.render(),"edit"===t?n.set({icon:fm,label:r("Edit source"),class:"raw-html-embed__edit-button"}):"save"===t?(n.set({icon:Vp,label:r("Save changes"),class:"raw-html-embed__save-button"}),n.bind("isEnabled").to(o,"isEnabled")):n.set({icon:Up,label:r("Cancel"),class:"raw-html-embed__cancel-button"}),n.destroy(),n.element.cloneNode(!0)}class bk extends au{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("htmlEmbed",r=>{const n=e.commands.get("insertHtmlEmbed"),o=new Lc(r);return o.set({label:t("Insert HTML"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013l-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("insertHtmlEmbed"),e.editing.view.focus(),e.editing.view.document.selection.getSelectedElement().getCustomProperty("rawHtmlApi").makeEditable()}),o})}}class vk extends iu{}vk.builtinPlugins=[class extends au{static get requires(){return[hu,yu,Pu,ku,qu,ud]}static get pluginName(){return"Essentials"}},vd,class extends au{static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&wd(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&wd(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&wd(this.editor,this,/^\[\s?\]\s$/,"todoList")}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const e=Cd(this.editor,"bold");xd(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),xd(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(e.get("italic")){const e=Cd(this.editor,"italic");xd(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),xd(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(e.get("code")){const e=Cd(this.editor,"code");xd(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(e.get("strikethrough")){const e=Cd(this.editor,"strikethrough");xd(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter(e=>e.match(/^heading[1-6]$/)).forEach(t=>{const r=t[7],n=new RegExp(`^(#{${r}})\\s$`);wd(this.editor,this,n,()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&wd(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){this.editor.commands.get("codeBlock")&&wd(this.editor,this,/^```$/,"codeBlock")}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&wd(this.editor,this,/^---$/,"horizontalLine")}},class extends au{static get requires(){return[Td,Pd]}static get pluginName(){return"Bold"}},class extends au{static get requires(){return[Od,Dd]}static get pluginName(){return"Italic"}},class extends au{static get requires(){return[Nd,Fd]}static get pluginName(){return"BlockQuote"}},class extends au{static get pluginName(){return"CKFinder"}static get requires(){return[hp,Vd,vd]}},class extends au{static get requires(){return[yp,rf,Cf]}static get pluginName(){return"EasyImage"}},class extends au{static get requires(){return[Mf,jf]}static get pluginName(){return"Heading"}},rf,class extends au{static get requires(){return[Nf]}static get pluginName(){return"ImageCaption"}},class extends au{static get requires(){return[em,rm]}static get pluginName(){return"ImageStyle"}},class extends au{static get requires(){return[nm]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t;e.plugins.get(nm).register("image",{ariaLabel:t("Image toolbar"),items:e.config.get("image.toolbar")||[],getRelatedElement:hh})}},Cf,class extends au{static get pluginName(){return"Indent"}static get requires(){return[sm,um]}},class extends au{static get requires(){return[ap,vm,km]}static get pluginName(){return"Link"}},class extends au{static get requires(){return[Ym,Km]}static get pluginName(){return"List"}},class extends au{static get requires(){return[ig,ug,sg,Pp]}static get pluginName(){return"MediaEmbed"}},Af,class extends au{static get pluginName(){return"PasteFromOffice"}static get requires(){return[hu]}init(){const e=this.editor,t=e.editing.view.document,r=[];r.push(new wg(t)),r.push(new gg(t)),e.plugins.get("Clipboard").on("inputTransformation",(e,t)=>{if(t.isTransformedWithPasteFromOffice)return;const n=t.dataTransfer.getData("text/html"),o=r.find(e=>e.isActive(n));o&&(o.execute(t),t.isTransformedWithPasteFromOffice=!0)},{priority:"high"})}},class extends au{static get requires(){return[zb,Fb,qb,Kb,Yb,Hb,Pp]}static get pluginName(){return"Table"}},class extends au{static get requires(){return[nm]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,r=e.plugins.get(nm),n=e.config.get("table.contentToolbar"),o=e.config.get("table.tableToolbar");n&&r.register("tableContent",{ariaLabel:t("Table toolbar"),items:n,getRelatedElement:ev}),o&&r.register("table",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:Qb})}},class extends au{static get pluginName(){return"TextTransformation"}constructor(e){super(e),e.config.define("typing",{transformations:{include:av}})}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,r=e.plugins.get("Input"),n=function(e){const t=e.extra||[],r=e.remove||[],n=e=>!r.includes(e);return function(e){const t=new Set;for(const r of e)if(iv[r])for(const e of iv[r])t.add(e);else t.add(r);return Array.from(t)}(e.include.concat(t).filter(n)).filter(n).map(e=>ov[e]||e).map(e=>({from:sv(e.from),to:lv(e.to)}))}(e.config.get("typing.transformations")),o=new wm(e.model,e=>{for(const t of n)if(t.from.test(e))return{normalizedTransformation:t}});o.on("matched:data",(e,n)=>{if(!r.isInput(n.batch))return;const{from:o,to:i}=n.normalizedTransformation,a=o.exec(n.text),s=i(a.slice(1)),l=n.range;let c=a.index;t.enqueueChange(e=>{for(let r=1;r<a.length;r++){const n=a[r],o=s[r-1];if(null==o){c+=n.length;continue}const i=l.start.getShiftedBy(c),u=t.createRange(i,i.getShiftedBy(n.length)),d=cv(i);t.insertContent(e.createText(o,d),u),c+=o.length}})}),o.bind("isEnabled").to(this)}},class extends au{static get requires(){return[gv,xv]}static get pluginName(){return"Alignment"}},kv,class extends au{static get requires(){return[Ev,Tv]}static get pluginName(){return"Underline"}},class extends au{static get requires(){return[Pv,Ov]}static get pluginName(){return"Strikethrough"}},class extends au{static get requires(){return[Dv,Rv]}static get pluginName(){return"Code"}},class extends au{static get requires(){return[Nv,Fv]}static get pluginName(){return"Subscript"}},class extends au{static get requires(){return[Uv,Hv]}static get pluginName(){return"Superscript"}},hu,class extends au{static get requires(){return[hy,_y,Ay,n_]}static get pluginName(){return"Font"}},class extends au{static get requires(){return[i_,s_]}static get pluginName(){return"Highlight"}},class extends au{static get requires(){return[d_,h_,Pp]}static get pluginName(){return"HorizontalLine"}},class extends au{toMentionAttribute(e,t){return g_(e,t)}static get pluginName(){return"Mention"}static get requires(){return[f_,S_]}},class extends au{static get requires(){return[j_,R_,Pp]}static get pluginName(){return"PageBreak"}},class extends au{static get requires(){return[F_,N_]}static get pluginName(){return"RemoveFormat"}},class extends au{static get pluginName(){return"StandardEditingMode"}static get requires(){return[U_,q_]}},class extends au{static get requires(){return[ow,aw]}static get pluginName(){return"CodeBlock"}},class extends au{static get requires(){return[qu]}static get pluginName(){return"SpecialCharacters"}constructor(e){super(e),this._characters=new Map,this._groups=new Map}init(){const e=this.editor,t=e.t,r=e.commands.get("input");e.ui.componentFactory.add("specialCharacters",n=>{const o=$c(n);let i;return o.buttonView.set({label:t("Special characters"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>',tooltip:!0}),o.bind("isEnabled").to(r),o.on("execute",(t,r)=>{e.execute("input",{text:r.character}),e.editing.view.focus()}),o.on("change:isOpen",()=>{i||(i=this._createDropdownPanelContent(n,o),o.panelView.children.add(i.navigationView),o.panelView.children.add(i.gridView),o.panelView.children.add(i.infoView)),i.infoView.set({character:null,name:null})}),o})}addItems(e,t){if("All"===e)throw new qt('special-character-invalid-group-name: The name "All" is reserved and cannot be used.');const r=this._getGroup(e);for(const e of t)r.add(e.title),this._characters.set(e.title,e.character)}getGroups(){return this._groups.keys()}getCharactersForGroup(e){return"All"===e?new Set(this._characters.keys()):this._groups.get(e)}getCharacter(e){return this._characters.get(e)}_getGroup(e){return this._groups.has(e)||this._groups.set(e,new Set),this._groups.get(e)}_updateGrid(e,t){t.tiles.clear();const r=this.getCharactersForGroup(e);for(const e of r){const r=this.getCharacter(e);t.tiles.add(t.createTile(r,e))}}_createDropdownPanelContent(e,t){const r=[...this.getGroups()];r.unshift("All");const n=new cw(e,r),o=new dw(e),i=new pw(e);return o.delegate("execute").to(t),o.on("tileHover",(e,t)=>{i.set(t)}),n.on("execute",()=>{this._updateGrid(n.currentGroupName,o)}),this._updateGrid(n.currentGroupName,o),{navigationView:n,gridView:o,infoView:i}}},class extends au{static get requires(){return[gw,_w,bw,vw,yw]}},class extends au{constructor(e){super(e),this.set("characters",0),this.set("words",0),Object.defineProperties(this,{characters:{get(){return this.characters=this._getCharacters()}},words:{get(){return this.words=this._getWords()}}}),this.set("_wordsLabel"),this.set("_charactersLabel"),this._config=e.config.get("wordCount")||{},this._outputView=void 0,this._wordsMatchRegExp=Vn.isRegExpUnicodePropertySupported?new RegExp("([\\p{L}\\p{N}]+\\S?)+","gu"):/([a-zA-Z0-9-]+\S?)+/gu}static get pluginName(){return"WordCount"}init(){this.editor.model.document.on("change:data",xw(this._refreshStats.bind(this),250)),"function"==typeof this._config.onUpdate&&this.on("update",(e,t)=>{this._config.onUpdate(t)}),jt(this._config.container)&&this._config.container.appendChild(this.wordCountContainer)}destroy(){this._outputView&&(this._outputView.element.remove(),this._outputView.destroy()),super.destroy()}get wordCountContainer(){const e=this.editor,t=e.t,r=e.config.get("wordCount.displayWords"),n=e.config.get("wordCount.displayCharacters"),o=Nl.bind(this,this),i=[];return this._outputView||(this._outputView=new oc,(r||void 0===r)&&(this.bind("_wordsLabel").to(this,"words",e=>t("Words: %0",e)),i.push({tag:"div",children:[{text:[o.to("_wordsLabel")]}],attributes:{class:"ck-word-count__words"}})),(n||void 0===n)&&(this.bind("_charactersLabel").to(this,"characters",e=>t("Characters: %0",e)),i.push({tag:"div",children:[{text:[o.to("_charactersLabel")]}],attributes:{class:"ck-word-count__characters"}})),this._outputView.setTemplate({tag:"div",attributes:{class:["ck","ck-word-count"]},children:i}),this._outputView.render()),this._outputView.element}_getCharacters(){return ww(this.editor.model.document.getRoot()).replace(/\n/g,"").length}_getWords(){return(ww(this.editor.model.document.getRoot()).match(this._wordsMatchRegExp)||[]).length}_refreshStats(){const e=this.words=this._getWords(),t=this.characters=this._getCharacters();this.fire("update",{words:e,characters:t})}},class extends au{static get requires(){return[Cw,jw,Tw]}static get pluginName(){return"ImageResize"}},ef,class extends au{static get requires(){return[fd]}static get pluginName(){return"SimpleUploadAdapter"}init(){const e=this.editor.config.get("simpleUpload");e&&(e.uploadUrl?this.editor.plugins.get(fd).createUploadAdapter=t=>new Lw(t,e):Ht("simple-upload-adapter-missing-uploadurl"))}},class extends au{static get pluginName(){return"TableProperties"}static get requires(){return[dx,Hx]}},class extends au{static get pluginName(){return"TableCellProperties"}static get requires(){return[ck,Kx]}},class extends au{static get requires(){return[mk,bk,Pp]}static get pluginName(){return"HtmlEmbed"}}],vk.defaultConfig={toolbar:{items:["removeFormat","|","heading","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","bold","italic","underline","strikethrough","code","subscript","superscript","|","bulletedList","numberedList","|","alignment","indent","outdent","|","link","insertTable","specialCharacters","imageUpload","mediaEmbed","htmlEmbed","|","highlight","blockQuote","horizontalLine","pageBreak","|","restrictedEditingException","|","undo","redo"]},blockToolbar:["heading","fontSize","fontColor","fontBackgroundColor","alignment","|","bulletedList","numberedList","|","blockQuote","imageUpload"],fontSize:{options:[8,9,10,11,12,14,16,18,20,22,24,26,28]},image:{toolbar:["imageStyle:alignLeft","imageStyle:full","imageStyle:alignRight","|","imageTextAlternative"],styles:["full","side","alignLeft","alignCenter","alignRight"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties"]},language:"en"}})(),a.default})()}).call(this,r(43),r(119)(e))},,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),a=d(i),s=d(r(17)),l=d(r(218)),c=d(r(219)),u=r(227);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){return!0},p=function(e){function t(e){var r=e.alwaysRenderSuggestions;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return f.call(n),n.state={isFocused:!1,isCollapsed:!r,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null},n.justPressedUpDown=!1,n.justMouseEntered=!1,n.pressedSuggestion=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onDocumentMouseDown),document.addEventListener("mouseup",this.onDocumentMouseUp),this.input=this.autowhatever.input,this.suggestionsContainer=this.autowhatever.itemsContainer}},{key:"componentWillReceiveProps",value:function(e){(0,l.default)(e.suggestions,this.props.suggestions)?e.highlightFirstSuggestion&&e.suggestions.length>0&&!1===this.justPressedUpDown&&!1===this.justMouseEntered&&this.highlightFirstSuggestion():this.willRenderSuggestions(e)?this.state.isCollapsed&&!this.justSelectedSuggestion&&this.revealSuggestions():this.resetHighlightedSuggestion()}},{key:"componentDidUpdate",value:function(e,t){var r=this.props,n=r.suggestions,o=r.onSuggestionHighlighted,i=r.highlightFirstSuggestion;if(!(0,l.default)(n,e.suggestions)&&n.length>0&&i)this.highlightFirstSuggestion();else if(o){var a=this.getHighlightedSuggestion();a!=t.highlightedSuggestion&&o({suggestion:a})}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onDocumentMouseDown),document.removeEventListener("mouseup",this.onDocumentMouseUp)}},{key:"updateHighlightedSuggestion",value:function(e,t,r){var n=this;this.setState((function(o){var i=o.valueBeforeUpDown;return null===t?i=null:null===i&&void 0!==r&&(i=r),{highlightedSectionIndex:e,highlightedSuggestionIndex:t,highlightedSuggestion:null===t?null:n.getSuggestion(e,t),valueBeforeUpDown:i}}))}},{key:"resetHighlightedSuggestion",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState((function(t){var r=t.valueBeforeUpDown;return{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:e?null:r}}))}},{key:"revealSuggestions",value:function(){this.setState({isCollapsed:!1})}},{key:"closeSuggestions",value:function(){this.setState({highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!0})}},{key:"getSuggestion",value:function(e,t){var r=this.props,n=r.suggestions,o=r.multiSection,i=r.getSectionSuggestions;return o?i(n[e])[t]:n[t]}},{key:"getHighlightedSuggestion",value:function(){var e=this.state,t=e.highlightedSectionIndex,r=e.highlightedSuggestionIndex;return null===r?null:this.getSuggestion(t,r)}},{key:"getSuggestionValueByIndex",value:function(e,t){return(0,this.props.getSuggestionValue)(this.getSuggestion(e,t))}},{key:"getSuggestionIndices",value:function(e){var t=e.getAttribute("data-section-index"),r=e.getAttribute("data-suggestion-index");return{sectionIndex:"string"==typeof t?parseInt(t,10):null,suggestionIndex:parseInt(r,10)}}},{key:"findSuggestionElement",value:function(e){var t=e;do{if(null!==t.getAttribute("data-suggestion-index"))return t;t=t.parentNode}while(null!==t);throw console.error("Clicked element:",e),new Error("Couldn't find suggestion element")}},{key:"maybeCallOnChange",value:function(e,t,r){var n=this.props.inputProps,o=n.value,i=n.onChange;t!==o&&i(e,{newValue:t,method:r})}},{key:"willRenderSuggestions",value:function(e){var t=e.suggestions,r=e.inputProps,n=e.shouldRenderSuggestions,o=r.value;return t.length>0&&n(o)}},{key:"getQuery",value:function(){var e=this.props.inputProps.value,t=this.state.valueBeforeUpDown;return(null===t?e:t).trim()}},{key:"render",value:function(){var e=this,t=this.props,r=t.suggestions,o=t.renderInputComponent,i=t.onSuggestionsFetchRequested,s=t.renderSuggestion,l=t.inputProps,d=t.multiSection,p=t.renderSectionTitle,f=t.id,m=t.getSectionSuggestions,g=t.theme,b=t.getSuggestionValue,v=t.alwaysRenderSuggestions,y=t.highlightFirstSuggestion,_=this.state,w=_.isFocused,x=_.isCollapsed,k=_.highlightedSectionIndex,C=_.highlightedSuggestionIndex,E=_.valueBeforeUpDown,S=v?h:this.props.shouldRenderSuggestions,T=l.value,A=l.onFocus,P=l.onKeyDown,I=this.willRenderSuggestions(this.props),O=v||w&&!x&&I,M=O?r:[],D=n({},l,{onFocus:function(t){if(!e.justSelectedSuggestion&&!e.justClickedOnSuggestionsContainer){var r=S(T);e.setState({isFocused:!0,isCollapsed:!r}),A&&A(t),r&&i({value:T,reason:"input-focused"})}},onBlur:function(t){e.justClickedOnSuggestionsContainer?e.input.focus():(e.blurEvent=t,e.justSelectedSuggestion||(e.onBlur(),e.onSuggestionsClearRequested()))},onChange:function(t){var r=t.target.value,o=S(r);e.maybeCallOnChange(t,r,"type"),e.suggestionsContainer&&(e.suggestionsContainer.scrollTop=0),e.setState(n({},y?{}:{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null},{valueBeforeUpDown:null,isCollapsed:!o})),o?i({value:r,reason:"input-changed"}):e.onSuggestionsClearRequested()},onKeyDown:function(t,n){var o=t.keyCode;switch(o){case 40:case 38:if(x)S(T)&&(i({value:T,reason:"suggestions-revealed"}),e.revealSuggestions());else if(r.length>0){var a=n.newHighlightedSectionIndex,s=n.newHighlightedItemIndex,l=void 0;l=null===s?null===E?T:E:e.getSuggestionValueByIndex(a,s),e.updateHighlightedSuggestion(a,s,T),e.maybeCallOnChange(t,l,40===o?"down":"up")}t.preventDefault(),e.justPressedUpDown=!0,setTimeout((function(){e.justPressedUpDown=!1}));break;case 13:if(229===t.keyCode)break;var c=e.getHighlightedSuggestion();if(O&&!v&&e.closeSuggestions(),null!=c){var u=b(c);e.maybeCallOnChange(t,u,"enter"),e.onSuggestionSelected(t,{suggestion:c,suggestionValue:u,suggestionIndex:C,sectionIndex:k,method:"enter"}),e.justSelectedSuggestion=!0,setTimeout((function(){e.justSelectedSuggestion=!1}))}break;case 27:O&&t.preventDefault();var d=O&&!v;if(null===E){if(!d){e.maybeCallOnChange(t,"","escape"),S("")?i({value:"",reason:"escape-pressed"}):e.onSuggestionsClearRequested()}}else e.maybeCallOnChange(t,E,"escape");d?(e.onSuggestionsClearRequested(),e.closeSuggestions()):e.resetHighlightedSuggestion()}P&&P(t)}}),z={query:this.getQuery()};return a.default.createElement(c.default,{multiSection:d,items:M,renderInputComponent:o,renderItemsContainer:this.renderSuggestionsContainer,renderItem:s,renderItemData:z,renderSectionTitle:p,getSectionItems:m,highlightedSectionIndex:k,highlightedItemIndex:C,inputProps:D,itemProps:this.itemProps,theme:(0,u.mapToAutowhateverTheme)(g),id:f,ref:this.storeAutowhateverRef})}}]),t}(i.Component);p.propTypes={suggestions:s.default.array.isRequired,onSuggestionsFetchRequested:function(e,t){var r=e[t];if("function"!=typeof r)throw new Error("'onSuggestionsFetchRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsFetchRequestedProp")},onSuggestionsClearRequested:function(e,t){var r=e[t];if(!1===e.alwaysRenderSuggestions&&"function"!=typeof r)throw new Error("'onSuggestionsClearRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsClearRequestedProp")},onSuggestionSelected:s.default.func,onSuggestionHighlighted:s.default.func,renderInputComponent:s.default.func,renderSuggestionsContainer:s.default.func,getSuggestionValue:s.default.func.isRequired,renderSuggestion:s.default.func.isRequired,inputProps:function(e,t){var r=e[t];if(!r.hasOwnProperty("value"))throw new Error("'inputProps' must have 'value'.");if(!r.hasOwnProperty("onChange"))throw new Error("'inputProps' must have 'onChange'.")},shouldRenderSuggestions:s.default.func,alwaysRenderSuggestions:s.default.bool,multiSection:s.default.bool,renderSectionTitle:function(e,t){var r=e[t];if(!0===e.multiSection&&"function"!=typeof r)throw new Error("'renderSectionTitle' must be implemented. See: https://github.com/moroshko/react-autosuggest#renderSectionTitleProp")},getSectionSuggestions:function(e,t){var r=e[t];if(!0===e.multiSection&&"function"!=typeof r)throw new Error("'getSectionSuggestions' must be implemented. See: https://github.com/moroshko/react-autosuggest#getSectionSuggestionsProp")},focusInputOnSuggestionClick:s.default.bool,highlightFirstSuggestion:s.default.bool,theme:s.default.object,id:s.default.string},p.defaultProps={renderSuggestionsContainer:function(e){var t=e.containerProps,r=e.children;return a.default.createElement("div",t,r)},shouldRenderSuggestions:function(e){return e.trim().length>0},alwaysRenderSuggestions:!1,multiSection:!1,focusInputOnSuggestionClick:!0,highlightFirstSuggestion:!1,theme:u.defaultTheme,id:"1"};var f=function(){var e=this;this.onDocumentMouseDown=function(t){e.justClickedOnSuggestionsContainer=!1;for(var r=t.detail&&t.detail.target||t.target;null!==r&&r!==document;){if(null!==r.getAttribute("data-suggestion-index"))return;if(r===e.suggestionsContainer)return void(e.justClickedOnSuggestionsContainer=!0);r=r.parentNode}},this.storeAutowhateverRef=function(t){null!==t&&(e.autowhatever=t)},this.onSuggestionMouseEnter=function(t,r){var n=r.sectionIndex,o=r.itemIndex;e.updateHighlightedSuggestion(n,o),t.target===e.pressedSuggestion&&(e.justSelectedSuggestion=!0),e.justMouseEntered=!0,setTimeout((function(){e.justMouseEntered=!1}))},this.highlightFirstSuggestion=function(){e.updateHighlightedSuggestion(e.props.multiSection?0:null,0)},this.onDocumentMouseUp=function(){e.pressedSuggestion&&!e.justSelectedSuggestion&&e.input.focus(),e.pressedSuggestion=null},this.onSuggestionMouseDown=function(t){e.justSelectedSuggestion||(e.justSelectedSuggestion=!0,e.pressedSuggestion=t.target)},this.onSuggestionsClearRequested=function(){var t=e.props.onSuggestionsClearRequested;t&&t()},this.onSuggestionSelected=function(t,r){var n=e.props,o=n.alwaysRenderSuggestions,i=n.onSuggestionSelected,a=n.onSuggestionsFetchRequested;i&&i(t,r),o?a({value:r.suggestionValue,reason:"suggestion-selected"}):e.onSuggestionsClearRequested(),e.resetHighlightedSuggestion()},this.onSuggestionClick=function(t){var r=e.props,n=r.alwaysRenderSuggestions,o=r.focusInputOnSuggestionClick,i=e.getSuggestionIndices(e.findSuggestionElement(t.target)),a=i.sectionIndex,s=i.suggestionIndex,l=e.getSuggestion(a,s),c=e.props.getSuggestionValue(l);e.maybeCallOnChange(t,c,"click"),e.onSuggestionSelected(t,{suggestion:l,suggestionValue:c,suggestionIndex:s,sectionIndex:a,method:"click"}),n||e.closeSuggestions(),!0===o?e.input.focus():e.onBlur(),setTimeout((function(){e.justSelectedSuggestion=!1}))},this.onBlur=function(){var t=e.props,r=t.inputProps,n=t.shouldRenderSuggestions,o=r.value,i=r.onBlur,a=e.getHighlightedSuggestion(),s=n(o);e.setState({isFocused:!1,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!s}),i&&i(e.blurEvent,{highlightedSuggestion:a})},this.onSuggestionMouseLeave=function(t){e.resetHighlightedSuggestion(!1),e.justSelectedSuggestion&&t.target===e.pressedSuggestion&&(e.justSelectedSuggestion=!1)},this.onSuggestionTouchStart=function(){e.justSelectedSuggestion=!0},this.onSuggestionTouchMove=function(){e.justSelectedSuggestion=!1,e.pressedSuggestion=null,e.input.focus()},this.itemProps=function(t){return{"data-section-index":t.sectionIndex,"data-suggestion-index":t.itemIndex,onMouseEnter:e.onSuggestionMouseEnter,onMouseLeave:e.onSuggestionMouseLeave,onMouseDown:e.onSuggestionMouseDown,onTouchStart:e.onSuggestionTouchStart,onTouchMove:e.onSuggestionTouchMove,onClick:e.onSuggestionClick}},this.renderSuggestionsContainer=function(t){var r=t.containerProps,n=t.children;return(0,e.props.renderSuggestionsContainer)({containerProps:r,children:n,query:e.getQuery()})}};t.default=p},function(e,t,r){"use strict";e.exports=function(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=e.length;if(t.length!==r)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}},function(e,t,r){"use strict";e.exports=r(220).default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),s=p(a),l=p(r(17)),c=p(r(221)),u=p(r(222)),d=p(r(224)),h=p(r(225));function p(e){return e&&e.__esModule?e:{default:e}}var f={},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.storeInputReference=function(e){null!==e&&(r.input=e)},r.storeItemsContainerReference=function(e){null!==e&&(r.itemsContainer=e)},r.onHighlightedItemChange=function(e){r.highlightedItem=e},r.getItemId=function(e,t){return null===t?null:"react-autowhatever-"+r.props.id+"-"+(null===e?"":"section-"+e)+"-item-"+t},r.onFocus=function(e){var t=r.props.inputProps;r.setState({isInputFocused:!0}),t.onFocus&&t.onFocus(e)},r.onBlur=function(e){var t=r.props.inputProps;r.setState({isInputFocused:!1}),t.onBlur&&t.onBlur(e)},r.onKeyDown=function(e){var t=r.props,n=t.inputProps,i=t.highlightedSectionIndex,a=t.highlightedItemIndex;switch(e.key){case"ArrowDown":case"ArrowUp":var s="ArrowDown"===e.key?"next":"prev",l=r.sectionIterator[s]([i,a]),c=o(l,2),u=c[0],d=c[1];n.onKeyDown(e,{newHighlightedSectionIndex:u,newHighlightedItemIndex:d});break;default:n.onKeyDown(e,{highlightedSectionIndex:i,highlightedItemIndex:a})}},r.highlightedItem=null,r.state={isInputFocused:!1},r.setSectionsItems(e),r.setSectionIterator(e),r.setTheme(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.items!==this.props.items&&this.setSectionsItems(e),e.items===this.props.items&&e.multiSection===this.props.multiSection||this.setSectionIterator(e),e.theme!==this.props.theme&&this.setTheme(e)}},{key:"componentDidUpdate",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"setSectionsItems",value:function(e){e.multiSection&&(this.sectionsItems=e.items.map((function(t){return e.getSectionItems(t)})),this.sectionsLengths=this.sectionsItems.map((function(e){return e.length})),this.allSectionsAreEmpty=this.sectionsLengths.every((function(e){return 0===e})))}},{key:"setSectionIterator",value:function(e){this.sectionIterator=(0,c.default)({multiSection:e.multiSection,data:e.multiSection?this.sectionsLengths:e.items.length})}},{key:"setTheme",value:function(e){this.theme=(0,u.default)(e.theme)}},{key:"renderSections",value:function(){var e=this;if(this.allSectionsAreEmpty)return null;var t=this.theme,r=this.props,n=r.id,o=r.items,i=r.renderItem,a=r.renderItemData,l=r.renderSectionTitle,c=r.highlightedSectionIndex,u=r.highlightedItemIndex,p=r.itemProps;return o.map((function(r,o){var f="react-autowhatever-"+n+"-",m=f+"section-"+o+"-",g=0===o;return s.default.createElement("div",t(m+"container","sectionContainer",g&&"sectionContainerFirst"),s.default.createElement(d.default,{section:r,renderSectionTitle:l,theme:t,sectionKeyPrefix:m}),s.default.createElement(h.default,{items:e.sectionsItems[o],itemProps:p,renderItem:i,renderItemData:a,sectionIndex:o,highlightedItemIndex:c===o?u:null,onHighlightedItemChange:e.onHighlightedItemChange,getItemId:e.getItemId,theme:t,keyPrefix:f,ref:e.storeItemsListReference}))}))}},{key:"renderItems",value:function(){var e=this.props.items;if(0===e.length)return null;var t=this.theme,r=this.props,n=r.id,o=r.renderItem,i=r.renderItemData,a=r.highlightedSectionIndex,l=r.highlightedItemIndex,c=r.itemProps;return s.default.createElement(h.default,{items:e,itemProps:c,renderItem:o,renderItemData:i,highlightedItemIndex:null===a?l:null,onHighlightedItemChange:this.onHighlightedItemChange,getItemId:this.getItemId,theme:t,keyPrefix:"react-autowhatever-"+n+"-"})}},{key:"ensureHighlightedItemIsVisible",value:function(){var e=this.highlightedItem;if(e){var t=this.itemsContainer,r=e.offsetParent===t?e.offsetTop:e.offsetTop-t.offsetTop,n=t.scrollTop;r<n?n=r:r+e.offsetHeight>n+t.offsetHeight&&(n=r+e.offsetHeight-t.offsetHeight),n!==t.scrollTop&&(t.scrollTop=n)}}},{key:"render",value:function(){var e=this.theme,t=this.props,r=t.id,o=t.multiSection,i=t.renderInputComponent,a=t.renderItemsContainer,l=t.highlightedSectionIndex,c=t.highlightedItemIndex,u=this.state.isInputFocused,d=o?this.renderSections():this.renderItems(),h=null!==d,p=this.getItemId(l,c),f="react-autowhatever-"+r,m=n({role:"combobox","aria-haspopup":"listbox","aria-owns":f,"aria-expanded":h},e("react-autowhatever-"+r+"-container","container",h&&"containerOpen"),this.props.containerProps),g=i(n({type:"text",value:"",autoComplete:"off","aria-autocomplete":"list","aria-controls":f,"aria-activedescendant":p},e("react-autowhatever-"+r+"-input","input",h&&"inputOpen",u&&"inputFocused"),this.props.inputProps,{onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.props.inputProps.onKeyDown&&this.onKeyDown,ref:this.storeInputReference})),b=a({containerProps:n({id:f,role:"listbox"},e("react-autowhatever-"+r+"-items-container","itemsContainer",h&&"itemsContainerOpen"),{ref:this.storeItemsContainerReference}),children:d});return s.default.createElement("div",m,g,b)}}]),t}(a.Component);m.propTypes={id:l.default.string,multiSection:l.default.bool,renderInputComponent:l.default.func,renderItemsContainer:l.default.func,items:l.default.array.isRequired,renderItem:l.default.func,renderItemData:l.default.object,renderSectionTitle:l.default.func,getSectionItems:l.default.func,containerProps:l.default.object,inputProps:l.default.object,itemProps:l.default.oneOfType([l.default.object,l.default.func]),highlightedSectionIndex:l.default.number,highlightedItemIndex:l.default.number,theme:l.default.oneOfType([l.default.object,l.default.array])},m.defaultProps={id:"1",multiSection:!1,renderInputComponent:function(e){return s.default.createElement("input",e)},renderItemsContainer:function(e){var t=e.containerProps,r=e.children;return s.default.createElement("div",t,r)},renderItem:function(){throw new Error("`renderItem` must be provided")},renderItemData:f,renderSectionTitle:function(){throw new Error("`renderSectionTitle` must be provided")},getSectionItems:function(){throw new Error("`getSectionItems` must be provided")},containerProps:f,inputProps:f,itemProps:f,highlightedSectionIndex:null,highlightedItemIndex:null,theme:{container:"react-autowhatever__container",containerOpen:"react-autowhatever__container--open",input:"react-autowhatever__input",inputOpen:"react-autowhatever__input--open",inputFocused:"react-autowhatever__input--focused",itemsContainer:"react-autowhatever__items-container",itemsContainerOpen:"react-autowhatever__items-container--open",itemsList:"react-autowhatever__items-list",item:"react-autowhatever__item",itemFirst:"react-autowhatever__item--first",itemHighlighted:"react-autowhatever__item--highlighted",sectionContainer:"react-autowhatever__section-container",sectionContainerFirst:"react-autowhatever__section-container--first",sectionTitle:"react-autowhatever__section-title"}},t.default=m},function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.exports=function(e){var t=e.data,r=e.multiSection;function o(e){var o=n(e,2),i=o[0],a=o[1];return r?null===a||a===t[i]-1?null===(i=function(e){for(null===e?e=0:e++;e<t.length&&0===t[e];)e++;return e===t.length?null:e}(i))?[null,null]:[i,0]:[i,a+1]:0===t||a===t-1?[null,null]:null===a?[null,0]:[null,a+1]}return{next:o,prev:function(e){var o=n(e,2),i=o[0],a=o[1];return r?null===a||0===a?null===(i=function(e){for(null===e?e=t.length-1:e--;e>=0&&0===t[e];)e--;return-1===e?null:e}(i))?[null,null]:[i,t[i]-1]:[i,a-1]:0===t||0===a?[null,null]:null===a?[null,t-1]:[null,a-1]},isLast:function(e){return null===o(e)[1]}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var i,a=r(223),s=(i=a)&&i.__esModule?i:{default:i},l=function(e){return e};t.default=function(e){var t=Array.isArray(e)&&2===e.length?e:[e,null],r=n(t,2),i=r[0],a=r[1];return function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var c=r.map((function(e){return i[e]})).filter(l);return"string"==typeof c[0]||"function"==typeof a?{key:e,className:a?a.apply(void 0,o(c)):c.join(" ")}:{key:e,style:s.default.apply(void 0,[{}].concat(o(c)))}}},e.exports=t.default},function(e,t,r){"use strict";var n=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(e){var t=Object.getOwnPropertyNames(e);return Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t.filter((function(t){return n.call(e,t)}))}e.exports=Object.assign||function(e,t){for(var r,n,a=o(e),s=1;s<arguments.length;s++){r=arguments[s],n=i(Object(r));for(var l=0;l<n.length;l++)a[n[l]]=r[n[l]]}return a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(1),i=l(o),a=l(r(17)),s=l(r(121));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"shouldComponentUpdate",value:function(e){return(0,s.default)(e,this.props)}},{key:"render",value:function(){var e=this.props,t=e.section,r=e.renderSectionTitle,n=e.theme,o=e.sectionKeyPrefix,a=r(t);return a?i.default.createElement("div",n(o+"title","sectionTitle"),a):null}}]),t}(o.Component);d.propTypes={section:a.default.any.isRequired,renderSectionTitle:a.default.func.isRequired,theme:a.default.func.isRequired,sectionKeyPrefix:a.default.string.isRequired},t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),a=u(i),s=u(r(17)),l=u(r(226)),c=u(r(121));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){var e,r,n;d(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return r=n=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.storeHighlightedItemReference=function(e){n.props.onHighlightedItemChange(null===e?null:e.item)},h(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"shouldComponentUpdate",value:function(e){return(0,c.default)(e,this.props,["itemProps"])}},{key:"render",value:function(){var e=this,t=this.props,r=t.items,o=t.itemProps,i=t.renderItem,s=t.renderItemData,c=t.sectionIndex,u=t.highlightedItemIndex,d=t.getItemId,h=t.theme,p=t.keyPrefix,f=null===c?p:p+"section-"+c+"-",m="function"==typeof o;return a.default.createElement("ul",n({role:"listbox"},h(f+"items-list","itemsList")),r.map((function(t,r){var p=0===r,g=r===u,b=f+"item-"+r,v=m?o({sectionIndex:c,itemIndex:r}):o,y=n({id:d(c,r),"aria-selected":g},h(b,"item",p&&"itemFirst",g&&"itemHighlighted"),v);return g&&(y.ref=e.storeHighlightedItemReference),a.default.createElement(l.default,n({},y,{sectionIndex:c,isHighlighted:g,itemIndex:r,item:t,renderItem:i,renderItemData:s}))})))}}]),t}(i.Component);p.propTypes={items:s.default.array.isRequired,itemProps:s.default.oneOfType([s.default.object,s.default.func]),renderItem:s.default.func.isRequired,renderItemData:s.default.object.isRequired,sectionIndex:s.default.number,highlightedItemIndex:s.default.number,onHighlightedItemChange:s.default.func.isRequired,getItemId:s.default.func.isRequired,theme:s.default.func.isRequired,keyPrefix:s.default.string.isRequired},p.defaultProps={sectionIndex:null},t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),a=c(i),s=c(r(17)),l=c(r(121));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){var e,r,n;u(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return r=n=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.storeItemReference=function(e){null!==e&&(n.item=e)},n.onMouseEnter=function(e){var t=n.props,r=t.sectionIndex,o=t.itemIndex;n.props.onMouseEnter(e,{sectionIndex:r,itemIndex:o})},n.onMouseLeave=function(e){var t=n.props,r=t.sectionIndex,o=t.itemIndex;n.props.onMouseLeave(e,{sectionIndex:r,itemIndex:o})},n.onMouseDown=function(e){var t=n.props,r=t.sectionIndex,o=t.itemIndex;n.props.onMouseDown(e,{sectionIndex:r,itemIndex:o})},n.onClick=function(e){var t=n.props,r=t.sectionIndex,o=t.itemIndex;n.props.onClick(e,{sectionIndex:r,itemIndex:o})},d(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"shouldComponentUpdate",value:function(e){return(0,l.default)(e,this.props,["renderItemData"])}},{key:"render",value:function(){var e=this.props,t=e.isHighlighted,r=e.item,o=e.renderItem,i=e.renderItemData,s=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["isHighlighted","item","renderItem","renderItemData"]);return delete s.sectionIndex,delete s.itemIndex,"function"==typeof s.onMouseEnter&&(s.onMouseEnter=this.onMouseEnter),"function"==typeof s.onMouseLeave&&(s.onMouseLeave=this.onMouseLeave),"function"==typeof s.onMouseDown&&(s.onMouseDown=this.onMouseDown),"function"==typeof s.onClick&&(s.onClick=this.onClick),a.default.createElement("li",n({role:"option"},s,{ref:this.storeItemReference}),o(r,n({isHighlighted:t},i)))}}]),t}(i.Component);h.propTypes={sectionIndex:s.default.number,isHighlighted:s.default.bool.isRequired,itemIndex:s.default.number.isRequired,item:s.default.any.isRequired,renderItem:s.default.func.isRequired,renderItemData:s.default.object.isRequired,onMouseEnter:s.default.func,onMouseLeave:s.default.func,onMouseDown:s.default.func,onClick:s.default.func},t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultTheme={container:"react-autosuggest__container",containerOpen:"react-autosuggest__container--open",input:"react-autosuggest__input",inputOpen:"react-autosuggest__input--open",inputFocused:"react-autosuggest__input--focused",suggestionsContainer:"react-autosuggest__suggestions-container",suggestionsContainerOpen:"react-autosuggest__suggestions-container--open",suggestionsList:"react-autosuggest__suggestions-list",suggestion:"react-autosuggest__suggestion",suggestionFirst:"react-autosuggest__suggestion--first",suggestionHighlighted:"react-autosuggest__suggestion--highlighted",sectionContainer:"react-autosuggest__section-container",sectionContainerFirst:"react-autosuggest__section-container--first",sectionTitle:"react-autosuggest__section-title"},t.mapToAutowhateverTheme=function(e){var t={};for(var r in e)switch(r){case"suggestionsContainer":t.itemsContainer=e[r];break;case"suggestionsContainerOpen":t.itemsContainerOpen=e[r];break;case"suggestion":t.item=e[r];break;case"suggestionFirst":t.itemFirst=e[r];break;case"suggestionHighlighted":t.itemHighlighted=e[r];break;case"suggestionsList":t.itemsList=e[r];break;default:t[r]=e[r]}return t}},function(e,t,r){var n=r(22),o=r(229);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,'tr .dashicon:hover {\n    cursor: pointer;\n    opacity: 0.7;\n}\n\n.jeo-layers-list .layer > div {\n\tdisplay: inline-block;\n}\n\n.jeo-layers-list .layer {\n\tdisplay: grid;\n\talign-items: center;\n    grid-template-columns: 40px 3fr 2fr 3fr 2fr 3fr 1fr;\n    grid-template-rows: repeat(3, auto);\n    grid-template-areas:\n        "a b c d e f g"\n\t\t"h h h h h h h"\n\t\t"i i i i i i i";\n}\n\n\n.jeo-layers-list .use-control > .components-base-control > div > div {\n\tflex-direction: row;\n    align-items: center;\n}\n\n.jeo-layers-list .layer-actions a {\n\ttext-decoration: none;\n}\n\n.informative-message {\n    grid-area: i;\n    margin: 0.5rem;\n}\n\n.jeo-layers-list .layers-selector {\n\tgrid-area: h;\n}\n.jeo-layers-list .layers-selector button.toggle-button svg {\n\twidth: 26px;\n\tmargin-right: 15px;\n}\n\n.jeo-layers-list .layers-selector button.toggle-button {\n\tborder: none;\n\tpadding: 0;\n\tbackground: unset;\n\twidth: 100%;\n    display: flex;\n\talign-items: center;\n    text-align: left;\n}\n\n.jeo-layers-list .layers-selector button.toggle-button.active {\n\tfont-weight: bold;\n}\n\n.jeo-layers-list button.show-style-layers {\n\tbackground: none;\n    border: 0;\n    width: 34px;\n    padding: 0 10px;\n    cursor: pointer;\n    color: #444;\n}\n\n\n.jeo-layers-list .layer > .layers-selector {\n\tcolumn-count: 4;\n\tborder-top: 2px solid #0000002e;\n    padding-top: 15px;\n    margin: 0.5rem\n}\n\n.jeo-layers-list .layer .layer-actions {\n    display: flex;\n    justify-content: flex-end;\n}\n\n.jeo-layers-list .layers-selector .style-layer {\n\tdisplay: flex;\n\talign-items: center;\n\tbreak-inside: avoid-column;\n    padding: 5px 0;\n}\n\n',""]),e.exports=t},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){var n=r(22),o=r(232);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".done-button {\n    margin: 12px 13px 0;\n}\n\n.create-layer-button {\n    margin: 0;\n}\n\n.all-layers-list {\n    display: flex;\n    flex-direction: row;\n}\n\n.all-layers-list-button {\n    margin-top: 5px;\n}\n\n.all-layers-list-link {\n    color: inherit;\n    text-decoration: none;\n}\n\n.all-layers-list-link:hover {\n    letter-spacing: 0.2;\n}\n\n.jeo-layers-library-filters, .jeo-layers-library-filters-button-filter {\n    margin-right: 5px;\n}\n\n.all-layers-list p a {\n    color: #0073aa !important;\n}\n\n.all-layers-list p a:hover {\n    color: #34a6dd !important;\n}\n\n.layer-card .layer-info{\n    margin-top: 6px;\n}\n\n.layer-card {\n    height: 80px;\n}\n\n.layer-card .layer-buttons {\n    display: none;\n}\n\n.layer-card:hover .layer-buttons {\n    display: flex;\n    flex-direction: row;\n}\n\n.layer-card:hover .add-button, .layer-card:hover .remove-button {\n    margin-top: -6px;\n}\n\n.layer-card:hover .edit-button {\n    text-decoration: none;\n}\n\n.layer-card:hover .button-divider {\n    opacity: 0.4;\n    margin: -6px 4px 0;\n}\n\n.layer-card:hover .add-button {\n    color: #0073aa;\n}\n\n.layer-card:hover .remove-button {\n    color: #a00;\n}\n\n.layer-card:hover .add-button:hover {\n    color: #34a6dd;\n    cursor: pointer;\n}\n\n.layer-card:hover .remove-button:hover {\n    color: #e63939;\n    cursor: pointer;\n}\n\n.jeo-layers-library-controls .left, .jeo-layers-library-controls .right {\n    display: flex;\n    flex-direction: row;\n}\n\n.jeo-layers-library-controls .right {\n    margin-right: 24px;\n    float: right;\n}\n\n.jeo-layers-library-controls .left {\n    float: left;\n}\n\n.jeo-layers-library-controls {\n    width: 100%;\n    display: inline-block !important;\n    overflow: auto;\n}\n\n.jeo-layers-library-controls__label {\n    margin: 6px;\n}\n\n.selected-layers-title {\n    margin-left: 12px;\n}\n\n\n",""]),e.exports=t},function(e,t,r){var n=r(22),o=r(234);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".jeo-layers-panel .components-button.is-button {\n\tmargin: 10px 10px 0;\n}\n",""]),e.exports=t},function(e,t,r){var n=r(22),o=r(236);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,'.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle, .react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle, .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view--down-arrow {\n  margin-left: -8px;\n  position: absolute;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle, .react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle, .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view--down-arrow, .react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle::before, .react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle::before, .react-datepicker__year-read-view--down-arrow::before,\n.react-datepicker__month-read-view--down-arrow::before,\n.react-datepicker__month-year-read-view--down-arrow::before {\n  box-sizing: content-box;\n  position: absolute;\n  border: 8px solid transparent;\n  height: 0;\n  width: 1px;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle::before, .react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle::before, .react-datepicker__year-read-view--down-arrow::before,\n.react-datepicker__month-read-view--down-arrow::before,\n.react-datepicker__month-year-read-view--down-arrow::before {\n  content: "";\n  z-index: -1;\n  border-width: 8px;\n  left: -8px;\n  border-bottom-color: #aeaeae;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle {\n  top: 0;\n  margin-top: -8px;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle, .react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle::before {\n  border-top: none;\n  border-bottom-color: #f0f0f0;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] .react-datepicker__triangle::before {\n  top: -1px;\n  border-bottom-color: #aeaeae;\n}\n\n.react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle, .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view--down-arrow {\n  bottom: 0;\n  margin-bottom: -8px;\n}\n\n.react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle, .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view--down-arrow, .react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle::before, .react-datepicker__year-read-view--down-arrow::before,\n.react-datepicker__month-read-view--down-arrow::before,\n.react-datepicker__month-year-read-view--down-arrow::before {\n  border-bottom: none;\n  border-top-color: #fff;\n}\n\n.react-datepicker-popper[data-placement^="top"] .react-datepicker__triangle::before, .react-datepicker__year-read-view--down-arrow::before,\n.react-datepicker__month-read-view--down-arrow::before,\n.react-datepicker__month-year-read-view--down-arrow::before {\n  bottom: -1px;\n  border-top-color: #aeaeae;\n}\n\n.react-datepicker-wrapper {\n  display: inline-block;\n  padding: 0;\n  border: 0;\n}\n\n.react-datepicker {\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  font-size: 0.8rem;\n  background-color: #fff;\n  color: #000;\n  border: 1px solid #aeaeae;\n  border-radius: 0.3rem;\n  display: inline-block;\n  position: relative;\n}\n\n.react-datepicker--time-only .react-datepicker__triangle {\n  left: 35px;\n}\n\n.react-datepicker--time-only .react-datepicker__time-container {\n  border-left: 0;\n}\n\n.react-datepicker--time-only .react-datepicker__time {\n  border-radius: 0.3rem;\n}\n\n.react-datepicker--time-only .react-datepicker__time-box {\n  border-radius: 0.3rem;\n}\n\n.react-datepicker__triangle {\n  position: absolute;\n  left: 50px;\n}\n\n.react-datepicker-popper {\n  z-index: 1;\n}\n\n.react-datepicker-popper[data-placement^="bottom"] {\n  margin-top: 10px;\n}\n\n.react-datepicker-popper[data-placement="bottom-end"] .react-datepicker__triangle, .react-datepicker-popper[data-placement="top-end"] .react-datepicker__triangle {\n  left: auto;\n  right: 50px;\n}\n\n.react-datepicker-popper[data-placement^="top"] {\n  margin-bottom: 10px;\n}\n\n.react-datepicker-popper[data-placement^="right"] {\n  margin-left: 8px;\n}\n\n.react-datepicker-popper[data-placement^="right"] .react-datepicker__triangle {\n  left: auto;\n  right: 42px;\n}\n\n.react-datepicker-popper[data-placement^="left"] {\n  margin-right: 8px;\n}\n\n.react-datepicker-popper[data-placement^="left"] .react-datepicker__triangle {\n  left: 42px;\n  right: auto;\n}\n\n.react-datepicker__header {\n  text-align: center;\n  background-color: #f0f0f0;\n  border-bottom: 1px solid #aeaeae;\n  border-top-left-radius: 0.3rem;\n  border-top-right-radius: 0.3rem;\n  padding-top: 8px;\n  position: relative;\n}\n\n.react-datepicker__header--time {\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.react-datepicker__year-dropdown-container--select,\n.react-datepicker__month-dropdown-container--select,\n.react-datepicker__month-year-dropdown-container--select,\n.react-datepicker__year-dropdown-container--scroll,\n.react-datepicker__month-dropdown-container--scroll,\n.react-datepicker__month-year-dropdown-container--scroll {\n  display: inline-block;\n  margin: 0 2px;\n}\n\n.react-datepicker__current-month,\n.react-datepicker-time__header,\n.react-datepicker-year-header {\n  margin-top: 0;\n  color: #000;\n  font-weight: bold;\n  font-size: 0.944rem;\n}\n\n.react-datepicker-time__header {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n}\n\n.react-datepicker__navigation {\n  background: none;\n  line-height: 1.7rem;\n  text-align: center;\n  cursor: pointer;\n  position: absolute;\n  top: 10px;\n  width: 0;\n  padding: 0;\n  border: 0.45rem solid transparent;\n  z-index: 1;\n  height: 10px;\n  width: 10px;\n  text-indent: -999em;\n  overflow: hidden;\n}\n\n.react-datepicker__navigation--previous {\n  left: 10px;\n  border-right-color: #ccc;\n}\n\n.react-datepicker__navigation--previous:hover {\n  border-right-color: #b3b3b3;\n}\n\n.react-datepicker__navigation--previous--disabled, .react-datepicker__navigation--previous--disabled:hover {\n  border-right-color: #e6e6e6;\n  cursor: default;\n}\n\n.react-datepicker__navigation--next {\n  right: 10px;\n  border-left-color: #ccc;\n}\n\n.react-datepicker__navigation--next--with-time:not(.react-datepicker__navigation--next--with-today-button) {\n  right: 80px;\n}\n\n.react-datepicker__navigation--next:hover {\n  border-left-color: #b3b3b3;\n}\n\n.react-datepicker__navigation--next--disabled, .react-datepicker__navigation--next--disabled:hover {\n  border-left-color: #e6e6e6;\n  cursor: default;\n}\n\n.react-datepicker__navigation--years {\n  position: relative;\n  top: 0;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.react-datepicker__navigation--years-previous {\n  top: 4px;\n  border-top-color: #ccc;\n}\n\n.react-datepicker__navigation--years-previous:hover {\n  border-top-color: #b3b3b3;\n}\n\n.react-datepicker__navigation--years-upcoming {\n  top: -4px;\n  border-bottom-color: #ccc;\n}\n\n.react-datepicker__navigation--years-upcoming:hover {\n  border-bottom-color: #b3b3b3;\n}\n\n.react-datepicker__month-container {\n  float: left;\n}\n\n.react-datepicker__year-container {\n  margin: 0.4rem;\n  text-align: center;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.react-datepicker__year-container-text {\n  display: inline-block;\n  cursor: pointer;\n  flex: 1 0 30%;\n  width: 12px;\n  padding: 2px;\n}\n\n.react-datepicker__month {\n  margin: 0.4rem;\n  text-align: center;\n}\n\n.react-datepicker__month .react-datepicker__month-text,\n.react-datepicker__month .react-datepicker__quarter-text {\n  display: inline-block;\n  width: 4rem;\n  margin: 2px;\n}\n\n.react-datepicker__input-time-container {\n  clear: both;\n  width: 100%;\n  float: left;\n  margin: 5px 0 10px 15px;\n  text-align: left;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__caption {\n  display: inline-block;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container {\n  display: inline-block;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input {\n  display: inline-block;\n  margin-left: 10px;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input {\n  width: 85px;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type="time"]::-webkit-inner-spin-button,\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type="time"]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type="time"] {\n  -moz-appearance: textfield;\n}\n\n.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__delimiter {\n  margin-left: 5px;\n  display: inline-block;\n}\n\n.react-datepicker__time-container {\n  float: right;\n  border-left: 1px solid #aeaeae;\n  width: 85px;\n}\n\n.react-datepicker__time-container--with-today-button {\n  display: inline;\n  border: 1px solid #aeaeae;\n  border-radius: 0.3rem;\n  position: absolute;\n  right: -72px;\n  top: 0;\n}\n\n.react-datepicker__time-container .react-datepicker__time {\n  position: relative;\n  background: white;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box {\n  width: 85px;\n  overflow-x: hidden;\n  margin: 0 auto;\n  text-align: center;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list {\n  list-style: none;\n  margin: 0;\n  height: calc(195px + (1.7rem / 2));\n  overflow-y: scroll;\n  padding-right: 0px;\n  padding-left: 0px;\n  width: 100%;\n  box-sizing: content-box;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item {\n  height: 30px;\n  padding: 5px 10px;\n  white-space: nowrap;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item:hover {\n  cursor: pointer;\n  background-color: #f0f0f0;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--selected {\n  background-color: #216ba5;\n  color: white;\n  font-weight: bold;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--selected:hover {\n  background-color: #216ba5;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--disabled {\n  color: #ccc;\n}\n\n.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--disabled:hover {\n  cursor: default;\n  background-color: transparent;\n}\n\n.react-datepicker__week-number {\n  color: #ccc;\n  display: inline-block;\n  width: 1.7rem;\n  line-height: 1.7rem;\n  text-align: center;\n  margin: 0.166rem;\n}\n\n.react-datepicker__week-number.react-datepicker__week-number--clickable {\n  cursor: pointer;\n}\n\n.react-datepicker__week-number.react-datepicker__week-number--clickable:hover {\n  border-radius: 0.3rem;\n  background-color: #f0f0f0;\n}\n\n.react-datepicker__day-names,\n.react-datepicker__week {\n  white-space: nowrap;\n}\n\n.react-datepicker__day-name,\n.react-datepicker__day,\n.react-datepicker__time-name {\n  color: #000;\n  display: inline-block;\n  width: 1.7rem;\n  line-height: 1.7rem;\n  text-align: center;\n  margin: 0.166rem;\n}\n\n.react-datepicker__month--selected, .react-datepicker__month--in-selecting-range, .react-datepicker__month--in-range,\n.react-datepicker__quarter--selected,\n.react-datepicker__quarter--in-selecting-range,\n.react-datepicker__quarter--in-range {\n  border-radius: 0.3rem;\n  background-color: #216ba5;\n  color: #fff;\n}\n\n.react-datepicker__month--selected:hover, .react-datepicker__month--in-selecting-range:hover, .react-datepicker__month--in-range:hover,\n.react-datepicker__quarter--selected:hover,\n.react-datepicker__quarter--in-selecting-range:hover,\n.react-datepicker__quarter--in-range:hover {\n  background-color: #1d5d90;\n}\n\n.react-datepicker__month--disabled,\n.react-datepicker__quarter--disabled {\n  color: #ccc;\n  pointer-events: none;\n}\n\n.react-datepicker__month--disabled:hover,\n.react-datepicker__quarter--disabled:hover {\n  cursor: default;\n  background-color: transparent;\n}\n\n.react-datepicker__day,\n.react-datepicker__month-text,\n.react-datepicker__quarter-text {\n  cursor: pointer;\n}\n\n.react-datepicker__day:hover,\n.react-datepicker__month-text:hover,\n.react-datepicker__quarter-text:hover {\n  border-radius: 0.3rem;\n  background-color: #f0f0f0;\n}\n\n.react-datepicker__day--today,\n.react-datepicker__month-text--today,\n.react-datepicker__quarter-text--today {\n  font-weight: bold;\n}\n\n.react-datepicker__day--highlighted,\n.react-datepicker__month-text--highlighted,\n.react-datepicker__quarter-text--highlighted {\n  border-radius: 0.3rem;\n  background-color: #3dcc4a;\n  color: #fff;\n}\n\n.react-datepicker__day--highlighted:hover,\n.react-datepicker__month-text--highlighted:hover,\n.react-datepicker__quarter-text--highlighted:hover {\n  background-color: #32be3f;\n}\n\n.react-datepicker__day--highlighted-custom-1,\n.react-datepicker__month-text--highlighted-custom-1,\n.react-datepicker__quarter-text--highlighted-custom-1 {\n  color: magenta;\n}\n\n.react-datepicker__day--highlighted-custom-2,\n.react-datepicker__month-text--highlighted-custom-2,\n.react-datepicker__quarter-text--highlighted-custom-2 {\n  color: green;\n}\n\n.react-datepicker__day--selected, .react-datepicker__day--in-selecting-range, .react-datepicker__day--in-range,\n.react-datepicker__month-text--selected,\n.react-datepicker__month-text--in-selecting-range,\n.react-datepicker__month-text--in-range,\n.react-datepicker__quarter-text--selected,\n.react-datepicker__quarter-text--in-selecting-range,\n.react-datepicker__quarter-text--in-range {\n  border-radius: 0.3rem;\n  background-color: #216ba5;\n  color: #fff;\n}\n\n.react-datepicker__day--selected:hover, .react-datepicker__day--in-selecting-range:hover, .react-datepicker__day--in-range:hover,\n.react-datepicker__month-text--selected:hover,\n.react-datepicker__month-text--in-selecting-range:hover,\n.react-datepicker__month-text--in-range:hover,\n.react-datepicker__quarter-text--selected:hover,\n.react-datepicker__quarter-text--in-selecting-range:hover,\n.react-datepicker__quarter-text--in-range:hover {\n  background-color: #1d5d90;\n}\n\n.react-datepicker__day--keyboard-selected,\n.react-datepicker__month-text--keyboard-selected,\n.react-datepicker__quarter-text--keyboard-selected {\n  border-radius: 0.3rem;\n  background-color: #2a87d0;\n  color: #fff;\n}\n\n.react-datepicker__day--keyboard-selected:hover,\n.react-datepicker__month-text--keyboard-selected:hover,\n.react-datepicker__quarter-text--keyboard-selected:hover {\n  background-color: #1d5d90;\n}\n\n.react-datepicker__day--in-selecting-range ,\n.react-datepicker__month-text--in-selecting-range ,\n.react-datepicker__quarter-text--in-selecting-range {\n  background-color: rgba(33, 107, 165, 0.5);\n}\n\n.react-datepicker__month--selecting-range .react-datepicker__day--in-range , .react-datepicker__month--selecting-range\n.react-datepicker__month-text--in-range , .react-datepicker__month--selecting-range\n.react-datepicker__quarter-text--in-range {\n  background-color: #f0f0f0;\n  color: #000;\n}\n\n.react-datepicker__day--disabled,\n.react-datepicker__month-text--disabled,\n.react-datepicker__quarter-text--disabled {\n  cursor: default;\n  color: #ccc;\n}\n\n.react-datepicker__day--disabled:hover,\n.react-datepicker__month-text--disabled:hover,\n.react-datepicker__quarter-text--disabled:hover {\n  background-color: transparent;\n}\n\n.react-datepicker__month-text.react-datepicker__month--selected:hover, .react-datepicker__month-text.react-datepicker__month--in-range:hover, .react-datepicker__month-text.react-datepicker__quarter--selected:hover, .react-datepicker__month-text.react-datepicker__quarter--in-range:hover,\n.react-datepicker__quarter-text.react-datepicker__month--selected:hover,\n.react-datepicker__quarter-text.react-datepicker__month--in-range:hover,\n.react-datepicker__quarter-text.react-datepicker__quarter--selected:hover,\n.react-datepicker__quarter-text.react-datepicker__quarter--in-range:hover {\n  background-color: #216ba5;\n}\n\n.react-datepicker__month-text:hover,\n.react-datepicker__quarter-text:hover {\n  background-color: #f0f0f0;\n}\n\n.react-datepicker__input-container {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n}\n\n.react-datepicker__year-read-view,\n.react-datepicker__month-read-view,\n.react-datepicker__month-year-read-view {\n  border: 1px solid transparent;\n  border-radius: 0.3rem;\n}\n\n.react-datepicker__year-read-view:hover,\n.react-datepicker__month-read-view:hover,\n.react-datepicker__month-year-read-view:hover {\n  cursor: pointer;\n}\n\n.react-datepicker__year-read-view:hover .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__year-read-view:hover .react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-read-view:hover .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view:hover .react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view:hover .react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-year-read-view:hover .react-datepicker__month-read-view--down-arrow {\n  border-top-color: #b3b3b3;\n}\n\n.react-datepicker__year-read-view--down-arrow,\n.react-datepicker__month-read-view--down-arrow,\n.react-datepicker__month-year-read-view--down-arrow {\n  border-top-color: #ccc;\n  float: right;\n  margin-left: 20px;\n  top: 8px;\n  position: relative;\n  border-width: 0.45rem;\n}\n\n.react-datepicker__year-dropdown,\n.react-datepicker__month-dropdown,\n.react-datepicker__month-year-dropdown {\n  background-color: #f0f0f0;\n  position: absolute;\n  width: 50%;\n  left: 25%;\n  top: 30px;\n  z-index: 1;\n  text-align: center;\n  border-radius: 0.3rem;\n  border: 1px solid #aeaeae;\n}\n\n.react-datepicker__year-dropdown:hover,\n.react-datepicker__month-dropdown:hover,\n.react-datepicker__month-year-dropdown:hover {\n  cursor: pointer;\n}\n\n.react-datepicker__year-dropdown--scrollable,\n.react-datepicker__month-dropdown--scrollable,\n.react-datepicker__month-year-dropdown--scrollable {\n  height: 150px;\n  overflow-y: scroll;\n}\n\n.react-datepicker__year-option,\n.react-datepicker__month-option,\n.react-datepicker__month-year-option {\n  line-height: 20px;\n  width: 100%;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.react-datepicker__year-option:first-of-type,\n.react-datepicker__month-option:first-of-type,\n.react-datepicker__month-year-option:first-of-type {\n  border-top-left-radius: 0.3rem;\n  border-top-right-radius: 0.3rem;\n}\n\n.react-datepicker__year-option:last-of-type,\n.react-datepicker__month-option:last-of-type,\n.react-datepicker__month-year-option:last-of-type {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  border-bottom-left-radius: 0.3rem;\n  border-bottom-right-radius: 0.3rem;\n}\n\n.react-datepicker__year-option:hover,\n.react-datepicker__month-option:hover,\n.react-datepicker__month-year-option:hover {\n  background-color: #ccc;\n}\n\n.react-datepicker__year-option:hover .react-datepicker__navigation--years-upcoming,\n.react-datepicker__month-option:hover .react-datepicker__navigation--years-upcoming,\n.react-datepicker__month-year-option:hover .react-datepicker__navigation--years-upcoming {\n  border-bottom-color: #b3b3b3;\n}\n\n.react-datepicker__year-option:hover .react-datepicker__navigation--years-previous,\n.react-datepicker__month-option:hover .react-datepicker__navigation--years-previous,\n.react-datepicker__month-year-option:hover .react-datepicker__navigation--years-previous {\n  border-top-color: #b3b3b3;\n}\n\n.react-datepicker__year-option--selected,\n.react-datepicker__month-option--selected,\n.react-datepicker__month-year-option--selected {\n  position: absolute;\n  left: 15px;\n}\n\n.react-datepicker__close-icon {\n  cursor: pointer;\n  background-color: transparent;\n  border: 0;\n  outline: 0;\n  padding: 0px 6px 0px 0px;\n  position: absolute;\n  top: 0;\n  right: 0;\n  height: 100%;\n  display: table-cell;\n  vertical-align: middle;\n}\n\n.react-datepicker__close-icon::after {\n  cursor: pointer;\n  background-color: #216ba5;\n  color: #fff;\n  border-radius: 50%;\n  height: 16px;\n  width: 16px;\n  padding: 2px;\n  font-size: 12px;\n  line-height: 1;\n  text-align: center;\n  display: table-cell;\n  vertical-align: middle;\n  content: "\\00d7";\n}\n\n.react-datepicker__today-button {\n  background: #f0f0f0;\n  border-top: 1px solid #aeaeae;\n  cursor: pointer;\n  text-align: center;\n  font-weight: bold;\n  padding: 5px 0;\n  clear: left;\n}\n\n.react-datepicker__portal {\n  position: fixed;\n  width: 100vw;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.8);\n  left: 0;\n  top: 0;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  z-index: 2147483647;\n}\n\n.react-datepicker__portal .react-datepicker__day-name,\n.react-datepicker__portal .react-datepicker__day,\n.react-datepicker__portal .react-datepicker__time-name {\n  width: 3rem;\n  line-height: 3rem;\n}\n\n@media (max-width: 400px), (max-height: 550px) {\n  .react-datepicker__portal .react-datepicker__day-name,\n  .react-datepicker__portal .react-datepicker__day,\n  .react-datepicker__portal .react-datepicker__time-name {\n    width: 2rem;\n    line-height: 2rem;\n  }\n}\n\n.react-datepicker__portal .react-datepicker__current-month,\n.react-datepicker__portal .react-datepicker-time__header {\n  font-size: 1.44rem;\n}\n\n.react-datepicker__portal .react-datepicker__navigation {\n  border: 0.81rem solid transparent;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--previous {\n  border-right-color: #ccc;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--previous:hover {\n  border-right-color: #b3b3b3;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--previous--disabled, .react-datepicker__portal .react-datepicker__navigation--previous--disabled:hover {\n  border-right-color: #e6e6e6;\n  cursor: default;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--next {\n  border-left-color: #ccc;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--next:hover {\n  border-left-color: #b3b3b3;\n}\n\n.react-datepicker__portal .react-datepicker__navigation--next--disabled, .react-datepicker__portal .react-datepicker__navigation--next--disabled:hover {\n  border-left-color: #e6e6e6;\n  cursor: default;\n}\n',""]),e.exports=t},function(e,t,r){var n=r(22),o=r(238);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".jeo-interval-selector .empty-selector input {\n\tcolor: gray;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return o}));var n=r(3);function o(e){return Object(n.a)(1,arguments),e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(128),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(129),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(77),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(130),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(78),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(131),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(t);return Object(o.default)(e,-r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getSeconds();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getMinutes();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getHours();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getDay();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getDate();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getMonth();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=Math.floor(t.getMonth()/3)+1;return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getFullYear();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getTime();return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);return r.setSeconds(a),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);return r.setMinutes(a),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);return r.setHours(a),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var n=r(6),o=r(4),i=r(133),a=r(3);function s(e,t){Object(a.a)(2,arguments);var r=Object(o.default)(e),s=Object(n.a)(t),l=Math.floor(r.getMonth()/3)+1,c=s-l;return Object(i.default)(r,r.getMonth()+3*c)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(6),o=r(4),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(n.a)(t);return isNaN(r)?new Date(NaN):(r.setFullYear(a),r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){var t,r;if(Object(o.a)(1,arguments),e&&"function"==typeof e.forEach)t=e;else{if("object"!=typeof e||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=Object(n.default)(e);(void 0===r||r>t||isNaN(t))&&(r=t)})),r||new Date(NaN)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){var t,r;if(Object(o.a)(1,arguments),e&&"function"==typeof e.forEach)t=e;else{if("object"!=typeof e||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=Object(n.default)(e);(void 0===r||r<t||isNaN(t))&&(r=t)})),r||new Date(NaN)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(37),o=r(58),i=r(3);function a(e,t){Object(i.a)(2,arguments);var r=Object(o.default)(e),a=Object(o.default)(t),s=r.getTime()-Object(n.a)(r),l=a.getTime()-Object(n.a)(a);return Math.round((s-l)/864e5)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t),a=r.getFullYear()-i.getFullYear(),s=r.getMonth()-i.getMonth();return 12*a+s}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(30),o=r(37),i=r(3);function a(e,t,r){Object(i.a)(2,arguments);var a=Object(n.default)(e,r),s=Object(n.default)(t,r),l=a.getTime()-Object(o.a)(a),c=s.getTime()-Object(o.a)(s);return Math.round((l-c)/6048e5)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getFullYear()-i.getFullYear()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e);return t.setDate(1),t.setHours(0,0,0,0),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e);return t.setHours(23,59,59,999),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r(4),o=r(6),i=r(3);function a(e,t){Object(i.a)(1,arguments);var r=t||{},a=r.locale,s=a&&a.options&&a.options.weekStartsOn,l=null==s?0:Object(o.a)(s),c=null==r.weekStartsOn?l:Object(o.a)(r.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=Object(n.default)(e),d=u.getDay(),h=6+(d<c?-7:0)-(d-c);return u.setDate(u.getDate()+h),u.setHours(23,59,59,999),u}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e){Object(o.a)(1,arguments);var t=Object(n.default)(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getTime()===i.getTime()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(58),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getTime()===i.getTime()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getFullYear()===i.getFullYear()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(97),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getTime()===i.getTime()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getTime()>i.getTime()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=Object(n.default)(e),i=Object(n.default)(t);return r.getTime()<i.getTime()}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r(4),o=r(3);function i(e,t){Object(o.a)(2,arguments);var r=t||{},i=Object(n.default)(e).getTime(),a=Object(n.default)(r.start).getTime(),s=Object(n.default)(r.end).getTime();if(!(a<=s))throw new RangeError("Invalid interval");return i>=a&&i<=s}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c}));var n=r(6),o=r(3),i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},a=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,l=/^([+-])(\d{2})(?::?(\d{2}))?$/;function c(e,t){Object(o.a)(1,arguments);var r=t||{},i=null==r.additionalDigits?2:Object(n.a)(r.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var a,s=u(e);if(s.date){var l=d(s.date,i);a=h(l.restDateString,l.year)}if(isNaN(a)||!a)return new Date(NaN);var c,p=a.getTime(),m=0;if(s.time&&(m=f(s.time),isNaN(m)||null===m))return new Date(NaN);if(!s.timezone){var b=new Date(p+m),v=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds());return v.setFullYear(b.getUTCFullYear()),v}return c=g(s.timezone),isNaN(c)?new Date(NaN):new Date(p+m+c)}function u(e){var t,r={},n=e.split(i.dateTimeDelimiter);if(n.length>2)return r;if(/:/.test(n[0])?(r.date=null,t=n[0]):(r.date=n[0],t=n[1],i.timeZoneDelimiter.test(r.date)&&(r.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){var o=i.timezone.exec(t);o?(r.time=t.replace(o[1],""),r.timezone=o[1]):r.time=t}return r}function d(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:null};var o=n[1]&&parseInt(n[1]),i=n[2]&&parseInt(n[2]);return{year:null==i?o:100*i,restDateString:e.slice((n[1]||n[2]).length)}}function h(e,t){if(null===t)return null;var r=e.match(a);if(!r)return null;var n=!!r[4],o=p(r[1]),i=p(r[2])-1,s=p(r[3]),l=p(r[4]),c=p(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,l,c)?function(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var o=n.getUTCDay()||7,i=7*(t-1)+r+1-o;return n.setUTCDate(n.getUTCDate()+i),n}(t,l,c):new Date(NaN);var u=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(b[t]||(v(e)?29:28))}(t,i,s)&&function(e,t){return t>=1&&t<=(v(e)?366:365)}(t,o)?(u.setUTCFullYear(t,i,Math.max(o,s)),u):new Date(NaN)}function p(e){return e?parseInt(e):1}function f(e){var t=e.match(s);if(!t)return null;var r=m(t[1]),n=m(t[2]),o=m(t[3]);return function(e,t,r){if(24===e)return 0===t&&0===r;return r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,n,o)?36e5*r+6e4*n+1e3*o:NaN}function m(e){return e&&parseFloat(e.replace(",","."))||0}function g(e){if("Z"===e)return 0;var t=e.match(l);if(!t)return 0;var r="+"===t[1]?-1:1,n=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,o)?r*(36e5*n+6e4*o):NaN}var b=[31,null,31,30,31,30,31,31,30,31,30,31];function v(e){return e%400==0||e%4==0&&e%100}},function(e,t,r){"use strict";r.r(t),r.d(t,"IGNORE_CLASS_NAME",(function(){return h}));var n=r(1),o=r(28);function i(e,t,r){return e===t||(e.correspondingElement?e.correspondingElement.classList.contains(r):e.classList.contains(r))}var a,s,l=(void 0===a&&(a=0),function(){return++a}),c={},u={},d=["touchstart","touchmove"],h="ignore-react-onclickoutside";function p(e,t){var r=null;return-1!==d.indexOf(t)&&s&&(r={passive:!e.props.preventDefault}),r}t.default=function(e,t){var r,a,d=e.displayName||e.name||"Component";return a=r=function(r){var a,h;function f(e){var n;return(n=r.call(this,e)||this).__outsideClickHandler=function(e){if("function"!=typeof n.__clickOutsideHandlerProp){var t=n.getInstance();if("function"!=typeof t.props.handleClickOutside){if("function"!=typeof t.handleClickOutside)throw new Error("WrappedComponent: "+d+" lacks a handleClickOutside(event) function for processing outside click events.");t.handleClickOutside(e)}else t.props.handleClickOutside(e)}else n.__clickOutsideHandlerProp(e)},n.__getComponentNode=function(){var e=n.getInstance();return t&&"function"==typeof t.setClickOutsideRef?t.setClickOutsideRef()(e):"function"==typeof e.setClickOutsideRef?e.setClickOutsideRef():Object(o.findDOMNode)(e)},n.enableOnClickOutside=function(){if("undefined"!=typeof document&&!u[n._uid]){void 0===s&&(s=function(){if("undefined"!=typeof window&&"function"==typeof window.addEventListener){var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),r=function(){};return window.addEventListener("testPassiveEventSupport",r,t),window.removeEventListener("testPassiveEventSupport",r,t),e}}()),u[n._uid]=!0;var e=n.props.eventTypes;e.forEach||(e=[e]),c[n._uid]=function(e){var t;null!==n.componentNode&&(n.props.preventDefault&&e.preventDefault(),n.props.stopPropagation&&e.stopPropagation(),n.props.excludeScrollbar&&(t=e,document.documentElement.clientWidth<=t.clientX||document.documentElement.clientHeight<=t.clientY)||function(e,t,r){if(e===t)return!0;for(;e.parentNode;){if(i(e,t,r))return!0;e=e.parentNode}return e}(e.target,n.componentNode,n.props.outsideClickIgnoreClass)===document&&n.__outsideClickHandler(e))},e.forEach((function(e){document.addEventListener(e,c[n._uid],p(n,e))}))}},n.disableOnClickOutside=function(){delete u[n._uid];var e=c[n._uid];if(e&&"undefined"!=typeof document){var t=n.props.eventTypes;t.forEach||(t=[t]),t.forEach((function(t){return document.removeEventListener(t,e,p(n,t))})),delete c[n._uid]}},n.getRef=function(e){return n.instanceRef=e},n._uid=l(),n}h=r,(a=f).prototype=Object.create(h.prototype),a.prototype.constructor=a,a.__proto__=h;var m=f.prototype;return m.getInstance=function(){if(!e.prototype.isReactComponent)return this;var t=this.instanceRef;return t.getInstance?t.getInstance():t},m.componentDidMount=function(){if("undefined"!=typeof document&&document.createElement){var e=this.getInstance();if(t&&"function"==typeof t.handleClickOutside&&(this.__clickOutsideHandlerProp=t.handleClickOutside(e),"function"!=typeof this.__clickOutsideHandlerProp))throw new Error("WrappedComponent: "+d+" lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=this.__getComponentNode(),this.props.disableOnClickOutside||this.enableOnClickOutside()}},m.componentDidUpdate=function(){this.componentNode=this.__getComponentNode()},m.componentWillUnmount=function(){this.disableOnClickOutside()},m.render=function(){var t=this.props,r=(t.excludeScrollbar,function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,["excludeScrollbar"]));return e.prototype.isReactComponent?r.ref=this.getRef:r.wrappedRef=this.getRef,r.disableOnClickOutside=this.disableOnClickOutside,r.enableOnClickOutside=this.enableOnClickOutside,Object(n.createElement)(e,r)},f}(n.Component),r.displayName="OnClickOutside("+d+")",r.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:t&&t.excludeScrollbar||!1,outsideClickIgnoreClass:h,preventDefault:!1,stopPropagation:!1},r.getClass=function(){return e.getClass?e.getClass():e},a}},function(e,t,r){"use strict";var n;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=r(153),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),c=s.call((function(){}),"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&o.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===i.call(e),n=a(e),s=t&&"[object String]"===i.call(e),h=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var f=c&&r;if(s&&e.length>0&&!o.call(e,0))for(var m=0;m<e.length;++m)h.push(String(m));if(n&&e.length>0)for(var g=0;g<e.length;++g)h.push(String(g));else for(var b in e)f&&"prototype"===b||!o.call(e,b)||h.push(String(b));if(l)for(var v=function(e){if("undefined"==typeof window||!p)return d(e);try{return d(e)}catch(e){return!1}}(e),y=0;y<u.length;++y)v&&"constructor"===u[y]||!o.call(e,u[y])||h.push(u[y]);return h}}e.exports=n},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,o=r(283)("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},a=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},s=function(){return i(arguments)}();i.isLegacyArguments=a,e.exports=s?i:a},function(e,t,r){"use strict";var n=r(154),o=r(155),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},function(e,t,r){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},function(e,t,r){"use strict";var n="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.call(t))throw new TypeError(n+t);for(var r,a=o.call(arguments,1),s=function(){if(this instanceof r){var n=t.apply(this,a.concat(o.call(arguments)));return Object(n)===n?n:this}return t.apply(e,a.concat(o.call(arguments)))},l=Math.max(0,t.length-a.length),c=[],u=0;u<l;u++)c.push("$"+u);if(r=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var d=function(){};d.prototype=t.prototype,r.prototype=new d,d.prototype=null}return r}},function(e,t,r){"use strict";var n=r(71);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,r){"use strict";var n=r(72),o=r(155),i=r(156),a=r(157),s=r(288),l=o(a(),Object);n(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},function(e,t,r){"use strict";var n=r(157),o=r(72);e.exports=function(){var e=n();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},function(e,t,r){"use strict";var n,o,i,a,s=r(122)()&&"symbol"==typeof Symbol.toStringTag;if(s){n=Function.call.bind(Object.prototype.hasOwnProperty),o=Function.call.bind(RegExp.prototype.exec),i={};var l=function(){throw i};a={toString:l,valueOf:l},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=l)}var c=Object.prototype.toString,u=Object.getOwnPropertyDescriptor;e.exports=s?function(e){if(!e||"object"!=typeof e)return!1;var t=u(e,"lastIndex");if(!(t&&n(t,"value")))return!1;try{o(e,a)}catch(e){return e===i}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===c.call(e)}},function(e,t,r){"use strict";var n=r(72),o=r(291),i=r(158),a=r(159),s=r(293),l=o(i);n(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},function(e,t,r){"use strict";var n=r(71),o=r(292),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||n.call(a,i),l=o("%Object.defineProperty%",!0);if(l)try{l({},"a",{value:1})}catch(e){l=null}e.exports=function(){return s(n,a,arguments)};var c=function(){return s(n,i,arguments)};l?l(e.exports,"apply",{value:c}):e.exports.apply=c},function(e,t,r){"use strict";var n=TypeError,o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch(e){o=null}var i=function(){throw new n},a=o?function(){try{return i}catch(e){try{return o(arguments,"callee").get}catch(e){return i}}}():i,s=r(122)(),l=Object.getPrototypeOf||function(e){return e.__proto__},c=void 0,u="undefined"==typeof Uint8Array?void 0:l(Uint8Array),d={"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"%ArrayIteratorPrototype%":s?l([][Symbol.iterator]()):void 0,"%ArrayPrototype%":Array.prototype,"%ArrayProto_entries%":Array.prototype.entries,"%ArrayProto_forEach%":Array.prototype.forEach,"%ArrayProto_keys%":Array.prototype.keys,"%ArrayProto_values%":Array.prototype.values,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":void 0,"%AsyncFunctionPrototype%":void 0,"%AsyncGenerator%":void 0,"%AsyncGeneratorFunction%":void 0,"%AsyncGeneratorPrototype%":void 0,"%AsyncIteratorPrototype%":c&&s&&Symbol.asyncIterator?c[Symbol.asyncIterator]():void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%Boolean%":Boolean,"%BooleanPrototype%":Boolean.prototype,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"%Date%":Date,"%DatePrototype%":Date.prototype,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%ErrorPrototype%":Error.prototype,"%eval%":eval,"%EvalError%":EvalError,"%EvalErrorPrototype%":EvalError.prototype,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"%Function%":Function,"%FunctionPrototype%":Function.prototype,"%Generator%":void 0,"%GeneratorFunction%":void 0,"%GeneratorPrototype%":void 0,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":s?l(l([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%JSONParse%":"object"==typeof JSON?JSON.parse:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&s?l((new Map)[Symbol.iterator]()):void 0,"%MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"%Math%":Math,"%Number%":Number,"%NumberPrototype%":Number.prototype,"%Object%":Object,"%ObjectPrototype%":Object.prototype,"%ObjProto_toString%":Object.prototype.toString,"%ObjProto_valueOf%":Object.prototype.valueOf,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"%PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"%Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"%Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"%Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%RangeErrorPrototype%":RangeError.prototype,"%ReferenceError%":ReferenceError,"%ReferenceErrorPrototype%":ReferenceError.prototype,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%RegExpPrototype%":RegExp.prototype,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&s?l((new Set)[Symbol.iterator]()):void 0,"%SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"%String%":String,"%StringIteratorPrototype%":s?l(""[Symbol.iterator]()):void 0,"%StringPrototype%":String.prototype,"%Symbol%":s?Symbol:void 0,"%SymbolPrototype%":s?Symbol.prototype:void 0,"%SyntaxError%":SyntaxError,"%SyntaxErrorPrototype%":SyntaxError.prototype,"%ThrowTypeError%":a,"%TypedArray%":u,"%TypedArrayPrototype%":u?u.prototype:void 0,"%TypeError%":n,"%TypeErrorPrototype%":n.prototype,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"%URIError%":URIError,"%URIErrorPrototype%":URIError.prototype,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},h=r(71).call(Function.call,String.prototype.replace),p=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,f=/\\(\\)?/g,m=function(e){var t=[];return h(e,p,(function(e,r,n,o){t[t.length]=n?h(o,f,"$1"):r||e})),t},g=function(e,t){if(!(e in d))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===d[e]&&!t)throw new n("intrinsic "+e+" exists, but is not available. Please file an issue!");return d[e]};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');for(var r=m(e),i=g("%"+(r.length>0?r[0]:"")+"%",t),a=1;a<r.length;a+=1)if(null!=i)if(o&&a+1>=r.length){var s=o(i,r[a]);if(!t&&!(r[a]in i))throw new n("base intrinsic for "+e+" exists, but the property is not available.");i=s&&"get"in s&&!("originalValue"in s.get)?s.get:i[r[a]]}else i=i[r[a]];return i}},function(e,t,r){"use strict";var n=r(72).supportsDescriptors,o=r(159),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,l=Object.getPrototypeOf,c=/a/;e.exports=function(){if(!n||!l)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=o(),t=l(c),r=i(t,"flags");return r&&r.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},function(e,t,r){"use strict";var n=Date.prototype.getDay,o=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){return"object"==typeof e&&null!==e&&(i?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Date]"===o.call(e))}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(1),o=(a(n),a(r(17))),i=a(r(296));a(r(132));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(r,n){e=r,t.forEach((function(t){return t(e,n)}))}}}t.default=function(e,t){var r,a,d="__create-react-context-"+(0,i.default)()+"__",h=function(e){function r(){var t,n;s(this,r);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=n=l(this,e.call.apply(e,[this].concat(i))),n.emitter=u(n.props.value),l(n,t)}return c(r,e),r.prototype.getChildContext=function(){var e;return(e={})[d]=this.emitter,e},r.prototype.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var r=this.props.value,n=e.value,o=void 0;((i=r)===(a=n)?0!==i||1/i==1/a:i!=i&&a!=a)?o=0:(o="function"==typeof t?t(r,n):1073741823,0!==(o|=0)&&this.emitter.set(e.value,o))}var i,a},r.prototype.render=function(){return this.props.children},r}(n.Component);h.childContextTypes=((r={})[d]=o.default.object.isRequired,r);var p=function(t){function r(){var e,n;s(this,r);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=n=l(this,t.call.apply(t,[this].concat(i))),n.state={value:n.getValue()},n.onUpdate=function(e,t){0!=((0|n.observedBits)&t)&&n.setState({value:n.getValue()})},l(n,e)}return c(r,t),r.prototype.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?1073741823:t},r.prototype.componentDidMount=function(){this.context[d]&&this.context[d].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?1073741823:e},r.prototype.componentWillUnmount=function(){this.context[d]&&this.context[d].off(this.onUpdate)},r.prototype.getValue=function(){return this.context[d]?this.context[d].get():e},r.prototype.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},r}(n.Component);return p.contextTypes=((a={})[d]=o.default.object,a),{Provider:h,Consumer:p}},e.exports=t.default},function(e,t,r){"use strict";(function(t){var r="__global_unique_id__";e.exports=function(){return t[r]=(t[r]||0)+1}}).call(this,r(43))},function(e,t,r){var n=r(22),o=r(298);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".components-panel__row.jeo-meta-selector {\n\talign-items: flex-start;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.jeo-meta-selector label {\n\tmargin-bottom: 10px;\n}\n\n.jeo-meta-selector fieldset {\n\tborder: 1px solid #e2e4e7;\n\tborder-radius: 4px;\n\tmargin-bottom: 10px;\n\tpadding: 10px;\n}\n\n.jeo-meta-selector button {\n\tmargin-top: 10px;\n}\n",""]),e.exports=t},function(e,t,r){var n=r(22),o=r(300);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".related-posts-checkbox {\n    margin-top: 20px;\n}\n\n.date-interval-button {\n    margin-top: 20px;\n}",""]),e.exports=t},function(e,t,r){var n=r(22),o=r(302);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,".react-autosuggest__suggestion {\n\tmargin: 0;\n}\n\n.react-autosuggest__suggestion:nth-of-type(even) {\n\tbackground-color: #f9f9f9;\n}\n\n.react-autosuggest__suggestion:hover {\n\tbackground-color: aliceblue;\n}\n\n.jeo-geo-autocomplete {\n\tpadding: 5px;\n}\n",""]),e.exports=t},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ie}));var n=r(98),o=r(94),i=r(4);function a(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t=t||{})t.hasOwnProperty(r)&&(e[r]=t[r]);return e}var s=r(95),l=r(37),c=r(39),u=r(6),d=r(67),h=r(3);function p(e,t,r){Object(h.a)(2,arguments);var n=r||{},o=n.locale,a=o&&o.options&&o.options.weekStartsOn,s=null==a?0:Object(u.a)(a),l=null==n.weekStartsOn?s:Object(u.a)(n.weekStartsOn);if(!(l>=0&&l<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=Object(i.default)(e),d=Object(u.a)(t),p=c.getUTCDay(),f=d%7,m=(f+7)%7,g=(m<l?7:0)+d-p;return c.setUTCDate(c.getUTCDate()+g),c}var f=r(100);var m=r(99);var g=r(38),b=r(31),v=/^(1[0-2]|0?\d)/,y=/^(3[0-1]|[0-2]?\d)/,_=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,w=/^(5[0-3]|[0-4]?\d)/,x=/^(2[0-3]|[0-1]?\d)/,k=/^(2[0-4]|[0-1]?\d)/,C=/^(1[0-1]|0?\d)/,E=/^(1[0-2]|0?\d)/,S=/^[0-5]?\d/,T=/^[0-5]?\d/,A=/^\d/,P=/^\d{1,2}/,I=/^\d{1,3}/,O=/^\d{1,4}/,M=/^-?\d+/,D=/^-?\d/,z=/^-?\d{1,2}/,j=/^-?\d{1,3}/,R=/^-?\d{1,4}/,L=/^([+-])(\d{2})(\d{2})?|Z/,N=/^([+-])(\d{2})(\d{2})|Z/,B=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,F=/^([+-])(\d{2}):(\d{2})|Z/,V=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function U(e,t,r){var n=t.match(e);if(!n)return null;var o=parseInt(n[0],10);return{value:r?r(o):o,rest:t.slice(n[0].length)}}function q(e,t){var r=t.match(e);return r?"Z"===r[0]?{value:0,rest:t.slice(1)}:{value:("+"===r[1]?1:-1)*(36e5*(r[2]?parseInt(r[2],10):0)+6e4*(r[3]?parseInt(r[3],10):0)+1e3*(r[5]?parseInt(r[5],10):0)),rest:t.slice(r[0].length)}:null}function H(e,t){return U(M,e,t)}function W(e,t,r){switch(e){case 1:return U(A,t,r);case 2:return U(P,t,r);case 3:return U(I,t,r);case 4:return U(O,t,r);default:return U(new RegExp("^\\d{1,"+e+"}"),t,r)}}function G(e,t,r){switch(e){case 1:return U(D,t,r);case 2:return U(z,t,r);case 3:return U(j,t,r);case 4:return U(R,t,r);default:return U(new RegExp("^-?\\d{1,"+e+"}"),t,r)}}function Z(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Y(e,t){var r,n=t>0,o=n?t:1-t;if(o<=50)r=e||100;else{var i=o+50;r=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return n?r:1-r}var $=[31,28,31,30,31,30,31,31,30,31,30,31],K=[31,29,31,30,31,30,31,31,30,31,30,31];function X(e){return e%400==0||e%4==0&&e%100!=0}var J={G:{priority:140,parse:function(e,t,r,n){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}},set:function(e,t,r,n){return t.era=r,e.setUTCFullYear(r,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,r,n){var o=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return W(4,e,o);case"yo":return r.ordinalNumber(e,{unit:"year",valueCallback:o});default:return W(t.length,e,o)}},validate:function(e,t,r){return t.isTwoDigitYear||t.year>0},set:function(e,t,r,n){var o=e.getUTCFullYear();if(r.isTwoDigitYear){var i=Y(r.year,o);return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}var a="era"in t&&1!==t.era?1-r.year:r.year;return e.setUTCFullYear(a,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,r,n){var o=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return W(4,e,o);case"Yo":return r.ordinalNumber(e,{unit:"year",valueCallback:o});default:return W(t.length,e,o)}},validate:function(e,t,r){return t.isTwoDigitYear||t.year>0},set:function(e,t,r,n){var o=Object(d.a)(e,n);if(r.isTwoDigitYear){var i=Y(r.year,o);return e.setUTCFullYear(i,0,n.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(b.a)(e,n)}var a="era"in t&&1!==t.era?1-r.year:r.year;return e.setUTCFullYear(a,0,n.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(b.a)(e,n)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,r,n){return G("R"===t?4:t.length,e)},set:function(e,t,r,n){var o=new Date(0);return o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0),Object(g.a)(o)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,r,n){return G("u"===t?4:t.length,e)},set:function(e,t,r,n){return e.setUTCFullYear(r,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,r,n){switch(t){case"Q":case"QQ":return W(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,r){return t>=1&&t<=4},set:function(e,t,r,n){return e.setUTCMonth(3*(r-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,r,n){switch(t){case"q":case"qq":return W(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,r){return t>=1&&t<=4},set:function(e,t,r,n){return e.setUTCMonth(3*(r-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,r,n){var o=function(e){return e-1};switch(t){case"M":return U(v,e,o);case"MM":return W(2,e,o);case"Mo":return r.ordinalNumber(e,{unit:"month",valueCallback:o});case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,r){return t>=0&&t<=11},set:function(e,t,r,n){return e.setUTCMonth(r,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,r,n){var o=function(e){return e-1};switch(t){case"L":return U(v,e,o);case"LL":return W(2,e,o);case"Lo":return r.ordinalNumber(e,{unit:"month",valueCallback:o});case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,r){return t>=0&&t<=11},set:function(e,t,r,n){return e.setUTCMonth(r,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,r,n){switch(t){case"w":return U(w,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=1&&t<=53},set:function(e,t,r,n){return Object(b.a)(function(e,t,r){Object(h.a)(2,arguments);var n=Object(i.default)(e),o=Object(u.a)(t),a=Object(m.a)(n,r)-o;return n.setUTCDate(n.getUTCDate()-7*a),n}(e,r,n),n)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,r,n){switch(t){case"I":return U(w,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=1&&t<=53},set:function(e,t,r,n){return Object(g.a)(function(e,t){Object(h.a)(2,arguments);var r=Object(i.default)(e),n=Object(u.a)(t),o=Object(f.a)(r)-n;return r.setUTCDate(r.getUTCDate()-7*o),r}(e,r,n),n)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(e,t,r,n){switch(t){case"d":return U(y,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return W(t.length,e)}},validate:function(e,t,r){var n=X(e.getUTCFullYear()),o=e.getUTCMonth();return n?t>=1&&t<=K[o]:t>=1&&t<=$[o]},set:function(e,t,r,n){return e.setUTCDate(r),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(e,t,r,n){switch(t){case"D":case"DD":return U(_,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return W(t.length,e)}},validate:function(e,t,r){return X(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365},set:function(e,t,r,n){return e.setUTCMonth(0,r),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,r,n){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,r){return t>=0&&t<=6},set:function(e,t,r,n){return(e=p(e,r,n)).setUTCHours(0,0,0,0),e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,r,n){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return W(t.length,e,o);case"eo":return r.ordinalNumber(e,{unit:"day",valueCallback:o});case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,r){return t>=0&&t<=6},set:function(e,t,r,n){return(e=p(e,r,n)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,r,n){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return W(t.length,e,o);case"co":return r.ordinalNumber(e,{unit:"day",valueCallback:o});case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,r){return t>=0&&t<=6},set:function(e,t,r,n){return(e=p(e,r,n)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,r,n){var o=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return W(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return r.day(e,{width:"abbreviated",context:"formatting",valueCallback:o})||r.day(e,{width:"short",context:"formatting",valueCallback:o})||r.day(e,{width:"narrow",context:"formatting",valueCallback:o});case"iiiii":return r.day(e,{width:"narrow",context:"formatting",valueCallback:o});case"iiiiii":return r.day(e,{width:"short",context:"formatting",valueCallback:o})||r.day(e,{width:"narrow",context:"formatting",valueCallback:o});case"iiii":default:return r.day(e,{width:"wide",context:"formatting",valueCallback:o})||r.day(e,{width:"abbreviated",context:"formatting",valueCallback:o})||r.day(e,{width:"short",context:"formatting",valueCallback:o})||r.day(e,{width:"narrow",context:"formatting",valueCallback:o})}},validate:function(e,t,r){return t>=1&&t<=7},set:function(e,t,r,n){return(e=function(e,t){Object(h.a)(2,arguments);var r=Object(u.a)(t);r%7==0&&(r-=7);var n=1,o=Object(i.default)(e),a=o.getUTCDay(),s=r%7,l=(s+7)%7,c=(l<n?7:0)+r-a;return o.setUTCDate(o.getUTCDate()+c),o}(e,r,n)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,r,n){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,r,n){return e.setUTCHours(Z(r),0,0,0),e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,r,n){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,r,n){return e.setUTCHours(Z(r),0,0,0),e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,r,n){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,r,n){return e.setUTCHours(Z(r),0,0,0),e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,r,n){switch(t){case"h":return U(E,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=1&&t<=12},set:function(e,t,r,n){var o=e.getUTCHours()>=12;return o&&r<12?e.setUTCHours(r+12,0,0,0):o||12!==r?e.setUTCHours(r,0,0,0):e.setUTCHours(0,0,0,0),e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,r,n){switch(t){case"H":return U(x,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=0&&t<=23},set:function(e,t,r,n){return e.setUTCHours(r,0,0,0),e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,r,n){switch(t){case"K":return U(C,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=0&&t<=11},set:function(e,t,r,n){return e.getUTCHours()>=12&&r<12?e.setUTCHours(r+12,0,0,0):e.setUTCHours(r,0,0,0),e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,r,n){switch(t){case"k":return U(k,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=1&&t<=24},set:function(e,t,r,n){var o=r<=24?r%24:r;return e.setUTCHours(o,0,0,0),e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,r,n){switch(t){case"m":return U(S,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=0&&t<=59},set:function(e,t,r,n){return e.setUTCMinutes(r,0,0),e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,r,n){switch(t){case"s":return U(T,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return W(t.length,e)}},validate:function(e,t,r){return t>=0&&t<=59},set:function(e,t,r,n){return e.setUTCSeconds(r,0),e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,r,n){return W(t.length,e,(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))},set:function(e,t,r,n){return e.setUTCMilliseconds(r),e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,r,n){switch(t){case"X":return q(L,e);case"XX":return q(N,e);case"XXXX":return q(B,e);case"XXXXX":return q(V,e);case"XXX":default:return q(F,e)}},set:function(e,t,r,n){return t.timestampIsSet?e:new Date(e.getTime()-r)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,r,n){switch(t){case"x":return q(L,e);case"xx":return q(N,e);case"xxxx":return q(B,e);case"xxxxx":return q(V,e);case"xxx":default:return q(F,e)}},set:function(e,t,r,n){return t.timestampIsSet?e:new Date(e.getTime()-r)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,r,n){return H(e)},set:function(e,t,r,n){return[new Date(1e3*r),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,r,n){return H(e)},set:function(e,t,r,n){return[new Date(r),{timestampIsSet:!0}]},incompatibleTokens:"*"}},Q=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,te=/^'([^]*?)'?$/,re=/''/g,ne=/\S/,oe=/[a-zA-Z]/;function ie(e,t,r,d){Object(h.a)(3,arguments);var p=String(e),f=String(t),m=d||{},g=m.locale||n.a;if(!g.match)throw new RangeError("locale must contain match property");var b=g.options&&g.options.firstWeekContainsDate,v=null==b?1:Object(u.a)(b),y=null==m.firstWeekContainsDate?v:Object(u.a)(m.firstWeekContainsDate);if(!(y>=1&&y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var _=g.options&&g.options.weekStartsOn,w=null==_?0:Object(u.a)(_),x=null==m.weekStartsOn?w:Object(u.a)(m.weekStartsOn);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===f)return""===p?Object(i.default)(r):new Date(NaN);var k,C={firstWeekContainsDate:y,weekStartsOn:x,locale:g},E=[{priority:10,subPriority:-1,set:ae,index:0}],S=f.match(ee).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,s.a[t])(e,g.formatLong,C):e})).join("").match(Q),T=[];for(k=0;k<S.length;k++){var A=S[k];!m.useAdditionalWeekYearTokens&&Object(c.b)(A)&&Object(c.c)(A,f,e),!m.useAdditionalDayOfYearTokens&&Object(c.a)(A)&&Object(c.c)(A,f,e);var P=A[0],I=J[P];if(I){var O=I.incompatibleTokens;if(Array.isArray(O)){for(var M=void 0,D=0;D<T.length;D++){var z=T[D].token;if(-1!==O.indexOf(z)||z===P){M=T[D];break}}if(M)throw new RangeError("The format string mustn't contain `".concat(M.fullToken,"` and `").concat(A,"` at the same time"))}else if("*"===I.incompatibleTokens&&T.length)throw new RangeError("The format string mustn't contain `".concat(A,"` and any other token at the same time"));T.push({token:P,fullToken:A});var j=I.parse(p,A,g.match,C);if(!j)return new Date(NaN);E.push({priority:I.priority,subPriority:I.subPriority||0,set:I.set,validate:I.validate,value:j.value,index:E.length}),p=j.rest}else{if(P.match(oe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");if("''"===A?A="'":"'"===P&&(A=se(A)),0!==p.indexOf(A))return new Date(NaN);p=p.slice(A.length)}}if(p.length>0&&ne.test(p))return new Date(NaN);var R=E.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,r){return r.indexOf(e)===t})).map((function(e){return E.filter((function(t){return t.priority===e})).sort((function(e,t){return t.subPriority-e.subPriority}))})).map((function(e){return e[0]})),L=Object(i.default)(r);if(isNaN(L))return new Date(NaN);var N=Object(o.a)(L,Object(l.a)(L)),B={};for(k=0;k<R.length;k++){var F=R[k];if(F.validate&&!F.validate(N,F.value,C))return new Date(NaN);var V=F.set(N,B,F.value,C);V[0]?(N=V[0],a(B,V[1])):N=V}return N}function ae(e,t){if(t.timestampIsSet)return e;var r=new Date(0);return r.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),r.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),r}function se(e){return e.match(te)[1].replace(re,"'")}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return D}));var n=r(127),o=r(98),i=r(94),a=r(4);function s(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var l={y:function(e,t){var r=e.getUTCFullYear(),n=r>0?r:1-r;return s("yy"===t?n%100:n,t.length)},M:function(e,t){var r=e.getUTCMonth();return"M"===t?String(r+1):s(r+1,2)},d:function(e,t){return s(e.getUTCDate(),t.length)},a:function(e,t){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return r.toUpperCase();case"aaaaa":return r[0];case"aaaa":default:return"am"===r?"a.m.":"p.m."}},h:function(e,t){return s(e.getUTCHours()%12||12,t.length)},H:function(e,t){return s(e.getUTCHours(),t.length)},m:function(e,t){return s(e.getUTCMinutes(),t.length)},s:function(e,t){return s(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length,n=e.getUTCMilliseconds();return s(Math.floor(n*Math.pow(10,r-3)),t.length)}},c=r(3);var u=r(100),d=r(96),h=r(99),p=r(67),f="midnight",m="noon",g="morning",b="afternoon",v="evening",y="night";function _(e,t){var r=e>0?"-":"+",n=Math.abs(e),o=Math.floor(n/60),i=n%60;if(0===i)return r+String(o);var a=t||"";return r+String(o)+a+s(i,2)}function w(e,t){return e%60==0?(e>0?"-":"+")+s(Math.abs(e)/60,2):x(e,t)}function x(e,t){var r=t||"",n=e>0?"-":"+",o=Math.abs(e);return n+s(Math.floor(o/60),2)+r+s(o%60,2)}var k={G:function(e,t,r){var n=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if("yo"===t){var n=e.getUTCFullYear(),o=n>0?n:1-n;return r.ordinalNumber(o,{unit:"year"})}return l.y(e,t)},Y:function(e,t,r,n){var o=Object(p.a)(e,n),i=o>0?o:1-o;return"YY"===t?s(i%100,2):"Yo"===t?r.ordinalNumber(i,{unit:"year"}):s(i,t.length)},R:function(e,t){return s(Object(d.a)(e),t.length)},u:function(e,t){return s(e.getUTCFullYear(),t.length)},Q:function(e,t,r){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return s(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return s(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){var n=e.getUTCMonth();switch(t){case"M":case"MM":return l.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){var n=e.getUTCMonth();switch(t){case"L":return String(n+1);case"LL":return s(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){var o=Object(h.a)(e,n);return"wo"===t?r.ordinalNumber(o,{unit:"week"}):s(o,t.length)},I:function(e,t,r){var n=Object(u.a)(e);return"Io"===t?r.ordinalNumber(n,{unit:"week"}):s(n,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):l.d(e,t)},D:function(e,t,r){var n=function(e){Object(c.a)(1,arguments);var t=Object(a.default)(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),o=r-n;return Math.floor(o/864e5)+1}(e);return"Do"===t?r.ordinalNumber(n,{unit:"dayOfYear"}):s(n,t.length)},E:function(e,t,r){var n=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){var o=e.getUTCDay(),i=(o-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return s(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(o,{width:"short",context:"formatting"});case"eeee":default:return r.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){var o=e.getUTCDay(),i=(o-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return s(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(o,{width:"narrow",context:"standalone"});case"cccccc":return r.day(o,{width:"short",context:"standalone"});case"cccc":default:return r.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,r){var n=e.getUTCDay(),o=0===n?7:n;switch(t){case"i":return String(o);case"ii":return s(o,t.length);case"io":return r.ordinalNumber(o,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){var n,o=e.getUTCHours();switch(n=12===o?m:0===o?f:o/12>=1?"pm":"am",t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){var n,o=e.getUTCHours();switch(n=o>=17?v:o>=12?b:o>=4?g:y,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){var n=e.getUTCHours()%12;return 0===n&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return l.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):l.H(e,t)},K:function(e,t,r){var n=e.getUTCHours()%12;return"Ko"===t?r.ordinalNumber(n,{unit:"hour"}):s(n,t.length)},k:function(e,t,r){var n=e.getUTCHours();return 0===n&&(n=24),"ko"===t?r.ordinalNumber(n,{unit:"hour"}):s(n,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):l.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):l.s(e,t)},S:function(e,t){return l.S(e,t)},X:function(e,t,r,n){var o=(n._originalDate||e).getTimezoneOffset();if(0===o)return"Z";switch(t){case"X":return w(o);case"XXXX":case"XX":return x(o);case"XXXXX":case"XXX":default:return x(o,":")}},x:function(e,t,r,n){var o=(n._originalDate||e).getTimezoneOffset();switch(t){case"x":return w(o);case"xxxx":case"xx":return x(o);case"xxxxx":case"xxx":default:return x(o,":")}},O:function(e,t,r,n){var o=(n._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_(o,":");case"OOOO":default:return"GMT"+x(o,":")}},z:function(e,t,r,n){var o=(n._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_(o,":");case"zzzz":default:return"GMT"+x(o,":")}},t:function(e,t,r,n){var o=n._originalDate||e;return s(Math.floor(o.getTime()/1e3),t.length)},T:function(e,t,r,n){return s((n._originalDate||e).getTime(),t.length)}},C=r(95),E=r(37),S=r(39),T=r(6),A=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,P=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,I=/^'([^]*?)'?$/,O=/''/g,M=/[a-zA-Z]/;function D(e,t,r){Object(c.a)(2,arguments);var s=String(t),l=r||{},u=l.locale||o.a,d=u.options&&u.options.firstWeekContainsDate,h=null==d?1:Object(T.a)(d),p=null==l.firstWeekContainsDate?h:Object(T.a)(l.firstWeekContainsDate);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=u.options&&u.options.weekStartsOn,m=null==f?0:Object(T.a)(f),g=null==l.weekStartsOn?m:Object(T.a)(l.weekStartsOn);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!u.localize)throw new RangeError("locale must contain localize property");if(!u.formatLong)throw new RangeError("locale must contain formatLong property");var b=Object(a.default)(e);if(!Object(n.default)(b))throw new RangeError("Invalid time value");var v=Object(E.a)(b),y=Object(i.a)(b,v),_={firstWeekContainsDate:p,weekStartsOn:g,locale:u,_originalDate:b},w=s.match(P).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,C.a[t])(e,u.formatLong,_):e})).join("").match(A).map((function(r){if("''"===r)return"'";var n=r[0];if("'"===n)return z(r);var o=k[n];if(o)return!l.useAdditionalWeekYearTokens&&Object(S.b)(r)&&Object(S.c)(r,t,e),!l.useAdditionalDayOfYearTokens&&Object(S.a)(r)&&Object(S.c)(r,t,e),o(y,r,u.localize,_);if(n.match(M))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");return r})).join("");return w}function z(e){return e.match(I)[1].replace(O,"'")}},function(e,t,r){"use strict";r.r(t),r.d(t,"Popper",(function(){return P})),r.d(t,"placements",(function(){return A})),r.d(t,"Manager",(function(){return w})),r.d(t,"Reference",(function(){return D}));var n=r(126),o=r.n(n),i=r(24),a=r.n(i),s=r(7),l=r.n(s),c=r(68),u=r.n(c),d=r(8),h=r.n(d),p=r(173),f=r.n(p),m=r(1),g=r(138),b=r(139),v=r.n(b),y=v()(),_=v()(),w=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t=e.call.apply(e,[this].concat(n))||this,h()(l()(t),"referenceNode",void 0),h()(l()(t),"setReferenceNode",(function(e){e&&t.referenceNode!==e&&(t.referenceNode=e,t.forceUpdate())})),t}u()(t,e);var r=t.prototype;return r.componentWillUnmount=function(){this.referenceNode=null},r.render=function(){return m.createElement(y.Provider,{value:this.referenceNode},m.createElement(_.Provider,{value:this.setReferenceNode},this.props.children))},t}(m.Component),x=function(e){return Array.isArray(e)?e[0]:e},k=function(e){if("function"==typeof e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,r)}},C=function(e,t){if("function"==typeof e)return k(e,t);null!=e&&(e.current=t)},E={position:"absolute",top:0,left:0,opacity:0,pointerEvents:"none"},S={},T=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t=e.call.apply(e,[this].concat(n))||this,h()(l()(t),"state",{data:void 0,placement:void 0}),h()(l()(t),"popperInstance",void 0),h()(l()(t),"popperNode",null),h()(l()(t),"arrowNode",null),h()(l()(t),"setPopperNode",(function(e){e&&t.popperNode!==e&&(C(t.props.innerRef,e),t.popperNode=e,t.updatePopperInstance())})),h()(l()(t),"setArrowNode",(function(e){t.arrowNode=e})),h()(l()(t),"updateStateModifier",{enabled:!0,order:900,fn:function(e){var r=e.placement;return t.setState({data:e,placement:r}),e}}),h()(l()(t),"getOptions",(function(){return{placement:t.props.placement,eventsEnabled:t.props.eventsEnabled,positionFixed:t.props.positionFixed,modifiers:a()({},t.props.modifiers,{arrow:a()({},t.props.modifiers&&t.props.modifiers.arrow,{enabled:!!t.arrowNode,element:t.arrowNode}),applyStyle:{enabled:!1},updateStateModifier:t.updateStateModifier})}})),h()(l()(t),"getPopperStyle",(function(){return t.popperNode&&t.state.data?a()({position:t.state.data.offsets.popper.position},t.state.data.styles):E})),h()(l()(t),"getPopperPlacement",(function(){return t.state.data?t.state.placement:void 0})),h()(l()(t),"getArrowStyle",(function(){return t.arrowNode&&t.state.data?t.state.data.arrowStyles:S})),h()(l()(t),"getOutOfBoundariesState",(function(){return t.state.data?t.state.data.hide:void 0})),h()(l()(t),"destroyPopperInstance",(function(){t.popperInstance&&(t.popperInstance.destroy(),t.popperInstance=null)})),h()(l()(t),"updatePopperInstance",(function(){t.destroyPopperInstance();var e=l()(t).popperNode,r=t.props.referenceElement;r&&e&&(t.popperInstance=new g.a(r,e,t.getOptions()))})),h()(l()(t),"scheduleUpdate",(function(){t.popperInstance&&t.popperInstance.scheduleUpdate()})),t}u()(t,e);var r=t.prototype;return r.componentDidUpdate=function(e,t){this.props.placement===e.placement&&this.props.referenceElement===e.referenceElement&&this.props.positionFixed===e.positionFixed&&f()(this.props.modifiers,e.modifiers,{strict:!0})?this.props.eventsEnabled!==e.eventsEnabled&&this.popperInstance&&(this.props.eventsEnabled?this.popperInstance.enableEventListeners():this.popperInstance.disableEventListeners()):this.updatePopperInstance(),t.placement!==this.state.placement&&this.scheduleUpdate()},r.componentWillUnmount=function(){C(this.props.innerRef,null),this.destroyPopperInstance()},r.render=function(){return x(this.props.children)({ref:this.setPopperNode,style:this.getPopperStyle(),placement:this.getPopperPlacement(),outOfBoundaries:this.getOutOfBoundariesState(),scheduleUpdate:this.scheduleUpdate,arrowProps:{ref:this.setArrowNode,style:this.getArrowStyle()}})},t}(m.Component);h()(T,"defaultProps",{placement:"bottom",eventsEnabled:!0,referenceElement:void 0,positionFixed:!1});var A=g.a.placements;function P(e){var t=e.referenceElement,r=o()(e,["referenceElement"]);return m.createElement(y.Consumer,null,(function(e){return m.createElement(T,a()({referenceElement:void 0!==t?t:e},r))}))}var I=r(132),O=r.n(I),M=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t=e.call.apply(e,[this].concat(n))||this,h()(l()(t),"refHandler",(function(e){C(t.props.innerRef,e),k(t.props.setReferenceNode,e)})),t}u()(t,e);var r=t.prototype;return r.componentWillUnmount=function(){C(this.props.innerRef,null)},r.render=function(){return O()(Boolean(this.props.setReferenceNode),"`Reference` should not be used outside of a `Manager` component."),x(this.props.children)({ref:this.refHandler})},t}(m.Component);function D(e){return m.createElement(_.Consumer,null,(function(t){return m.createElement(M,a()({setReferenceNode:t},e))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c}));var n=r(30),o=r(4),i=r(6),a=r(3);function s(e,t){Object(a.a)(1,arguments);var r=Object(o.default)(e),s=r.getFullYear(),l=t||{},c=l.locale,u=c&&c.options&&c.options.firstWeekContainsDate,d=null==u?1:Object(i.a)(u),h=null==l.firstWeekContainsDate?d:Object(i.a)(l.firstWeekContainsDate);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setFullYear(s+1,0,h),p.setHours(0,0,0,0);var f=Object(n.default)(p,t),m=new Date(0);m.setFullYear(s,0,h),m.setHours(0,0,0,0);var g=Object(n.default)(m,t);return r.getTime()>=f.getTime()?s+1:r.getTime()>=g.getTime()?s:s-1}function l(e,t){Object(a.a)(1,arguments);var r=t||{},o=r.locale,l=o&&o.options&&o.options.firstWeekContainsDate,c=null==l?1:Object(i.a)(l),u=null==r.firstWeekContainsDate?c:Object(i.a)(r.firstWeekContainsDate),d=s(e,t),h=new Date(0);h.setFullYear(d,0,u),h.setHours(0,0,0,0);var p=Object(n.default)(h,t);return p}function c(e,t){Object(a.a)(1,arguments);var r=Object(o.default)(e),i=Object(n.default)(r,t).getTime()-l(r,t).getTime();return Math.round(i/6048e5)+1}},,,,,function(e,t,r){var n=r(22),o=r(405);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=window.wp.blockEditor},function(e,t){e.exports=window.wp.mediaUtils},,,,,,,,,function(e,t,r){(t=r(23)(!1)).push([e.i,'.react-autosuggest__container {\n\tposition: relative;\n}\n\n.react-autosuggest__input {\n\twidth: 240px;\n\theight: 30px;\n\tpadding: 10px 20px;\n\tfont-family: Helvetica, sans-serif;\n\tfont-weight: 300;\n\tfont-size: 16px;\n\tborder: 1px solid #aaa;\n\tborder-radius: 4px;\n}\n\n.react-autosuggest__input:focus {\n\toutline: none;\n}\n\n.react-autosuggest__container--open .react-autosuggest__input {\n\tborder-bottom-left-radius: 0;\n\tborder-bottom-right-radius: 0;\n}\n\n.react-autosuggest__suggestions-container {\n\tdisplay: none;\n}\n\n.react-autosuggest__container--open .react-autosuggest__suggestions-container {\n\tdisplay: block;\n\tposition: absolute;\n\ttop: 51px;\n\twidth: 280px;\n\tborder: 1px solid #aaa;\n\tbackground-color: #fff;\n\tfont-family: Helvetica, sans-serif;\n\tfont-weight: 300;\n\tfont-size: 16px;\n\tborder-bottom-left-radius: 4px;\n\tborder-bottom-right-radius: 4px;\n\t/* z-index: 2; */\n\tz-index: 3;\n}\n\n.react-autosuggest__suggestions-list {\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style-type: none;\n}\n\n.react-autosuggest__suggestion {\n\tcursor: pointer;\n\tpadding: 10px 20px;\n\toverflow-wrap: break-word;\n}\n\n.react-autosuggest__suggestion:not(:first-child) {\n\tborder-top: 1px solid #ddd;\n}\n\n.react-autosuggest__suggestion--focused {\n\t/* background-color: #0C7EAF; */\n\tbackground-color: blueviolet; \n\tcolor: #fff;\n}\n\n.jeo-preview-controls {\n\tdisplay: flex;\n\tflex-direction: row;\n}\n\n.jeo-preview-controls .select-another-map {\n\tmargin-left: 10px;\n}\n\n.wp-block[data-type="jeo/map"] .jeo-preview-controls {\n\tdisplay: none;\n}\n\n.wp-block[data-type="jeo/map"]:focus-within .jeo-preview-controls {\n\tdisplay: flex;\n}',""]),e.exports=t},function(e,t,r){var n=r(22),o=r(407);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,"/**\n * Map Editor Modal\n */\n\n.jeo-layers-modal {\n\tposition: fixed;\n\ttop: 30px;\n\tright: 30px;\n\tbottom: 30px;\n\tleft: 30px;\n\tz-index: 16000;\n\ttransform: none;\n\tmax-height: none;\n}\n\n.jeo-layers-modal .components-modal__content {\n\tpadding: 0;\n}\n\n.jeo-layers-modal .components-modal__header {\n\tpadding: 0 24px;\n\tbackground-color: #fcfcfc;\n\tmargin: 0;\n\tborder-bottom: none;\n}\n\n/**\n * Layers Settings\n */\n.jeo-layers-list {\n\tborder-collapse: collapse;\n\twidth: calc(100% - 2em);\n\tmargin: 1em;\n}\n\n.jeo-layers-list .layer {\n\tborder: 1px solid lightgray;\n\tvertical-align: middle;\n}\n\n.jeo-layers-list .layer > div {\n\tpadding: 0.5em;\n}\n\n.jeo-layers-list .layer .remove-control svg {\n\tcursor: pointer;\n}\n\n.jeo-layers-list .components-select-control__input {\n\twidth: auto;\n\tmargin-bottom: 0;\n}\n\n.jeo-layers-list .components-base-control__field {\n\tmargin-bottom: 0;\n}\n\n.jeo-layers-list .components-base-control__label {\n\tmargin: 0 1em 0 0;\n}\n\n.jeo-layers-list .components-base-control__help {\n\tmargin: 0;\n}\n\n.jeo-layers-list .drag-handle {\n\tvertical-align: middle;\n}\n\n.jeo-layers-list .layer-title {\n\tfont-weight: bold;\n}\n\n.jeo-layers-list.dragging {\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.jeo-layers-list.dragging * {\n\tbox-sizing: border-box;\n}\n\n.jeo-layers-list.dragging .layer {\n\tbackground-color: white;\n}\n\n/**\n * Layers Library\n */\n.jeo-layers-library-controls,\n.jeo-layers-library .library-controls {\n\tmargin-left: 12px;\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 1em 0;\n}\n\n/*new layer settings modal*/\n.jeo-layers-modal .jeo-layers-library-controls {\n    margin-left: 0px;\n    padding: 1em;\n}\n\n.jeo-layers-library-controls button.components-button {\n    height: 30px;\n}\n\n.layer-info__single-row {\n\tmargin: 0px;\n\tmargin-bottom: 3px;\n}\n\nli.jeo-setting-layer.all-layers-list {\n    margin-bottom: 0px;\n}\n\n.layer-buttons .add-button, .layer-buttons .remove-button{\n\tmargin-bottom: 0px;\n}\n\n.jeo-layers-list .layer-card .layer-info {\n    margin-top: 0px;\n}\n\nul.jeo-layers-list .components-card {\n    height: auto;\n}\n\n.jeo-layers-modal .done-button {\n    margin: 15px;\n}\n/**/\n\n.jeo-layers-library-controls .components-base-control__field,\n.jeo-layers-library .library-controls .components-base-control__field {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 0;\n}\n\n.jeo-layers-library-controls .components-base-control__label,\n.jeo-layers-library .library-controls .components-base-control__label {\n\tmargin: 0 1em 0;\n\tflex-basis: 100%;\n}\n\n.jeo-layers-library-controls > span,\n.jeo-layers-library .library-controls > span {\n\tflex-basis: 4em;\n\ttext-align: center;\n}\n\n.jeo-layers-library .available-layers {\n\tdisplay: grid;\n\tgrid: auto-flow 8em / 1fr 1fr;\n\tgrid-gap: 1em;\n}\n\n.jeo-layers-library .layer {\n\tdisplay: flex;\n\tbackground-color: #f3f3f3;\n}\n\n.jeo-layers-library .layer-button {\n\tflex-basis: 4em;\n\tfont-size: 1.33em;\n\ttext-align: center;\n\tborder: none;\n\tcursor: pointer;\n}\n\n.jeo-layers-library .layer-button .dashicon {\n\tdisplay: block;\n\tmargin: 0 auto 0.66em;\n}\n\n.jeo-layers-library .layer-add {\n\tbackground-color: #0079c0;\n\tcolor: white;\n}\n\n.jeo-layers-library .layer-add:hover {\n\tbackground-color: #33acf3;\n}\n\n.jeo-layers-library .layer-added {\n\tbackground-color: #999999;\n\tcolor: white;\n}\n\n.jeo-layers-library .layer-description {\n\tpadding: 0 1em;\n\tflex-grow: 1;\n}\n\n.jeo-layers-library .layer-type {\n\tfont-size: 0.8em;\n\tcolor: darkgray;\n}\n\n.jeo-layers-library .edit-layer {\n\tflex-basis: 2em;\n\tfont-size: 1.3em;\n\ttext-align: center;\n\tmargin: 1em 0;\n}\n\n.jeo-layers-library .edit-layer svg {\n\tcursor: pointer;\n}\n\n/**\n * Layer Editor\n */\n.jeo-map-settings .form-group,\n.jeo-layer-settings .form-group {\n\tfont-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen-Sans,\n\t\tUbuntu, Cantarell, Helvetica Neue, sans-serif;\n\tfont-size: 13px;\n\tmargin-bottom: 8px;\n}\n\n.jeo-map-settings .control-label,\n.jeo-layer-settings .control-label {\n\tdisplay: inline-block;\n\tmargin-bottom: 4px;\n}\n\n.jeo-map-settings .form-control,\n.jeo-layer-settings .form-control {\n\tdisplay: block;\n\twidth: 100%;\n}\n.jeo-map-settings .form-control:not(select),\n.jeo-layer-settings .form-control:not(select) {\n\tpadding: 6px 8px;\n}\n.jeo-map-settings .help-block,\n.jeo-layer-settings .help-block {\n\tcolor: gray;\n\tfont-size: 1.125em;\n\tmargin-top: 0;\n}\n\n.jeo-layer-settings .save-layer {\n\tmargin-right: 1em;\n}\n\n.jeo-layer-settings fieldset legend {\n\tdisplay: none;\n}\n\n/**\n * Sidebar Panels\n */\n.jeo-setting {\n\tdisplay: flex;\n\tjustify-content: space-between;\n}\n.jeo-setting__title {\n\tfont-weight: bold;\n}\n.jeo-setting + button {\n\tmargin-top: 1em;\n}\n.jeo-setting-layer h2 {\n\tmargin-bottom: 0;\n}\n",""]),e.exports=t},function(e,t,r){var n=r(22),o=r(409);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){(t=r(23)(!1)).push([e.i,'.jeo-mapblock.storymap .storymap-controls .story-settings,.jeo-mapblock.storymap .storymap-controls .slides-settings,.jeo-mapblock.storymap .storymap-controls .story-settings-hide,.jeo-mapblock.storymap .storymap-controls .slides-settings-hide{border-radius:7px;box-shadow:1px 3px 4px 0 rgba(0,0,0,.1)}.jeo-mapblock.storymap .storymap-controls .story-settings .heading,.jeo-mapblock.storymap .storymap-controls .slides-settings .heading,.jeo-mapblock.storymap .storymap-controls .story-settings-hide .heading,.jeo-mapblock.storymap .storymap-controls .slides-settings-hide .heading{display:flex;justify-content:space-between;align-items:center}.jeo-mapblock.storymap .storymap-controls .story-settings .section-title,.jeo-mapblock.storymap .storymap-controls .slides-settings .section-title,.jeo-mapblock.storymap .storymap-controls .story-settings-hide .section-title,.jeo-mapblock.storymap .storymap-controls .slides-settings-hide .section-title{font-weight:bold}.jeo-mapblock.storymap .storymap-controls .story-settings label.components-checkbox-control__label,.jeo-mapblock.storymap .storymap-controls .slides-settings label.components-checkbox-control__label,.jeo-mapblock.storymap .storymap-controls .story-settings-hide label.components-checkbox-control__label,.jeo-mapblock.storymap .storymap-controls .slides-settings-hide label.components-checkbox-control__label{font-weight:normal}.jeo-mapblock.storymap .storymap-controls .story-settings .ck-color-grid,.jeo-mapblock.storymap .storymap-controls .slides-settings .ck-color-grid{--ck-color-grid-tile-size: 18px;max-height:250px;overflow:hidden auto}.jeo-mapblock.storymap .storymap-controls .story-settings .ck-editor{margin-bottom:15px}.jeo-mapblock.storymap .storymap-controls .slides-settings .heading{margin-bottom:15px}.jeo-mapblock.storymap .storymap-controls .slides-settings .slide-panel .input-label{font-size:14px;font-weight:bold}.jeo-mapblock.storymap .storymap-controls .slides-settings .slide-panel .ck-editor{margin-bottom:15px}.jeo-mapblock.storymap .storymap-controls .slides-settings .slide-panel .flex-center{display:flex;justify-content:center;align-items:center}.jeo-mapblock.storymap{font-family:var(--globalFontFamily),sans-serif}.ck.ck-balloon-panel,.ck.ck-toolbar__items{z-index:9999999 !important}.ck.ck-toolbar[aria-label="Dropdown toolbar"]{width:240px}.ck.ck-content.ck-editor__editable.ck-blurred,.ck.ck-content.ck-editor__editable.ck-focused{height:300px !important}.story-settings{max-width:30%;margin:10px;background-color:#fff;position:absolute;top:50px;padding:10px;left:calc(45% + 15px)}.story-settings .title label{font-weight:bold}.story-settings .description label{font-weight:bold}.story-settings .description textarea{height:150px}.story-settings .input-label{font-size:12px;font-weight:bold}.story-settings-hide{width:30%;margin:10px;background-color:#fff;position:absolute;bottom:15%;padding:10px;display:flex;left:calc(45% + 15px)}.story-settings-hide .show-button{margin-left:auto}.current-slide-box{display:flex;flex-direction:row;width:140px;margin-bottom:10px;background-color:#fff;position:absolute;right:50px;top:10px;padding:10px;font-size:14px}.current-slide-box div{margin:auto;display:flex}.slides-settings{width:45%;margin:10px;padding:10px;position:absolute;top:50px;background-color:#fff}.slides-settings .slide-panel{border-left:none;width:100%}.slides-settings .slide-panel .layer{padding:10px;margin:0 0 5px 0;cursor:pointer;width:100%}.slides-settings .slide-panel .layer p{font-size:12px;margin:2px 10px}.slides-settings .slide-panel .layers{display:flex;flex-direction:column}.slides-settings .slide{display:flex;flex-direction:row}.slides-settings .slide>button{border:1px solid #f0f0f0;border-right:none;background:transparent;height:56px}.slides-settings .slide h2::before{background:none;content:none}.slides-settings .add-button{margin-top:15px;width:100%;background:#f0f0f0}.slides-settings .add-button:focus{background:#f0f0f0}.slides-settings .add-button div{margin:auto;display:flex}.slides-settings .add-button svg{margin-top:auto;margin-bottom:auto;margin-right:5px}.slides-settings .add-button p{margin:0 0 0 5px}.slides-settings .lock-location-button{margin-top:15px;width:100%;background:#f0f0f0}.slides-settings .lock-location-button:focus{background:#f0f0f0}.slides-settings .lock-location-button div{margin:auto;display:flex}.slides-settings .lock-location-button svg{margin-top:auto;margin-bottom:auto;margin-right:5px}.slides-settings .lock-location-button p{margin:0 0 0 5px}.slides-settings .preview-button{margin:15px 0;width:100%;background:#f0f0f0}.slides-settings .preview-button:focus{background:#f0f0f0}.slides-settings .preview-button div{margin:auto;display:flex}.slides-settings .preview-button svg{margin-top:auto;margin-bottom:auto;margin-right:5px}.slides-settings .preview-button p{margin:0 0 0 5px}.slides-settings .remove-button{margin-top:15px;width:100%;background:#ff7474}.slides-settings .remove-button:focus{background:#ff7474}.slides-settings .remove-button div{margin:auto;display:flex}.slides-settings .remove-button svg{margin-top:auto;margin-bottom:auto;margin-right:5px}.slides-settings .remove-button p{margin:0 0 0 5px}.slides-settings .slides-container{height:330px;overflow-y:scroll;overflow-x:hidden}.slides-settings-hide{display:flex;width:45%;margin:10px;background-color:#fff;position:absolute;bottom:15%;padding:10px}.slides-settings-hide .show-button{margin-left:auto}.search-adress-input{position:absolute;top:0;left:10px}.tooltip{background-color:#fff;padding:10px;display:none !important}.lock-location-button:hover~.tooltip{display:block !important}.slides-container h2.components-panel__body-title{display:flex;margin-top:0px;margin-bottom:0px;padding:13px 4px}.editor-styles-wrapper .wp-block[data-type="jeo/storymap"]{max-width:97%}',""]),e.exports=t},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(180),i=r(2),a=r(8),s=r.n(a),l=r(49),c=r(16),u=r(12),d=r.n(u),h=r(24),p=r.n(h),f=r(134),m=r.n(f),g=r(135),b=r.n(g);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _=Object(c.withSelect)((function(e,t){var r=t.query,n=t.postType;return{entityRecords:e("core").getEntityRecords("postType",n,r),loading:e("core/data").isResolving("core","getEntityRecords",["postType",n,r])}}))((function(e){var t=e.entityRecords,r=e.filterSuggestions,o=m()(e,["entityRecords","filterSuggestions"]);return Object(n.createElement)(b.a,p()({suggestions:(t||[]).filter(r)},o))})),w=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)}))},x=window._.debounce,k=function(){return!0},C=function(e){return w(e.title.rendered)},E=function(e){return Object(n.createElement)("span",null,w(e.title.rendered))},S=function(e){var t=e.value.trim().toLowerCase();return t?{search:t}:{}},T=Object(l.withInstanceId)((function(e){var t=e.instanceId,r=e.inputProps,o=e.postType,i=e.onSuggestionSelected,a=e.filterSuggestions,s=void 0===a?k:a,l=e.getSuggestionValue,c=void 0===l?C:l,u=e.handleFetchRequest,h=void 0===u?S:u,p=e.renderSuggestion,f=void 0===p?E:p,m=Object(n.useState)({}),g=d()(m,2),b=g[0],v=g[1],w=Object(n.useState)(""),T=d()(w,2),A=T[0],P=T[1],I=Object(n.useCallback)((function(e,t){var r=t.newValue;P(r)}),[P]),O=Object(n.useCallback)(x((function(e){v(h(e))}),500),[v,h]),M=Object(n.useCallback)((function(){v({})}),[v]);return Object(n.createElement)(_,{id:"jeo-autosuggest-".concat(t),query:b,postType:o,inputProps:y(y({},r),{},{value:A,onChange:I}),filterSuggestions:s,getSuggestionValue:c,renderSuggestion:f,onSuggestionsFetchRequested:O,onSuggestionsClearRequested:M,onSuggestionSelected:i})}));function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=Object(c.withSelect)((function(e,t){var r=t.attributes;return{loadedStory:r.storyID&&e("core").getEntityRecord("postType","storymap",r.storyID)}})),O=Object(l.compose)(l.withInstanceId,I)((function(e){var t=e.attributes,r=e.instanceId,o=e.loadedStory,a=e.setAttributes,s="jeo-storymap-autosuggest-".concat(r);return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("label",{htmlFor:s},Object(i.__)("Insert a story map from the library","jeo")+":"),Object(n.createElement)(T,{inputProps:{id:s,placeholder:o?o.title.raw:Object(i.__)("Type a story name","jeo")},postType:"storymap",onSuggestionSelected:function(e,r){var n=r.suggestion;a(P(P({},t),{},{storyID:n.id}))}}))})),M=r(29),D=r.n(M),z=function(e){var t=e.attributes,r=e.className;return Object(n.createElement)("div",{className:D()(["jeomap",r,"map_id_"+t.map_id]),style:{}})},j=r(5),R=r(42),L=r(48);r(340);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=window.jeo_settings.map_defaults,V=Object(c.withSelect)((function(e,t){var r=t.attributes;return{loadedMap:r.map_id&&e("core").getEntityRecord("postType","map",r.map_id),loadingMap:r.map_id&&e("core/data").isResolving("core","getEntityRecord",["postType","map",r.map_id]),loadedLayers:e("core").getEntityRecords("postType","map-layer",{per_page:-1,order:"asc",orderby:"menu_order"}),loadingLayers:e("core/data").isResolving("core","getEntityRecords",["postType","map-layer"])}})),U=Object(l.compose)(l.withInstanceId,V)((function(e){var t=e.attributes,r=e.setAttributes,o=e.instanceId,a=e.loadedLayers,s=e.loadedMap,l=e.loadingMap,c=Object(n.useState)(0),u=d()(c,2),h=u[0],p=u[1];Object(n.useEffect)((function(){p(h+1)}),[t.align,window.screen.width]);return t.map_id&&!s?null:Object(n.createElement)("div",{className:"jeo-mapblock"},t.map_id&&l&&Object(n.createElement)(j.Spinner,null),t.map_id&&!l&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"jeo-preview-area"},Object(n.createElement)(R.b,{onStyleLoad:function(e){e.addControl(new mapboxgl.NavigationControl({showCompass:!1}),"top-left"),s.meta.enable_fullscreen&&e.addControl(new mapboxgl.FullscreenControl,"top-left"),s.meta.disable_scroll_zoom&&e.scrollZoom.disable(),s.meta.disable_drag_pan&&(e.dragPan.disable(),e.touchZoomRotate.disable()),s.meta.disable_drag_rotate&&e.dragRotate.disable()},key:h,style:"mapbox://styles/mapbox/streets-v11",zoom:[s.meta.initial_zoom||F.zoom],center:[s.meta.center_lon||F.lng,s.meta.center_lat||F.lat],containerStyle:{height:"50vh"}},a&&s.meta.layers.map((function(e){var t=a.find((function(t){return t.id===e.id}));if(t)return Object(L.b)({layer:t.meta,instance:e})})))),Object(n.createElement)("div",{className:"jeo-preview-controls"},Object(n.createElement)("p",null,Object(n.createElement)("strong",null,s.title.rendered.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})))),Object(n.createElement)(j.Button,{className:"select-another-map",isLink:!0,isLarge:!0,onClick:function(){var e=t.map_id;r(B(B({},t),{},{map_id:void 0,previous_map:e}))}},Object(n.createElement)("em",null,Object(i.__)("(Select another map)","jeo"))))),!t.map_id&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("label",{htmlFor:"jeo-map-autosuggest-".concat(o)},Object(i.__)("Insert a map from the library","jeo")+":"),Object(n.createElement)(T,{inputProps:{placeholder:Object(i.__)("Type a map name","jeo"),id:"jeo-map-autosuggest-".concat(o)},postType:"map",onSuggestionSelected:function(e,n){var o=n.suggestion;return r(B(B({},t),{},{map_id:o.id}))}}),t.previous_map&&Object(n.createElement)(j.Button,{className:"select-another-map",isLarge:!0,isPrimary:!0,style:{marginTop:"10px"},onClick:function(){var e=t.previous_map;r(B(B({},t),{},{map_id:e}))}},Object(i.__)("Cancel","jeo"))))})),q=function(e){var t,r=e.attributes,o=e.className;t=!!r.related_posts&&["categories","tags","before","after","meta_query"].some((function(e){return r.related_posts[e]}));return Object(n.createElement)("div",{className:D()(["jeomap",o]),"data-center_lat":r.center_lat,"data-center_lon":r.center_lon,"data-initial_zoom":r.initial_zoom,"data-min_zoom":r.min_zoom,"data-max_zoom":r.max_zoom,"data-disable_scroll_zoom":r.disable_scroll_zoom,"data-disable_drag_pan":r.disable_drag_pan,"data-disable_drag_rotate":r.disable_drag_rotate,"data-enable_fullscreen":r.enable_fullscreen,"data-layers":JSON.stringify(r.layers),"data-pan_limits":JSON.stringify(r.pan_limits),"data-related_posts":t?JSON.stringify(r.related_posts):void 0,style:{}})},H=r(395),W=r(177),G=r(179),Z=r(172),Y=r(178),$=r(36);r(406);function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J=window.jeo_settings.map_defaults,Q=Object(c.withSelect)((function(e,t){var r={include:t.attributes.layers.map((function(e){return e.id})),per_page:-1,order:"asc",orderby:"menu_order"};return{loadedLayers:e("core").getEntityRecords("postType","map-layer",r),loadingLayers:e("core/data").isResolving("core","getEntityRecords",["postType","map-layer",r])}}))((function(e){var t=e.attributes,r=e.setAttributes,o=e.loadedLayers,a=e.loadingLayers,l=Object(n.useState)(!1),c=d()(l,2),u=c[0],h=c[1],p=Object(n.useState)(0),f=d()(p,2),m=f[0],g=f[1],b=Object($.a)(o);Object(n.useEffect)((function(){g(m+1)}),[t.align,window.screen.width]);var v=Object(n.useCallback)((function(e){r(X(X({},t),{},{related_posts:e}))}),[r]),y=Object(n.useCallback)((function(){return h(!1)}),[h]),_=Object(n.useCallback)((function(){return h(!0)}),[h]),w=Object(n.useState)("initial_zoom"),x=d()(w,2),k=x[0],C=x[1],E=t[k],S=Object(n.useState)(!1),T=d()(S,2),A=T[0],P=T[1];return Object(n.createElement)(n.Fragment,null,u&&Object(n.createElement)(W.a,{closeModal:y,attributes:t,setAttributes:r,loadedLayers:o,loadingLayers:a}),Object(n.createElement)(H.InspectorControls,null,Object(n.createElement)(G.a,{attributes:t,setAttributes:r,renderPanel:j.PanelBody,setZoomState:C,setPanLimitsFromMap:function(){if(A){var e=A.getBounds();r(X(X({},t),{},{pan_limits:{east:e._ne.lat,north:e._ne.lng,south:e._sw.lng,west:e._sw.lat}}))}}}),Object(n.createElement)(Z.a,{attributes:t,openModal:_,loadLayer:b,loadingLayers:a,renderPanel:j.PanelBody}),Object(n.createElement)(Y.a,{relatedPosts:t.related_posts,setRelatedPosts:v,renderPanel:j.PanelBody})),Object(n.createElement)("div",{className:"jeo-preview-area"},Object(n.createElement)(R.b,{onStyleLoad:function(e){e.addControl(new mapboxgl.NavigationControl({showCompass:!1}),"top-left"),e.addControl(new mapboxgl.FullscreenControl,"top-left"),P(e)},key:E,style:"mapbox://styles/mapbox/streets-v11",zoom:[E||J.zoom],center:[t.center_lon||J.lng,t.center_lat||J.lat],containerStyle:{height:"50vh"},animationOptions:{animate:!1},onMoveEnd:function(e){var t=e.getCenter(),n=Math.round(10*e.getZoom())/10;r(s()({center_lat:t.lat,center_lon:t.lng},k,n))}},o&&t.layers.map((function(e){var t=o.find((function(t){return t.id===e.id})).meta;return Object(L.b)({layer:t,instance:e})})))),Object(n.createElement)("div",{className:"jeo-preview-controls"},Object(n.createElement)(j.Button,{isPrimary:!0,isLarge:!0,onClick:_},Object(i.__)("Edit layers settings","jeo"))))})),ee=r(11),te=r.n(ee),re=r(203),ne=r(204),oe=r.n(ne),ie=r(60),ae=r(70),se=r(13),le=r.n(se),ce=r(14),ue=r.n(ce),de=r(396),he=function(){function e(t){le()(this,e),this.loader=t}return ue()(e,[{key:"upload",value:function(){return this.loader.file.then((function(e){return new Promise((function(t,r){Object(de.uploadMedia)({filesList:[e],onError:function(e){r(e.message)},onFileChange:function(e){var r=d()(e,1)[0];r.url.startsWith("blob:")||t({default:r.url})}})}))}))}},{key:"abort",value:function(){}}]),e}();function pe(e){return new he(e)}var fe=[{color:"rgb(0, 0, 0)",label:"Black"},{color:"rgb(26, 26, 26)",label:"90% Gray"},{color:"rgb(51, 51, 51)",label:"80% Gray"},{color:"rgb(77, 77, 77)",label:"70% Gray"},{color:"rgb(102, 102, 102)",label:"60% Gray"},{color:"rgb(128, 128, 128)",label:"50% Gray"},{color:"rgb(153, 153, 153)",label:"40% Gray"},{color:"rgb(179, 179, 179)",label:"30% Gray"},{color:"rgb(204, 204, 204)",label:"20% Gray"},{color:"rgb(230, 230, 230)",label:"10% Gray"},{color:"rgb(236, 236, 236)",label:"7.5% Gray"},{color:"rgb(242, 242, 242)",label:"5% Gray"},{color:"rgb(249, 249, 249)",label:"2.5% Gray"},{color:"rgb(255, 255, 255)",label:"White"},{color:"rgb(128, 0, 0)",label:"Maroon"},{color:"rgb(255, 0, 0)",label:"Red"},{color:"rgb(128, 128, 0)",label:"Olive"},{color:"rgb(255, 255, 0)",label:"Yellow"},{color:"rgb(0, 128, 0)",label:"Green"},{color:"rgb(0, 255, 0)",label:"Lime"},{color:"rgb(0, 128, 128)",label:"Teal"},{color:"rgb(0, 255, 255)",label:"Aqua"},{color:"rgb(0, 0, 128)",label:"Navy"},{color:"rgb(0, 0, 255)",label:"Blue"},{color:"rgb(128, 0, 128)",label:"Purple"},{color:"rgb(255, 0, 255)",label:"Fuchsia"},{color:"rgb(43, 0, 0)"},{color:"rgb(85, 0, 0)"},{color:"rgb(128, 0, 0)"},{color:"rgb(170, 0, 0)"},{color:"rgb(212, 0, 0)"},{color:"rgb(255, 0, 0)"},{color:"rgb(255, 42, 42)"},{color:"rgb(255, 85, 85)"},{color:"rgb(255, 128, 128)"},{color:"rgb(255, 170, 170)"},{color:"rgb(255, 213, 213)"},{color:"rgb(40, 11, 11)"},{color:"rgb(80, 22, 22)"},{color:"rgb(120, 33, 33)"},{color:"rgb(160, 44, 44)"},{color:"rgb(200, 55, 55)"},{color:"rgb(211, 95, 95)"},{color:"rgb(222, 135, 135)"},{color:"rgb(233, 175, 175)"},{color:"rgb(244, 215, 215)"},{color:"rgb(36, 28, 28)"},{color:"rgb(72, 55, 55)"},{color:"rgb(108, 83, 83)"},{color:"rgb(145, 111, 111)"},{color:"rgb(172, 147, 147)"},{color:"rgb(200, 183, 183)"},{color:"rgb(227, 219, 219)"},{color:"rgb(43, 17, 0)"},{color:"rgb(85, 34, 0)"},{color:"rgb(128, 51, 0)"},{color:"rgb(170, 68, 0)"},{color:"rgb(212, 85, 0)"},{color:"rgb(255, 102, 0)"},{color:"rgb(255, 127, 42)"},{color:"rgb(255, 153, 85)"},{color:"rgb(255, 179, 128)"},{color:"rgb(255, 204, 170)"},{color:"rgb(255, 230, 213)"},{color:"rgb(40, 23, 11)"},{color:"rgb(80, 45, 22)"},{color:"rgb(120, 68, 33)"},{color:"rgb(160, 90, 44)"},{color:"rgb(200, 113, 55)"},{color:"rgb(211, 141, 95)"},{color:"rgb(222, 170, 135)"},{color:"rgb(233, 198, 175)"},{color:"rgb(244, 227, 215)"},{color:"rgb(36, 31, 28)"},{color:"rgb(72, 62, 55)"},{color:"rgb(108, 93, 83)"},{color:"rgb(145, 124, 111)"},{color:"rgb(172, 157, 147)"},{color:"rgb(200, 190, 183)"},{color:"rgb(227, 222, 219)"},{color:"rgb(43, 34, 0)"},{color:"rgb(85, 68, 0)"},{color:"rgb(128, 102, 0)"},{color:"rgb(170, 136, 0)"},{color:"rgb(212, 170, 0)"},{color:"rgb(255, 204, 0)"},{color:"rgb(255, 212, 42)"},{color:"rgb(255, 221, 85)"},{color:"rgb(255, 230, 128)"},{color:"rgb(255, 238, 170)"},{color:"rgb(255, 246, 213)"},{color:"rgb(40, 34, 11)"},{color:"rgb(80, 68, 22)"},{color:"rgb(120, 103, 33)"},{color:"rgb(160, 137, 44)"},{color:"rgb(200, 171, 55)"},{color:"rgb(211, 188, 95)"},{color:"rgb(222, 205, 135)"},{color:"rgb(233, 221, 175)"},{color:"rgb(244, 238, 215)"},{color:"rgb(36, 34, 28)"},{color:"rgb(72, 69, 55)"},{color:"rgb(108, 103, 83)"},{color:"rgb(145, 138, 111)"},{color:"rgb(172, 167, 147)"},{color:"rgb(200, 196, 183)"},{color:"rgb(227, 226, 219)"},{color:"rgb(34, 43, 0)"},{color:"rgb(68, 85, 0)"},{color:"rgb(102, 128, 0)"},{color:"rgb(136, 170, 0)"},{color:"rgb(170, 212, 0)"},{color:"rgb(204, 255, 0)"},{color:"rgb(212, 255, 42)"},{color:"rgb(221, 255, 85)"},{color:"rgb(229, 255, 128)"},{color:"rgb(238, 255, 170)"},{color:"rgb(246, 255, 213)"},{color:"rgb(34, 40, 11)"},{color:"rgb(68, 80, 22)"},{color:"rgb(103, 120, 33)"},{color:"rgb(137, 160, 44)"},{color:"rgb(171, 200, 55)"},{color:"rgb(188, 211, 95)"},{color:"rgb(205, 222, 135)"},{color:"rgb(221, 233, 175)"},{color:"rgb(238, 244, 215)"},{color:"rgb(34, 36, 28)"},{color:"rgb(69, 72, 55)"},{color:"rgb(103, 108, 83)"},{color:"rgb(138, 145, 111)"},{color:"rgb(167, 172, 147)"},{color:"rgb(196, 200, 183)"},{color:"rgb(226, 227, 219)"},{color:"rgb(17, 43, 0)"},{color:"rgb(34, 85, 0)"},{color:"rgb(51, 128, 0)"},{color:"rgb(68, 170, 0)"},{color:"rgb(85, 212, 0)"},{color:"rgb(102, 255, 0)"},{color:"rgb(127, 255, 42)"},{color:"rgb(153, 255, 85)"},{color:"rgb(179, 255, 128)"},{color:"rgb(204, 255, 170)"},{color:"rgb(229, 255, 213)"},{color:"rgb(23, 40, 11)"},{color:"rgb(45, 80, 22)"},{color:"rgb(68, 120, 33)"},{color:"rgb(90, 160, 44)"},{color:"rgb(113, 200, 55)"},{color:"rgb(141, 211, 95)"},{color:"rgb(170, 222, 135)"},{color:"rgb(198, 233, 175)"},{color:"rgb(227, 244, 215)"},{color:"rgb(31, 36, 28)"},{color:"rgb(62, 72, 55)"},{color:"rgb(93, 108, 83)"},{color:"rgb(124, 145, 111)"},{color:"rgb(157, 172, 147)"},{color:"rgb(190, 200, 183)"},{color:"rgb(222, 227, 219)"},{color:"rgb(0, 43, 0)"},{color:"rgb(0, 85, 0)"},{color:"rgb(0, 128, 0)"},{color:"rgb(0, 170, 0)"},{color:"rgb(0, 212, 0)"},{color:"rgb(0, 255, 0)"},{color:"rgb(42, 255, 42)"},{color:"rgb(85, 255, 85)"},{color:"rgb(128, 255, 128)"},{color:"rgb(170, 255, 170)"},{color:"rgb(213, 255, 213)"},{color:"rgb(11, 40, 11)"},{color:"rgb(22, 80, 22)"},{color:"rgb(33, 120, 33)"},{color:"rgb(44, 160, 44)"},{color:"rgb(55, 200, 55)"},{color:"rgb(95, 211, 95)"},{color:"rgb(135, 222, 135)"},{color:"rgb(175, 233, 175)"},{color:"rgb(215, 244, 215)"},{color:"rgb(28, 36, 28)"},{color:"rgb(55, 72, 55)"},{color:"rgb(83, 108, 83)"},{color:"rgb(111, 145, 111)"},{color:"rgb(147, 172, 147)"},{color:"rgb(183, 200, 183)"},{color:"rgb(219, 227, 219)"},{color:"rgb(0, 43, 17)"},{color:"rgb(0, 85, 34)"},{color:"rgb(0, 128, 51)"},{color:"rgb(0, 170, 68)"},{color:"rgb(0, 212, 85)"},{color:"rgb(0, 255, 102)"},{color:"rgb(42, 255, 128)"},{color:"rgb(85, 255, 153)"},{color:"rgb(128, 255, 179)"},{color:"rgb(170, 255, 204)"},{color:"rgb(213, 255, 230)"},{color:"rgb(11, 40, 23)"},{color:"rgb(22, 80, 45)"},{color:"rgb(33, 120, 68)"},{color:"rgb(44, 160, 90)"},{color:"rgb(55, 200, 113)"},{color:"rgb(95, 211, 141)"},{color:"rgb(135, 222, 170)"},{color:"rgb(175, 233, 198)"},{color:"rgb(215, 244, 227)"},{color:"rgb(28, 36, 31)"},{color:"rgb(55, 72, 62)"},{color:"rgb(83, 108, 93)"},{color:"rgb(111, 145, 124)"},{color:"rgb(147, 172, 157)"},{color:"rgb(183, 200, 190)"},{color:"rgb(219, 227, 222)"},{color:"rgb(0, 43, 34)"},{color:"rgb(0, 85, 68)"},{color:"rgb(0, 128, 102)"},{color:"rgb(0, 170, 136)"},{color:"rgb(0, 212, 170)"},{color:"rgb(0, 255, 204)"},{color:"rgb(42, 255, 213)"},{color:"rgb(85, 255, 221)"},{color:"rgb(128, 255, 230)"},{color:"rgb(170, 255, 238)"},{color:"rgb(213, 255, 246)"},{color:"rgb(11, 40, 34)"},{color:"rgb(22, 80, 68)"},{color:"rgb(33, 120, 103)"},{color:"rgb(44, 160, 137)"},{color:"rgb(55, 200, 171)"},{color:"rgb(95, 211, 188)"},{color:"rgb(135, 222, 205)"},{color:"rgb(175, 233, 221)"},{color:"rgb(215, 244, 238)"},{color:"rgb(28, 36, 34)"},{color:"rgb(55, 72, 69)"},{color:"rgb(83, 108, 103)"},{color:"rgb(111, 145, 138)"},{color:"rgb(147, 172, 167)"},{color:"rgb(183, 200, 196)"},{color:"rgb(219, 227, 226)"},{color:"rgb(0, 34, 43)"},{color:"rgb(0, 68, 85)"},{color:"rgb(0, 102, 128)"},{color:"rgb(0, 136, 170)"},{color:"rgb(0, 170, 212)"},{color:"rgb(0, 204, 255)"},{color:"rgb(42, 212, 255)"},{color:"rgb(85, 221, 255)"},{color:"rgb(128, 229, 255)"},{color:"rgb(170, 238, 255)"},{color:"rgb(213, 246, 255)"},{color:"rgb(11, 34, 40)"},{color:"rgb(22, 68, 80)"},{color:"rgb(33, 103, 120)"},{color:"rgb(44, 137, 160)"},{color:"rgb(55, 171, 200)"},{color:"rgb(95, 188, 211)"},{color:"rgb(135, 205, 222)"},{color:"rgb(175, 221, 233)"},{color:"rgb(215, 238, 244)"},{color:"rgb(28, 34, 36)"},{color:"rgb(55, 69, 72)"},{color:"rgb(83, 103, 108)"},{color:"rgb(111, 138, 145)"},{color:"rgb(147, 167, 172)"},{color:"rgb(183, 196, 200)"},{color:"rgb(219, 226, 227)"},{color:"rgb(0, 17, 43)"},{color:"rgb(0, 34, 85)"},{color:"rgb(0, 51, 128)"},{color:"rgb(0, 68, 170)"},{color:"rgb(0, 85, 212)"},{color:"rgb(0, 102, 255)"},{color:"rgb(42, 127, 255)"},{color:"rgb(85, 153, 255)"},{color:"rgb(128, 179, 255)"},{color:"rgb(170, 204, 255)"},{color:"rgb(213, 229, 255)"},{color:"rgb(11, 23, 40)"},{color:"rgb(22, 45, 80)"},{color:"rgb(33, 68, 120)"},{color:"rgb(44, 90, 160)"},{color:"rgb(55, 113, 200)"},{color:"rgb(95, 141, 211)"},{color:"rgb(135, 170, 222)"},{color:"rgb(175, 198, 233)"},{color:"rgb(215, 227, 244)"},{color:"rgb(28, 31, 36)"},{color:"rgb(55, 62, 72)"},{color:"rgb(83, 93, 108)"},{color:"rgb(111, 124, 145)"},{color:"rgb(147, 157, 172)"},{color:"rgb(183, 190, 200)"},{color:"rgb(219, 222, 227)"},{color:"rgb(0, 0, 43)"},{color:"rgb(0, 0, 85)"},{color:"rgb(0, 0, 128)"},{color:"rgb(0, 0, 170)"},{color:"rgb(0, 0, 212)"},{color:"rgb(0, 0, 255)"},{color:"rgb(42, 42, 255)"},{color:"rgb(85, 85, 255)"},{color:"rgb(128, 128, 255)"},{color:"rgb(170, 170, 255)"},{color:"rgb(213, 213, 255)"},{color:"rgb(11, 11, 40)"},{color:"rgb(22, 22, 80)"},{color:"rgb(33, 33, 120)"},{color:"rgb(44, 44, 160)"},{color:"rgb(55, 55, 200)"},{color:"rgb(95, 95, 211)"},{color:"rgb(135, 135, 222)"},{color:"rgb(175, 175, 233)"},{color:"rgb(215, 215, 244)"},{color:"rgb(28, 28, 36)"},{color:"rgb(55, 55, 72)"},{color:"rgb(83, 83, 108)"},{color:"rgb(111, 111, 145)"},{color:"rgb(147, 147, 172)"},{color:"rgb(183, 183, 200)"},{color:"rgb(219, 219, 227)"},{color:"rgb(17, 0, 43)"},{color:"rgb(34, 0, 85)"},{color:"rgb(51, 0, 128)"},{color:"rgb(68, 0, 170)"},{color:"rgb(85, 0, 212)"},{color:"rgb(102, 0, 255)"},{color:"rgb(127, 42, 255)"},{color:"rgb(153, 85, 255)"},{color:"rgb(179, 128, 255)"},{color:"rgb(204, 170, 255)"},{color:"rgb(229, 213, 255)"},{color:"rgb(23, 11, 40)"},{color:"rgb(45, 22, 80)"},{color:"rgb(68, 33, 120)"},{color:"rgb(90, 44, 160)"},{color:"rgb(113, 55, 200)"},{color:"rgb(141, 95, 211)"},{color:"rgb(170, 135, 222)"},{color:"rgb(198, 175, 233)"},{color:"rgb(227, 215, 244)"},{color:"rgb(31, 28, 36)"},{color:"rgb(62, 55, 72)"},{color:"rgb(93, 83, 108)"},{color:"rgb(124, 111, 145)"},{color:"rgb(157, 147, 172)"},{color:"rgb(190, 183, 200)"},{color:"rgb(222, 219, 227)"},{color:"rgb(34, 0, 43)"},{color:"rgb(68, 0, 85)"},{color:"rgb(102, 0, 128)"},{color:"rgb(136, 0, 170)"},{color:"rgb(170, 0, 212)"},{color:"rgb(204, 0, 255)"},{color:"rgb(212, 42, 255)"},{color:"rgb(221, 85, 255)"},{color:"rgb(229, 128, 255)"},{color:"rgb(238, 170, 255)"},{color:"rgb(246, 213, 255)"},{color:"rgb(34, 11, 40)"},{color:"rgb(68, 22, 80)"},{color:"rgb(103, 33, 120)"},{color:"rgb(137, 44, 160)"},{color:"rgb(171, 55, 200)"},{color:"rgb(188, 95, 211)"},{color:"rgb(205, 135, 222)"},{color:"rgb(221, 175, 233)"},{color:"rgb(238, 215, 244)"},{color:"rgb(34, 28, 36)"},{color:"rgb(69, 55, 72)"},{color:"rgb(103, 83, 108)"},{color:"rgb(138, 111, 145)"},{color:"rgb(167, 147, 172)"},{color:"rgb(196, 183, 200)"},{color:"rgb(226, 219, 227)"},{color:"rgb(43, 0, 34)"},{color:"rgb(85, 0, 68)"},{color:"rgb(128, 0, 102)"},{color:"rgb(170, 0, 136)"},{color:"rgb(212, 0, 170)"},{color:"rgb(255, 0, 204)"},{color:"rgb(255, 42, 212)"},{color:"rgb(255, 85, 221)"},{color:"rgb(255, 128, 229)"},{color:"rgb(255, 170, 238)"},{color:"rgb(255, 213, 246)"},{color:"rgb(40, 11, 34)"},{color:"rgb(80, 22, 68)"},{color:"rgb(120, 33, 103)"},{color:"rgb(160, 44, 137)"},{color:"rgb(200, 55, 171)"},{color:"rgb(211, 95, 188)"},{color:"rgb(222, 135, 205)"},{color:"rgb(233, 175, 221)"},{color:"rgb(244, 215, 238)"},{color:"rgb(36, 28, 34)"},{color:"rgb(72, 55, 69)"},{color:"rgb(108, 83, 103)"},{color:"rgb(145, 111, 138)"},{color:"rgb(172, 147, 167)"},{color:"rgb(200, 183, 196)"},{color:"rgb(227, 219, 226)"},{color:"rgb(43, 0, 17)"},{color:"rgb(85, 0, 34)"},{color:"rgb(128, 0, 51)"},{color:"rgb(170, 0, 68)"},{color:"rgb(212, 0, 85)"},{color:"rgb(255, 0, 102)"},{color:"rgb(255, 42, 127)"},{color:"rgb(255, 85, 153)"},{color:"rgb(255, 128, 178)"},{color:"rgb(255, 170, 204)"},{color:"rgb(255, 213, 229)"},{color:"rgb(40, 11, 23)"},{color:"rgb(80, 22, 45)"},{color:"rgb(120, 33, 68)"},{color:"rgb(160, 44, 90)"},{color:"rgb(200, 55, 113)"},{color:"rgb(211, 95, 141)"},{color:"rgb(222, 135, 170)"},{color:"rgb(233, 175, 198)"},{color:"rgb(244, 215, 227)"},{color:"rgb(36, 28, 31)"},{color:"rgb(72, 55, 62)"},{color:"rgb(108, 83, 93)"},{color:"rgb(145, 111, 124)"},{color:"rgb(172, 147, 157)"},{color:"rgb(200, 183, 190)"},{color:"rgb(227, 219, 222)"}],me=r(174);r(408);function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ye=window.jeo_settings.map_defaults,_e=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2});var we,xe=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ve(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(fe);try{for(xe.s();!(we=xe.n()).done;){var ke=we.value;ke.label||(ke.label=ke.color),ke.hasBorder=!0}}catch(e){xe.e(e)}finally{xe.f()}var Ce=Object(c.withSelect)((function(e,t){var r=t.attributes;return{loadedMap:r.map_id&&e("core").getEntityRecord("postType","map",r.map_id),loadingMap:r.map_id&&e("core/data").isResolving("core","getEntityRecord",["postType","map",r.map_id]),loadedLayers:e("core").getEntityRecords("postType","map-layer",{per_page:-1,order:"asc",orderby:"menu_order",ID:122820}),loadingLayers:e("core/data").isResolving("core","getEntityRecords",["postType","map-layer"]),themeColors:e("core/editor").getEditorSettings().colors}})),Ee=Object(l.compose)(l.withInstanceId,Ce)((function(e){var t=e.attributes,r=e.setAttributes,o=e.instanceId,a=e.loadedLayers,s=e.loadedMap,l=e.loadingMap,u=e.themeColors,h=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)}))};function f(e){return null!==e&&""!==e&&(e=e.toString()).replace(/<[^>]*>/g,"")}var m=function(e){if(e.destination){var t=function(e,t,r){var n=Array.from(e),o=n.splice(t,1),i=d()(o,1)[0];return n.splice(r,0,i),n}(G,e.source.index,e.destination.index);Z(t)}},g=Object(n.useState)(!1),b=d()(g,2),v=b[0],y=b[1],_=Object(n.useState)(!1),w=d()(_,2),x=w[0],k=w[1],C=Object(n.useState)(null),E=d()(C,2),S=E[0],A=E[1],P=Object(n.useState)(0),I=d()(P,2),O=I[0],M=I[1],D=Object(n.useState)(""),z=d()(D,2),N=z[0],B=z[1],F=Object(n.useState)(0),V=d()(F,2),U=V[0],q=V[1],H=Object(n.useState)([]),W=d()(H,2),G=W[0],Z=W[1];Object(n.useEffect)((function(){if(t.slides&&s&&a){var e=t.slides.map((function(e){e.selectedLayers.forEach((function(t,r){s.meta.layers.some((function(e){return e.id===t.id}))&&a.some((function(e){return e.id===t.id}))||e.selectedLayers.splice(r,1)}));var t=[];return s.meta.layers.forEach((function(r){var n=e.selectedLayers.find((function(e){return e.id===r.id}));n&&t.push(n)})),e.selectedLayers=t,e})),n=a.filter((function(e){return s.meta.layers.some((function(t){return t.id===e.id}))})),o=[];return s.meta.layers.forEach((function(e){var t=n.find((function(t){return t.id===e.id}));t&&o.push(t)})),n=o,void r(be(be({},t),{},{slides:e,loadedLayers:a,navigateMapLayers:n}))}r(be(be({},t),{},{loadedLayers:a,navigateMapLayers:a}))}),[l,a]);var Y=Object(n.useMemo)((function(){var e=[];return t.map_id&&s&&(e=s.meta.layers),e.map((function(e){return Object(c.select)("core").getEntityRecord("postType","map-layer",e.id)}))}),[s,a,t.map_id]),$=Object(n.useMemo)((function(){var e=Y.flatMap((function(e){var t,r;return(null==e||null===(t=e.meta.legend_type_options)||void 0===t||null===(r=t.colors)||void 0===r?void 0:r.map((function(t,r,n){var o;return{label:"".concat(e.title.raw,"  ").concat(t.label||(o=r/(n.length-1),_e.format(o))),color:t.color,hasBorder:!0}})))||[]})),t=[].concat(te()(e),te()((u||[]).map((function(e){return{label:e.name,color:e.color,hasBorder:!0}}))),te()(fe));return{toolbar:"undo redo | bold italic underline fontColor fontBackgroundColor | heading bulletedList numberedList | link imageUpload htmlEmbed".split(" "),fontBackgroundColor:{colors:t,columns:14},fontColor:{colors:t,columns:14},image:{toolbar:["imageTextAlternative"]},mediaEmbed:{previewsInData:!0}}}),[Y,u]);if(Object(n.useEffect)((function(){t.slides||r(be(be({},t),{},{slides:[{title:null,content:null,selectedLayers:[],latitude:ye.lat,longitude:ye.lng,zoom:ye.zoom,pitch:0,bearing:0}],loadedLayers:a,navigateMapLayers:[]}));var e=wp.data.select("core/editor").getCurrentPostId();r(be(be({},t),{},{postID:e}))}),[]),t.map_id&&!s)return Object(n.createElement)("div",null,"Esse aqui  o loadedMap");var K=window.jeo_settings.jeo_typography_name;return K||(K="sans-serif"),document.body.style.setProperty("--globalFontFamily",K),Object(n.createElement)("div",{className:"jeo-mapblock storymap"},t.map_id&&l&&Object(n.createElement)(j.Spinner,null),t.map_id&&!l&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"jeo-preview-area"},Object(n.createElement)(R.b,{key:U,onStyleLoad:function(e){A(e),Z(Y),e.addControl(new mapboxgl.NavigationControl({showCompass:!1}),"top-right"),s.meta.enable_fullscreen&&e.addControl(new mapboxgl.FullscreenControl,"top-right")},style:"mapbox://styles/mapbox/streets-v11",zoom:[t.slides[O].zoom||ye.zoom],center:[t.slides[O].longitude||ye.lng,t.slides[O].latitude||ye.lat],bearing:[t.slides[O].bearing]||!1,pitch:[t.slides[O].pitch]||!1,containerStyle:{height:"85vh"}},t.slides[O].selectedLayers.map((function(e){if(t.navigateMapLayers){var r=t.navigateMapLayers.find((function(t){return t.id===e.id}));if(r)return Object(L.b)({layer:r.meta,instance:e})}})))),Object(n.createElement)("div",{className:"storymap-controls"},v&&Object(n.createElement)("div",{className:"story-settings"},Object(n.createElement)("div",{className:"heading"},Object(n.createElement)("span",{className:"section-title"},Object(i.__)("Story settings","jeo")),Object(n.createElement)(j.Button,{className:"hide-button",onClick:function(){y(!1)}},Object(n.createElement)(j.Dashicon,{icon:"arrow-down-alt2"}))),Object(n.createElement)("label",{className:"input-label"},Object(i.__)("Brief description","jeo")),Object(n.createElement)(re.CKEditor,{editor:oe.a,data:t.description,config:$,onReady:function(e){e.plugins.get("FileRepository").createUploadAdapter=pe},onChange:function(e,n){r(be(be({},t),{},{description:n.getData()}))}}),Object(n.createElement)(j.CheckboxControl,{className:"introduction-button",label:Object(i.__)("Show story map introduction","jeo"),checked:t.hasIntroduction,onChange:function(e){r(be(be({},t),{},{hasIntroduction:e}))}}),Object(n.createElement)(j.CheckboxControl,{className:"navigate-button",label:Object(i.__)('Use "Navigate to map" button',"jeo"),checked:t.navigateButton,onChange:function(e){r(be(be({},t),{},{navigateButton:e}))}})),!v&&Object(n.createElement)("div",{className:"story-settings-hide"},Object(n.createElement)("span",{className:"section-title"},Object(i.__)("Story settings","jeo")),Object(n.createElement)(j.Button,{className:"show-button",disabled:!(s&&a),onClick:function(){y(!0)}},Object(n.createElement)(j.Dashicon,{icon:"arrow-up-alt2"}))),x&&Object(n.createElement)("div",{className:"slides-settings"},Object(n.createElement)("div",{className:"heading"},Object(n.createElement)("span",{className:"section-title"},Object(i.__)("Slides settings","jeo")),Object(n.createElement)(j.Button,{className:"hide-button",onClick:function(){k(!1)}},Object(n.createElement)(j.Dashicon,{icon:"arrow-down-alt2"}))),Object(n.createElement)(ae.List,{values:t.slides,onChange:function(e){var n=e.oldIndex,o=e.newIndex,i=JSON.parse(JSON.stringify(t.slides));i=Object(ae.arrayMove)(i,n,o),r(be(be({},t),{},{slides:i}))},renderList:function(e){var t=e.children,r=e.props;return Object(n.createElement)("div",p()({className:"slides-container"},r),t)},renderItem:function(e){var o=e.value,a=e.isDragged,l=e.props,c=o,u=t.slides.indexOf(o);return Object(n.createElement)("div",p()({key:c.content,className:"slide"},l),Object(n.createElement)("button",{"data-movable-handle":!0,tabIndex:-1},"="),Object(n.createElement)(j.Panel,{key:U,className:"slide-panel"},Object(n.createElement)(j.PanelBody,{title:c.title?f(c.title).replace(/\&nbsp;/g,""):Object(i.__)("Slide ","jeo")+(u+1),initialOpen:u===O&&!a,onToggle:function(e){u!==O&&M(u)}},Object(n.createElement)("span",{className:"input-label"},Object(i.__)("Layers","jeo")),Object(n.createElement)(ie.a,{onDragEnd:m},Object(n.createElement)(ie.c,{droppableId:"droppable"},(function(e,o){return Object(n.createElement)("div",p()({},e.droppableProps,{ref:e.innerRef,className:"layers"}),t.navigateMapLayers.map((function(e,o){return Object(n.createElement)(ie.b,{key:"".concat(o),draggableId:"".concat(o),index:o},(function(o,i){var a={background:"rgb(240, 240, 240)"};return t.slides[u].selectedLayers.map((function(t){t.id===e.id&&(a={background:"rgb(200, 200, 200)"})})),e?Object(n.createElement)("div",p()({ref:o.innerRef},o.draggableProps,o.dragHandleProps),Object(n.createElement)(j.Button,{style:a,className:"layer",key:e.id,onClick:function(){M(u);var n=JSON.parse(JSON.stringify(t.slides)),o=!1;if(n[u].selectedLayers.map((function(t,r){t.id===e.id&&(n[u].selectedLayers.splice(r,1),o=!0)})),!o){var i,a=Array(s.meta.layers.length).fill(null),l=function(e){var t=-1;return s.meta.layers.forEach((function(r,n){e.id===r.id&&(t=n)})),t};n[u].selectedLayers.map((function(e){var t=l(e);t>=0&&(a[t]=e)})),i=l(e),a[i]=e,a=a.filter((function(e){return null!==e})),n[u].selectedLayers=a}q(U+1),r(be(be({},t),{},{slides:n}))}},Object(n.createElement)("span",null,h(e.title.rendered)))):null}))})),e.placeholder)}))),Object(n.createElement)("div",{style:{display:"flex"}},t.slides[u].latitude==ye.lat&&t.slides[u].longitude==ye.lng&&t.slides[u].zoom==ye.zoom&&0==t.slides[u].bearing&&0==t.slides[u].pitch&&Object(n.createElement)(j.Button,{className:"lock-location-button",onClick:function(){M(u);var e=S.getCenter().lat,n=S.getCenter().lng,o=Math.round(10*S.getZoom())/10,i=S.getPitch(),a=S.getBearing(),s=te()(t.slides);s[u].latitude=e,s[u].longitude=n,s[u].zoom=o,s[u].pitch=i,s[u].bearing=a,r(be(be({},t),{},{slides:s}))}},Object(n.createElement)("div",{className:"flex-center"},Object(n.createElement)(j.Dashicon,{icon:"unlock"}),Object(n.createElement)("span",null,Object(i.__)("Lock current spot","jeo")))),!(t.slides[u].latitude==ye.lat&&t.slides[u].longitude==ye.lng&&t.slides[u].zoom==ye.zoom&&0==t.slides[u].bearing&&0==t.slides[u].pitch)&&Object(n.createElement)(j.Button,{className:"lock-location-button",onClick:function(){M(u);var e=S.getCenter().lat,n=S.getCenter().lng,o=Math.round(10*S.getZoom())/10,i=S.getPitch(),a=S.getBearing(),s=te()(t.slides);s[u].latitude=e,s[u].longitude=n,s[u].zoom=o,s[u].pitch=i,s[u].bearing=a,r(be(be({},t),{},{slides:s}))}},Object(n.createElement)("div",null,Object(n.createElement)(j.Dashicon,{icon:"lock"}),Object(n.createElement)("span",null,Object(i.__)("Lock current spot","jeo"))))),Object(n.createElement)(j.Button,{className:"preview-button",onClick:function(){M(u),q(U+1)}},Object(n.createElement)("div",{className:"flex-center"},Object(n.createElement)(j.Dashicon,{icon:"visibility"}),Object(n.createElement)("span",null,Object(i.__)("Preview","jeo")))),Object(n.createElement)("span",{className:"input-label"},Object(i.__)("Title","jeo")),Object(n.createElement)(re.CKEditor,{atributo:"meuatributo",editor:oe.a,data:c.title,config:$,onReady:function(e){e.plugins.get("FileRepository").createUploadAdapter=pe},onChange:function(e,n){n.ui.getEditableElement().setAttribute("role","button"),M(u);var o=te()(t.slides);o[u].title=n.getData(),r(be(be({},t),{},{slides:o}))}}),Object(n.createElement)("span",{className:"input-label"},Object(i.__)("Content","jeo")),Object(n.createElement)(re.CKEditor,{editor:oe.a,data:c.content,config:$,onReady:function(e){e.plugins.get("FileRepository").createUploadAdapter=pe},onChange:function(e,n){n.ui.getEditableElement().setAttribute("role","button"),M(u);var o=te()(t.slides);o[u].content=n.getData(),r(be(be({},t),{},{slides:o}))}}),Object(n.createElement)(j.Button,{className:"remove-button",onClick:function(){if(t.slides.length<=1)alert(Object(i.__)("The minimum number of slides is 1.","jeo"));else if(confirm(Object(i.__)("Do you really want to remove this slide?","jeo"))&&t.slides.length>=2){M(0);var e=te()(t.slides);e.splice(u,1),r(be(be({},t),{},{slides:e}))}}},Object(n.createElement)("div",{className:"flex-center"},Object(n.createElement)(j.Dashicon,{icon:"trash"}),Object(n.createElement)("span",null,Object(i.__)("Remove","jeo")))))))}}),Object(n.createElement)(j.Button,{className:"add-button",onClick:function(){var e=t.slides.slice(-1);r(be(be({},t),{},{slides:[].concat(te()(t.slides),[{title:null,content:null,selectedLayers:e[0].selectedLayers,latitude:e[0].latitude,longitude:e[0].longitude,zoom:e[0].zoom,pitch:e[0].pitch,bearing:e[0].bearing}])})),M(t.slides.length),q(U+1)}},Object(n.createElement)("div",{className:"flex-center"},Object(n.createElement)(j.Dashicon,{icon:"plus"}),Object(n.createElement)("span",null,Object(i.__)("Add","jeo"))))),!x&&Object(n.createElement)("div",{className:"slides-settings-hide"},Object(n.createElement)("span",{className:"section-title"},Object(i.__)("Slides settings","jeo")),Object(n.createElement)(j.Button,{className:"show-button",disabled:!(s&&a),onClick:function(){k(!0)}},Object(n.createElement)(j.Dashicon,{icon:"arrow-up-alt2"}))),Object(n.createElement)("div",{className:"current-slide-box"},Object(n.createElement)("div",null,Object(n.createElement)("strong",null,Object(i.__)("Current slide: ","jeo"),t.slides[O].title?f(t.slides[O].title).replace(/\&nbsp;/g,""):Object(i.__)("Slide ","jeo")+(O+1)))),Object(n.createElement)(me.a,{className:"search-adress-input",onSelect:function(e){!function(e,t){e.flyTo({center:[parseFloat(t.lon),parseFloat(t.lat)]})}(S,e)},value:N,onChange:function(e){B(e)}})),Object(n.createElement)("div",{className:"jeo-preview-controls"},Object(n.createElement)("span",null,Object(n.createElement)("strong",null,Object(i.__)("Map: ","jeo"),h(s.title.rendered))))),!t.map_id&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("label",{htmlFor:"jeo-map-autosuggest-".concat(o)},Object(i.__)("Insert a map from the library","jeo")+":"),Object(n.createElement)(T,{inputProps:{placeholder:Object(i.__)("Type a map name","jeo"),id:"jeo-map-autosuggest-".concat(o)},postType:"map",onSuggestionSelected:function(e,n){var o=n.suggestion;return r(be(be({},t),{},{map_id:o.id,slides:[{title:null,content:null,selectedLayers:[],latitude:ye.lat,longitude:ye.lng,zoom:ye.zoom,pitch:0,bearing:0}],loadedLayers:a,navigateMapLayers:[]}))}}),t.previous_map&&Object(n.createElement)(j.Button,{className:"select-another-map",isLarge:!0,isPrimary:!0,style:{marginTop:"10px"},onClick:function(){var e=t.previous_map;r(be(be({},t),{},{map_id:e}))}},Object(i.__)("Cancel","jeo"))))})),Se=function(){return Object(n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},Object(n.createElement)("path",{d:"M313.27 124.64L198.73 51.36a32 32 0 0 0-29.28.35L56.51 127.49A16 16 0 0 0 48 141.63v295.8a16 16 0 0 0 23.49 14.14l97.82-63.79a32 32 0 0 1 29.5-.24l111.86 73a32 32 0 0 0 29.27-.11l115.43-75.94a16 16 0 0 0 8.63-14.2V74.57a16 16 0 0 0-23.49-14.14l-98 63.86a32 32 0 0 1-29.24.35z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"36"}),Object(n.createElement)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"36",d:"M328 128v336"}),Object(n.createElement)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"36",d:"M184 48v336"}))},Te=r(41);Object(o.registerBlockType)("jeo/map",{title:Object(i.__)("JEO Map","jeo"),description:Object(i.__)("Display maps with layers and data","jeo"),category:"jeo",icon:Se,supports:{align:!0},attributes:{map_id:{type:"number"}},edit:function(e){return Object(n.createElement)(c.AsyncModeProvider,{value:!0},Object(n.createElement)(U,e))},save:function(e){return Object(n.createElement)(z,e)}}),Object(o.registerBlockType)("jeo/onetime-map",{title:Object(i.__)("JEO One-time Map","jeo"),description:Object(i.__)("Display maps with layers and data","jeo"),category:"jeo",icon:Se,supports:{align:!0},attributes:{layers:{type:"array",default:[],items:{type:"object",properties:{id:{type:"number"},use:{type:"string"},default:{type:"boolean"},show_legend:{type:"boolean"}}}},center_lat:{type:"number"},center_lon:{type:"number"},initial_zoom:{type:"number"},min_zoom:{type:"number"},max_zoom:{type:"number"},disable_scroll_zoom:{type:"boolean"},disable_drag_pan:{type:"booelan"},disable_drag_rotate:{type:"boolean"},enable_fullscreen:{type:"boolean"},pan_limits:{type:"object",properties:{east:{description:Object(i.__)("East pan limit","jeo"),type:"number"},north:{description:Object(i.__)("North pan limit","jeo"),type:"number"},south:{description:Object(i.__)("South pan limit","jeo"),type:"number"},west:{description:Object(i.__)("West pan limit","jeo"),type:"number"}}},related_posts:{type:"object",default:{categories:[],tags:[],meta_query:[]},properties:{categories:{type:"array",items:{type:"integer"}},tags:{type:"array",items:{type:"integer"}},before:{type:"string"},after:{type:"string"},meta_query:{type:"array",items:{type:"object",properties:{key:{type:"string"},compare:{type:"string"},value:{type:"string"}}}}}}},edit:function(e){return Object(n.createElement)(c.AsyncModeProvider,{value:!0},Object(n.createElement)(Q,e))},save:function(e){return Object(n.createElement)(q,e)}});Object(o.registerBlockType)("jeo/storymap",{title:Object(i.__)("Story Map","jeo"),description:Object(i.__)("Display maps with storytelling","jeo"),category:"jeo",icon:Se,attributes:{map_id:{type:"number"},description:{type:"string"},slides:{type:"array"},navigateButton:{type:"boolean"},hasIntroduction:{type:"boolean"},loadedLayers:{type:"array"},navigateMapLayers:{type:"array"},postID:{type:"number"}},edit:function(e){return Object(n.createElement)(c.AsyncModeProvider,{value:!0},Object(n.createElement)(Ee,e))},save:function(e){var t=function(e){var t=Object(Te.cloneDeep)(e),r={map_id:null,description:null,slides:null,navigateButton:null,hasIntroduction:null,navigateMapLayers:null,postID:null};for(var n in r)t.attributes[n]&&(r[n]=t.attributes[n]);function o(e){e&&e.hasOwnProperty("yoast_head")&&delete e.yoast_head}return r.navigateMapLayers.forEach((function(e){o(e),delete e.content})),r.slides.forEach((function(e){e.selectedLayers.forEach((function(e){o(e),e.content&&delete e.content}))})),r.loadedLayers=[],r}(e);return JSON.stringify(t)}}),Object(o.registerBlockType)("jeo/embedded-storymap",{title:Object(i.__)("Embedded Story Map","jeo"),description:Object(i.__)("Display maps with storytelling","jeo"),category:"jeo",icon:Se,attributes:{storyID:{type:"number"}},edit:function(e){return Object(n.createElement)(c.AsyncModeProvider,{value:!0},Object(n.createElement)(O,e))},save:function(e){return JSON.stringify(e)}})}]);